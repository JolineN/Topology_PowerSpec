Cubic Torus
Running - E1 l_max=30, Lx=13824
Running {'topology': 'E1', 'Lx': 0.5, 'Ly': 0.5, 'Lz': 0.5, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 30, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'local', 'amp': 0.6, 'pow_min': 0.0001, 'pow_max': 0.0002, 'location': 0.00045, 'width': 0.05, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Making run folder: runs/E1_Lx_0.50_Ly_0.50_Lz_0.50_beta_90_alpha_90_l_max_30_accuracy_99_percent/
Shape of transfer function from CAMB: (3, 179, 2853)

Finding k_max as a function of ell
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  8.63it/s] 10%|█         | 3/29 [00:00<00:02, 12.53it/s] 17%|█▋        | 5/29 [00:00<00:01, 14.15it/s] 24%|██▍       | 7/29 [00:00<00:01, 15.33it/s] 31%|███       | 9/29 [00:00<00:01, 16.38it/s] 41%|████▏     | 12/29 [00:00<00:00, 18.01it/s] 52%|█████▏    | 15/29 [00:00<00:00, 19.62it/s] 62%|██████▏   | 18/29 [00:00<00:00, 21.24it/s] 72%|███████▏  | 21/29 [00:01<00:00, 22.66it/s] 83%|████████▎ | 24/29 [00:01<00:00, 23.29it/s] 93%|█████████▎| 27/29 [00:01<00:00, 24.09it/s]100%|██████████| 29/29 [00:01<00:00, 20.35it/s]
Done. k_max for TT ell_max = 0.02930188031725805 k_max for EE ell_max = 0.08517944519572987
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 1122308 Minimum k_amp 0.0004544832372877624 n_x_max 65 n_z_max 65
Time to get list of k, phi, theta: 1.9119668006896973 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07599785442142443
Ratio of unique |k|: 0.0030873877759046535
Time to get unique k and theta: 0.21190166473388672 seconds

Getting transfer functions
  0%|          | 0/3465 [00:00<?, ?it/s]  2%|▏         | 55/3465 [00:00<00:06, 523.08it/s]  3%|▎         | 120/3465 [00:00<00:05, 573.95it/s]  5%|▌         | 185/3465 [00:00<00:05, 590.98it/s]  7%|▋         | 245/3465 [00:00<00:05, 589.69it/s]  9%|▉         | 305/3465 [00:00<00:05, 589.51it/s] 11%|█         | 370/3465 [00:00<00:05, 601.14it/s] 13%|█▎        | 435/3465 [00:00<00:04, 611.00it/s] 14%|█▍        | 497/3465 [00:00<00:04, 613.59it/s] 16%|█▌        | 560/3465 [00:00<00:04, 603.75it/s] 18%|█▊        | 625/3465 [00:01<00:04, 614.31it/s] 20%|█▉        | 690/3465 [00:01<00:04, 619.78it/s] 22%|██▏       | 755/3465 [00:01<00:04, 623.52it/s] 24%|██▎       | 820/3465 [00:01<00:04, 625.74it/s] 26%|██▌       | 885/3465 [00:01<00:04, 625.66it/s] 27%|██▋       | 950/3465 [00:01<00:04, 628.35it/s] 30%|███       | 1045/3465 [00:01<00:03, 719.00it/s] 33%|███▎      | 1150/3465 [00:01<00:02, 810.35it/s] 36%|███▋      | 1260/3465 [00:01<00:02, 886.61it/s] 39%|███▉      | 1355/3465 [00:01<00:02, 892.58it/s] 42%|████▏     | 1460/3465 [00:02<00:02, 935.87it/s] 45%|████▌     | 1565/3465 [00:02<00:01, 967.80it/s] 48%|████▊     | 1665/3465 [00:02<00:01, 970.24it/s] 51%|█████     | 1763/3465 [00:02<00:01, 903.12it/s] 54%|█████▎    | 1855/3465 [00:02<00:01, 853.92it/s] 56%|█████▌    | 1942/3465 [00:02<00:01, 834.96it/s] 58%|█████▊    | 2027/3465 [00:02<00:01, 817.46it/s] 61%|██████    | 2110/3465 [00:02<00:01, 796.60it/s] 63%|██████▎   | 2190/3465 [00:02<00:01, 784.74it/s] 66%|██████▌   | 2270/3465 [00:03<00:01, 785.59it/s] 68%|██████▊   | 2349/3465 [00:03<00:01, 782.13it/s] 70%|███████   | 2428/3465 [00:03<00:01, 759.03it/s] 72%|███████▏  | 2505/3465 [00:03<00:01, 745.59it/s] 74%|███████▍  | 2580/3465 [00:03<00:01, 741.37it/s] 77%|███████▋  | 2660/3465 [00:03<00:01, 754.06it/s] 79%|███████▉  | 2740/3465 [00:03<00:00, 759.11it/s] 81%|████████▏ | 2816/3465 [00:03<00:00, 752.42it/s] 84%|████████▎ | 2895/3465 [00:03<00:00, 756.69it/s] 86%|████████▌ | 2975/3465 [00:03<00:00, 764.12it/s] 88%|████████▊ | 3055/3465 [00:04<00:00, 767.70it/s] 90%|█████████ | 3135/3465 [00:04<00:00, 772.45it/s] 93%|█████████▎| 3220/3465 [00:04<00:00, 790.85it/s] 95%|█████████▌| 3305/3465 [00:04<00:00, 796.09it/s] 98%|█████████▊| 3395/3465 [00:04<00:00, 815.55it/s]100%|██████████| 3465/3465 [00:04<00:00, 753.82it/s]
Size of transfer function: 0.82 MB. 

Size of integrand: 25.4 MB. Time to calculate integrand: 0.6220812797546387 s

Getting spherical harmonics
  0%|          | 0/85293 [00:00<?, ?it/s]  5%|▌         | 4368/85293 [00:00<00:01, 43246.07it/s] 10%|█         | 8693/85293 [00:00<00:02, 35352.25it/s] 14%|█▍        | 12316/85293 [00:00<00:02, 35158.56it/s] 19%|█▊        | 15904/85293 [00:00<00:01, 35029.61it/s] 23%|██▎       | 19434/85293 [00:00<00:01, 34577.37it/s] 27%|██▋       | 22908/85293 [00:00<00:01, 32526.20it/s] 31%|███▏      | 26656/85293 [00:00<00:01, 33863.24it/s] 37%|███▋      | 31360/85293 [00:00<00:01, 37774.97it/s] 42%|████▏     | 35616/85293 [00:00<00:01, 39086.99it/s] 47%|████▋     | 39760/85293 [00:01<00:01, 39747.76it/s] 52%|█████▏    | 44016/85293 [00:01<00:01, 40289.36it/s] 57%|█████▋    | 48832/85293 [00:01<00:00, 42513.84it/s] 64%|██████▍   | 54432/85293 [00:01<00:00, 46406.49it/s] 69%|██████▉   | 59087/85293 [00:01<00:00, 45791.79it/s] 75%|███████▍  | 63678/85293 [00:01<00:00, 45561.35it/s] 80%|████████  | 68320/85293 [00:01<00:00, 45572.82it/s] 87%|████████▋ | 74256/85293 [00:01<00:00, 49629.83it/s] 93%|█████████▎| 79296/85293 [00:01<00:00, 49670.80it/s] 99%|█████████▉| 84270/85293 [00:02<00:00, 46507.62it/s]100%|██████████| 85293/85293 [00:02<00:00, 41984.63it/s]
The spherical harmonics array is 161.38 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=30 and accuracy=0.99: 22.73962903022766 seconds

Calculating covariance matrix
  0%|          | 0/1122308 [00:00<?, ?it/s]Only calculating diagonal
  0%|          | 0/1122308 [00:00<?, ?it/s]  0%|          | 0/1122308 [00:00<?, ?it/s]  0%|          | 0/1122308 [00:00<?, ?it/s]  0%|          | 0/1122308 [00:00<?, ?it/s]  0%|          | 0/1122308 [00:00<?, ?it/s]  0%|          | 0/1122308 [00:00<?, ?it/s]  0%|          | 0/1122308 [00:00<?, ?it/s]  0%|          | 0/1122308 [00:00<?, ?it/s]  0%|          | 0/1122308 [00:00<?, ?it/s]  0%|          | 0/1122308 [00:00<?, ?it/s]  6%|▌         | 65151/1122308 [00:01<00:16, 63315.89it/s] 11%|█         | 122690/1122308 [00:01<00:09, 108637.72it/s] 16%|█▌        | 177242/1122308 [00:01<00:06, 144140.51it/s] 21%|██        | 230903/1122308 [00:01<00:05, 173618.54it/s] 25%|██▌       | 286095/1122308 [00:01<00:04, 200030.44it/s] 31%|███       | 343224/1122308 [00:01<00:03, 224248.07it/s] 36%|███▌      | 402180/1122308 [00:01<00:02, 246606.94it/s] 41%|████      | 462390/1122308 [00:01<00:02, 267098.93it/s] 47%|████▋     | 523406/1122308 [00:01<00:02, 285786.76it/s] 52%|█████▏    | 584646/1122308 [00:01<00:01, 302650.06it/s] 57%|█████▋    | 644409/1122308 [00:02<00:01, 317122.07it/s] 63%|██████▎   | 706056/1122308 [00:02<00:01, 331114.38it/s] 68%|██████▊   | 768759/1122308 [00:02<00:01, 344324.18it/s] 74%|███████▍  | 833777/1122308 [00:02<00:00, 357390.16it/s] 80%|████████  | 900171/1122308 [00:02<00:00, 369942.19it/s] 86%|████████▋ | 970621/1122308 [00:02<00:00, 383103.21it/s] 93%|█████████▎| 1049112/1122308 [00:02<00:00, 398315.62it/s]100%|██████████| 1122308/1122308 [00:02<00:00, 415121.64it/s]100%|██████████| 1122308/1122308 [00:02<00:00, 415066.01it/s]100%|██████████| 1122308/1122308 [00:02<00:00, 415040.94it/s]
Time to calculate C_TT with l_max=30 and c_l_ratio=0.99: 2.705078601837158 seconds with Numba

Calculating covariance matrix
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:20<00:00, 20.96s/it]100%|██████████| 1/1 [00:20<00:00, 20.96s/it]
  0%|          | 0/10000 [00:00<?, ?it/s]  1%|          | 83/10000 [00:00<00:11, 829.47it/s]  2%|▏         | 197/10000 [00:00<00:09, 1008.53it/s]  3%|▎         | 312/10000 [00:00<00:09, 1069.07it/s]  4%|▍         | 427/10000 [00:00<00:08, 1099.97it/s]  5%|▌         | 543/10000 [00:00<00:08, 1118.48it/s]  7%|▋         | 659/10000 [00:00<00:08, 1129.88it/s]  8%|▊         | 773/10000 [00:00<00:08, 1131.77it/s]  9%|▉         | 888/10000 [00:00<00:08, 1135.13it/s] 10%|█         | 1003/10000 [00:00<00:07, 1138.05it/s] 11%|█         | 1117/10000 [00:01<00:07, 1138.41it/s] 12%|█▏        | 1231/10000 [00:01<00:07, 1138.77it/s] 13%|█▎        | 1345/10000 [00:01<00:07, 1138.51it/s] 15%|█▍        | 1460/10000 [00:01<00:07, 1140.78it/s] 16%|█▌        | 1575/10000 [00:01<00:07, 1140.17it/s] 17%|█▋        | 1690/10000 [00:01<00:07, 1140.04it/s] 18%|█▊        | 1805/10000 [00:01<00:07, 1141.22it/s] 19%|█▉        | 1923/10000 [00:01<00:07, 1152.22it/s] 20%|██        | 2046/10000 [00:01<00:06, 1175.33it/s] 22%|██▏       | 2174/10000 [00:01<00:06, 1204.50it/s] 23%|██▎       | 2310/10000 [00:02<00:06, 1248.15it/s] 25%|██▍       | 2451/10000 [00:02<00:05, 1295.88it/s] 26%|██▌       | 2601/10000 [00:02<00:05, 1355.19it/s] 28%|██▊       | 2758/10000 [00:02<00:05, 1417.92it/s] 29%|██▉       | 2924/10000 [00:02<00:04, 1490.22it/s] 31%|███       | 3102/10000 [00:02<00:04, 1575.02it/s] 33%|███▎      | 3280/10000 [00:02<00:04, 1634.75it/s] 35%|███▍      | 3459/10000 [00:02<00:03, 1679.53it/s] 36%|███▋      | 3638/10000 [00:02<00:03, 1709.91it/s] 38%|███▊      | 3816/10000 [00:02<00:03, 1728.53it/s] 40%|███▉      | 3993/10000 [00:03<00:03, 1740.66it/s] 42%|████▏     | 4171/10000 [00:03<00:03, 1749.42it/s] 43%|████▎     | 4348/10000 [00:03<00:03, 1754.00it/s] 45%|████▌     | 4525/10000 [00:03<00:03, 1756.88it/s] 47%|████▋     | 4702/10000 [00:03<00:03, 1760.27it/s] 49%|████▉     | 4880/10000 [00:03<00:02, 1763.43it/s] 51%|█████     | 5057/10000 [00:03<00:02, 1763.03it/s] 52%|█████▏    | 5235/10000 [00:03<00:02, 1766.11it/s] 54%|█████▍    | 5412/10000 [00:03<00:02, 1765.28it/s] 56%|█████▌    | 5589/10000 [00:03<00:02, 1764.59it/s] 58%|█████▊    | 5766/10000 [00:04<00:02, 1764.46it/s] 59%|█████▉    | 5943/10000 [00:04<00:02, 1738.94it/s] 61%|██████    | 6117/10000 [00:04<00:02, 1727.35it/s] 63%|██████▎   | 6294/10000 [00:04<00:02, 1737.51it/s] 65%|██████▍   | 6471/10000 [00:04<00:02, 1744.47it/s] 66%|██████▋   | 6648/10000 [00:04<00:01, 1750.14it/s] 68%|██████▊   | 6824/10000 [00:04<00:01, 1751.16it/s] 70%|███████   | 7001/10000 [00:04<00:01, 1753.85it/s] 72%|███████▏  | 7177/10000 [00:04<00:01, 1755.48it/s] 74%|███████▎  | 7353/10000 [00:04<00:01, 1753.59it/s] 75%|███████▌  | 7529/10000 [00:05<00:01, 1749.41it/s] 77%|███████▋  | 7704/10000 [00:05<00:01, 1748.52it/s] 79%|███████▉  | 7880/10000 [00:05<00:01, 1749.44it/s] 81%|████████  | 8060/10000 [00:05<00:01, 1763.71it/s] 82%|████████▏ | 8240/10000 [00:05<00:00, 1774.44it/s] 84%|████████▍ | 8423/10000 [00:05<00:00, 1790.82it/s] 86%|████████▋ | 8633/10000 [00:05<00:00, 1881.41it/s] 88%|████████▊ | 8843/10000 [00:05<00:00, 1944.70it/s] 91%|█████████ | 9052/10000 [00:05<00:00, 1985.38it/s] 93%|█████████▎| 9261/10000 [00:05<00:00, 2015.94it/s] 95%|█████████▍| 9470/10000 [00:06<00:00, 2036.95it/s] 97%|█████████▋| 9679/10000 [00:06<00:00, 2052.34it/s] 99%|█████████▉| 9885/10000 [00:06<00:00, 2020.81it/s]100%|██████████| 10000/10000 [00:06<00:00, 1588.73it/s]
C_ell diag [566.26200772 235.8321807  269.14827727 213.96669122 148.04284341
 107.10927523  76.14457121  53.70462491  36.02011668  31.27319876
  34.61449747  31.32753721  22.76219337  18.85214717  18.40123433
  16.8430462   14.96812121  13.80894544  12.97901718  12.07651096
  10.65503221   9.33474973   9.27364457   9.36111048   8.49921671
   7.5914212    7.26544024   6.97720391   6.59798014]
C_ell CAMB [1016.40873339  481.26542164  273.2255867   174.32789703  120.63615032
   88.58020843   68.00338177   54.05603479   44.15960466   36.88099026
   31.37125605   27.09077005   23.69408737   20.94822157   18.69703385
   16.82975634   15.24700193   13.92130213   12.77479645   11.7825495
   10.91693642   10.15705706    9.4862152     8.89028104    8.35753915
    7.87990445    7.44941789    7.06011974    6.70683632]
Cubic Torus
Running - E1 l_max=30, Lx=13824
Running {'topology': 'E1', 'Lx': 0.5, 'Ly': 0.5, 'Lz': 0.5, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 30, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'local', 'amp': 0.6, 'pow_min': 0.0001, 'pow_max': 0.0002, 'location': 0.0005, 'width': 0.05, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 179, 2853)

Finding k_max as a function of ell
  0%|          | 0/29 [00:00<?, ?it/s]  7%|▋         | 2/29 [00:00<00:01, 14.54it/s] 14%|█▍        | 4/29 [00:00<00:01, 15.69it/s] 21%|██        | 6/29 [00:00<00:01, 16.65it/s] 28%|██▊       | 8/29 [00:00<00:01, 17.52it/s] 38%|███▊      | 11/29 [00:00<00:00, 19.00it/s] 48%|████▊     | 14/29 [00:00<00:00, 20.48it/s] 59%|█████▊    | 17/29 [00:00<00:00, 21.71it/s] 69%|██████▉   | 20/29 [00:00<00:00, 22.97it/s] 79%|███████▉  | 23/29 [00:01<00:00, 23.94it/s] 90%|████████▉ | 26/29 [00:01<00:00, 24.38it/s]100%|██████████| 29/29 [00:01<00:00, 24.89it/s]100%|██████████| 29/29 [00:01<00:00, 21.76it/s]
Done. k_max for TT ell_max = 0.02930188031725805 k_max for EE ell_max = 0.08517944519572987
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 1122308 Minimum k_amp 0.0004544832372877624 n_x_max 65 n_z_max 65
Time to get list of k, phi, theta: 0.13455867767333984 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07599785442142443
Ratio of unique |k|: 0.0030873877759046535
Time to get unique k and theta: 0.20885467529296875 seconds

Getting transfer functions
  0%|          | 0/3465 [00:00<?, ?it/s]  2%|▏         | 55/3465 [00:00<00:06, 542.47it/s]  3%|▎         | 115/3465 [00:00<00:05, 568.39it/s]  5%|▌         | 175/3465 [00:00<00:05, 580.24it/s]  7%|▋         | 240/3465 [00:00<00:05, 594.08it/s]  9%|▉         | 305/3465 [00:00<00:05, 605.37it/s] 11%|█         | 370/3465 [00:00<00:05, 608.14it/s] 13%|█▎        | 435/3465 [00:00<00:04, 608.38it/s] 14%|█▍        | 496/3465 [00:00<00:05, 583.89it/s] 16%|█▌        | 555/3465 [00:00<00:05, 559.24it/s] 18%|█▊        | 612/3465 [00:01<00:05, 553.12it/s] 19%|█▉        | 668/3465 [00:01<00:05, 545.09it/s] 21%|██        | 723/3465 [00:01<00:05, 533.15it/s] 22%|██▏       | 777/3465 [00:01<00:05, 524.49it/s] 24%|██▍       | 830/3465 [00:01<00:05, 514.98it/s] 26%|██▌       | 885/3465 [00:01<00:05, 513.05it/s] 27%|██▋       | 940/3465 [00:01<00:04, 517.95it/s] 30%|██▉       | 1025/3465 [00:01<00:04, 608.02it/s] 32%|███▏      | 1120/3465 [00:01<00:03, 702.28it/s] 35%|███▌      | 1225/3465 [00:02<00:02, 797.39it/s] 38%|███▊      | 1330/3465 [00:02<00:02, 865.98it/s] 41%|████      | 1420/3465 [00:02<00:02, 874.96it/s] 44%|████▍     | 1525/3465 [00:02<00:02, 919.97it/s] 47%|████▋     | 1620/3465 [00:02<00:01, 925.63it/s] 49%|████▉     | 1713/3465 [00:02<00:01, 910.93it/s] 52%|█████▏    | 1805/3465 [00:02<00:01, 912.65it/s] 55%|█████▍    | 1905/3465 [00:02<00:01, 933.76it/s] 58%|█████▊    | 1999/3465 [00:02<00:01, 909.99it/s] 60%|██████    | 2091/3465 [00:02<00:01, 890.81it/s] 63%|██████▎   | 2181/3465 [00:03<00:01, 884.45it/s] 66%|██████▌   | 2285/3465 [00:03<00:01, 918.52it/s] 69%|██████▊   | 2380/3465 [00:03<00:01, 925.16it/s] 71%|███████▏  | 2475/3465 [00:03<00:01, 922.30it/s] 74%|███████▍  | 2570/3465 [00:03<00:00, 925.06it/s] 77%|███████▋  | 2675/3465 [00:03<00:00, 952.00it/s] 80%|████████  | 2775/3465 [00:03<00:00, 956.76it/s] 83%|████████▎ | 2871/3465 [00:03<00:00, 956.96it/s] 86%|████████▌ | 2970/3465 [00:03<00:00, 953.32it/s] 88%|████████▊ | 3066/3465 [00:03<00:00, 951.98it/s] 91%|█████████▏| 3165/3465 [00:04<00:00, 953.53it/s] 94%|█████████▍| 3265/3465 [00:04<00:00, 953.05it/s] 97%|█████████▋| 3365/3465 [00:04<00:00, 966.52it/s]100%|█████████▉| 3462/3465 [00:04<00:00, 949.44it/s]100%|██████████| 3465/3465 [00:04<00:00, 788.74it/s]
Size of transfer function: 0.82 MB. 

Size of integrand: 25.4 MB. Time to calculate integrand: 0.009846210479736328 s

Getting spherical harmonics
  0%|          | 0/85293 [00:00<?, ?it/s]  5%|▍         | 4256/85293 [00:00<00:01, 42279.81it/s] 10%|▉         | 8484/85293 [00:00<00:02, 37361.68it/s] 14%|█▍        | 12257/85293 [00:00<00:02, 33749.10it/s] 18%|█▊        | 15672/85293 [00:00<00:02, 32837.55it/s] 22%|██▏       | 18975/85293 [00:00<00:02, 32468.94it/s] 27%|██▋       | 22736/85293 [00:00<00:01, 33833.96it/s] 31%|███       | 26432/85293 [00:00<00:01, 34487.83it/s] 36%|███▌      | 30352/85293 [00:00<00:01, 35761.73it/s] 40%|███▉      | 33941/85293 [00:01<00:01, 31040.16it/s] 44%|████▎     | 37153/85293 [00:01<00:01, 30043.11it/s] 48%|████▊     | 40659/85293 [00:01<00:01, 31406.02it/s] 52%|█████▏    | 44128/85293 [00:01<00:01, 32299.91it/s] 56%|█████▌    | 47712/85293 [00:01<00:01, 33129.64it/s] 61%|██████    | 51632/85293 [00:01<00:00, 34813.99it/s] 65%|██████▌   | 55552/85293 [00:01<00:00, 35960.70it/s] 69%|██████▉   | 59177/85293 [00:01<00:00, 33672.23it/s] 75%|███████▍  | 63728/85293 [00:01<00:00, 36946.48it/s] 79%|███████▉  | 67760/85293 [00:01<00:00, 37457.89it/s] 85%|████████▍ | 72464/85293 [00:02<00:00, 40136.55it/s] 90%|█████████ | 77056/85293 [00:02<00:00, 41664.32it/s] 95%|█████████▌| 81252/85293 [00:02<00:00, 41091.27it/s]100%|██████████| 85293/85293 [00:02<00:00, 36071.63it/s]
The spherical harmonics array is 161.38 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=30 and accuracy=0.99: 32.45432710647583 seconds

Calculating covariance matrix
  0%|          | 0/1122308 [00:00<?, ?it/s]  0%|          | 0/1122308 [00:00<?, ?it/s]Only calculating diagonal
  6%|▌         | 68686/1122308 [00:00<00:01, 677410.85it/s] 11%|█         | 118235/1122308 [00:00<00:01, 586222.94it/s] 15%|█▍        | 162972/1122308 [00:00<00:01, 539670.42it/s] 18%|█▊        | 205679/1122308 [00:00<00:01, 511252.47it/s] 22%|██▏       | 245948/1122308 [00:00<00:01, 489354.43it/s] 25%|██▌       | 284997/1122308 [00:00<00:01, 472717.69it/s] 29%|██▉       | 323103/1122308 [00:00<00:01, 459479.55it/s] 32%|███▏      | 362153/1122308 [00:00<00:01, 450720.19it/s] 36%|███▌      | 402595/1122308 [00:00<00:01, 445451.46it/s] 40%|███▉      | 443361/1122308 [00:01<00:01, 441557.42it/s] 43%|████▎     | 485700/1122308 [00:01<00:01, 439789.19it/s] 47%|████▋     | 531405/1122308 [00:01<00:01, 441114.80it/s] 52%|█████▏    | 578295/1122308 [00:01<00:01, 443144.71it/s] 56%|█████▌    | 629200/1122308 [00:01<00:01, 447735.89it/s] 61%|██████    | 685210/1122308 [00:01<00:00, 455111.57it/s] 66%|██████▋   | 743964/1122308 [00:01<00:00, 463274.89it/s] 72%|███████▏  | 808545/1122308 [00:01<00:00, 473891.74it/s] 78%|███████▊  | 873847/1122308 [00:01<00:00, 483727.36it/s] 84%|████████▍ | 943309/1122308 [00:01<00:00, 494713.26it/s] 91%|█████████ | 1018151/1122308 [00:02<00:00, 507281.76it/s] 99%|█████████▉| 1112100/1122308 [00:02<00:00, 527717.44it/s]100%|██████████| 1122308/1122308 [00:02<00:00, 530924.15it/s]100%|██████████| 1122308/1122308 [00:02<00:00, 530843.98it/s]100%|██████████| 1122308/1122308 [00:02<00:00, 530808.30it/s]
Time to calculate C_TT with l_max=30 and c_l_ratio=0.99: 2.1149914264678955 seconds with Numba

Calculating covariance matrix
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:20<00:00, 20.60s/it]100%|██████████| 1/1 [00:20<00:00, 20.60s/it]
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 3/10000 [00:00<07:49, 21.30it/s]  0%|          | 6/10000 [00:00<08:18, 20.03it/s]  0%|          | 9/10000 [00:00<08:37, 19.31it/s]  0%|          | 11/10000 [00:00<08:37, 19.29it/s]  0%|          | 13/10000 [00:00<08:38, 19.27it/s]  0%|          | 15/10000 [00:00<08:53, 18.71it/s]  0%|          | 17/10000 [00:00<08:48, 18.90it/s]  0%|          | 21/10000 [00:01<06:58, 23.83it/s]  0%|          | 25/10000 [00:01<05:59, 27.76it/s]  0%|          | 29/10000 [00:01<05:24, 30.71it/s]  0%|          | 33/10000 [00:01<05:02, 32.90it/s]  0%|          | 38/10000 [00:01<04:40, 35.46it/s]  0%|          | 42/10000 [00:01<04:34, 36.32it/s]  0%|          | 46/10000 [00:01<04:31, 36.63it/s]  0%|          | 50/10000 [00:01<04:26, 37.27it/s]  2%|▏         | 158/10000 [00:01<00:29, 335.29it/s]  3%|▎         | 298/10000 [00:01<00:15, 642.69it/s]  4%|▍         | 420/10000 [00:02<00:11, 810.85it/s]  6%|▌         | 558/10000 [00:02<00:09, 976.82it/s]  7%|▋         | 695/10000 [00:02<00:08, 1092.87it/s]  8%|▊         | 830/10000 [00:02<00:07, 1169.09it/s] 10%|▉         | 965/10000 [00:02<00:07, 1221.33it/s] 11%|█         | 1099/10000 [00:02<00:07, 1256.21it/s] 12%|█▏        | 1233/10000 [00:02<00:06, 1279.39it/s] 14%|█▎        | 1368/10000 [00:02<00:06, 1297.60it/s] 15%|█▌        | 1506/10000 [00:02<00:06, 1320.13it/s] 16%|█▋        | 1648/10000 [00:02<00:06, 1347.63it/s] 18%|█▊        | 1783/10000 [00:03<00:06, 1328.38it/s] 19%|█▉        | 1938/10000 [00:03<00:05, 1392.10it/s] 21%|██        | 2101/10000 [00:03<00:05, 1461.64it/s] 23%|██▎       | 2272/10000 [00:03<00:05, 1533.44it/s] 25%|██▍       | 2451/10000 [00:03<00:04, 1607.48it/s] 26%|██▋       | 2639/10000 [00:03<00:04, 1686.52it/s] 28%|██▊       | 2836/10000 [00:03<00:04, 1771.09it/s] 30%|███       | 3038/10000 [00:03<00:03, 1844.48it/s] 32%|███▏      | 3238/10000 [00:03<00:03, 1889.85it/s] 34%|███▍      | 3441/10000 [00:03<00:03, 1929.85it/s] 36%|███▋      | 3635/10000 [00:04<00:03, 1880.65it/s] 38%|███▊      | 3835/10000 [00:04<00:03, 1913.94it/s] 40%|████      | 4036/10000 [00:04<00:03, 1940.66it/s] 42%|████▏     | 4236/10000 [00:04<00:02, 1955.98it/s] 44%|████▍     | 4438/10000 [00:04<00:02, 1973.76it/s] 46%|████▋     | 4640/10000 [00:04<00:02, 1985.72it/s] 48%|████▊     | 4839/10000 [00:04<00:02, 1984.78it/s] 50%|█████     | 5039/10000 [00:04<00:02, 1988.14it/s] 52%|█████▏    | 5239/10000 [00:04<00:02, 1991.60it/s] 54%|█████▍    | 5439/10000 [00:04<00:02, 1991.72it/s] 56%|█████▋    | 5639/10000 [00:05<00:02, 1898.80it/s] 58%|█████▊    | 5840/10000 [00:05<00:02, 1928.17it/s] 60%|██████    | 6040/10000 [00:05<00:02, 1948.91it/s] 62%|██████▏   | 6240/10000 [00:05<00:01, 1962.48it/s] 64%|██████▍   | 6440/10000 [00:05<00:01, 1970.91it/s] 66%|██████▋   | 6641/10000 [00:05<00:01, 1980.90it/s] 68%|██████▊   | 6840/10000 [00:05<00:01, 1982.19it/s] 70%|███████   | 7039/10000 [00:05<00:01, 1984.06it/s] 72%|███████▏  | 7240/10000 [00:05<00:01, 1990.96it/s] 74%|███████▍  | 7440/10000 [00:06<00:01, 1990.94it/s] 76%|███████▋  | 7640/10000 [00:06<00:01, 1926.48it/s] 78%|███████▊  | 7840/10000 [00:06<00:01, 1947.29it/s] 80%|████████  | 8038/10000 [00:06<00:01, 1956.70it/s] 82%|████████▏ | 8236/10000 [00:06<00:00, 1962.56it/s] 84%|████████▍ | 8434/10000 [00:06<00:00, 1965.12it/s] 86%|████████▋ | 8634/10000 [00:06<00:00, 1973.94it/s] 88%|████████▊ | 8833/10000 [00:06<00:00, 1976.49it/s] 90%|█████████ | 9032/10000 [00:06<00:00, 1979.12it/s] 92%|█████████▏| 9232/10000 [00:06<00:00, 1982.83it/s] 94%|█████████▍| 9431/10000 [00:07<00:00, 1984.51it/s] 96%|█████████▋| 9630/10000 [00:07<00:00, 1886.91it/s] 98%|█████████▊| 9820/10000 [00:07<00:00, 1818.50it/s]100%|██████████| 10000/10000 [00:07<00:00, 1359.92it/s]
C_ell diag [475.73239978 231.76155027 222.53507644 158.27367152 118.7057748
  97.12128004  73.86214734  53.30318482  35.96412306  31.26658503
  34.61372012  31.32752718  22.76219284  18.85214715  18.40123433
  16.8430462   14.96812121  13.80894544  12.97901718  12.07651096
  10.65503221   9.33474973   9.27364457   9.36111048   8.49921671
   7.5914212    7.26544024   6.97720391   6.59798014]
C_ell CAMB [1016.40873339  481.26542164  273.2255867   174.32789703  120.63615032
   88.58020843   68.00338177   54.05603479   44.15960466   36.88099026
   31.37125605   27.09077005   23.69408737   20.94822157   18.69703385
   16.82975634   15.24700193   13.92130213   12.77479645   11.7825495
   10.91693642   10.15705706    9.4862152     8.89028104    8.35753915
    7.87990445    7.44941789    7.06011974    6.70683632]
Cubic Torus
Running - E1 l_max=30, Lx=13824
Running {'topology': 'E1', 'Lx': 0.5, 'Ly': 0.5, 'Lz': 0.5, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 30, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'local', 'amp': 0.6, 'pow_min': 0.0001, 'pow_max': 0.0002, 'location': 0.0007, 'width': 0.05, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 179, 2853)

Finding k_max as a function of ell
  0%|          | 0/29 [00:00<?, ?it/s]  7%|▋         | 2/29 [00:00<00:01, 16.97it/s] 14%|█▍        | 4/29 [00:00<00:01, 17.80it/s] 21%|██        | 6/29 [00:00<00:01, 18.66it/s] 31%|███       | 9/29 [00:00<00:00, 20.08it/s] 41%|████▏     | 12/29 [00:00<00:00, 21.53it/s] 52%|█████▏    | 15/29 [00:00<00:00, 22.90it/s] 62%|██████▏   | 18/29 [00:00<00:00, 23.85it/s] 72%|███████▏  | 21/29 [00:00<00:00, 24.40it/s] 83%|████████▎ | 24/29 [00:01<00:00, 24.86it/s] 93%|█████████▎| 27/29 [00:01<00:00, 25.18it/s]100%|██████████| 29/29 [00:01<00:00, 23.22it/s]
Done. k_max for TT ell_max = 0.02930188031725805 k_max for EE ell_max = 0.08517944519572987
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 1122308 Minimum k_amp 0.0004544832372877624 n_x_max 65 n_z_max 65
Time to get list of k, phi, theta: 0.13148021697998047 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07599785442142443
Ratio of unique |k|: 0.0030873877759046535
Time to get unique k and theta: 0.20843076705932617 seconds

Getting transfer functions
  0%|          | 0/3465 [00:00<?, ?it/s]  2%|▏         | 55/3465 [00:00<00:06, 536.73it/s]  3%|▎         | 120/3465 [00:00<00:05, 580.03it/s]  5%|▌         | 180/3465 [00:00<00:05, 586.44it/s]  7%|▋         | 239/3465 [00:00<00:06, 533.83it/s]  9%|▊         | 295/3465 [00:00<00:05, 533.37it/s] 10%|█         | 355/3465 [00:00<00:05, 545.69it/s] 12%|█▏        | 410/3465 [00:00<00:05, 532.01it/s] 13%|█▎        | 465/3465 [00:00<00:05, 525.90it/s] 15%|█▌        | 520/3465 [00:00<00:05, 522.93it/s] 17%|█▋        | 575/3465 [00:01<00:05, 520.98it/s] 18%|█▊        | 630/3465 [00:01<00:05, 520.54it/s] 20%|█▉        | 686/3465 [00:01<00:05, 531.98it/s] 22%|██▏       | 745/3465 [00:01<00:04, 545.17it/s] 23%|██▎       | 805/3465 [00:01<00:04, 556.80it/s] 25%|██▍       | 865/3465 [00:01<00:04, 559.12it/s] 27%|██▋       | 925/3465 [00:01<00:04, 563.84it/s] 29%|██▉       | 1005/3465 [00:01<00:03, 628.80it/s] 32%|███▏      | 1095/3465 [00:01<00:03, 697.18it/s] 34%|███▍      | 1180/3465 [00:02<00:03, 740.91it/s] 37%|███▋      | 1285/3465 [00:02<00:02, 827.04it/s] 40%|███▉      | 1385/3465 [00:02<00:02, 868.53it/s] 43%|████▎     | 1480/3465 [00:02<00:02, 881.14it/s] 46%|████▌     | 1580/3465 [00:02<00:02, 912.17it/s] 48%|████▊     | 1680/3465 [00:02<00:01, 931.60it/s] 51%|█████     | 1775/3465 [00:02<00:01, 931.73it/s] 54%|█████▍    | 1869/3465 [00:02<00:01, 920.70it/s] 57%|█████▋    | 1962/3465 [00:02<00:01, 922.29it/s] 59%|█████▉    | 2060/3465 [00:02<00:01, 926.65it/s] 62%|██████▏   | 2153/3465 [00:03<00:01, 923.16it/s] 65%|██████▍   | 2246/3465 [00:03<00:01, 906.58it/s] 68%|██████▊   | 2350/3465 [00:03<00:01, 936.89it/s] 71%|███████   | 2445/3465 [00:03<00:01, 938.38it/s] 74%|███████▎  | 2550/3465 [00:03<00:00, 961.11it/s] 76%|███████▋  | 2650/3465 [00:03<00:00, 960.82it/s] 79%|███████▉  | 2747/3465 [00:03<00:00, 934.99it/s] 82%|████████▏ | 2841/3465 [00:03<00:00, 931.55it/s] 85%|████████▍ | 2940/3465 [00:03<00:00, 943.69it/s] 88%|████████▊ | 3040/3465 [00:03<00:00, 946.92it/s] 90%|█████████ | 3135/3465 [00:04<00:00, 943.26it/s] 93%|█████████▎| 3235/3465 [00:04<00:00, 952.88it/s] 96%|█████████▌| 3335/3465 [00:04<00:00, 961.47it/s] 99%|█████████▉| 3432/3465 [00:04<00:00, 934.03it/s]100%|██████████| 3465/3465 [00:04<00:00, 783.29it/s]
Size of transfer function: 0.82 MB. 

Size of integrand: 25.4 MB. Time to calculate integrand: 0.012575864791870117 s

Getting spherical harmonics
  0%|          | 0/85293 [00:00<?, ?it/s]  4%|▎         | 3024/85293 [00:00<00:02, 29020.81it/s]  7%|▋         | 6048/85293 [00:00<00:02, 29272.97it/s] 11%|█         | 8976/85293 [00:00<00:02, 25538.26it/s] 14%|█▍        | 11984/85293 [00:00<00:02, 27021.99it/s] 17%|█▋        | 14727/85293 [00:00<00:02, 26697.29it/s] 21%|██        | 17808/85293 [00:00<00:02, 27856.61it/s] 25%|██▍       | 21168/85293 [00:00<00:02, 29415.25it/s] 29%|██▊       | 24416/85293 [00:00<00:02, 29862.63it/s] 33%|███▎      | 28224/85293 [00:00<00:01, 32271.17it/s] 37%|███▋      | 31468/85293 [00:01<00:01, 31174.09it/s] 41%|████      | 34603/85293 [00:01<00:01, 30145.01it/s] 45%|████▌     | 38416/85293 [00:01<00:01, 32256.36it/s] 49%|████▉     | 41662/85293 [00:01<00:01, 31788.74it/s] 53%|█████▎    | 45062/85293 [00:01<00:01, 32426.60it/s] 57%|█████▋    | 48317/85293 [00:01<00:01, 31680.33it/s] 62%|██████▏   | 52528/85293 [00:01<00:00, 33961.92it/s] 66%|██████▌   | 55929/85293 [00:01<00:00, 33451.23it/s] 69%|██████▉   | 59277/85293 [00:01<00:00, 33243.36it/s] 75%|███████▍  | 63840/85293 [00:02<00:00, 36794.34it/s] 80%|███████▉  | 68096/85293 [00:02<00:00, 38431.45it/s] 84%|████████▍ | 72016/85293 [00:02<00:00, 38425.39it/s] 89%|████████▉ | 75867/85293 [00:02<00:00, 37401.28it/s] 93%|█████████▎| 79618/85293 [00:02<00:00, 35574.54it/s] 98%|█████████▊| 83440/85293 [00:02<00:00, 36280.14it/s]100%|██████████| 85293/85293 [00:02<00:00, 32613.60it/s]
The spherical harmonics array is 161.38 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=30 and accuracy=0.99: 48.42521929740906 seconds

Calculating covariance matrix
  0%|          | 0/1122308 [00:00<?, ?it/s]  0%|          | 0/1122308 [00:00<?, ?it/s]Only calculating diagonal
  6%|▌         | 66654/1122308 [00:00<00:01, 659432.67it/s] 10%|█         | 115906/1122308 [00:00<00:01, 575509.55it/s] 14%|█▍        | 160842/1122308 [00:00<00:01, 533018.12it/s] 18%|█▊        | 204012/1122308 [00:00<00:01, 507424.59it/s] 22%|██▏       | 243961/1122308 [00:00<00:01, 485637.56it/s] 25%|██▌       | 284197/1122308 [00:00<00:01, 471567.54it/s] 29%|██▉       | 323284/1122308 [00:00<00:01, 459889.60it/s] 32%|███▏      | 364720/1122308 [00:00<00:01, 454051.31it/s] 36%|███▌      | 405994/1122308 [00:00<00:01, 449330.35it/s] 40%|████      | 448972/1122308 [00:01<00:01, 447244.68it/s] 44%|████▍     | 495151/1122308 [00:01<00:01, 448441.51it/s] 48%|████▊     | 541129/1122308 [00:01<00:01, 449224.66it/s] 53%|█████▎    | 591948/1122308 [00:01<00:01, 453631.30it/s] 58%|█████▊    | 647209/1122308 [00:01<00:01, 460606.42it/s] 63%|██████▎   | 705390/1122308 [00:01<00:00, 468597.35it/s] 68%|██████▊   | 768748/1122308 [00:01<00:00, 478814.73it/s] 74%|███████▍  | 834930/1122308 [00:01<00:00, 489486.96it/s] 80%|████████  | 902264/1122308 [00:01<00:00, 499614.83it/s] 87%|████████▋ | 973394/1122308 [00:01<00:00, 510669.71it/s] 94%|█████████▍| 1053622/1122308 [00:02<00:00, 525155.02it/s]100%|██████████| 1122308/1122308 [00:02<00:00, 542274.79it/s]100%|██████████| 1122308/1122308 [00:02<00:00, 542185.60it/s]100%|██████████| 1122308/1122308 [00:02<00:00, 542136.90it/s]
Time to calculate C_TT with l_max=30 and c_l_ratio=0.99: 2.0708837509155273 seconds with Numba

Calculating covariance matrix
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:23<00:00, 23.28s/it]100%|██████████| 1/1 [00:23<00:00, 23.28s/it]
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 3/10000 [00:00<06:32, 25.46it/s]  0%|          | 6/10000 [00:00<07:47, 21.40it/s]  0%|          | 10/10000 [00:00<06:05, 27.35it/s]  0%|          | 14/10000 [00:00<05:19, 31.23it/s]  0%|          | 19/10000 [00:00<04:49, 34.52it/s]  0%|          | 24/10000 [00:00<04:32, 36.64it/s]  2%|▏         | 155/10000 [00:00<00:24, 400.18it/s]  3%|▎         | 262/10000 [00:00<00:16, 592.71it/s]  4%|▍         | 377/10000 [00:01<00:12, 753.85it/s]  5%|▍         | 492/10000 [00:01<00:10, 869.40it/s]  6%|▌         | 608/10000 [00:01<00:09, 952.93it/s]  7%|▋         | 724/10000 [00:01<00:09, 1012.50it/s]  8%|▊         | 841/10000 [00:01<00:08, 1057.26it/s] 10%|▉         | 959/10000 [00:01<00:08, 1092.14it/s] 11%|█         | 1081/10000 [00:01<00:07, 1128.44it/s] 12%|█▏        | 1208/10000 [00:01<00:07, 1169.14it/s] 13%|█▎        | 1342/10000 [00:01<00:07, 1217.78it/s] 15%|█▍        | 1468/10000 [00:01<00:06, 1229.75it/s] 16%|█▌        | 1616/10000 [00:02<00:06, 1303.43it/s] 18%|█▊        | 1774/10000 [00:02<00:05, 1385.44it/s] 19%|█▉        | 1940/10000 [00:02<00:05, 1466.81it/s] 21%|██        | 2116/10000 [00:02<00:05, 1552.31it/s] 23%|██▎       | 2294/10000 [00:02<00:04, 1617.80it/s] 25%|██▍       | 2472/10000 [00:02<00:04, 1664.86it/s] 26%|██▋       | 2650/10000 [00:02<00:04, 1696.97it/s] 28%|██▊       | 2828/10000 [00:02<00:04, 1720.49it/s] 30%|███       | 3001/10000 [00:02<00:04, 1685.73it/s] 32%|███▏      | 3171/10000 [00:02<00:04, 1689.65it/s] 33%|███▎      | 3349/10000 [00:03<00:03, 1714.19it/s] 35%|███▌      | 3525/10000 [00:03<00:03, 1727.42it/s] 37%|███▋      | 3703/10000 [00:03<00:03, 1740.96it/s] 39%|███▉      | 3880/10000 [00:03<00:03, 1749.61it/s] 41%|████      | 4057/10000 [00:03<00:03, 1754.52it/s] 42%|████▏     | 4234/10000 [00:03<00:03, 1757.51it/s] 44%|████▍     | 4412/10000 [00:03<00:03, 1761.30it/s] 46%|████▌     | 4589/10000 [00:03<00:03, 1763.65it/s] 48%|████▊     | 4767/10000 [00:03<00:02, 1766.37it/s] 49%|████▉     | 4944/10000 [00:03<00:02, 1746.64it/s] 51%|█████     | 5119/10000 [00:04<00:02, 1746.33it/s] 53%|█████▎    | 5295/10000 [00:04<00:02, 1749.73it/s] 55%|█████▍    | 5472/10000 [00:04<00:02, 1753.91it/s] 56%|█████▋    | 5649/10000 [00:04<00:02, 1757.30it/s] 58%|█████▊    | 5827/10000 [00:04<00:02, 1761.26it/s] 60%|██████    | 6004/10000 [00:04<00:02, 1756.22it/s] 62%|██████▏   | 6180/10000 [00:04<00:02, 1750.92it/s] 64%|██████▎   | 6356/10000 [00:04<00:02, 1747.73it/s] 65%|██████▌   | 6531/10000 [00:04<00:01, 1743.79it/s] 67%|██████▋   | 6706/10000 [00:04<00:01, 1718.18it/s] 69%|██████▉   | 6879/10000 [00:05<00:01, 1719.08it/s] 71%|███████   | 7051/10000 [00:05<00:01, 1715.52it/s] 72%|███████▏  | 7223/10000 [00:05<00:01, 1716.05it/s] 74%|███████▍  | 7395/10000 [00:05<00:01, 1714.91it/s] 76%|███████▌  | 7567/10000 [00:05<00:01, 1712.40it/s] 77%|███████▋  | 7739/10000 [00:05<00:01, 1710.09it/s] 79%|███████▉  | 7911/10000 [00:05<00:01, 1704.10it/s] 81%|████████  | 8082/10000 [00:05<00:01, 1700.48it/s] 83%|████████▎ | 8253/10000 [00:05<00:01, 1698.64it/s] 84%|████████▍ | 8423/10000 [00:05<00:00, 1669.17it/s] 86%|████████▌ | 8591/10000 [00:06<00:00, 1670.78it/s] 88%|████████▊ | 8759/10000 [00:06<00:00, 1378.87it/s] 89%|████████▉ | 8927/10000 [00:06<00:00, 1456.49it/s] 91%|█████████ | 9098/10000 [00:06<00:00, 1522.62it/s] 93%|█████████▎| 9268/10000 [00:06<00:00, 1571.50it/s] 94%|█████████▍| 9438/10000 [00:06<00:00, 1607.87it/s] 96%|█████████▌| 9609/10000 [00:06<00:00, 1636.82it/s] 98%|█████████▊| 9779/10000 [00:06<00:00, 1655.02it/s] 99%|█████████▉| 9949/10000 [00:06<00:00, 1667.41it/s]100%|██████████| 10000/10000 [00:06<00:00, 1430.91it/s]
C_ell diag [501.68305505 235.72862291 214.47979923 161.49620856 127.83343508
 100.21782974  71.15371963  50.57016727  34.58771575  30.75933669
  34.49235321  31.30470353  22.75957035  18.85190978  18.40114193
  16.8430532   14.96812121  13.80894544  12.97901718  12.07651096
  10.65503221   9.33474973   9.27364457   9.36111048   8.49921671
   7.5914212    7.26544024   6.97720391   6.59798014]
C_ell CAMB [1016.40873339  481.26542164  273.2255867   174.32789703  120.63615032
   88.58020843   68.00338177   54.05603479   44.15960466   36.88099026
   31.37125605   27.09077005   23.69408737   20.94822157   18.69703385
   16.82975634   15.24700193   13.92130213   12.77479645   11.7825495
   10.91693642   10.15705706    9.4862152     8.89028104    8.35753915
    7.87990445    7.44941789    7.06011974    6.70683632]
Cubic Torus
Running - E1 l_max=30, Lx=13824
Running {'topology': 'E1', 'Lx': 0.5, 'Ly': 0.5, 'Lz': 0.5, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 30, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'local', 'amp': 0.6, 'pow_min': 0.0001, 'pow_max': 0.0002, 'location': 0.0009, 'width': 0.05, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 179, 2853)

Finding k_max as a function of ell
  0%|          | 0/29 [00:00<?, ?it/s]  7%|▋         | 2/29 [00:00<00:01, 16.07it/s] 14%|█▍        | 4/29 [00:00<00:01, 17.37it/s] 24%|██▍       | 7/29 [00:00<00:01, 18.99it/s] 34%|███▍      | 10/29 [00:00<00:00, 20.57it/s] 45%|████▍     | 13/29 [00:00<00:00, 22.12it/s] 55%|█████▌    | 16/29 [00:00<00:00, 23.35it/s] 66%|██████▌   | 19/29 [00:00<00:00, 24.18it/s] 76%|███████▌  | 22/29 [00:00<00:00, 24.66it/s] 86%|████████▌ | 25/29 [00:01<00:00, 25.03it/s] 97%|█████████▋| 28/29 [00:01<00:00, 25.31it/s]100%|██████████| 29/29 [00:01<00:00, 23.25it/s]
Done. k_max for TT ell_max = 0.02930188031725805 k_max for EE ell_max = 0.08517944519572987
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 1122308 Minimum k_amp 0.0004544832372877624 n_x_max 65 n_z_max 65
Time to get list of k, phi, theta: 0.14138197898864746 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07599785442142443
Ratio of unique |k|: 0.0030873877759046535
Time to get unique k and theta: 0.21857786178588867 seconds

Getting transfer functions
  0%|          | 0/3465 [00:00<?, ?it/s]  1%|          | 20/3465 [00:00<00:18, 183.30it/s]  2%|▏         | 75/3465 [00:00<00:08, 383.40it/s]  4%|▍         | 135/3465 [00:00<00:07, 462.30it/s]  5%|▌         | 190/3465 [00:00<00:06, 492.98it/s]  7%|▋         | 250/3465 [00:00<00:06, 519.46it/s]  9%|▉         | 310/3465 [00:00<00:05, 536.43it/s] 11%|█         | 370/3465 [00:00<00:05, 546.18it/s] 12%|█▏        | 430/3465 [00:00<00:05, 555.57it/s] 14%|█▍        | 490/3465 [00:00<00:05, 562.32it/s] 16%|█▌        | 550/3465 [00:01<00:05, 570.28it/s] 18%|█▊        | 610/3465 [00:01<00:05, 570.37it/s] 19%|█▉        | 670/3465 [00:01<00:04, 567.68it/s] 21%|██        | 730/3465 [00:01<00:04, 572.22it/s] 23%|██▎       | 788/3465 [00:01<00:04, 574.43it/s] 24%|██▍       | 846/3465 [00:01<00:04, 573.70it/s] 26%|██▌       | 905/3465 [00:01<00:04, 567.03it/s] 28%|██▊       | 965/3465 [00:01<00:04, 572.50it/s] 31%|███       | 1065/3465 [00:01<00:03, 693.21it/s] 34%|███▎      | 1165/3465 [00:01<00:02, 777.80it/s] 36%|███▌      | 1255/3465 [00:02<00:02, 812.62it/s] 39%|███▉      | 1350/3465 [00:02<00:02, 843.83it/s] 42%|████▏     | 1450/3465 [00:02<00:02, 882.79it/s] 45%|████▌     | 1560/3465 [00:02<00:02, 939.76it/s] 48%|████▊     | 1660/3465 [00:02<00:01, 946.70it/s] 51%|█████     | 1765/3465 [00:02<00:01, 967.40it/s] 54%|█████▍    | 1865/3465 [00:02<00:01, 962.64it/s] 57%|█████▋    | 1965/3465 [00:02<00:01, 966.46it/s] 60%|█████▉    | 2065/3465 [00:02<00:01, 971.18it/s] 62%|██████▏   | 2163/3465 [00:03<00:01, 970.55it/s] 66%|██████▌   | 2270/3465 [00:03<00:01, 990.40it/s] 68%|██████▊   | 2370/3465 [00:03<00:01, 965.17it/s] 72%|███████▏  | 2480/3465 [00:03<00:00, 992.42it/s] 74%|███████▍  | 2580/3465 [00:03<00:00, 987.03it/s] 77%|███████▋  | 2679/3465 [00:03<00:00, 968.81it/s] 80%|████████  | 2776/3465 [00:03<00:00, 963.30it/s] 83%|████████▎ | 2880/3465 [00:03<00:00, 975.53it/s] 86%|████████▌ | 2978/3465 [00:03<00:00, 970.07it/s] 89%|████████▉ | 3080/3465 [00:03<00:00, 982.15it/s] 92%|█████████▏| 3185/3465 [00:04<00:00, 998.97it/s] 95%|█████████▌| 3300/3465 [00:04<00:00, 1031.55it/s] 98%|█████████▊| 3404/3465 [00:04<00:00, 1010.95it/s]100%|██████████| 3465/3465 [00:04<00:00, 798.96it/s] 
Size of transfer function: 0.82 MB. 

Size of integrand: 25.4 MB. Time to calculate integrand: 0.012126445770263672 s

Getting spherical harmonics
  0%|          | 0/85293 [00:00<?, ?it/s]  2%|▏         | 1680/85293 [00:00<00:05, 16396.81it/s]  6%|▌         | 4704/85293 [00:00<00:03, 23039.15it/s]  8%|▊         | 6988/85293 [00:00<00:07, 10135.37it/s] 10%|▉         | 8512/85293 [00:00<00:06, 11160.31it/s] 12%|█▏        | 10008/85293 [00:00<00:08, 8847.46it/s] 15%|█▍        | 12544/85293 [00:01<00:06, 12107.67it/s] 17%|█▋        | 14175/85293 [00:01<00:06, 10206.88it/s] 19%|█▉        | 16352/85293 [00:01<00:05, 12489.81it/s] 21%|██        | 17954/85293 [00:01<00:05, 13174.65it/s] 23%|██▎       | 19600/85293 [00:01<00:04, 13795.21it/s] 27%|██▋       | 23184/85293 [00:01<00:03, 19305.71it/s] 30%|██▉       | 25424/85293 [00:01<00:02, 20062.11it/s] 33%|███▎      | 27812/85293 [00:01<00:02, 21104.91it/s] 36%|███▋      | 31024/85293 [00:01<00:02, 24160.27it/s] 40%|████      | 34272/85293 [00:02<00:01, 26508.90it/s] 43%|████▎     | 37020/85293 [00:02<00:02, 22776.24it/s] 47%|████▋     | 39760/85293 [00:02<00:01, 23954.80it/s] 51%|█████▏    | 43904/85293 [00:02<00:01, 28204.92it/s] 55%|█████▍    | 46840/85293 [00:02<00:01, 20748.60it/s] 58%|█████▊    | 49268/85293 [00:03<00:02, 14660.99it/s] 60%|██████    | 51202/85293 [00:03<00:02, 12337.23it/s] 62%|██████▏   | 52794/85293 [00:03<00:03, 10239.53it/s] 63%|██████▎   | 54094/85293 [00:03<00:03, 9478.79it/s]  65%|██████▍   | 55222/85293 [00:03<00:03, 7926.87it/s] 69%|██████▊   | 58464/85293 [00:04<00:02, 11902.58it/s] 73%|███████▎  | 61936/85293 [00:04<00:01, 16091.82it/s] 78%|███████▊  | 66304/85293 [00:04<00:00, 21838.76it/s] 81%|████████  | 69085/85293 [00:04<00:00, 21976.94it/s] 84%|████████▍ | 71702/85293 [00:04<00:00, 16566.06it/s] 87%|████████▋ | 73833/85293 [00:04<00:00, 12526.29it/s] 89%|████████▊ | 75537/85293 [00:05<00:00, 10669.47it/s] 90%|█████████ | 76938/85293 [00:05<00:00, 10740.70it/s] 92%|█████████▏| 78250/85293 [00:05<00:00, 11044.36it/s] 93%|█████████▎| 79538/85293 [00:05<00:00, 9429.44it/s]  95%|█████████▍| 80630/85293 [00:05<00:00, 9202.37it/s] 96%|█████████▌| 81648/85293 [00:05<00:00, 8302.05it/s] 97%|█████████▋| 82547/85293 [00:06<00:00, 7804.78it/s] 98%|█████████▊| 83370/85293 [00:06<00:00, 7348.39it/s] 99%|█████████▉| 84336/85293 [00:06<00:00, 7617.11it/s]100%|██████████| 85293/85293 [00:06<00:00, 13527.02it/s]
The spherical harmonics array is 161.38 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=30 and accuracy=0.99: 65.93280792236328 seconds

Calculating covariance matrix
  0%|          | 0/1122308 [00:00<?, ?it/s]Only calculating diagonal
  0%|          | 0/1122308 [00:00<?, ?it/s]  6%|▌         | 64547/1122308 [00:00<00:01, 635727.73it/s] 10%|█         | 114519/1122308 [00:00<00:01, 567428.98it/s] 14%|█▍        | 159738/1122308 [00:00<00:01, 528699.12it/s] 18%|█▊        | 203277/1122308 [00:00<00:01, 505120.81it/s] 22%|██▏       | 244233/1122308 [00:00<00:01, 485814.94it/s] 25%|██▌       | 285178/1122308 [00:00<00:01, 472901.03it/s] 29%|██▉       | 324553/1122308 [00:00<00:01, 461437.06it/s] 33%|███▎      | 365116/1122308 [00:00<00:01, 454321.54it/s] 36%|███▌      | 405061/1122308 [00:00<00:01, 448100.77it/s] 40%|███▉      | 445984/1122308 [00:01<00:01, 444097.62it/s] 44%|████▎     | 488958/1122308 [00:01<00:01, 442676.44it/s] 48%|████▊     | 533893/1122308 [00:01<00:01, 443121.13it/s] 52%|█████▏    | 581619/1122308 [00:01<00:01, 445631.63it/s] 56%|█████▌    | 631269/1122308 [00:01<00:01, 449157.05it/s] 61%|██████    | 686659/1122308 [00:01<00:00, 456023.29it/s] 66%|██████▋   | 744801/1122308 [00:01<00:00, 463738.47it/s] 72%|███████▏  | 809580/1122308 [00:01<00:00, 474443.47it/s] 78%|███████▊  | 876780/1122308 [00:01<00:00, 485299.65it/s] 84%|████████▍ | 946722/1122308 [00:01<00:00, 496452.41it/s] 91%|█████████ | 1023041/1122308 [00:02<00:00, 509667.65it/s]100%|█████████▉| 1121828/1122308 [00:02<00:00, 532285.49it/s]100%|██████████| 1122308/1122308 [00:02<00:00, 532363.04it/s]100%|██████████| 1122308/1122308 [00:02<00:00, 532280.39it/s]100%|██████████| 1122308/1122308 [00:02<00:00, 532248.91it/s]
Time to calculate C_TT with l_max=30 and c_l_ratio=0.99: 2.1094541549682617 seconds with Numba

Calculating covariance matrix
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:20<00:00, 20.41s/it]100%|██████████| 1/1 [00:20<00:00, 20.41s/it]
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 3/10000 [00:00<06:20, 26.26it/s]  0%|          | 6/10000 [00:00<06:05, 27.35it/s]  0%|          | 9/10000 [00:00<06:33, 25.41it/s]  0%|          | 12/10000 [00:00<06:26, 25.85it/s]  0%|          | 15/10000 [00:00<06:30, 25.60it/s]  0%|          | 19/10000 [00:00<05:35, 29.75it/s]  0%|          | 23/10000 [00:00<05:07, 32.45it/s]  0%|          | 28/10000 [00:00<04:34, 36.29it/s]  1%|▏         | 134/10000 [00:01<00:29, 333.71it/s]  2%|▏         | 249/10000 [00:01<00:17, 572.43it/s]  4%|▎         | 365/10000 [00:01<00:12, 745.03it/s]  5%|▍         | 481/10000 [00:01<00:10, 867.66it/s]  6%|▌         | 597/10000 [00:01<00:09, 954.15it/s]  7%|▋         | 712/10000 [00:01<00:09, 1012.17it/s]  8%|▊         | 829/10000 [00:01<00:08, 1056.69it/s]  9%|▉         | 949/10000 [00:01<00:08, 1096.83it/s] 11%|█         | 1073/10000 [00:01<00:07, 1138.72it/s] 12%|█▏        | 1203/10000 [00:01<00:07, 1185.81it/s] 13%|█▎        | 1334/10000 [00:02<00:07, 1220.42it/s] 15%|█▍        | 1457/10000 [00:02<00:07, 1194.22it/s] 16%|█▌        | 1589/10000 [00:02<00:06, 1228.61it/s] 17%|█▋        | 1716/10000 [00:02<00:06, 1239.50it/s] 18%|█▊        | 1843/10000 [00:02<00:06, 1246.41it/s] 20%|█▉        | 1968/10000 [00:02<00:06, 1238.23it/s] 21%|██        | 2098/10000 [00:02<00:06, 1255.99it/s] 22%|██▏       | 2224/10000 [00:02<00:06, 1251.48it/s] 24%|██▎       | 2354/10000 [00:02<00:06, 1265.44it/s] 25%|██▍       | 2481/10000 [00:02<00:05, 1263.87it/s] 26%|██▌       | 2608/10000 [00:03<00:05, 1261.53it/s] 27%|██▋       | 2735/10000 [00:03<00:05, 1216.58it/s] 29%|██▊       | 2858/10000 [00:03<00:06, 1183.39it/s] 30%|██▉       | 2983/10000 [00:03<00:05, 1200.64it/s] 31%|███       | 3108/10000 [00:03<00:05, 1213.13it/s] 32%|███▏      | 3233/10000 [00:03<00:05, 1222.06it/s] 34%|███▎      | 3358/10000 [00:03<00:05, 1228.73it/s] 35%|███▍      | 3482/10000 [00:03<00:05, 1231.50it/s] 36%|███▌      | 3606/10000 [00:03<00:05, 1231.76it/s] 37%|███▋      | 3733/10000 [00:03<00:05, 1241.64it/s] 39%|███▊      | 3870/10000 [00:04<00:04, 1279.43it/s] 40%|████      | 4007/10000 [00:04<00:04, 1306.02it/s] 41%|████▏     | 4138/10000 [00:04<00:04, 1290.05it/s] 43%|████▎     | 4291/10000 [00:04<00:04, 1359.82it/s] 44%|████▍     | 4444/10000 [00:04<00:03, 1409.27it/s] 46%|████▌     | 4612/10000 [00:04<00:03, 1489.88it/s] 48%|████▊     | 4785/10000 [00:04<00:03, 1561.00it/s] 50%|████▉     | 4959/10000 [00:04<00:03, 1614.34it/s] 52%|█████▏    | 5152/10000 [00:04<00:02, 1707.80it/s] 54%|█████▎    | 5355/10000 [00:04<00:02, 1802.88it/s] 56%|█████▌    | 5560/10000 [00:05<00:02, 1875.27it/s] 58%|█████▊    | 5762/10000 [00:05<00:02, 1917.99it/s] 60%|█████▉    | 5965/10000 [00:05<00:02, 1948.83it/s] 62%|██████▏   | 6160/10000 [00:05<00:02, 1805.52it/s] 63%|██████▎   | 6343/10000 [00:05<00:02, 1782.59it/s] 65%|██████▌   | 6523/10000 [00:05<00:01, 1765.68it/s] 67%|██████▋   | 6701/10000 [00:05<00:01, 1752.49it/s] 69%|██████▉   | 6877/10000 [00:05<00:01, 1742.55it/s] 71%|███████   | 7052/10000 [00:05<00:01, 1655.66it/s] 72%|███████▏  | 7222/10000 [00:06<00:01, 1667.73it/s] 74%|███████▍  | 7392/10000 [00:06<00:01, 1675.96it/s] 76%|███████▌  | 7562/10000 [00:06<00:01, 1682.30it/s] 77%|███████▋  | 7732/10000 [00:06<00:01, 1684.80it/s] 79%|███████▉  | 7901/10000 [00:06<00:01, 1677.69it/s] 81%|████████  | 8069/10000 [00:06<00:01, 1675.57it/s] 82%|████████▏ | 8237/10000 [00:06<00:01, 1676.31it/s] 84%|████████▍ | 8405/10000 [00:06<00:00, 1676.46it/s] 86%|████████▌ | 8574/10000 [00:06<00:00, 1679.07it/s] 87%|████████▋ | 8743/10000 [00:06<00:00, 1681.72it/s] 89%|████████▉ | 8912/10000 [00:07<00:00, 1681.96it/s] 91%|█████████ | 9081/10000 [00:07<00:00, 1681.70it/s] 92%|█████████▎| 9250/10000 [00:07<00:00, 1681.11it/s] 94%|█████████▍| 9419/10000 [00:07<00:00, 1680.76it/s] 96%|█████████▌| 9588/10000 [00:07<00:00, 1680.83it/s] 98%|█████████▊| 9757/10000 [00:07<00:00, 1679.33it/s] 99%|█████████▉| 9925/10000 [00:07<00:00, 1679.34it/s]100%|██████████| 10000/10000 [00:07<00:00, 1303.94it/s]
C_ell diag [487.63607805 233.17298486 219.57880978 162.54900593 123.53617463
  99.91518579  74.47478976  52.08535564  33.79851842  28.791864
  33.40301019  30.87611087  22.62979256  18.81367632  18.3936814
  16.84190374  14.96814302  13.80895035  12.97901813  12.07651112
  10.65503223   9.33474974   9.27364457   9.36111048   8.49921671
   7.5914212    7.26544024   6.97720391   6.59798014]
C_ell CAMB [1016.40873339  481.26542164  273.2255867   174.32789703  120.63615032
   88.58020843   68.00338177   54.05603479   44.15960466   36.88099026
   31.37125605   27.09077005   23.69408737   20.94822157   18.69703385
   16.82975634   15.24700193   13.92130213   12.77479645   11.7825495
   10.91693642   10.15705706    9.4862152     8.89028104    8.35753915
    7.87990445    7.44941789    7.06011974    6.70683632]
Cubic Torus
Running - E1 l_max=30, Lx=13824
Running {'topology': 'E1', 'Lx': 0.5, 'Ly': 0.5, 'Lz': 0.5, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 30, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'local', 'amp': 1.0, 'pow_min': 0.0001, 'pow_max': 0.0002, 'location': 0.00045, 'width': 0.05, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 179, 2853)

Finding k_max as a function of ell
  0%|          | 0/29 [00:00<?, ?it/s]  7%|▋         | 2/29 [00:00<00:01, 15.61it/s] 14%|█▍        | 4/29 [00:00<00:01, 16.40it/s] 21%|██        | 6/29 [00:00<00:01, 17.19it/s] 28%|██▊       | 8/29 [00:00<00:01, 17.90it/s] 38%|███▊      | 11/29 [00:00<00:00, 19.41it/s] 48%|████▊     | 14/29 [00:00<00:00, 20.95it/s] 59%|█████▊    | 17/29 [00:00<00:00, 22.37it/s] 69%|██████▉   | 20/29 [00:00<00:00, 23.32it/s] 79%|███████▉  | 23/29 [00:01<00:00, 24.08it/s] 90%|████████▉ | 26/29 [00:01<00:00, 24.64it/s]100%|██████████| 29/29 [00:01<00:00, 24.99it/s]100%|██████████| 29/29 [00:01<00:00, 22.14it/s]
Done. k_max for TT ell_max = 0.02930188031725805 k_max for EE ell_max = 0.08517944519572987
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 1122308 Minimum k_amp 0.0004544832372877624 n_x_max 65 n_z_max 65
Time to get list of k, phi, theta: 0.14008116722106934 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07599785442142443
Ratio of unique |k|: 0.0030873877759046535
Time to get unique k and theta: 0.21366643905639648 seconds

Getting transfer functions
  0%|          | 0/3465 [00:00<?, ?it/s]  1%|          | 35/3465 [00:00<00:10, 327.02it/s]  2%|▏         | 85/3465 [00:00<00:08, 421.93it/s]  4%|▍         | 140/3465 [00:00<00:07, 461.95it/s]  6%|▌         | 195/3465 [00:00<00:06, 489.76it/s]  7%|▋         | 250/3465 [00:00<00:06, 504.51it/s]  9%|▉         | 310/3465 [00:00<00:05, 535.65it/s] 11%|█         | 365/3465 [00:00<00:05, 539.94it/s] 12%|█▏        | 425/3465 [00:00<00:05, 554.69it/s] 14%|█▍        | 481/3465 [00:00<00:05, 556.28it/s] 15%|█▌        | 537/3465 [00:01<00:05, 550.69it/s] 17%|█▋        | 595/3465 [00:01<00:05, 546.68it/s] 19%|█▉        | 660/3465 [00:01<00:04, 564.41it/s] 21%|██        | 725/3465 [00:01<00:04, 577.39it/s] 23%|██▎       | 785/3465 [00:01<00:04, 579.30it/s] 24%|██▍       | 845/3465 [00:01<00:04, 580.61it/s] 26%|██▋       | 910/3465 [00:01<00:04, 586.35it/s] 28%|██▊       | 970/3465 [00:01<00:04, 586.11it/s] 31%|███       | 1070/3465 [00:01<00:03, 706.42it/s] 33%|███▎      | 1160/3465 [00:01<00:03, 754.98it/s] 36%|███▌      | 1255/3465 [00:02<00:02, 798.32it/s] 39%|███▉      | 1350/3465 [00:02<00:02, 842.53it/s] 42%|████▏     | 1455/3465 [00:02<00:02, 897.16it/s] 45%|████▍     | 1555/3465 [00:02<00:02, 914.06it/s] 48%|████▊     | 1650/3465 [00:02<00:01, 924.30it/s] 50%|█████     | 1745/3465 [00:02<00:01, 924.89it/s] 53%|█████▎    | 1845/3465 [00:02<00:01, 937.43it/s] 56%|█████▌    | 1945/3465 [00:02<00:01, 941.39it/s] 59%|█████▉    | 2040/3465 [00:02<00:01, 915.47it/s] 62%|██████▏   | 2145/3465 [00:03<00:01, 942.88it/s] 65%|██████▍   | 2240/3465 [00:03<00:01, 935.12it/s] 67%|██████▋   | 2335/3465 [00:03<00:01, 939.03it/s] 70%|███████   | 2440/3465 [00:03<00:01, 958.89it/s] 73%|███████▎  | 2536/3465 [00:03<00:00, 957.39it/s] 76%|███████▌  | 2640/3465 [00:03<00:00, 966.70it/s] 79%|███████▉  | 2740/3465 [00:03<00:00, 966.36it/s] 82%|████████▏ | 2837/3465 [00:03<00:00, 965.61it/s] 85%|████████▍ | 2935/3465 [00:03<00:00, 958.81it/s] 88%|████████▊ | 3035/3465 [00:03<00:00, 968.63it/s] 90%|█████████ | 3132/3465 [00:04<00:00, 958.39it/s] 93%|█████████▎| 3235/3465 [00:04<00:00, 970.29it/s] 96%|█████████▌| 3333/3465 [00:04<00:00, 950.16it/s] 99%|█████████▉| 3429/3465 [00:04<00:00, 949.49it/s]100%|██████████| 3465/3465 [00:04<00:00, 788.57it/s]
Size of transfer function: 0.82 MB. 

Size of integrand: 25.4 MB. Time to calculate integrand: 0.011480569839477539 s

Getting spherical harmonics
  0%|          | 0/85293 [00:00<?, ?it/s]  4%|▎         | 3024/85293 [00:00<00:02, 29765.06it/s]  7%|▋         | 6048/85293 [00:00<00:02, 29974.22it/s] 11%|█         | 9046/85293 [00:00<00:04, 15612.36it/s] 13%|█▎        | 11128/85293 [00:00<00:06, 10827.94it/s] 15%|█▍        | 12643/85293 [00:01<00:07, 9628.67it/s]  16%|█▋        | 13888/85293 [00:01<00:07, 10121.48it/s] 18%|█▊        | 15117/85293 [00:01<00:07, 9795.52it/s]  19%|█▉        | 16235/85293 [00:01<00:07, 9190.54it/s] 20%|██        | 17241/85293 [00:01<00:08, 7878.47it/s] 21%|██        | 18101/85293 [00:01<00:10, 6688.53it/s] 22%|██▏       | 18830/85293 [00:01<00:10, 6622.86it/s] 26%|██▌       | 22064/85293 [00:02<00:05, 12141.97it/s] 30%|███       | 25760/85293 [00:02<00:03, 17861.87it/s] 34%|███▍      | 29120/85293 [00:02<00:02, 21287.77it/s] 37%|███▋      | 31518/85293 [00:02<00:03, 14725.55it/s] 39%|███▉      | 33442/85293 [00:02<00:03, 14890.68it/s] 41%|████▏     | 35252/85293 [00:02<00:04, 12179.31it/s] 43%|████▎     | 36753/85293 [00:03<00:04, 11649.01it/s] 48%|████▊     | 40880/85293 [00:03<00:02, 17542.19it/s] 51%|█████     | 43232/85293 [00:03<00:02, 18816.68it/s] 55%|█████▍    | 46592/85293 [00:03<00:01, 22365.07it/s] 59%|█████▊    | 50064/85293 [00:03<00:01, 25362.43it/s] 63%|██████▎   | 53648/85293 [00:03<00:01, 28095.75it/s] 66%|██████▋   | 56680/85293 [00:03<00:01, 27496.43it/s] 70%|███████   | 60032/85293 [00:03<00:00, 29095.72it/s] 74%|███████▍  | 63066/85293 [00:03<00:00, 28131.30it/s] 78%|███████▊  | 66864/85293 [00:03<00:00, 29954.81it/s] 82%|████████▏ | 69984/85293 [00:04<00:00, 30291.89it/s] 86%|████████▌ | 73472/85293 [00:04<00:00, 31560.83it/s] 90%|█████████ | 77056/85293 [00:04<00:00, 32502.39it/s] 96%|█████████▌| 81648/85293 [00:04<00:00, 36131.17it/s]100%|██████████| 85293/85293 [00:04<00:00, 19031.73it/s]
The spherical harmonics array is 161.38 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=30 and accuracy=0.99: 67.42729091644287 seconds

Calculating covariance matrix
  0%|          | 0/1122308 [00:00<?, ?it/s]  0%|          | 0/1122308 [00:00<?, ?it/s]Only calculating diagonal
  6%|▌         | 67043/1122308 [00:00<00:01, 654807.86it/s] 10%|█         | 116864/1122308 [00:00<00:01, 576503.13it/s] 14%|█▍        | 162189/1122308 [00:00<00:01, 535266.32it/s] 18%|█▊        | 205394/1122308 [00:00<00:01, 509266.19it/s] 22%|██▏       | 245747/1122308 [00:00<00:01, 487973.49it/s] 25%|██▌       | 285017/1122308 [00:00<00:01, 471960.81it/s] 29%|██▉       | 323035/1122308 [00:00<00:01, 458731.01it/s] 32%|███▏      | 360958/1122308 [00:00<00:01, 448673.65it/s] 35%|███▌      | 398390/1122308 [00:00<00:01, 440310.88it/s] 39%|███▉      | 435391/1122308 [00:01<00:01, 433188.34it/s] 42%|████▏     | 472239/1122308 [00:01<00:01, 427219.69it/s] 45%|████▌     | 508829/1122308 [00:01<00:01, 422027.95it/s] 49%|████▊     | 544953/1122308 [00:01<00:01, 417278.44it/s] 52%|█████▏    | 580533/1122308 [00:01<00:01, 412812.97it/s] 55%|█████▍    | 616899/1122308 [00:01<00:01, 409468.85it/s] 58%|█████▊    | 655407/1122308 [00:01<00:01, 407875.64it/s] 62%|██████▏   | 696361/1122308 [00:01<00:01, 407902.92it/s] 66%|██████▌   | 740337/1122308 [00:01<00:00, 409595.29it/s] 70%|███████   | 787494/1122308 [00:01<00:00, 412780.42it/s] 75%|███████▍  | 837759/1122308 [00:02<00:00, 417195.67it/s] 80%|███████▉  | 893673/1122308 [00:02<00:00, 423869.71it/s] 85%|████████▌ | 954869/1122308 [00:02<00:00, 432263.79it/s] 91%|█████████▏| 1026297/1122308 [00:02<00:00, 444208.69it/s]100%|██████████| 1122308/1122308 [00:02<00:00, 466807.83it/s]100%|██████████| 1122308/1122308 [00:02<00:00, 466736.37it/s]100%|██████████| 1122308/1122308 [00:02<00:00, 466700.97it/s]
Time to calculate C_TT with l_max=30 and c_l_ratio=0.99: 2.4056460857391357 seconds with Numba

Calculating covariance matrix
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:21<00:00, 21.83s/it]100%|██████████| 1/1 [00:21<00:00, 21.83s/it]
Traceback (most recent call last):
  File "/home/jnoltmann/topology/run_create_realizations_cholesky.py", line 87, in <module>
    a_lm_list, c_l_list = a.make_realization_c_lmlpmp_cholesky(10000)
  File "/home/jnoltmann/topology/src/topology.py", line 634, in make_realization_c_lmlpmp_cholesky
    Tilde_L = np.linalg.cholesky(Tilde_C)
  File "/home/conda/envs/topology/lib/python3.10/site-packages/numpy/linalg/linalg.py", line 779, in cholesky
    r = gufunc(a, signature=signature, extobj=extobj)
  File "/home/conda/envs/topology/lib/python3.10/site-packages/numpy/linalg/linalg.py", line 115, in _raise_linalgerror_nonposdef
    raise LinAlgError("Matrix is not positive definite")
numpy.linalg.LinAlgError: Matrix is not positive definite
