Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw', 'amp': 1.0, 'pow_min': 0.00037, 'pow_max': 0.00057, 'location': 0.00045, 'width': 0.05, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Making run folder: runs/E1_Lx_1.15_Ly_1.15_Lz_1.15_beta_90_alpha_90_l_max_20_accuracy_99_percent/
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.74it/s] 16%|█▌        | 3/19 [00:00<00:01, 11.52it/s] 26%|██▋       | 5/19 [00:00<00:01, 13.27it/s] 37%|███▋      | 7/19 [00:00<00:00, 14.36it/s] 47%|████▋     | 9/19 [00:00<00:00, 15.33it/s] 58%|█████▊    | 11/19 [00:00<00:00, 16.31it/s] 68%|██████▊   | 13/19 [00:00<00:00, 17.37it/s] 84%|████████▍ | 16/19 [00:00<00:00, 18.92it/s]100%|██████████| 19/19 [00:01<00:00, 20.48it/s]100%|██████████| 19/19 [00:01<00:00, 17.04it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519265089295892
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6356712 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 2.460036516189575 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07026981873647886
Ratio of unique |k|: 0.0017317128729443774
Time to get unique k and theta: 1.4522426128387451 seconds

Getting transfer functions
  0%|          | 0/11008 [00:00<?, ?it/s]  2%|▏         | 255/11008 [00:00<00:04, 2495.11it/s]  5%|▍         | 525/11008 [00:00<00:04, 2543.56it/s]  7%|▋         | 795/11008 [00:00<00:03, 2591.37it/s] 10%|▉         | 1080/11008 [00:00<00:03, 2670.67it/s] 12%|█▏        | 1350/11008 [00:00<00:03, 2629.30it/s] 15%|█▍        | 1620/11008 [00:00<00:03, 2625.03it/s] 17%|█▋        | 1883/11008 [00:00<00:03, 2556.36it/s] 19%|█▉        | 2139/11008 [00:00<00:03, 2510.74it/s] 22%|██▏       | 2400/11008 [00:00<00:03, 2539.38it/s] 24%|██▍       | 2670/11008 [00:01<00:03, 2567.89it/s] 27%|██▋       | 2985/11008 [00:01<00:02, 2716.49it/s] 30%|███       | 3345/11008 [00:01<00:02, 2973.53it/s] 34%|███▎      | 3705/11008 [00:01<00:02, 3153.54it/s] 37%|███▋      | 4110/11008 [00:01<00:02, 3383.44it/s] 41%|████      | 4500/11008 [00:01<00:01, 3508.67it/s] 44%|████▍     | 4890/11008 [00:01<00:01, 3598.32it/s] 48%|████▊     | 5280/11008 [00:01<00:01, 3658.68it/s] 52%|█████▏    | 5670/11008 [00:01<00:01, 3704.57it/s] 55%|█████▍    | 6045/11008 [00:01<00:01, 3713.82it/s] 59%|█████▊    | 6450/11008 [00:02<00:01, 3803.87it/s] 62%|██████▏   | 6831/11008 [00:02<00:01, 3782.29it/s] 66%|██████▌   | 7215/11008 [00:02<00:01, 3765.67it/s] 69%|██████▉   | 7605/11008 [00:02<00:00, 3782.64it/s] 73%|███████▎  | 7995/11008 [00:02<00:00, 3788.51it/s] 77%|███████▋  | 8430/11008 [00:02<00:00, 3953.47it/s] 80%|████████  | 8826/11008 [00:02<00:00, 3912.70it/s] 84%|████████▎ | 9218/11008 [00:02<00:00, 3864.42it/s] 87%|████████▋ | 9605/11008 [00:02<00:00, 3758.00it/s] 91%|█████████ | 9982/11008 [00:02<00:00, 3688.26it/s] 94%|█████████▍| 10365/11008 [00:03<00:00, 3699.74it/s] 98%|█████████▊| 10770/11008 [00:03<00:00, 3761.90it/s]100%|██████████| 11008/11008 [00:03<00:00, 3376.17it/s]
Size of transfer function: 1.76 MB. 

Size of integrand: 37.04 MB. Time to calculate integrand: 0.6367397308349609 s

Getting spherical harmonics
  0%|          | 0/446685 [00:00<?, ?it/s]  2%|▏         | 6984/446685 [00:00<00:06, 68180.86it/s]  3%|▎         | 13968/446685 [00:00<00:06, 65941.73it/s]  5%|▍         | 20952/446685 [00:00<00:06, 65492.29it/s]  6%|▌         | 27505/446685 [00:00<00:07, 54090.15it/s]  8%|▊         | 34338/446685 [00:00<00:07, 57506.41it/s]  9%|▉         | 40271/446685 [00:00<00:07, 57590.67it/s] 10%|█         | 46152/446685 [00:00<00:07, 55060.08it/s] 12%|█▏        | 51746/446685 [00:00<00:07, 54178.66it/s] 13%|█▎        | 57618/446685 [00:01<00:07, 53665.99it/s] 14%|█▍        | 63438/446685 [00:01<00:07, 54708.14it/s] 16%|█▌        | 69258/446685 [00:01<00:06, 54625.53it/s] 17%|█▋        | 74744/446685 [00:01<00:07, 52161.27it/s] 18%|█▊        | 81480/446685 [00:01<00:06, 55352.45it/s] 20%|█▉        | 87300/446685 [00:01<00:06, 55015.45it/s] 21%|██        | 93702/446685 [00:01<00:06, 56883.84it/s] 22%|██▏       | 99410/446685 [00:01<00:06, 56505.83it/s] 24%|██▎       | 105073/446685 [00:01<00:06, 55966.40it/s] 25%|██▍       | 110678/446685 [00:01<00:06, 54787.79it/s] 26%|██▌       | 116400/446685 [00:02<00:06, 54488.34it/s] 27%|██▋       | 122802/446685 [00:02<00:05, 56205.20it/s] 29%|██▉       | 128426/446685 [00:02<00:05, 55418.22it/s] 30%|███       | 135024/446685 [00:02<00:05, 57413.15it/s] 32%|███▏      | 140844/446685 [00:02<00:05, 57525.51it/s] 33%|███▎      | 147828/446685 [00:02<00:05, 59677.82it/s] 35%|███▍      | 154230/446685 [00:02<00:04, 60443.31it/s] 36%|███▌      | 160632/446685 [00:02<00:04, 60091.56it/s] 37%|███▋      | 167034/446685 [00:02<00:04, 60650.05it/s] 39%|███▉      | 173100/446685 [00:03<00:04, 60479.21it/s] 40%|████      | 179256/446685 [00:03<00:04, 59271.13it/s] 41%|████▏     | 185187/446685 [00:03<00:04, 58338.18it/s] 43%|████▎     | 192060/446685 [00:03<00:04, 59953.24it/s] 44%|████▍     | 198462/446685 [00:03<00:04, 58559.21it/s] 46%|████▌     | 204864/446685 [00:03<00:04, 60026.85it/s] 47%|████▋     | 211848/446685 [00:03<00:03, 62760.75it/s] 49%|████▉     | 218250/446685 [00:03<00:03, 62660.50it/s] 50%|█████     | 224531/446685 [00:03<00:03, 60852.50it/s] 52%|█████▏    | 230634/446685 [00:03<00:03, 59027.73it/s] 53%|█████▎    | 236555/446685 [00:04<00:03, 58904.17it/s] 54%|█████▍    | 242458/446685 [00:04<00:03, 57299.89it/s] 56%|█████▌    | 248514/446685 [00:04<00:03, 57357.06it/s] 57%|█████▋    | 254334/446685 [00:04<00:03, 57588.96it/s] 58%|█████▊    | 260997/446685 [00:04<00:03, 60216.72it/s] 60%|██████    | 268302/446685 [00:04<00:02, 62922.56it/s] 61%|██████▏   | 274704/446685 [00:04<00:02, 62604.46it/s] 63%|██████▎   | 280968/446685 [00:04<00:02, 62184.85it/s] 64%|██████▍   | 287508/446685 [00:04<00:02, 61862.00it/s] 66%|██████▌   | 293697/446685 [00:05<00:02, 59305.32it/s] 67%|██████▋   | 299730/446685 [00:05<00:02, 59070.76it/s] 69%|██████▊   | 306132/446685 [00:05<00:02, 60347.74it/s] 70%|███████   | 313116/446685 [00:05<00:02, 62272.22it/s] 72%|███████▏  | 319518/446685 [00:05<00:02, 62000.05it/s] 73%|███████▎  | 325725/446685 [00:05<00:01, 61181.14it/s] 74%|███████▍  | 331848/446685 [00:05<00:02, 54348.63it/s] 76%|███████▌  | 339306/446685 [00:05<00:01, 59307.20it/s] 78%|███████▊  | 346290/446685 [00:05<00:01, 59641.00it/s] 79%|███████▉  | 353274/446685 [00:06<00:01, 61564.45it/s] 81%|████████  | 360258/446685 [00:06<00:01, 63100.04it/s] 82%|████████▏ | 366629/446685 [00:06<00:01, 60288.22it/s] 84%|████████▎ | 373062/446685 [00:06<00:01, 60626.76it/s] 85%|████████▍ | 379464/446685 [00:06<00:01, 60471.74it/s] 86%|████████▋ | 385866/446685 [00:06<00:01, 60294.41it/s] 88%|████████▊ | 392268/446685 [00:06<00:00, 60577.70it/s] 89%|████████▉ | 399252/446685 [00:06<00:00, 62788.68it/s] 91%|█████████ | 406818/446685 [00:06<00:00, 65243.38it/s] 93%|█████████▎| 413353/446685 [00:06<00:00, 64119.52it/s] 94%|█████████▍| 420204/446685 [00:07<00:00, 63402.88it/s] 96%|█████████▌| 427188/446685 [00:07<00:00, 65069.00it/s] 97%|█████████▋| 434884/446685 [00:07<00:00, 68502.22it/s] 99%|█████████▉| 441757/446685 [00:07<00:00, 67709.00it/s]100%|██████████| 446685/446685 [00:07<00:00, 59725.36it/s]
The spherical harmonics array is 393.62 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 29.245544910430908 seconds

Calculating covariance matrix
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:14<00:00, 14.71s/it]100%|██████████| 1/1 [00:14<00:00, 14.71s/it]
Calculating KL divergence

Calculating covariance matrix
KL: 0.697145823380796 0.6346900044073216
