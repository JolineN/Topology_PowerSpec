Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.0001, 'pow_max': 0.00015000000000000001, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:05,  3.02it/s] 16%|█▌        | 3/19 [00:00<00:02,  6.93it/s] 26%|██▋       | 5/19 [00:00<00:01,  9.08it/s] 37%|███▋      | 7/19 [00:00<00:01, 10.37it/s] 47%|████▋     | 9/19 [00:00<00:00, 11.17it/s] 58%|█████▊    | 11/19 [00:01<00:00, 11.69it/s] 68%|██████▊   | 13/19 [00:01<00:00, 12.27it/s] 79%|███████▉  | 15/19 [00:01<00:00, 12.94it/s] 89%|████████▉ | 17/19 [00:01<00:00, 13.76it/s]100%|██████████| 19/19 [00:01<00:00, 14.67it/s]100%|██████████| 19/19 [00:01<00:00, 11.59it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4307060 Minimum k_amp 0.00022499170162760515 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 4.384567499160767 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07154532325994994
Ratio of unique |k|: 0.0019711821985298555
Time to get unique k and theta: 0.9564857482910156 seconds

Getting transfer functions
  0%|          | 0/8490 [00:00<?, ?it/s]  2%|▏         | 192/8490 [00:00<00:04, 1811.59it/s]  5%|▍         | 420/8490 [00:00<00:03, 2033.30it/s]  7%|▋         | 636/8490 [00:00<00:03, 2073.01it/s] 10%|█         | 864/8490 [00:00<00:03, 2133.26it/s] 13%|█▎        | 1092/8490 [00:00<00:03, 2169.73it/s] 15%|█▌        | 1310/8490 [00:00<00:03, 2171.36it/s] 18%|█▊        | 1536/8490 [00:00<00:03, 2177.11it/s] 21%|██        | 1764/8490 [00:00<00:03, 2200.14it/s] 23%|██▎       | 1985/8490 [00:00<00:02, 2195.51it/s] 26%|██▋       | 2232/8490 [00:01<00:02, 2239.23it/s] 30%|██▉       | 2508/8490 [00:01<00:02, 2384.87it/s] 33%|███▎      | 2784/8490 [00:01<00:02, 2488.56it/s] 36%|███▌      | 3060/8490 [00:01<00:02, 2561.69it/s] 40%|███▉      | 3372/8490 [00:01<00:01, 2722.32it/s] 44%|████▎     | 3696/8490 [00:01<00:01, 2850.51it/s] 47%|████▋     | 4008/8490 [00:01<00:01, 2911.72it/s] 51%|█████     | 4344/8490 [00:01<00:01, 3036.69it/s] 55%|█████▌    | 4680/8490 [00:01<00:01, 3110.25it/s] 59%|█████▉    | 4992/8490 [00:01<00:01, 3085.26it/s] 62%|██████▏   | 5304/8490 [00:02<00:01, 3065.43it/s] 66%|██████▌   | 5616/8490 [00:02<00:00, 3067.80it/s] 70%|██████▉   | 5928/8490 [00:02<00:00, 3056.11it/s] 74%|███████▎  | 6252/8490 [00:02<00:00, 3078.15it/s] 77%|███████▋  | 6564/8490 [00:02<00:00, 3070.31it/s] 81%|████████  | 6876/8490 [00:02<00:00, 3083.42it/s] 85%|████████▍ | 7188/8490 [00:02<00:00, 3068.48it/s] 88%|████████▊ | 7495/8490 [00:02<00:00, 3066.44it/s] 92%|█████████▏| 7802/8490 [00:02<00:00, 3037.56it/s] 96%|█████████▌| 8112/8490 [00:02<00:00, 3027.87it/s] 99%|█████████▉| 8424/8490 [00:03<00:00, 3044.11it/s]100%|██████████| 8490/8490 [00:03<00:00, 2749.32it/s]
Size of transfer function: 1.36 MB. 

Size of integrand: 28.57 MB. Time to calculate integrand: 0.6344621181488037 s

Getting spherical harmonics
  0%|          | 0/308150 [00:00<?, ?it/s]  2%|▏         | 5226/308150 [00:00<00:06, 47955.46it/s]  3%|▎         | 10022/308150 [00:00<00:07, 41414.22it/s]  5%|▍         | 14472/308150 [00:00<00:06, 42337.44it/s]  6%|▌         | 18894/308150 [00:00<00:06, 41780.77it/s]  8%|▊         | 23316/308150 [00:00<00:06, 41602.06it/s]  9%|▉         | 27738/308150 [00:00<00:06, 42103.22it/s] 10%|█         | 31958/308150 [00:00<00:06, 41080.81it/s] 12%|█▏        | 36074/308150 [00:00<00:06, 40020.08it/s] 13%|█▎        | 40200/308150 [00:00<00:06, 39206.28it/s] 14%|█▍        | 44126/308150 [00:01<00:06, 38194.31it/s] 16%|█▌        | 47950/308150 [00:01<00:06, 37998.29it/s] 17%|█▋        | 53064/308150 [00:01<00:06, 41004.44it/s] 19%|█▊        | 57486/308150 [00:01<00:06, 41172.93it/s] 20%|██        | 62310/308150 [00:01<00:05, 42519.19it/s] 22%|██▏       | 66732/308150 [00:01<00:05, 42337.00it/s] 23%|██▎       | 71154/308150 [00:01<00:05, 42131.98it/s] 24%|██▍       | 75368/308150 [00:01<00:05, 40622.24it/s] 26%|██▌       | 80802/308150 [00:01<00:05, 43987.41it/s] 28%|██▊       | 86028/308150 [00:02<00:04, 45945.26it/s] 30%|██▉       | 92058/308150 [00:02<00:04, 49735.35it/s] 32%|███▏      | 97686/308150 [00:02<00:04, 51135.59it/s] 34%|███▎      | 103716/308150 [00:02<00:03, 52294.27it/s] 35%|███▌      | 108952/308150 [00:02<00:03, 51013.43it/s] 37%|███▋      | 114570/308150 [00:02<00:03, 52094.88it/s] 39%|███▉      | 121404/308150 [00:02<00:03, 55973.06it/s] 42%|████▏     | 128238/308150 [00:02<00:03, 58474.67it/s] 44%|████▎     | 134089/308150 [00:02<00:03, 55790.92it/s] 45%|████▌     | 139689/308150 [00:03<00:03, 55110.58it/s] 47%|████▋     | 145213/308150 [00:03<00:02, 54525.77it/s] 49%|████▉     | 151956/308150 [00:03<00:02, 57849.89it/s] 51%|█████     | 157756/308150 [00:03<00:02, 57258.35it/s] 53%|█████▎    | 163492/308150 [00:03<00:02, 55202.24it/s] 55%|█████▍    | 169030/308150 [00:03<00:02, 54978.26it/s] 57%|█████▋    | 174870/308150 [00:03<00:02, 55699.65it/s] 59%|█████▊    | 180900/308150 [00:03<00:02, 55880.13it/s] 61%|██████    | 187322/308150 [00:03<00:02, 58291.84it/s] 63%|██████▎   | 193165/308150 [00:03<00:02, 55732.23it/s] 65%|██████▍   | 198767/308150 [00:04<00:02, 54310.70it/s] 66%|██████▋   | 204221/308150 [00:04<00:02, 51182.28it/s] 68%|██████▊   | 210246/308150 [00:04<00:01, 52688.93it/s] 70%|███████   | 216276/308150 [00:04<00:01, 53492.46it/s] 72%|███████▏  | 221650/308150 [00:04<00:01, 53297.42it/s] 74%|███████▎  | 226996/308150 [00:04<00:01, 52359.38it/s] 75%|███████▌  | 232243/308150 [00:04<00:01, 49758.22it/s] 77%|███████▋  | 237244/308150 [00:04<00:01, 49311.81it/s] 79%|███████▉  | 243612/308150 [00:04<00:01, 52524.23it/s] 81%|████████  | 249642/308150 [00:05<00:01, 53895.16it/s] 83%|████████▎ | 255046/308150 [00:05<00:00, 53722.75it/s] 85%|████████▍ | 260496/308150 [00:05<00:00, 53844.28it/s] 86%|████████▋ | 266124/308150 [00:05<00:00, 53822.68it/s] 88%|████████▊ | 272556/308150 [00:05<00:00, 56692.28it/s] 90%|█████████ | 278235/308150 [00:05<00:00, 55825.73it/s] 93%|█████████▎| 285420/308150 [00:05<00:00, 59960.11it/s] 95%|█████████▍| 291450/308150 [00:05<00:00, 59816.33it/s] 97%|█████████▋| 297437/308150 [00:05<00:00, 58350.05it/s] 98%|█████████▊| 303281/308150 [00:05<00:00, 57614.59it/s]100%|██████████| 308150/308150 [00:06<00:00, 50870.51it/s]
The spherical harmonics array is 271.54 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 28.957938194274902 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 23.766277557073906
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.0002, 'pow_max': 0.00025, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 16%|█▌        | 3/19 [00:00<00:00, 22.59it/s] 32%|███▏      | 6/19 [00:00<00:00, 23.17it/s] 47%|████▋     | 9/19 [00:00<00:00, 23.44it/s] 63%|██████▎   | 12/19 [00:00<00:00, 23.61it/s] 79%|███████▉  | 15/19 [00:00<00:00, 23.79it/s] 95%|█████████▍| 18/19 [00:00<00:00, 23.84it/s]100%|██████████| 19/19 [00:00<00:00, 23.66it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4307060 Minimum k_amp 0.00022499170162760515 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 0.4781982898712158 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07154532325994994
Ratio of unique |k|: 0.0019711821985298555
Time to get unique k and theta: 0.9800500869750977 seconds

Getting transfer functions
  0%|          | 0/8490 [00:00<?, ?it/s]  2%|▏         | 144/8490 [00:00<00:05, 1437.46it/s]  4%|▎         | 312/8490 [00:00<00:05, 1557.68it/s]  6%|▌         | 492/8490 [00:00<00:04, 1636.22it/s]  8%|▊         | 684/8490 [00:00<00:04, 1728.80it/s] 10%|█         | 864/8490 [00:00<00:04, 1739.07it/s] 12%|█▏        | 1044/8490 [00:00<00:04, 1741.92it/s] 15%|█▍        | 1236/8490 [00:00<00:04, 1769.74it/s] 17%|█▋        | 1428/8490 [00:00<00:03, 1784.68it/s] 19%|█▉        | 1620/8490 [00:00<00:03, 1803.44it/s] 21%|██▏       | 1812/8490 [00:01<00:03, 1819.32it/s] 23%|██▎       | 1994/8490 [00:01<00:03, 1812.34it/s] 26%|██▌       | 2184/8490 [00:01<00:03, 1806.73it/s] 28%|██▊       | 2388/8490 [00:01<00:03, 1854.67it/s] 32%|███▏      | 2676/8490 [00:01<00:02, 2140.77it/s] 35%|███▌      | 2988/8490 [00:01<00:02, 2404.08it/s] 39%|███▉      | 3312/8490 [00:01<00:01, 2631.11it/s] 43%|████▎     | 3612/8490 [00:01<00:01, 2736.65it/s] 46%|████▌     | 3924/8490 [00:01<00:01, 2833.51it/s] 50%|████▉     | 4236/8490 [00:01<00:01, 2906.73it/s] 54%|█████▎    | 4548/8490 [00:02<00:01, 2956.38it/s] 57%|█████▋    | 4860/8490 [00:02<00:01, 2990.94it/s] 61%|██████    | 5184/8490 [00:02<00:01, 3033.98it/s] 65%|██████▍   | 5508/8490 [00:02<00:00, 3076.36it/s] 69%|██████▊   | 5820/8490 [00:02<00:00, 3080.60it/s] 72%|███████▏  | 6129/8490 [00:02<00:00, 3067.43it/s] 76%|███████▌  | 6444/8490 [00:02<00:00, 3065.98it/s] 80%|███████▉  | 6768/8490 [00:02<00:00, 3085.75it/s] 83%|████████▎ | 7077/8490 [00:02<00:00, 3061.26it/s] 87%|████████▋ | 7384/8490 [00:02<00:00, 3010.37it/s] 91%|█████████ | 7692/8490 [00:03<00:00, 3025.10it/s] 94%|█████████▍| 8016/8490 [00:03<00:00, 3076.85it/s] 98%|█████████▊| 8340/8490 [00:03<00:00, 3102.12it/s]100%|██████████| 8490/8490 [00:03<00:00, 2547.22it/s]
Size of transfer function: 1.36 MB. 

Size of integrand: 28.57 MB. Time to calculate integrand: 0.016739606857299805 s

Getting spherical harmonics
  0%|          | 0/308150 [00:00<?, ?it/s]  2%|▏         | 5226/308150 [00:00<00:06, 50037.06it/s]  3%|▎         | 10230/308150 [00:00<00:07, 41795.26it/s]  5%|▍         | 14874/308150 [00:00<00:06, 42640.78it/s]  6%|▌         | 19186/308150 [00:00<00:07, 40663.94it/s]  8%|▊         | 23282/308150 [00:00<00:07, 39865.84it/s]  9%|▉         | 27284/308150 [00:00<00:07, 37992.74it/s] 10%|█         | 31098/308150 [00:00<00:07, 36416.10it/s] 12%|█▏        | 35778/308150 [00:00<00:06, 39186.78it/s] 13%|█▎        | 39798/308150 [00:01<00:06, 38844.84it/s] 14%|█▍        | 44220/308150 [00:01<00:06, 40140.31it/s] 16%|█▌        | 48642/308150 [00:01<00:06, 40626.67it/s] 17%|█▋        | 53064/308150 [00:01<00:06, 40736.67it/s] 19%|█▊        | 57486/308150 [00:01<00:06, 41371.86it/s] 20%|██        | 61632/308150 [00:01<00:07, 34488.00it/s] 21%|██▏       | 65526/308150 [00:01<00:06, 35535.15it/s] 23%|██▎       | 70350/308150 [00:01<00:06, 38409.08it/s] 25%|██▍       | 75576/308150 [00:01<00:05, 41325.15it/s] 26%|██▌       | 80802/308150 [00:02<00:05, 44195.59it/s] 28%|██▊       | 86028/308150 [00:02<00:04, 46361.63it/s] 30%|██▉       | 91254/308150 [00:02<00:04, 47617.18it/s] 32%|███▏      | 97284/308150 [00:02<00:04, 50720.64it/s] 34%|███▎      | 103314/308150 [00:02<00:03, 52491.89it/s] 35%|███▌      | 108592/308150 [00:02<00:03, 51423.70it/s] 37%|███▋      | 113766/308150 [00:02<00:03, 50613.99it/s] 39%|███▊      | 119394/308150 [00:02<00:03, 51711.58it/s] 41%|████      | 125424/308150 [00:02<00:03, 53618.86it/s] 43%|████▎     | 131856/308150 [00:02<00:03, 55593.49it/s] 45%|████▍     | 137421/308150 [00:03<00:03, 50369.32it/s] 46%|████▋     | 143112/308150 [00:03<00:03, 51227.46it/s] 48%|████▊     | 148338/308150 [00:03<00:03, 50874.59it/s] 50%|████▉     | 153564/308150 [00:03<00:03, 50812.04it/s] 52%|█████▏    | 159594/308150 [00:03<00:02, 53226.52it/s] 54%|█████▎    | 164948/308150 [00:03<00:02, 52657.81it/s] 55%|█████▌    | 170235/308150 [00:03<00:02, 51639.36it/s] 57%|█████▋    | 176478/308150 [00:03<00:02, 53692.81it/s] 59%|█████▉    | 181858/308150 [00:03<00:02, 52045.92it/s] 61%|██████    | 187075/308150 [00:04<00:02, 50075.66it/s] 63%|██████▎   | 192960/308150 [00:04<00:02, 50868.28it/s] 64%|██████▍   | 198588/308150 [00:04<00:02, 52136.51it/s] 66%|██████▋   | 204618/308150 [00:04<00:01, 54380.40it/s] 68%|██████▊   | 210648/308150 [00:04<00:01, 55953.45it/s] 70%|███████   | 216264/308150 [00:04<00:01, 53826.27it/s] 72%|███████▏  | 221674/308150 [00:04<00:01, 52961.90it/s] 74%|███████▎  | 226989/308150 [00:04<00:01, 50622.00it/s] 75%|███████▌  | 232078/308150 [00:04<00:01, 49531.21it/s] 77%|███████▋  | 237984/308150 [00:05<00:01, 51853.38it/s] 79%|███████▉  | 244014/308150 [00:05<00:01, 53726.41it/s] 81%|████████  | 249408/308150 [00:05<00:01, 53103.80it/s] 83%|████████▎ | 254868/308150 [00:05<00:01, 52004.53it/s] 85%|████████▍ | 260496/308150 [00:05<00:00, 52535.85it/s] 86%|████████▌ | 265760/308150 [00:05<00:00, 51143.78it/s] 88%|████████▊ | 270885/308150 [00:05<00:00, 51059.21it/s] 90%|████████▉ | 276174/308150 [00:05<00:00, 50847.62it/s] 92%|█████████▏| 282204/308150 [00:05<00:00, 53418.64it/s] 93%|█████████▎| 287557/308150 [00:05<00:00, 50613.95it/s] 95%|█████████▌| 293058/308150 [00:06<00:00, 51846.42it/s] 97%|█████████▋| 299088/308150 [00:06<00:00, 53553.53it/s] 99%|█████████▉| 304466/308150 [00:06<00:00, 53149.28it/s]100%|██████████| 308150/308150 [00:06<00:00, 48652.87it/s]
The spherical harmonics array is 271.54 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 44.50311207771301 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 24.008921555930286
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.0003, 'pow_max': 0.00035, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 16%|█▌        | 3/19 [00:00<00:00, 21.12it/s] 32%|███▏      | 6/19 [00:00<00:00, 22.04it/s] 47%|████▋     | 9/19 [00:00<00:00, 22.65it/s] 63%|██████▎   | 12/19 [00:00<00:00, 22.96it/s] 79%|███████▉  | 15/19 [00:00<00:00, 23.11it/s] 95%|█████████▍| 18/19 [00:00<00:00, 23.20it/s]100%|██████████| 19/19 [00:00<00:00, 22.90it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4307060 Minimum k_amp 0.00022499170162760515 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 0.47545504570007324 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07154532325994994
Ratio of unique |k|: 0.0019711821985298555
Time to get unique k and theta: 0.9550564289093018 seconds

Getting transfer functions
  0%|          | 0/8490 [00:00<?, ?it/s]  2%|▏         | 204/8490 [00:00<00:04, 1964.89it/s]  5%|▌         | 432/8490 [00:00<00:03, 2108.20it/s]  8%|▊         | 643/8490 [00:00<00:03, 2007.61it/s] 10%|█         | 864/8490 [00:00<00:03, 2068.14it/s] 13%|█▎        | 1080/8490 [00:00<00:03, 2097.37it/s] 15%|█▌        | 1296/8490 [00:00<00:03, 2107.91it/s] 18%|█▊        | 1524/8490 [00:00<00:03, 2142.17it/s] 20%|██        | 1739/8490 [00:00<00:03, 2140.08it/s] 23%|██▎       | 1954/8490 [00:00<00:03, 2109.42it/s] 26%|██▌       | 2166/8490 [00:01<00:02, 2108.12it/s] 28%|██▊       | 2412/8490 [00:01<00:02, 2209.83it/s] 32%|███▏      | 2712/8490 [00:01<00:02, 2445.51it/s] 36%|███▌      | 3024/8490 [00:01<00:02, 2641.97it/s] 39%|███▉      | 3324/8490 [00:01<00:01, 2732.02it/s] 43%|████▎     | 3624/8490 [00:01<00:01, 2788.92it/s] 47%|████▋     | 3948/8490 [00:01<00:01, 2912.83it/s] 50%|█████     | 4248/8490 [00:01<00:01, 2912.35it/s] 54%|█████▍    | 4572/8490 [00:01<00:01, 3005.95it/s] 58%|█████▊    | 4884/8490 [00:01<00:01, 3020.80it/s] 61%|██████▏   | 5208/8490 [00:02<00:01, 3083.78it/s] 65%|██████▌   | 5520/8490 [00:02<00:00, 3083.47it/s] 69%|██████▉   | 5868/8490 [00:02<00:00, 3160.63it/s] 73%|███████▎  | 6184/8490 [00:02<00:00, 3084.56it/s] 76%|███████▋  | 6493/8490 [00:02<00:00, 3054.58it/s] 80%|████████  | 6804/8490 [00:02<00:00, 3048.56it/s] 84%|████████▍ | 7152/8490 [00:02<00:00, 3147.46it/s] 88%|████████▊ | 7467/8490 [00:02<00:00, 3087.31it/s] 92%|█████████▏| 7776/8490 [00:02<00:00, 3014.19it/s] 95%|█████████▌| 8078/8490 [00:02<00:00, 2971.25it/s] 99%|█████████▉| 8388/8490 [00:03<00:00, 3003.72it/s]100%|██████████| 8490/8490 [00:03<00:00, 2712.76it/s]
Size of transfer function: 1.36 MB. 

Size of integrand: 28.57 MB. Time to calculate integrand: 0.021007299423217773 s

Getting spherical harmonics
  0%|          | 0/308150 [00:00<?, ?it/s]  2%|▏         | 4824/308150 [00:00<00:06, 45721.72it/s]  3%|▎         | 10050/308150 [00:00<00:06, 47913.74it/s]  5%|▍         | 14874/308150 [00:00<00:06, 47421.09it/s]  6%|▋         | 19616/308150 [00:00<00:06, 44379.38it/s]  8%|▊         | 24075/308150 [00:00<00:06, 42723.76it/s]  9%|▉         | 28363/308150 [00:00<00:07, 38450.00it/s] 11%|█         | 32964/308150 [00:00<00:06, 40096.27it/s] 12%|█▏        | 37386/308150 [00:00<00:06, 41098.74it/s] 14%|█▍        | 42612/308150 [00:00<00:06, 43570.47it/s] 15%|█▌        | 47436/308150 [00:01<00:06, 42962.28it/s] 17%|█▋        | 51762/308150 [00:01<00:06, 40078.15it/s] 18%|█▊        | 56280/308150 [00:01<00:06, 41136.74it/s] 20%|█▉        | 61104/308150 [00:01<00:05, 42879.04it/s] 21%|██▏       | 65526/308150 [00:01<00:05, 43122.35it/s] 23%|██▎       | 69948/308150 [00:01<00:05, 43187.91it/s] 24%|██▍       | 74288/308150 [00:01<00:06, 36587.90it/s] 25%|██▌       | 78125/308150 [00:01<00:06, 36685.44it/s] 27%|██▋       | 84247/308150 [00:02<00:05, 43278.60it/s] 29%|██▉       | 90852/308150 [00:02<00:04, 48689.58it/s] 32%|███▏      | 97686/308150 [00:02<00:03, 53612.71it/s] 33%|███▎      | 103163/308150 [00:02<00:03, 53808.03it/s] 36%|███▌      | 110148/308150 [00:02<00:03, 57828.24it/s] 38%|███▊      | 115995/308150 [00:02<00:03, 56227.65it/s] 40%|████      | 123414/308150 [00:02<00:03, 60568.09it/s] 42%|████▏     | 129514/308150 [00:02<00:02, 60670.27it/s] 44%|████▍     | 136680/308150 [00:02<00:02, 63049.83it/s] 46%|████▋     | 143007/308150 [00:02<00:03, 54792.58it/s] 48%|████▊     | 148683/308150 [00:03<00:02, 53631.09it/s] 50%|█████     | 155172/308150 [00:03<00:02, 55813.47it/s] 52%|█████▏    | 160862/308150 [00:03<00:02, 55772.71it/s] 54%|█████▍    | 166515/308150 [00:03<00:02, 54479.02it/s] 56%|█████▋    | 174066/308150 [00:03<00:02, 58796.75it/s] 58%|█████▊    | 179984/308150 [00:03<00:02, 52349.96it/s] 60%|██████    | 185355/308150 [00:03<00:02, 50298.93it/s] 62%|██████▏   | 190548/308150 [00:03<00:02, 50125.77it/s] 64%|██████▍   | 197382/308150 [00:04<00:02, 54065.78it/s] 66%|██████▌   | 203814/308150 [00:04<00:01, 56547.59it/s] 68%|██████▊   | 209844/308150 [00:04<00:01, 57167.31it/s] 70%|██████▉   | 215609/308150 [00:04<00:01, 54734.55it/s] 72%|███████▏  | 221502/308150 [00:04<00:01, 55778.44it/s] 74%|███████▎  | 227119/308150 [00:04<00:01, 52302.06it/s] 75%|███████▌  | 232410/308150 [00:04<00:01, 49015.07it/s] 77%|███████▋  | 237582/308150 [00:04<00:01, 48408.50it/s] 79%|███████▉  | 243612/308150 [00:04<00:01, 51245.64it/s] 81%|████████▏ | 250446/308150 [00:04<00:01, 55752.42it/s] 83%|████████▎ | 257181/308150 [00:05<00:00, 58997.19it/s] 86%|████████▌ | 263712/308150 [00:05<00:00, 60232.85it/s] 88%|████████▊ | 269783/308150 [00:05<00:00, 59934.62it/s] 90%|████████▉ | 276220/308150 [00:05<00:00, 61224.94it/s] 92%|█████████▏| 283812/308150 [00:05<00:00, 64944.93it/s] 94%|█████████▍| 290325/308150 [00:05<00:00, 64114.58it/s] 97%|█████████▋| 297480/308150 [00:05<00:00, 65894.15it/s] 99%|█████████▊| 304081/308150 [00:05<00:00, 64014.06it/s]100%|██████████| 308150/308150 [00:05<00:00, 52395.14it/s]
The spherical harmonics array is 271.54 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 58.74348258972168 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 24.302551956832154
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.0004, 'pow_max': 0.00045000000000000004, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 17.89it/s] 26%|██▋       | 5/19 [00:00<00:00, 19.68it/s] 42%|████▏     | 8/19 [00:00<00:00, 20.91it/s] 58%|█████▊    | 11/19 [00:00<00:00, 21.40it/s] 74%|███████▎  | 14/19 [00:00<00:00, 21.93it/s] 89%|████████▉ | 17/19 [00:00<00:00, 22.22it/s]100%|██████████| 19/19 [00:00<00:00, 21.67it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4307060 Minimum k_amp 0.00022499170162760515 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 0.5151770114898682 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07154532325994994
Ratio of unique |k|: 0.0019711821985298555
Time to get unique k and theta: 0.9808330535888672 seconds

Getting transfer functions
  0%|          | 0/8490 [00:00<?, ?it/s]  3%|▎         | 216/8490 [00:00<00:03, 2113.96it/s]  5%|▌         | 444/8490 [00:00<00:03, 2208.53it/s]  8%|▊         | 665/8490 [00:00<00:03, 2156.86it/s] 10%|█         | 888/8490 [00:00<00:03, 2139.51it/s] 13%|█▎        | 1104/8490 [00:00<00:03, 2117.98it/s] 16%|█▌        | 1320/8490 [00:00<00:03, 2127.43it/s] 18%|█▊        | 1533/8490 [00:00<00:03, 2087.89it/s] 21%|██        | 1752/8490 [00:00<00:03, 2099.94it/s] 23%|██▎       | 1980/8490 [00:00<00:03, 2138.42it/s] 26%|██▌       | 2208/8490 [00:01<00:02, 2155.54it/s] 30%|██▉       | 2508/8490 [00:01<00:02, 2395.67it/s] 33%|███▎      | 2796/8490 [00:01<00:02, 2513.59it/s] 36%|███▋      | 3096/8490 [00:01<00:02, 2629.79it/s] 40%|████      | 3408/8490 [00:01<00:01, 2743.70it/s] 44%|████▍     | 3732/8490 [00:01<00:01, 2879.69it/s] 48%|████▊     | 4044/8490 [00:01<00:01, 2940.52it/s] 51%|█████     | 4339/8490 [00:01<00:01, 2902.57it/s] 55%|█████▍    | 4630/8490 [00:01<00:01, 2881.22it/s] 59%|█████▊    | 4968/8490 [00:01<00:01, 2995.34it/s] 62%|██████▏   | 5280/8490 [00:02<00:01, 3022.08it/s] 66%|██████▌   | 5583/8490 [00:02<00:00, 3007.39it/s] 70%|██████▉   | 5928/8490 [00:02<00:00, 3128.84it/s] 74%|███████▎  | 6242/8490 [00:02<00:00, 3088.92it/s] 77%|███████▋  | 6576/8490 [00:02<00:00, 3130.38it/s] 81%|████████  | 6890/8490 [00:02<00:00, 3086.52it/s] 85%|████████▍ | 7200/8490 [00:02<00:00, 3070.10it/s] 88%|████████▊ | 7512/8490 [00:02<00:00, 3056.99it/s] 92%|█████████▏| 7818/8490 [00:02<00:00, 3050.59it/s] 96%|█████████▌| 8136/8490 [00:02<00:00, 3058.32it/s]100%|█████████▉| 8460/8490 [00:03<00:00, 3085.28it/s]100%|██████████| 8490/8490 [00:03<00:00, 2740.79it/s]
Size of transfer function: 1.36 MB. 

Size of integrand: 28.57 MB. Time to calculate integrand: 0.012712478637695312 s

Getting spherical harmonics
  0%|          | 0/308150 [00:00<?, ?it/s]  1%|▏         | 4070/308150 [00:00<00:07, 40695.77it/s]  3%|▎         | 8442/308150 [00:00<00:07, 40881.19it/s]  4%|▍         | 13266/308150 [00:00<00:07, 41524.79it/s]  6%|▌         | 17688/308150 [00:00<00:06, 42288.14it/s]  7%|▋         | 22512/308150 [00:00<00:06, 43701.00it/s]  9%|▊         | 26885/308150 [00:00<00:06, 41589.27it/s] 10%|█         | 31356/308150 [00:00<00:06, 41396.23it/s] 12%|█▏        | 36180/308150 [00:00<00:06, 43211.13it/s] 13%|█▎        | 40516/308150 [00:00<00:06, 39727.20it/s] 14%|█▍        | 44542/308150 [00:01<00:07, 36906.32it/s] 16%|█▌        | 49044/308150 [00:01<00:06, 38145.91it/s] 17%|█▋        | 53868/308150 [00:01<00:06, 39879.77it/s] 19%|█▉        | 58692/308150 [00:01<00:05, 42094.09it/s] 20%|██        | 63114/308150 [00:01<00:05, 41961.14it/s] 22%|██▏       | 67536/308150 [00:01<00:05, 42585.89it/s] 24%|██▎       | 72762/308150 [00:01<00:05, 44930.36it/s] 25%|██▌       | 77279/308150 [00:01<00:05, 39013.47it/s] 27%|██▋       | 82812/308150 [00:02<00:05, 42207.35it/s] 28%|██▊       | 87234/308150 [00:02<00:05, 41928.47it/s] 30%|███       | 92862/308150 [00:02<00:04, 45718.02it/s] 32%|███▏      | 97526/308150 [00:02<00:04, 43559.96it/s] 33%|███▎      | 101959/308150 [00:02<00:06, 33546.28it/s] 34%|███▍      | 105693/308150 [00:02<00:06, 31305.20it/s] 35%|███▌      | 109344/308150 [00:02<00:06, 32227.91it/s] 38%|███▊      | 115776/308150 [00:02<00:04, 39702.23it/s] 40%|███▉      | 122208/308150 [00:03<00:04, 45352.80it/s] 42%|████▏     | 129444/308150 [00:03<00:03, 52054.87it/s] 44%|████▍     | 134896/308150 [00:03<00:03, 51053.19it/s] 45%|████▌     | 140173/308150 [00:03<00:03, 48658.03it/s] 47%|████▋     | 145171/308150 [00:03<00:03, 47565.87it/s] 49%|████▉     | 150750/308150 [00:03<00:03, 49633.69it/s] 51%|█████     | 155976/308150 [00:03<00:03, 49896.36it/s] 52%|█████▏    | 161202/308150 [00:03<00:02, 49721.95it/s] 54%|█████▍    | 166428/308150 [00:03<00:02, 50062.69it/s] 56%|█████▌    | 171654/308150 [00:03<00:02, 50471.13it/s] 57%|█████▋    | 176880/308150 [00:04<00:02, 50167.66it/s] 59%|█████▉    | 181913/308150 [00:04<00:02, 50102.80it/s] 61%|██████    | 186934/308150 [00:04<00:02, 49135.83it/s] 62%|██████▏   | 192558/308150 [00:04<00:02, 49772.35it/s] 64%|██████▍   | 198588/308150 [00:04<00:02, 51756.24it/s] 66%|██████▋   | 204618/308150 [00:04<00:01, 52645.00it/s] 68%|██████▊   | 209882/308150 [00:04<00:01, 51390.03it/s] 70%|██████▉   | 215070/308150 [00:04<00:01, 50847.78it/s] 71%|███████▏  | 220296/308150 [00:04<00:01, 51186.12it/s] 73%|███████▎  | 225924/308150 [00:05<00:01, 52623.63it/s] 75%|███████▌  | 231192/308150 [00:05<00:01, 52045.65it/s] 77%|███████▋  | 236401/308150 [00:05<00:01, 47627.02it/s] 79%|███████▉  | 243057/308150 [00:05<00:01, 52860.99it/s] 81%|████████  | 248436/308150 [00:05<00:01, 49785.69it/s] 83%|████████▎ | 254466/308150 [00:05<00:01, 51661.28it/s] 85%|████████▍ | 261300/308150 [00:05<00:00, 55309.92it/s] 87%|████████▋ | 266893/308150 [00:05<00:00, 52317.73it/s] 88%|████████▊ | 272188/308150 [00:05<00:00, 46916.25it/s] 90%|████████▉ | 277003/308150 [00:06<00:00, 46950.95it/s] 92%|█████████▏| 282204/308150 [00:06<00:00, 47939.32it/s] 93%|█████████▎| 287832/308150 [00:06<00:00, 50208.11it/s] 95%|█████████▌| 293460/308150 [00:06<00:00, 51263.15it/s] 97%|█████████▋| 299088/308150 [00:06<00:00, 51649.47it/s] 99%|█████████▊| 304289/308150 [00:06<00:00, 48295.26it/s]100%|██████████| 308150/308150 [00:06<00:00, 46088.02it/s]
The spherical harmonics array is 271.54 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 69.05602049827576 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 24.616251955652846
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.0005, 'pow_max': 0.00055, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 16%|█▌        | 3/19 [00:00<00:00, 20.63it/s] 32%|███▏      | 6/19 [00:00<00:00, 21.77it/s] 47%|████▋     | 9/19 [00:00<00:00, 22.46it/s] 63%|██████▎   | 12/19 [00:00<00:00, 22.63it/s] 79%|███████▉  | 15/19 [00:00<00:00, 22.90it/s] 95%|█████████▍| 18/19 [00:00<00:00, 23.08it/s]100%|██████████| 19/19 [00:00<00:00, 22.70it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4307060 Minimum k_amp 0.00022499170162760515 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 0.5266375541687012 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07154532325994994
Ratio of unique |k|: 0.0019711821985298555
Time to get unique k and theta: 1.0098655223846436 seconds

Getting transfer functions
  0%|          | 0/8490 [00:00<?, ?it/s]  2%|▏         | 180/8490 [00:00<00:04, 1799.74it/s]  4%|▍         | 360/8490 [00:00<00:04, 1768.42it/s]  6%|▋         | 540/8490 [00:00<00:04, 1767.47it/s]  9%|▉         | 756/8490 [00:00<00:04, 1887.80it/s] 11%|█▏        | 960/8490 [00:00<00:03, 1925.15it/s] 14%|█▎        | 1153/8490 [00:00<00:03, 1890.32it/s] 16%|█▌        | 1344/8490 [00:00<00:03, 1871.43it/s] 18%|█▊        | 1536/8490 [00:00<00:03, 1872.34it/s] 20%|██        | 1728/8490 [00:00<00:03, 1864.62it/s] 23%|██▎       | 1944/8490 [00:01<00:03, 1940.89it/s] 25%|██▌       | 2139/8490 [00:01<00:03, 1914.82it/s] 28%|██▊       | 2364/8490 [00:01<00:03, 2001.44it/s] 31%|███       | 2652/8490 [00:01<00:02, 2249.62it/s] 35%|███▍      | 2964/8490 [00:01<00:02, 2504.01it/s] 39%|███▊      | 3288/8490 [00:01<00:01, 2690.58it/s] 42%|████▏     | 3564/8490 [00:01<00:01, 2698.49it/s] 46%|████▌     | 3864/8490 [00:01<00:01, 2771.35it/s] 49%|████▉     | 4164/8490 [00:01<00:01, 2821.27it/s] 53%|█████▎    | 4476/8490 [00:01<00:01, 2885.21it/s] 56%|█████▋    | 4776/8490 [00:02<00:01, 2893.91it/s] 60%|█████▉    | 5076/8490 [00:02<00:01, 2899.07it/s] 64%|██████▎   | 5400/8490 [00:02<00:01, 2983.72it/s] 67%|██████▋   | 5700/8490 [00:02<00:00, 2972.20it/s] 71%|███████   | 6012/8490 [00:02<00:00, 2975.25it/s] 75%|███████▍  | 6336/8490 [00:02<00:00, 3027.76it/s] 78%|███████▊  | 6639/8490 [00:02<00:00, 3021.68it/s] 82%|████████▏ | 6948/8490 [00:02<00:00, 3010.90it/s] 85%|████████▌ | 7250/8490 [00:02<00:00, 2945.43it/s] 89%|████████▉ | 7578/8490 [00:02<00:00, 3042.84it/s] 93%|█████████▎| 7883/8490 [00:03<00:00, 2993.95it/s] 97%|█████████▋| 8196/8490 [00:03<00:00, 3011.03it/s]100%|██████████| 8490/8490 [00:03<00:00, 2587.11it/s]
Size of transfer function: 1.36 MB. 

Size of integrand: 28.57 MB. Time to calculate integrand: 0.02127861976623535 s

Getting spherical harmonics
  0%|          | 0/308150 [00:00<?, ?it/s]  1%|▏         | 4020/308150 [00:00<00:08, 36836.27it/s]  3%|▎         | 8442/308150 [00:00<00:07, 39725.91it/s]  4%|▍         | 12419/308150 [00:00<00:07, 37987.57it/s]  5%|▌         | 16223/308150 [00:00<00:08, 36301.36it/s]  7%|▋         | 20100/308150 [00:00<00:07, 37100.37it/s]  8%|▊         | 24120/308150 [00:00<00:07, 37885.84it/s]  9%|▉         | 28542/308150 [00:00<00:07, 39065.35it/s] 11%|█         | 32454/308150 [00:00<00:07, 38735.64it/s] 12%|█▏        | 36984/308150 [00:00<00:06, 39973.12it/s] 13%|█▎        | 41406/308150 [00:01<00:06, 40618.03it/s] 15%|█▍        | 45469/308150 [00:01<00:06, 38333.15it/s] 16%|█▌        | 49848/308150 [00:01<00:06, 39660.63it/s] 18%|█▊        | 55074/308150 [00:01<00:06, 41255.68it/s] 19%|█▉        | 59496/308150 [00:01<00:05, 41897.66it/s] 21%|██        | 63694/308150 [00:01<00:05, 41897.36it/s] 22%|██▏       | 67938/308150 [00:01<00:05, 41876.79it/s] 23%|██▎       | 72130/308150 [00:01<00:05, 41619.13it/s] 25%|██▍       | 76295/308150 [00:01<00:05, 41465.47it/s] 26%|██▌       | 80802/308150 [00:02<00:05, 42236.17it/s] 28%|██▊       | 86265/308150 [00:02<00:04, 45885.04it/s] 30%|██▉       | 91254/308150 [00:02<00:04, 46629.42it/s] 31%|███       | 95922/308150 [00:02<00:04, 44960.62it/s] 33%|███▎      | 100902/308150 [00:02<00:04, 45475.22it/s] 35%|███▍      | 106530/308150 [00:02<00:04, 48078.45it/s] 36%|███▋      | 111756/308150 [00:02<00:03, 49113.34it/s] 38%|███▊      | 118188/308150 [00:02<00:03, 50298.89it/s] 40%|███▉      | 123213/308150 [00:02<00:03, 48354.83it/s] 42%|████▏     | 128640/308150 [00:02<00:03, 49730.80it/s] 43%|████▎     | 133623/308150 [00:03<00:03, 48766.18it/s] 45%|████▍     | 138506/308150 [00:03<00:03, 47374.12it/s] 47%|████▋     | 144318/308150 [00:03<00:03, 49962.41it/s] 49%|████▊     | 149917/308150 [00:03<00:03, 51684.37it/s] 50%|█████     | 155172/308150 [00:03<00:02, 51754.50it/s] 52%|█████▏    | 160361/308150 [00:03<00:02, 50901.46it/s] 54%|█████▎    | 165462/308150 [00:03<00:02, 48542.40it/s] 55%|█████▌    | 170448/308150 [00:03<00:02, 47828.65it/s] 57%|█████▋    | 176478/308150 [00:03<00:02, 50897.28it/s] 59%|█████▉    | 181704/308150 [00:04<00:02, 50842.09it/s] 61%|██████    | 186804/308150 [00:04<00:02, 47446.14it/s] 62%|██████▏   | 191597/308150 [00:04<00:02, 47008.14it/s] 64%|██████▍   | 196980/308150 [00:04<00:02, 47378.98it/s] 66%|██████▌   | 203412/308150 [00:04<00:02, 51306.35it/s] 68%|██████▊   | 209844/308150 [00:04<00:01, 53918.13it/s] 70%|██████▉   | 215258/308150 [00:04<00:01, 51047.87it/s] 72%|███████▏  | 220698/308150 [00:04<00:01, 51030.28it/s] 73%|███████▎  | 225826/308150 [00:04<00:01, 51042.76it/s] 75%|███████▌  | 231150/308150 [00:05<00:01, 50393.64it/s] 77%|███████▋  | 237582/308150 [00:05<00:01, 54190.63it/s] 79%|███████▉  | 243028/308150 [00:05<00:01, 53347.43it/s] 81%|████████  | 248436/308150 [00:05<00:01, 53169.07it/s] 82%|████████▏ | 253766/308150 [00:05<00:01, 52956.17it/s] 84%|████████▍ | 259071/308150 [00:05<00:00, 49785.61it/s] 86%|████████▌ | 264516/308150 [00:05<00:00, 50739.56it/s] 88%|████████▊ | 270144/308150 [00:05<00:00, 51486.06it/s] 89%|████████▉ | 275772/308150 [00:05<00:00, 51554.53it/s] 91%|█████████ | 280944/308150 [00:05<00:00, 51539.74it/s] 93%|█████████▎| 286110/308150 [00:06<00:00, 50039.33it/s] 95%|█████████▍| 291852/308150 [00:06<00:00, 51647.07it/s] 96%|█████████▋| 297030/308150 [00:06<00:00, 50756.89it/s] 98%|█████████▊| 302115/308150 [00:06<00:00, 47437.40it/s]100%|█████████▉| 307530/308150 [00:06<00:00, 49045.01it/s]100%|██████████| 308150/308150 [00:06<00:00, 47117.65it/s]
The spherical harmonics array is 271.54 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 75.36375379562378 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 24.80352764686316
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.0006, 'pow_max': 0.00065, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 16%|█▌        | 3/19 [00:00<00:00, 22.03it/s] 32%|███▏      | 6/19 [00:00<00:00, 21.97it/s] 47%|████▋     | 9/19 [00:00<00:00, 22.58it/s] 63%|██████▎   | 12/19 [00:00<00:00, 22.89it/s] 79%|███████▉  | 15/19 [00:00<00:00, 22.62it/s] 95%|█████████▍| 18/19 [00:00<00:00, 22.87it/s]100%|██████████| 19/19 [00:00<00:00, 22.71it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4307060 Minimum k_amp 0.00022499170162760515 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 0.5392305850982666 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07154532325994994
Ratio of unique |k|: 0.0019711821985298555
Time to get unique k and theta: 1.0091464519500732 seconds

Getting transfer functions
  0%|          | 0/8490 [00:00<?, ?it/s]  2%|▏         | 180/8490 [00:00<00:04, 1778.98it/s]  5%|▍         | 396/8490 [00:00<00:04, 1944.85it/s]  7%|▋         | 624/8490 [00:00<00:03, 2071.56it/s] 10%|▉         | 832/8490 [00:00<00:03, 2027.06it/s] 13%|█▎        | 1068/8490 [00:00<00:03, 2113.43it/s] 15%|█▌        | 1308/8490 [00:00<00:03, 2175.87it/s] 18%|█▊        | 1548/8490 [00:00<00:03, 2207.70it/s] 21%|██        | 1769/8490 [00:00<00:03, 2122.18it/s] 23%|██▎       | 1982/8490 [00:00<00:03, 2111.32it/s] 26%|██▌       | 2194/8490 [00:01<00:03, 2087.76it/s] 29%|██▊       | 2436/8490 [00:01<00:02, 2179.67it/s] 32%|███▏      | 2724/8490 [00:01<00:02, 2383.09it/s] 35%|███▌      | 3012/8490 [00:01<00:02, 2509.95it/s] 39%|███▉      | 3300/8490 [00:01<00:01, 2615.78it/s] 42%|████▏     | 3564/8490 [00:01<00:01, 2611.90it/s] 45%|████▌     | 3852/8490 [00:01<00:01, 2679.12it/s] 49%|████▉     | 4164/8490 [00:01<00:01, 2806.30it/s] 52%|█████▏    | 4452/8490 [00:01<00:01, 2810.62it/s] 56%|█████▌    | 4734/8490 [00:01<00:01, 2786.06it/s] 59%|█████▉    | 5013/8490 [00:02<00:01, 2767.50it/s] 62%|██████▏   | 5290/8490 [00:02<00:01, 2732.24it/s] 66%|██████▌   | 5580/8490 [00:02<00:01, 2753.64it/s] 69%|██████▉   | 5856/8490 [00:02<00:00, 2739.13it/s] 72%|███████▏  | 6152/8490 [00:02<00:00, 2804.09it/s] 76%|███████▌  | 6433/8490 [00:02<00:00, 2798.43it/s] 79%|███████▉  | 6713/8490 [00:02<00:00, 2795.01it/s] 83%|████████▎ | 7008/8490 [00:02<00:00, 2839.45it/s] 86%|████████▌ | 7320/8490 [00:02<00:00, 2894.58it/s] 90%|████████▉ | 7610/8490 [00:02<00:00, 2852.16it/s] 93%|█████████▎| 7908/8490 [00:03<00:00, 2863.21it/s] 97%|█████████▋| 8195/8490 [00:03<00:00, 2801.23it/s]100%|█████████▉| 8476/8490 [00:03<00:00, 2764.50it/s]100%|██████████| 8490/8490 [00:03<00:00, 2562.65it/s]
Size of transfer function: 1.36 MB. 

Size of integrand: 28.57 MB. Time to calculate integrand: 0.018913745880126953 s

Getting spherical harmonics
  0%|          | 0/308150 [00:00<?, ?it/s]  2%|▏         | 5226/308150 [00:00<00:06, 49086.95it/s]  3%|▎         | 10135/308150 [00:00<00:06, 42725.46it/s]  5%|▍         | 14449/308150 [00:00<00:06, 42757.47it/s]  6%|▌         | 18748/308150 [00:00<00:06, 41948.91it/s]  7%|▋         | 22955/308150 [00:00<00:06, 41015.72it/s]  9%|▉         | 27336/308150 [00:00<00:06, 40895.24it/s] 10%|█         | 31430/308150 [00:00<00:07, 38024.61it/s] 11%|█▏        | 35376/308150 [00:00<00:07, 38345.60it/s] 13%|█▎        | 39396/308150 [00:00<00:07, 38264.70it/s] 14%|█▍        | 43416/308150 [00:01<00:06, 38531.37it/s] 15%|█▌        | 47436/308150 [00:01<00:07, 36727.98it/s] 17%|█▋        | 51133/308150 [00:01<00:09, 26675.23it/s] 18%|█▊        | 54185/308150 [00:01<00:11, 21639.05it/s] 18%|█▊        | 56732/308150 [00:01<00:13, 18161.47it/s] 19%|█▉        | 58867/308150 [00:02<00:14, 17358.49it/s] 20%|█▉        | 60809/308150 [00:02<00:15, 16247.37it/s] 20%|██        | 62565/308150 [00:02<00:15, 16142.97it/s] 21%|██        | 64320/308150 [00:02<00:15, 15812.11it/s] 22%|██▏       | 66330/308150 [00:02<00:15, 15954.42it/s] 22%|██▏       | 67966/308150 [00:02<00:15, 15723.15it/s] 23%|██▎       | 69563/308150 [00:02<00:15, 15228.64it/s] 23%|██▎       | 71154/308150 [00:02<00:15, 14850.46it/s] 24%|██▎       | 72762/308150 [00:03<00:17, 13595.04it/s] 24%|██▍       | 74370/308150 [00:03<00:18, 12811.54it/s] 25%|██▍       | 75978/308150 [00:03<00:17, 13283.93it/s] 26%|██▌       | 79194/308150 [00:03<00:12, 18036.45it/s] 28%|██▊       | 86430/308150 [00:03<00:06, 32370.41it/s] 30%|██▉       | 92058/308150 [00:03<00:05, 38443.06it/s] 31%|███       | 96102/308150 [00:03<00:05, 37558.82it/s] 32%|███▏      | 100000/308150 [00:03<00:07, 28409.70it/s] 34%|███▎      | 103257/308150 [00:04<00:08, 25201.37it/s] 34%|███▍      | 106105/308150 [00:04<00:09, 21526.55it/s] 35%|███▌      | 108541/308150 [00:04<00:10, 18342.21it/s] 36%|███▌      | 111354/308150 [00:04<00:09, 19983.16it/s] 38%|███▊      | 116580/308150 [00:04<00:07, 26794.05it/s] 40%|███▉      | 121806/308150 [00:04<00:05, 32616.83it/s] 41%|████▏     | 127434/308150 [00:04<00:04, 36383.97it/s] 43%|████▎     | 132258/308150 [00:05<00:04, 38858.50it/s] 45%|████▌     | 138690/308150 [00:05<00:03, 44679.42it/s] 47%|████▋     | 143514/308150 [00:05<00:03, 45481.24it/s] 48%|████▊     | 148740/308150 [00:05<00:03, 47266.05it/s] 50%|████▉     | 153966/308150 [00:05<00:03, 48384.60it/s] 52%|█████▏    | 159594/308150 [00:05<00:02, 49808.07it/s] 53%|█████▎    | 164820/308150 [00:05<00:02, 49820.51it/s] 55%|█████▌    | 169850/308150 [00:05<00:02, 47871.35it/s] 57%|█████▋    | 174870/308150 [00:05<00:02, 45624.65it/s] 58%|█████▊    | 180096/308150 [00:05<00:02, 47085.61it/s] 60%|██████    | 185724/308150 [00:06<00:02, 49153.43it/s] 62%|██████▏   | 190679/308150 [00:06<00:02, 48282.98it/s] 63%|██████▎   | 195535/308150 [00:06<00:03, 34659.09it/s] 65%|██████▍   | 199544/308150 [00:06<00:03, 30332.60it/s] 66%|██████▌   | 203014/308150 [00:06<00:03, 29140.70it/s] 67%|██████▋   | 206628/308150 [00:06<00:03, 29672.21it/s] 68%|██████▊   | 209811/308150 [00:07<00:04, 24145.86it/s] 69%|██████▉   | 212501/308150 [00:07<00:04, 20600.30it/s] 70%|██████▉   | 214799/308150 [00:07<00:04, 19607.02it/s] 70%|███████   | 216910/308150 [00:07<00:04, 18702.20it/s] 71%|███████   | 218871/308150 [00:07<00:05, 17509.91it/s] 72%|███████▏  | 222708/308150 [00:07<00:03, 21833.02it/s] 74%|███████▍  | 227934/308150 [00:07<00:02, 29010.57it/s] 76%|███████▌  | 233964/308150 [00:07<00:02, 36649.77it/s] 77%|███████▋  | 238367/308150 [00:08<00:01, 38601.49it/s] 79%|███████▉  | 242808/308150 [00:08<00:01, 39978.88it/s] 80%|████████  | 247632/308150 [00:08<00:01, 40162.63it/s] 82%|████████▏ | 251770/308150 [00:08<00:01, 40251.02it/s] 83%|████████▎ | 256878/308150 [00:08<00:01, 43104.94it/s] 85%|████████▍ | 261300/308150 [00:08<00:01, 43299.66it/s] 86%|████████▋ | 266526/308150 [00:08<00:00, 45178.71it/s] 88%|████████▊ | 271752/308150 [00:08<00:00, 47093.38it/s] 90%|████████▉ | 276978/308150 [00:08<00:00, 48298.35it/s] 91%|█████████▏| 281832/308150 [00:09<00:00, 47421.93it/s] 93%|█████████▎| 287832/308150 [00:09<00:00, 49984.93it/s] 95%|█████████▌| 292839/308150 [00:09<00:00, 49590.79it/s] 97%|█████████▋| 297803/308150 [00:09<00:00, 48772.42it/s] 98%|█████████▊| 303510/308150 [00:09<00:00, 50198.47it/s]100%|██████████| 308150/308150 [00:09<00:00, 32421.92it/s]
The spherical harmonics array is 271.54 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 78.69323563575745 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 24.989860946926516
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.0007, 'pow_max': 0.00075, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 16%|█▌        | 3/19 [00:00<00:00, 22.73it/s] 32%|███▏      | 6/19 [00:00<00:00, 23.09it/s] 47%|████▋     | 9/19 [00:00<00:00, 23.23it/s] 63%|██████▎   | 12/19 [00:00<00:00, 23.30it/s] 79%|███████▉  | 15/19 [00:00<00:00, 23.35it/s] 95%|█████████▍| 18/19 [00:00<00:00, 23.38it/s]100%|██████████| 19/19 [00:00<00:00, 23.29it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4307060 Minimum k_amp 0.00022499170162760515 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 0.5202767848968506 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07154532325994994
Ratio of unique |k|: 0.0019711821985298555
Time to get unique k and theta: 0.9869663715362549 seconds

Getting transfer functions
  0%|          | 0/8490 [00:00<?, ?it/s]  2%|▏         | 204/8490 [00:00<00:04, 1899.02it/s]  5%|▍         | 394/8490 [00:00<00:04, 1847.06it/s]  7%|▋         | 579/8490 [00:00<00:04, 1793.91it/s]  9%|▉         | 768/8490 [00:00<00:04, 1828.98it/s] 12%|█▏        | 984/8490 [00:00<00:03, 1913.28it/s] 14%|█▍        | 1176/8490 [00:00<00:03, 1869.53it/s] 16%|█▋        | 1392/8490 [00:00<00:03, 1926.32it/s] 19%|█▉        | 1596/8490 [00:00<00:03, 1942.19it/s] 21%|██        | 1800/8490 [00:00<00:03, 1947.90it/s] 24%|██▎       | 2016/8490 [00:01<00:03, 1997.51it/s] 26%|██▋       | 2232/8490 [00:01<00:03, 2041.81it/s] 29%|██▉       | 2484/8490 [00:01<00:02, 2163.56it/s] 33%|███▎      | 2844/8490 [00:01<00:02, 2579.61it/s] 37%|███▋      | 3156/8490 [00:01<00:01, 2726.46it/s] 41%|████      | 3480/8490 [00:01<00:01, 2858.60it/s] 45%|████▍     | 3780/8490 [00:01<00:01, 2888.83it/s] 48%|████▊     | 4070/8490 [00:01<00:01, 2885.67it/s] 51%|█████▏    | 4368/8490 [00:01<00:01, 2875.65it/s] 55%|█████▌    | 4704/8490 [00:01<00:01, 2996.50it/s] 59%|█████▉    | 5028/8490 [00:02<00:01, 3039.37it/s] 63%|██████▎   | 5340/8490 [00:02<00:01, 3037.90it/s] 67%|██████▋   | 5664/8490 [00:02<00:00, 3057.22it/s] 71%|███████   | 6012/8490 [00:02<00:00, 3151.10it/s] 75%|███████▍  | 6328/8490 [00:02<00:00, 3038.92it/s] 78%|███████▊  | 6660/8490 [00:02<00:00, 3110.78it/s] 82%|████████▏ | 6972/8490 [00:02<00:00, 3033.75it/s] 86%|████████▌ | 7296/8490 [00:02<00:00, 3084.50it/s] 90%|████████▉ | 7608/8490 [00:02<00:00, 3068.93it/s] 94%|█████████▎| 7956/8490 [00:03<00:00, 3178.24it/s] 97%|█████████▋| 8275/8490 [00:03<00:00, 3150.27it/s]100%|██████████| 8490/8490 [00:03<00:00, 2668.43it/s]
Size of transfer function: 1.36 MB. 

Size of integrand: 28.57 MB. Time to calculate integrand: 0.017207622528076172 s

Getting spherical harmonics
  0%|          | 0/308150 [00:00<?, ?it/s]  2%|▏         | 4824/308150 [00:00<00:06, 47334.50it/s]  3%|▎         | 10050/308150 [00:00<00:05, 49684.29it/s]  5%|▍         | 15019/308150 [00:00<00:06, 48573.95it/s]  6%|▋         | 19879/308150 [00:00<00:06, 44882.98it/s]  8%|▊         | 24402/308150 [00:00<00:06, 43579.74it/s] 10%|▉         | 29346/308150 [00:00<00:06, 44856.23it/s] 11%|█         | 33851/308150 [00:00<00:06, 44883.54it/s] 13%|█▎        | 38592/308150 [00:00<00:06, 44695.40it/s] 14%|█▍        | 43818/308150 [00:00<00:05, 46605.24it/s] 16%|█▌        | 48490/308150 [00:01<00:05, 46306.65it/s] 17%|█▋        | 53128/308150 [00:01<00:05, 45461.00it/s] 19%|█▉        | 58149/308150 [00:01<00:05, 46857.17it/s] 20%|██        | 62844/308150 [00:01<00:05, 43110.61it/s] 22%|██▏       | 67938/308150 [00:01<00:05, 44710.42it/s] 24%|██▎       | 72762/308150 [00:01<00:05, 44963.83it/s] 25%|██▌       | 77586/308150 [00:01<00:05, 45768.51it/s] 27%|██▋       | 83616/308150 [00:01<00:04, 49437.91it/s] 29%|██▊       | 88586/308150 [00:01<00:04, 48425.31it/s] 30%|███       | 93666/308150 [00:02<00:04, 48807.43it/s] 32%|███▏      | 99294/308150 [00:02<00:04, 49930.96it/s] 34%|███▍      | 105726/308150 [00:02<00:03, 53129.95it/s] 36%|███▌      | 111044/308150 [00:02<00:03, 51812.70it/s] 38%|███▊      | 116232/308150 [00:02<00:03, 47993.93it/s] 40%|███▉      | 122208/308150 [00:02<00:03, 50113.77it/s] 41%|████▏     | 127836/308150 [00:02<00:03, 51517.90it/s] 43%|████▎     | 133026/308150 [00:02<00:03, 51047.48it/s] 45%|████▍     | 138156/308150 [00:02<00:03, 47658.46it/s] 46%|████▋     | 142974/308150 [00:03<00:03, 47433.50it/s] 48%|████▊     | 147936/308150 [00:03<00:03, 47254.60it/s] 50%|████▉     | 152760/308150 [00:03<00:03, 47379.89it/s] 51%|█████     | 157584/308150 [00:03<00:03, 45850.17it/s] 53%|█████▎    | 162810/308150 [00:03<00:03, 46721.07it/s] 54%|█████▍    | 167634/308150 [00:03<00:02, 47146.14it/s] 56%|█████▌    | 173262/308150 [00:03<00:02, 48470.81it/s] 58%|█████▊    | 178115/308150 [00:03<00:02, 47700.34it/s] 60%|█████▉    | 184116/308150 [00:03<00:02, 50850.62it/s] 62%|██████▏   | 190146/308150 [00:03<00:02, 53110.28it/s] 64%|██████▍   | 196578/308150 [00:04<00:01, 55834.74it/s] 66%|██████▌   | 202172/308150 [00:04<00:01, 53071.93it/s] 68%|██████▊   | 209442/308150 [00:04<00:01, 58017.54it/s] 70%|██████▉   | 215472/308150 [00:04<00:01, 58257.24it/s] 72%|███████▏  | 221324/308150 [00:04<00:01, 57979.19it/s] 74%|███████▎  | 227140/308150 [00:04<00:01, 56197.89it/s] 76%|███████▌  | 232780/308150 [00:04<00:01, 52968.51it/s] 77%|███████▋  | 238386/308150 [00:04<00:01, 52903.05it/s] 79%|███████▉  | 243706/308150 [00:04<00:01, 50434.05it/s] 81%|████████  | 250044/308150 [00:05<00:01, 53328.96it/s] 83%|████████▎ | 255415/308150 [00:05<00:01, 50939.55it/s] 85%|████████▍ | 260546/308150 [00:05<00:01, 47085.80it/s] 86%|████████▋ | 266124/308150 [00:05<00:00, 49356.63it/s] 88%|████████▊ | 271350/308150 [00:05<00:00, 49294.12it/s] 90%|████████▉ | 276576/308150 [00:05<00:00, 49216.31it/s] 91%|█████████▏| 281533/308150 [00:05<00:00, 47189.47it/s] 93%|█████████▎| 286285/308150 [00:05<00:00, 45262.64it/s] 95%|█████████▍| 292254/308150 [00:05<00:00, 49184.12it/s] 97%|█████████▋| 297882/308150 [00:06<00:00, 50241.19it/s] 98%|█████████▊| 303510/308150 [00:06<00:00, 51434.53it/s]100%|██████████| 308150/308150 [00:06<00:00, 49114.02it/s]
The spherical harmonics array is 271.54 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 73.7980945110321 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 25.133581815549014
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.0008, 'pow_max': 0.0008500000000000001, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 15.61it/s] 21%|██        | 4/19 [00:00<00:00, 17.25it/s] 32%|███▏      | 6/19 [00:00<00:00, 18.28it/s] 47%|████▋     | 9/19 [00:00<00:00, 19.54it/s] 63%|██████▎   | 12/19 [00:00<00:00, 20.80it/s] 79%|███████▉  | 15/19 [00:00<00:00, 21.68it/s] 95%|█████████▍| 18/19 [00:00<00:00, 22.21it/s]100%|██████████| 19/19 [00:00<00:00, 20.85it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4307060 Minimum k_amp 0.00022499170162760515 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 0.5258467197418213 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07154532325994994
Ratio of unique |k|: 0.0019711821985298555
Time to get unique k and theta: 0.9971754550933838 seconds

Getting transfer functions
  0%|          | 0/8490 [00:00<?, ?it/s]  2%|▏         | 168/8490 [00:00<00:05, 1595.89it/s]  5%|▍         | 396/8490 [00:00<00:04, 1982.34it/s]  7%|▋         | 600/8490 [00:00<00:03, 2003.17it/s]  9%|▉         | 804/8490 [00:00<00:03, 1993.83it/s] 12%|█▏        | 1008/8490 [00:00<00:03, 1973.04it/s] 15%|█▍        | 1248/8490 [00:00<00:03, 2091.67it/s] 17%|█▋        | 1464/8490 [00:00<00:03, 2099.75it/s] 20%|█▉        | 1675/8490 [00:00<00:03, 2088.72it/s] 22%|██▏       | 1884/8490 [00:00<00:03, 2063.75it/s] 25%|██▍       | 2091/8490 [00:01<00:03, 2060.68it/s] 27%|██▋       | 2304/8490 [00:01<00:03, 2050.96it/s] 31%|███       | 2640/8490 [00:01<00:02, 2417.32it/s] 35%|███▌      | 3012/8490 [00:01<00:01, 2793.38it/s] 39%|███▉      | 3348/8490 [00:01<00:01, 2916.36it/s] 43%|████▎     | 3648/8490 [00:01<00:01, 2920.06it/s] 46%|████▋     | 3941/8490 [00:01<00:01, 2895.95it/s] 50%|████▉     | 4236/8490 [00:01<00:01, 2898.32it/s] 53%|█████▎    | 4526/8490 [00:01<00:01, 2894.11it/s] 57%|█████▋    | 4848/8490 [00:01<00:01, 2979.65it/s] 61%|██████    | 5172/8490 [00:02<00:01, 3027.92it/s] 65%|██████▌   | 5544/8490 [00:02<00:00, 3207.52it/s] 69%|██████▉   | 5868/8490 [00:02<00:00, 3201.15it/s] 73%|███████▎  | 6189/8490 [00:02<00:00, 3120.16it/s] 77%|███████▋  | 6502/8490 [00:02<00:00, 3058.30it/s] 80%|████████  | 6809/8490 [00:02<00:00, 2987.91it/s] 85%|████████▍ | 7176/8490 [00:02<00:00, 3166.87it/s] 88%|████████▊ | 7494/8490 [00:02<00:00, 3136.14it/s] 92%|█████████▏| 7809/8490 [00:02<00:00, 3111.14it/s] 96%|█████████▌| 8124/8490 [00:02<00:00, 3079.80it/s] 99%|█████████▉| 8433/8490 [00:03<00:00, 3036.49it/s]100%|██████████| 8490/8490 [00:03<00:00, 2718.10it/s]
Size of transfer function: 1.36 MB. 

Size of integrand: 28.57 MB. Time to calculate integrand: 0.014297723770141602 s

Getting spherical harmonics
  0%|          | 0/308150 [00:00<?, ?it/s]  2%|▏         | 5628/308150 [00:00<00:05, 52475.30it/s]  4%|▎         | 11256/308150 [00:00<00:05, 52846.40it/s]  5%|▌         | 16541/308150 [00:00<00:06, 48183.54it/s]  7%|▋         | 21392/308150 [00:00<00:07, 40662.15it/s]  9%|▊         | 26532/308150 [00:00<00:06, 41893.12it/s] 10%|█         | 30816/308150 [00:00<00:06, 41219.54it/s] 11%|█▏        | 34994/308150 [00:00<00:06, 40197.66it/s] 13%|█▎        | 39396/308150 [00:00<00:06, 40831.51it/s] 14%|█▍        | 43506/308150 [00:01<00:07, 35729.37it/s] 15%|█▌        | 47187/308150 [00:01<00:10, 25509.02it/s] 17%|█▋        | 51858/308150 [00:01<00:08, 29722.56it/s] 18%|█▊        | 55878/308150 [00:01<00:07, 31820.72it/s] 19%|█▉        | 59448/308150 [00:01<00:08, 29537.82it/s] 20%|██        | 62685/308150 [00:01<00:09, 24702.14it/s] 21%|██        | 65451/308150 [00:02<00:12, 20016.96it/s] 22%|██▏       | 67760/308150 [00:02<00:12, 19343.59it/s] 23%|██▎       | 72360/308150 [00:02<00:09, 24617.49it/s] 25%|██▌       | 77184/308150 [00:02<00:07, 29821.46it/s] 27%|██▋       | 82812/308150 [00:02<00:06, 35951.32it/s] 28%|██▊       | 87636/308150 [00:02<00:05, 38965.51it/s] 30%|██▉       | 91850/308150 [00:02<00:05, 37624.18it/s] 31%|███       | 95838/308150 [00:02<00:05, 38178.34it/s] 33%|███▎      | 101304/308150 [00:02<00:04, 41650.25it/s] 35%|███▍      | 106530/308150 [00:03<00:04, 43229.51it/s] 36%|███▌      | 110941/308150 [00:03<00:05, 37985.25it/s] 38%|███▊      | 115776/308150 [00:03<00:04, 40619.15it/s] 39%|███▉      | 120198/308150 [00:03<00:04, 41386.15it/s] 40%|████      | 124453/308150 [00:03<00:05, 32730.09it/s] 42%|████▏     | 128072/308150 [00:03<00:07, 24788.41it/s] 43%|████▎     | 131041/308150 [00:04<00:08, 20669.09it/s] 44%|████▍     | 135876/308150 [00:04<00:06, 25659.72it/s] 46%|████▌     | 140849/308150 [00:04<00:05, 30691.81it/s] 47%|████▋     | 144536/308150 [00:04<00:05, 27559.01it/s] 49%|████▊     | 149544/308150 [00:04<00:04, 32432.00it/s] 50%|█████     | 154770/308150 [00:04<00:04, 36987.82it/s] 52%|█████▏    | 161202/308150 [00:04<00:03, 43510.19it/s] 54%|█████▍    | 166830/308150 [00:04<00:03, 46451.23it/s] 56%|█████▌    | 172056/308150 [00:05<00:02, 47268.28it/s] 58%|█████▊    | 177282/308150 [00:05<00:02, 48520.67it/s] 59%|█████▉    | 182307/308150 [00:05<00:02, 46235.58it/s] 61%|██████    | 188112/308150 [00:05<00:02, 49493.85it/s] 63%|██████▎   | 193187/308150 [00:05<00:02, 46453.14it/s] 64%|██████▍   | 198588/308150 [00:05<00:02, 47614.97it/s] 66%|██████▋   | 204216/308150 [00:05<00:02, 48498.46it/s] 68%|██████▊   | 209844/308150 [00:05<00:01, 50438.84it/s] 70%|██████▉   | 215472/308150 [00:05<00:01, 50999.23it/s] 72%|███████▏  | 220698/308150 [00:05<00:01, 50999.27it/s] 73%|███████▎  | 226326/308150 [00:06<00:01, 52232.49it/s] 75%|███████▌  | 231573/308150 [00:06<00:01, 51622.72it/s] 77%|███████▋  | 237582/308150 [00:06<00:01, 53214.62it/s] 79%|███████▉  | 244416/308150 [00:06<00:01, 56589.14it/s] 81%|████████▏ | 250446/308150 [00:06<00:01, 56507.18it/s] 83%|████████▎ | 256101/308150 [00:06<00:01, 37709.35it/s] 85%|████████▍ | 260681/308150 [00:07<00:01, 28393.53it/s] 86%|████████▌ | 264376/308150 [00:07<00:01, 24169.61it/s] 87%|████████▋ | 267441/308150 [00:07<00:01, 24491.26it/s] 88%|████████▊ | 272556/308150 [00:07<00:01, 29400.15it/s] 90%|█████████ | 278586/308150 [00:07<00:00, 34914.00it/s] 92%|█████████▏| 283812/308150 [00:07<00:00, 38428.14it/s] 94%|█████████▎| 288127/308150 [00:07<00:00, 39434.43it/s] 95%|█████████▍| 292656/308150 [00:07<00:00, 40375.55it/s] 97%|█████████▋| 299490/308150 [00:08<00:00, 47243.42it/s] 99%|█████████▉| 304716/308150 [00:08<00:00, 48102.41it/s]100%|██████████| 308150/308150 [00:08<00:00, 37531.12it/s]
The spherical harmonics array is 271.54 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 73.62240815162659 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 25.062625617648834
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.0009, 'pow_max': 0.00095, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 14.09it/s] 21%|██        | 4/19 [00:00<00:00, 15.95it/s] 32%|███▏      | 6/19 [00:00<00:00, 17.21it/s] 47%|████▋     | 9/19 [00:00<00:00, 18.77it/s] 63%|██████▎   | 12/19 [00:00<00:00, 20.25it/s] 79%|███████▉  | 15/19 [00:00<00:00, 20.85it/s] 95%|█████████▍| 18/19 [00:00<00:00, 21.58it/s]100%|██████████| 19/19 [00:00<00:00, 20.06it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519392886365851
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4307060 Minimum k_amp 0.00022499170162760515 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 0.5103323459625244 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07154532325994994
Ratio of unique |k|: 0.0019711821985298555
Time to get unique k and theta: 1.0000288486480713 seconds

Getting transfer functions
  0%|          | 0/8490 [00:00<?, ?it/s]  2%|▏         | 144/8490 [00:00<00:06, 1372.32it/s]  4%|▍         | 348/8490 [00:00<00:04, 1712.10it/s]  7%|▋         | 552/8490 [00:00<00:04, 1841.86it/s]  9%|▉         | 756/8490 [00:00<00:04, 1899.72it/s] 11%|█▏        | 972/8490 [00:00<00:03, 1951.42it/s] 14%|█▍        | 1176/8490 [00:00<00:03, 1958.27it/s] 16%|█▋        | 1392/8490 [00:00<00:03, 2003.11it/s] 19%|█▉        | 1596/8490 [00:00<00:03, 2012.93it/s] 21%|██▏       | 1812/8490 [00:00<00:03, 2032.59it/s] 24%|██▎       | 2016/8490 [00:01<00:03, 2024.42it/s] 26%|██▌       | 2220/8490 [00:01<00:03, 2009.61it/s] 30%|██▉       | 2508/8490 [00:01<00:02, 2243.24it/s] 33%|███▎      | 2796/8490 [00:01<00:02, 2404.99it/s] 37%|███▋      | 3120/8490 [00:01<00:02, 2616.77it/s] 40%|████      | 3420/8490 [00:01<00:01, 2717.07it/s] 44%|████▍     | 3720/8490 [00:01<00:01, 2767.61it/s] 47%|████▋     | 4008/8490 [00:01<00:01, 2777.53it/s] 51%|█████     | 4308/8490 [00:01<00:01, 2821.83it/s] 54%|█████▍    | 4620/8490 [00:01<00:01, 2878.83it/s] 58%|█████▊    | 4920/8490 [00:02<00:01, 2904.31it/s] 61%|██████▏   | 5220/8490 [00:02<00:01, 2904.36it/s] 65%|██████▌   | 5532/8490 [00:02<00:01, 2950.30it/s] 69%|██████▉   | 5844/8490 [00:02<00:00, 2992.42it/s] 72%|███████▏  | 6144/8490 [00:02<00:00, 2957.01it/s] 76%|███████▌  | 6440/8490 [00:02<00:00, 2908.73it/s] 80%|███████▉  | 6768/8490 [00:02<00:00, 3007.52it/s] 83%|████████▎ | 7080/8490 [00:02<00:00, 3022.62it/s] 87%|████████▋ | 7416/8490 [00:02<00:00, 3112.03it/s] 91%|█████████ | 7728/8490 [00:02<00:00, 3065.13it/s] 95%|█████████▍| 8040/8490 [00:03<00:00, 3079.53it/s] 98%|█████████▊| 8349/8490 [00:03<00:00, 3062.51it/s]100%|██████████| 8490/8490 [00:03<00:00, 2618.50it/s]
Size of transfer function: 1.36 MB. 

Size of integrand: 28.57 MB. Time to calculate integrand: 0.012397289276123047 s

Getting spherical harmonics
  0%|          | 0/308150 [00:00<?, ?it/s]  2%|▏         | 5226/308150 [00:00<00:05, 51906.85it/s]  3%|▎         | 10452/308150 [00:00<00:05, 51583.07it/s]  5%|▌         | 15611/308150 [00:00<00:05, 51188.45it/s]  7%|▋         | 20731/308150 [00:00<00:06, 46468.09it/s]  8%|▊         | 25434/308150 [00:00<00:06, 43898.46it/s] 10%|▉         | 29870/308150 [00:00<00:06, 40983.68it/s] 11%|█▏        | 34974/308150 [00:00<00:06, 43193.74it/s] 13%|█▎        | 40602/308150 [00:00<00:05, 46668.54it/s] 15%|█▍        | 45327/308150 [00:00<00:05, 46832.76it/s] 16%|█▌        | 50052/308150 [00:01<00:06, 42941.16it/s] 18%|█▊        | 54425/308150 [00:01<00:05, 42633.24it/s] 19%|█▉        | 58741/308150 [00:01<00:05, 41773.42it/s] 21%|██        | 63918/308150 [00:01<00:05, 44002.80it/s] 22%|██▏       | 68352/308150 [00:01<00:05, 44090.80it/s] 24%|██▎       | 72785/308150 [00:01<00:05, 41022.02it/s] 25%|██▌       | 77988/308150 [00:01<00:05, 43976.72it/s] 27%|██▋       | 83214/308150 [00:01<00:04, 46275.91it/s] 29%|██▉       | 89244/308150 [00:01<00:04, 49606.17it/s] 31%|███       | 94247/308150 [00:02<00:04, 48761.16it/s] 33%|███▎      | 100500/308150 [00:02<00:03, 52087.40it/s] 35%|███▍      | 106932/308150 [00:02<00:03, 55307.39it/s] 37%|███▋      | 112489/308150 [00:02<00:03, 55114.06it/s] 38%|███▊      | 118018/308150 [00:02<00:03, 51264.60it/s] 40%|████      | 123414/308150 [00:02<00:03, 50476.95it/s] 42%|████▏     | 129042/308150 [00:02<00:03, 51805.03it/s] 44%|████▍     | 136680/308150 [00:02<00:02, 58351.23it/s] 46%|████▋     | 142566/308150 [00:02<00:02, 57948.55it/s] 48%|████▊     | 148740/308150 [00:03<00:02, 57639.70it/s] 50%|█████     | 155172/308150 [00:03<00:02, 59184.26it/s] 52%|█████▏    | 161112/308150 [00:03<00:02, 58108.84it/s] 54%|█████▍    | 166940/308150 [00:03<00:02, 55365.90it/s] 56%|█████▌    | 172508/308150 [00:03<00:02, 52362.24it/s] 58%|█████▊    | 177787/308150 [00:03<00:02, 50587.89it/s] 60%|█████▉    | 184518/308150 [00:03<00:02, 55137.38it/s] 62%|██████▏   | 190950/308150 [00:03<00:02, 55790.11it/s] 64%|██████▍   | 196571/308150 [00:03<00:02, 54655.70it/s] 66%|██████▌   | 202065/308150 [00:04<00:01, 53265.20it/s] 67%|██████▋   | 207412/308150 [00:04<00:01, 53074.52it/s] 69%|██████▉   | 213462/308150 [00:04<00:01, 54119.62it/s] 71%|███████   | 218884/308150 [00:04<00:01, 51733.07it/s] 73%|███████▎  | 224077/308150 [00:04<00:01, 50689.31it/s] 75%|███████▍  | 229944/308150 [00:04<00:01, 52319.72it/s] 76%|███████▋  | 235572/308150 [00:04<00:01, 52667.71it/s] 78%|███████▊  | 240850/308150 [00:04<00:01, 51783.68it/s] 80%|███████▉  | 246036/308150 [00:04<00:01, 48930.94it/s] 81%|████████▏ | 250957/308150 [00:05<00:01, 47445.30it/s] 83%|████████▎ | 257280/308150 [00:05<00:00, 51516.33it/s] 86%|████████▌ | 264114/308150 [00:05<00:00, 55228.86it/s] 88%|████████▊ | 269742/308150 [00:05<00:00, 55474.92it/s] 89%|████████▉ | 275370/308150 [00:05<00:00, 55159.47it/s] 91%|█████████ | 280998/308150 [00:05<00:00, 54919.61it/s] 93%|█████████▎| 286501/308150 [00:05<00:00, 54482.11it/s] 95%|█████████▍| 291957/308150 [00:05<00:00, 52790.55it/s] 97%|█████████▋| 299088/308150 [00:05<00:00, 56905.47it/s] 99%|█████████▉| 304785/308150 [00:05<00:00, 56208.34it/s]100%|██████████| 308150/308150 [00:05<00:00, 51399.48it/s]
The spherical harmonics array is 271.54 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 70.88537049293518 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 25.028503116584183
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.001, 'pow_max': 0.00105, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 19.94it/s] 26%|██▋       | 5/19 [00:00<00:00, 21.29it/s] 42%|████▏     | 8/19 [00:00<00:00, 22.14it/s] 58%|█████▊    | 11/19 [00:00<00:00, 22.20it/s] 74%|███████▎  | 14/19 [00:00<00:00, 22.60it/s] 89%|████████▉ | 17/19 [00:00<00:00, 22.85it/s]100%|██████████| 19/19 [00:00<00:00, 22.36it/s]
Done. k_max for TT ell_max = 0.022696475761330413 k_max for EE ell_max = 0.08518711301992739
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4299500 Minimum k_amp 0.00022499170162760515 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 0.5239191055297852 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07154924991278055
Ratio of unique |k|: 0.0019725549482497965
Time to get unique k and theta: 0.9874978065490723 seconds

Getting transfer functions
  0%|          | 0/8481 [00:00<?, ?it/s]  2%|▏         | 180/8481 [00:00<00:04, 1725.16it/s]  5%|▍         | 396/8481 [00:00<00:04, 1919.43it/s]  7%|▋         | 624/8481 [00:00<00:03, 2044.73it/s] 10%|▉         | 840/8481 [00:00<00:03, 2047.60it/s] 13%|█▎        | 1068/8481 [00:00<00:03, 2102.20it/s] 15%|█▌        | 1296/8481 [00:00<00:03, 2131.21it/s] 18%|█▊        | 1536/8481 [00:00<00:03, 2180.01it/s] 21%|██        | 1754/8481 [00:00<00:03, 2146.57it/s] 23%|██▎       | 1980/8481 [00:00<00:03, 2166.92it/s] 26%|██▌       | 2220/8481 [00:01<00:02, 2204.87it/s] 29%|██▉       | 2496/8481 [00:01<00:02, 2368.88it/s] 33%|███▎      | 2796/8481 [00:01<00:02, 2529.48it/s] 37%|███▋      | 3096/8481 [00:01<00:02, 2648.53it/s] 40%|████      | 3420/8481 [00:01<00:01, 2810.43it/s] 44%|████▍     | 3720/8481 [00:01<00:01, 2843.55it/s] 47%|████▋     | 4008/8481 [00:01<00:01, 2844.22it/s] 51%|█████     | 4296/8481 [00:01<00:01, 2841.93it/s] 54%|█████▍    | 4584/8481 [00:01<00:01, 2826.87it/s] 58%|█████▊    | 4920/8481 [00:01<00:01, 2958.77it/s] 62%|██████▏   | 5220/8481 [00:02<00:01, 2946.04it/s] 65%|██████▌   | 5544/8481 [00:02<00:00, 3002.62it/s] 69%|██████▉   | 5845/8481 [00:02<00:00, 3003.02it/s] 73%|███████▎  | 6156/8481 [00:02<00:00, 3030.60it/s] 76%|███████▋  | 6468/8481 [00:02<00:00, 3046.53it/s] 80%|███████▉  | 6780/8481 [00:02<00:00, 3039.52it/s] 84%|████████▎ | 7092/8481 [00:02<00:00, 3039.74it/s] 88%|████████▊ | 7428/8481 [00:02<00:00, 3098.65it/s] 91%|█████████ | 7738/8481 [00:02<00:00, 3026.68it/s] 95%|█████████▍| 8052/8481 [00:02<00:00, 3025.22it/s] 99%|█████████▊| 8364/8481 [00:03<00:00, 3018.16it/s]100%|██████████| 8481/8481 [00:03<00:00, 2705.25it/s]
Size of transfer function: 1.36 MB. 

Size of integrand: 28.53 MB. Time to calculate integrand: 0.02427816390991211 s

Getting spherical harmonics
  0%|          | 0/307626 [00:00<?, ?it/s]  1%|          | 2807/307626 [00:00<00:11, 27303.51it/s]  3%|▎         | 8822/307626 [00:00<00:06, 44715.46it/s]  4%|▍         | 13269/307626 [00:00<00:07, 37734.00it/s]  6%|▌         | 17126/307626 [00:00<00:07, 36320.13it/s]  7%|▋         | 21011/307626 [00:00<00:07, 37136.30it/s]  8%|▊         | 24862/307626 [00:00<00:07, 37476.78it/s]  9%|▉         | 29146/307626 [00:00<00:07, 39139.40it/s] 11%|█         | 34085/307626 [00:00<00:06, 41469.20it/s] 12%|█▏        | 38250/307626 [00:00<00:06, 40845.29it/s] 14%|█▍        | 42506/307626 [00:01<00:06, 40567.65it/s] 15%|█▌        | 46572/307626 [00:01<00:06, 39364.22it/s] 17%|█▋        | 51729/307626 [00:01<00:06, 42111.48it/s] 18%|█▊        | 56541/307626 [00:01<00:05, 42447.59it/s] 20%|█▉        | 60791/307626 [00:01<00:06, 40665.18it/s] 21%|██        | 65363/307626 [00:01<00:05, 41325.71it/s] 23%|██▎       | 69505/307626 [00:01<00:05, 39839.96it/s] 24%|██▍       | 73784/307626 [00:01<00:05, 40187.06it/s] 26%|██▌       | 78596/307626 [00:01<00:05, 42169.22it/s] 28%|██▊       | 84611/307626 [00:02<00:04, 44964.06it/s] 29%|██▉       | 89824/307626 [00:02<00:04, 46773.00it/s] 31%|███       | 95438/307626 [00:02<00:04, 49397.28it/s] 33%|███▎      | 102255/307626 [00:02<00:03, 53486.35it/s] 35%|███▍      | 107607/307626 [00:02<00:03, 50789.18it/s] 37%|███▋      | 113082/307626 [00:02<00:03, 51259.06it/s] 38%|███▊      | 118225/307626 [00:02<00:03, 51079.19it/s] 40%|████      | 123909/307626 [00:02<00:03, 52391.57it/s] 42%|████▏     | 129160/307626 [00:02<00:03, 52025.04it/s] 44%|████▍     | 135538/307626 [00:03<00:03, 54369.27it/s] 46%|████▌     | 141954/307626 [00:03<00:03, 55075.77it/s] 48%|████▊     | 147459/307626 [00:03<00:04, 36658.04it/s] 49%|████▉     | 151911/307626 [00:03<00:04, 34869.97it/s] 51%|█████     | 156390/307626 [00:03<00:04, 37000.17it/s] 53%|█████▎    | 161603/307626 [00:03<00:03, 40378.95it/s] 54%|█████▍    | 166047/307626 [00:04<00:04, 28929.02it/s] 55%|█████▌    | 169649/307626 [00:04<00:05, 27046.94it/s] 57%|█████▋    | 175237/307626 [00:04<00:04, 32785.88it/s] 58%|█████▊    | 179117/307626 [00:04<00:04, 30876.79it/s] 59%|█████▉    | 182625/307626 [00:04<00:04, 28864.36it/s] 61%|██████    | 187267/307626 [00:04<00:03, 32012.75it/s] 63%|██████▎   | 193683/307626 [00:04<00:02, 39430.39it/s] 64%|██████▍   | 198094/307626 [00:04<00:02, 39992.84it/s] 66%|██████▌   | 203708/307626 [00:05<00:02, 42939.83it/s] 68%|██████▊   | 208520/307626 [00:05<00:02, 44040.32it/s] 70%|██████▉   | 214538/307626 [00:05<00:01, 48475.80it/s] 72%|███████▏  | 220149/307626 [00:05<00:01, 50161.86it/s] 73%|███████▎  | 225274/307626 [00:05<00:01, 48533.78it/s] 75%|███████▍  | 230211/307626 [00:05<00:01, 43417.99it/s] 77%|███████▋  | 236590/307626 [00:05<00:01, 48154.25it/s] 79%|███████▊  | 241803/307626 [00:05<00:01, 49222.10it/s] 80%|████████  | 247016/307626 [00:05<00:01, 49640.85it/s] 82%|████████▏ | 253432/307626 [00:05<00:01, 52955.06it/s] 84%|████████▍ | 259046/307626 [00:06<00:00, 53420.19it/s] 86%|████████▌ | 264435/307626 [00:06<00:00, 52469.51it/s] 89%|████████▊ | 272279/307626 [00:06<00:00, 58899.40it/s] 91%|█████████ | 279096/307626 [00:06<00:00, 60545.96it/s] 93%|█████████▎| 285169/307626 [00:06<00:00, 51404.45it/s] 94%|█████████▍| 290543/307626 [00:06<00:00, 50241.54it/s] 97%|█████████▋| 298344/307626 [00:06<00:00, 57242.75it/s] 99%|█████████▉| 304760/307626 [00:06<00:00, 58807.69it/s]100%|██████████| 307626/307626 [00:06<00:00, 44374.05it/s]
The spherical harmonics array is 271.08 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 77.42490696907043 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 24.94545473825358
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.0015, 'pow_max': 0.00155, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 15.09it/s] 21%|██        | 4/19 [00:00<00:00, 15.86it/s] 32%|███▏      | 6/19 [00:00<00:00, 16.72it/s] 42%|████▏     | 8/19 [00:00<00:00, 17.68it/s] 58%|█████▊    | 11/19 [00:00<00:00, 19.14it/s] 74%|███████▎  | 14/19 [00:00<00:00, 20.51it/s] 89%|████████▉ | 17/19 [00:00<00:00, 21.45it/s]100%|██████████| 19/19 [00:00<00:00, 19.87it/s]
Done. k_max for TT ell_max = 0.01422693794493977 k_max for EE ell_max = 0.08518839099062697
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 2096394 Minimum k_amp 0.00022499170162760515 n_x_max 80 n_z_max 80
Time to get list of k, phi, theta: 0.2424304485321045 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0738935524524493
Ratio of unique |k|: 0.0025066852891202705
Time to get unique k and theta: 0.41742682456970215 seconds

Getting transfer functions
  0%|          | 0/5255 [00:00<?, ?it/s]  2%|▏         | 105/5255 [00:00<00:04, 1033.59it/s]  4%|▍         | 231/5255 [00:00<00:04, 1148.06it/s]  7%|▋         | 364/5255 [00:00<00:04, 1202.45it/s] 10%|▉         | 504/5255 [00:00<00:03, 1266.13it/s] 12%|█▏        | 644/5255 [00:00<00:03, 1290.31it/s] 15%|█▍        | 777/5255 [00:00<00:03, 1298.64it/s] 17%|█▋        | 917/5255 [00:00<00:03, 1324.74it/s] 20%|██        | 1057/5255 [00:00<00:03, 1330.98it/s] 23%|██▎       | 1191/5255 [00:00<00:03, 1332.45it/s] 25%|██▌       | 1330/5255 [00:01<00:02, 1333.12it/s] 29%|██▉       | 1533/5255 [00:01<00:02, 1539.72it/s] 33%|███▎      | 1757/5255 [00:01<00:02, 1746.25it/s] 37%|███▋      | 1953/5255 [00:01<00:01, 1803.29it/s] 41%|████▏     | 2170/5255 [00:01<00:01, 1898.29it/s] 45%|████▌     | 2387/5255 [00:01<00:01, 1963.14it/s] 49%|████▉     | 2590/5255 [00:01<00:01, 1978.38it/s] 54%|█████▎    | 2821/5255 [00:01<00:01, 2060.63it/s] 58%|█████▊    | 3031/5255 [00:01<00:01, 2058.30it/s] 62%|██████▏   | 3237/5255 [00:01<00:00, 2045.90it/s] 65%|██████▌   | 3442/5255 [00:02<00:00, 2000.71it/s] 69%|██████▉   | 3643/5255 [00:02<00:00, 1998.28it/s] 73%|███████▎  | 3850/5255 [00:02<00:00, 2016.04it/s] 77%|███████▋  | 4053/5255 [00:02<00:00, 2009.95it/s] 81%|████████  | 4255/5255 [00:02<00:00, 2009.50it/s] 85%|████████▍ | 4457/5255 [00:02<00:00, 2012.38it/s] 89%|████████▊ | 4662/5255 [00:02<00:00, 2021.74it/s] 93%|█████████▎| 4893/5255 [00:02<00:00, 2092.00it/s] 97%|█████████▋| 5103/5255 [00:02<00:00, 2037.77it/s]100%|██████████| 5255/5255 [00:02<00:00, 1783.44it/s]
Size of transfer function: 0.84 MB. 

Size of integrand: 17.68 MB. Time to calculate integrand: 0.01147770881652832 s

Getting spherical harmonics
  0%|          | 0/154910 [00:00<?, ?it/s]  2%|▏         | 3434/154910 [00:00<00:04, 33089.37it/s]  4%|▍         | 6743/154910 [00:00<00:04, 31173.52it/s]  6%|▋         | 9866/154910 [00:00<00:05, 28593.94it/s]  8%|▊         | 12744/154910 [00:00<00:05, 26712.89it/s] 10%|▉         | 15432/154910 [00:00<00:06, 22319.02it/s] 12%|█▏        | 18786/154910 [00:00<00:05, 25063.05it/s] 14%|█▍        | 21397/154910 [00:00<00:06, 21179.16it/s] 16%|█▌        | 24846/154910 [00:01<00:05, 23759.32it/s] 18%|█▊        | 27359/154910 [00:01<00:05, 22204.63it/s] 20%|██        | 31512/154910 [00:01<00:04, 26753.59it/s] 23%|██▎       | 35350/154910 [00:01<00:04, 29756.20it/s] 25%|██▍       | 38582/154910 [00:01<00:03, 29782.21it/s] 28%|██▊       | 42824/154910 [00:01<00:03, 33271.07it/s] 31%|███       | 48166/154910 [00:01<00:02, 38970.26it/s] 34%|███▎      | 52175/154910 [00:01<00:02, 37469.83it/s] 36%|███▌      | 56010/154910 [00:01<00:02, 35529.80it/s] 39%|███▊      | 59994/154910 [00:02<00:02, 35706.97it/s] 42%|████▏     | 65044/154910 [00:02<00:02, 38930.74it/s] 45%|████▍     | 69286/154910 [00:02<00:02, 39585.18it/s] 48%|████▊     | 74538/154910 [00:02<00:01, 43188.98it/s] 51%|█████     | 79386/154910 [00:02<00:01, 44701.75it/s] 54%|█████▍    | 83895/154910 [00:02<00:01, 44573.89it/s] 57%|█████▋    | 88380/154910 [00:02<00:01, 44027.66it/s] 60%|█████▉    | 92802/154910 [00:02<00:01, 41781.07it/s] 63%|██████▎   | 97162/154910 [00:02<00:01, 42022.96it/s] 66%|██████▌   | 102010/154910 [00:02<00:01, 43667.45it/s] 69%|██████▊   | 106400/154910 [00:03<00:01, 43398.06it/s] 71%|███████▏  | 110756/154910 [00:03<00:01, 40015.46it/s] 74%|███████▍  | 114815/154910 [00:03<00:01, 39641.27it/s] 77%|███████▋  | 118817/154910 [00:03<00:00, 37042.28it/s] 79%|███████▉  | 123018/154910 [00:03<00:00, 37910.71it/s] 83%|████████▎ | 128876/154910 [00:03<00:00, 43215.33it/s] 86%|████████▌ | 133256/154910 [00:03<00:00, 41289.03it/s] 89%|████████▉ | 137764/154910 [00:03<00:00, 41904.28it/s] 92%|█████████▏| 142612/154910 [00:03<00:00, 43381.23it/s] 95%|█████████▌| 147864/154910 [00:04<00:00, 45736.39it/s] 98%|█████████▊| 152471/154910 [00:04<00:00, 43894.79it/s]100%|██████████| 154910/154910 [00:04<00:00, 36719.66it/s]
The spherical harmonics array is 136.51 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 77.26235842704773 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 24.37049511942092
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.002, 'pow_max': 0.00205, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 18.88it/s] 26%|██▋       | 5/19 [00:00<00:00, 21.42it/s] 42%|████▏     | 8/19 [00:00<00:00, 22.21it/s] 58%|█████▊    | 11/19 [00:00<00:00, 22.53it/s] 74%|███████▎  | 14/19 [00:00<00:00, 22.31it/s] 89%|████████▉ | 17/19 [00:00<00:00, 22.63it/s]100%|██████████| 19/19 [00:00<00:00, 22.35it/s]
Done. k_max for TT ell_max = 0.016480852268776554 k_max for EE ell_max = 0.08520031871715644
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 2921040 Minimum k_amp 0.00022499170162760515 n_x_max 89 n_z_max 89
Time to get list of k, phi, theta: 0.35396409034729004 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0728175581299811
Ratio of unique |k|: 0.0022440637581135486
Time to get unique k and theta: 0.649097204208374 seconds

Getting transfer functions
  0%|          | 0/6555 [00:00<?, ?it/s]  2%|▏         | 135/6555 [00:00<00:04, 1328.92it/s]  5%|▍         | 297/6555 [00:00<00:04, 1462.79it/s]  7%|▋         | 444/6555 [00:00<00:04, 1461.65it/s]  9%|▉         | 612/6555 [00:00<00:03, 1525.62it/s] 12%|█▏        | 783/6555 [00:00<00:03, 1576.89it/s] 15%|█▍        | 963/6555 [00:00<00:03, 1631.29it/s] 17%|█▋        | 1143/6555 [00:00<00:03, 1665.45it/s] 20%|██        | 1314/6555 [00:00<00:03, 1673.01it/s] 23%|██▎       | 1485/6555 [00:00<00:03, 1658.54it/s] 25%|██▌       | 1656/6555 [00:01<00:02, 1661.24it/s] 29%|██▊       | 1872/6555 [00:01<00:02, 1804.98it/s] 32%|███▏      | 2124/6555 [00:01<00:02, 2014.06it/s] 36%|███▌      | 2358/6555 [00:01<00:01, 2108.16it/s] 40%|███▉      | 2592/6555 [00:01<00:01, 2169.91it/s] 43%|████▎     | 2817/6555 [00:01<00:01, 2173.88it/s] 47%|████▋     | 3060/6555 [00:01<00:01, 2235.00it/s] 51%|█████     | 3321/6555 [00:01<00:01, 2340.22it/s] 54%|█████▍    | 3564/6555 [00:01<00:01, 2352.69it/s] 58%|█████▊    | 3807/6555 [00:01<00:01, 2370.43it/s] 62%|██████▏   | 4045/6555 [00:02<00:01, 2372.91it/s] 65%|██████▌   | 4283/6555 [00:02<00:00, 2330.81it/s] 69%|██████▉   | 4517/6555 [00:02<00:00, 2295.62it/s] 72%|███████▏  | 4752/6555 [00:02<00:00, 2290.82it/s] 77%|███████▋  | 5022/6555 [00:02<00:00, 2386.96it/s] 80%|████████  | 5261/6555 [00:02<00:00, 2347.51it/s] 84%|████████▍ | 5496/6555 [00:02<00:00, 2316.51it/s] 87%|████████▋ | 5728/6555 [00:02<00:00, 2297.66it/s] 91%|█████████ | 5958/6555 [00:02<00:00, 2264.72it/s] 94%|█████████▍| 6192/6555 [00:02<00:00, 2265.55it/s] 98%|█████████▊| 6419/6555 [00:03<00:00, 2263.00it/s]100%|██████████| 6555/6555 [00:03<00:00, 2084.81it/s]
Size of transfer function: 1.05 MB. 

Size of integrand: 22.05 MB. Time to calculate integrand: 0.02005600929260254 s

Getting spherical harmonics
  0%|          | 0/212703 [00:00<?, ?it/s]  2%|▏         | 4155/212703 [00:00<00:05, 39414.27it/s]  4%|▍         | 8587/212703 [00:00<00:04, 41867.43it/s]  6%|▌         | 12778/212703 [00:00<00:06, 29832.48it/s]  8%|▊         | 16897/212703 [00:00<00:05, 33036.25it/s] 10%|█         | 21329/212703 [00:00<00:05, 35901.29it/s] 12%|█▏        | 25761/212703 [00:00<00:04, 38391.98it/s] 14%|█▍        | 30193/212703 [00:00<00:04, 39371.26it/s] 16%|█▌        | 34348/212703 [00:00<00:04, 39525.20it/s] 18%|█▊        | 38380/212703 [00:01<00:05, 33573.28it/s] 20%|█▉        | 42381/212703 [00:01<00:04, 34838.91it/s] 22%|██▏       | 47090/212703 [00:01<00:04, 37665.68it/s] 24%|██▍       | 51522/212703 [00:01<00:04, 38911.05it/s] 26%|██▌       | 55677/212703 [00:01<00:04, 39123.50it/s] 28%|██▊       | 60109/212703 [00:01<00:03, 40232.38it/s] 30%|███       | 64818/212703 [00:01<00:03, 42086.98it/s] 33%|███▎      | 70358/212703 [00:01<00:03, 45634.37it/s] 35%|███▌      | 75067/212703 [00:01<00:03, 45651.62it/s] 37%|███▋      | 79661/212703 [00:02<00:02, 45516.94it/s] 40%|███▉      | 84233/212703 [00:02<00:02, 44498.15it/s] 42%|████▏     | 90025/212703 [00:02<00:02, 48036.85it/s] 45%|████▌     | 95842/212703 [00:02<00:02, 50237.48it/s] 47%|████▋     | 100877/212703 [00:02<00:02, 49704.85it/s] 50%|████▉     | 105855/212703 [00:02<00:02, 47700.25it/s] 52%|█████▏    | 110800/212703 [00:02<00:02, 47758.60it/s] 54%|█████▍    | 115589/212703 [00:02<00:02, 47237.13it/s] 57%|█████▋    | 121049/212703 [00:02<00:01, 48932.56it/s] 59%|█████▉    | 125951/212703 [00:02<00:01, 48225.40it/s] 61%|██████▏   | 130780/212703 [00:03<00:01, 47100.29it/s] 64%|██████▎   | 135497/212703 [00:03<00:01, 46330.95it/s] 66%|██████▋   | 140993/212703 [00:03<00:01, 48371.50it/s] 69%|██████▊   | 145979/212703 [00:03<00:01, 48354.40it/s] 71%|███████   | 150820/212703 [00:03<00:01, 44064.87it/s] 74%|███████▎  | 156782/212703 [00:03<00:01, 47881.16it/s] 76%|███████▌  | 161644/212703 [00:03<00:01, 45085.84it/s] 78%|███████▊  | 166477/212703 [00:03<00:01, 45603.57it/s] 81%|████████  | 171463/212703 [00:03<00:00, 46379.40it/s] 83%|████████▎ | 176726/212703 [00:04<00:00, 47772.34it/s] 86%|████████▌ | 182543/212703 [00:04<00:00, 50005.65it/s] 88%|████████▊ | 187571/212703 [00:04<00:00, 48166.46it/s] 91%|█████████ | 193346/212703 [00:04<00:00, 50391.61it/s] 94%|█████████▎| 198886/212703 [00:04<00:00, 51421.03it/s] 96%|█████████▌| 204149/212703 [00:04<00:00, 51385.68it/s] 99%|█████████▊| 209966/212703 [00:04<00:00, 53057.93it/s]100%|██████████| 212703/212703 [00:04<00:00, 44956.12it/s]
The spherical harmonics array is 187.43 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 77.14086294174194 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 23.929348990507407
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.0001, 'pow_max': 0.00015000000000000001, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 16%|█▌        | 3/19 [00:00<00:00, 21.94it/s] 32%|███▏      | 6/19 [00:00<00:00, 22.11it/s] 47%|████▋     | 9/19 [00:00<00:00, 22.16it/s] 63%|██████▎   | 12/19 [00:00<00:00, 22.11it/s] 79%|███████▉  | 15/19 [00:00<00:00, 22.11it/s] 95%|█████████▍| 18/19 [00:00<00:00, 22.12it/s]100%|██████████| 19/19 [00:00<00:00, 22.10it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4307060 Minimum k_amp 0.00022499170162760515 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 0.4921886920928955 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07154532325994994
Ratio of unique |k|: 0.0019711821985298555
Time to get unique k and theta: 0.9611880779266357 seconds

Getting transfer functions
  0%|          | 0/8490 [00:00<?, ?it/s]  2%|▏         | 192/8490 [00:00<00:04, 1810.83it/s]  4%|▍         | 374/8490 [00:00<00:04, 1753.93it/s]  7%|▋         | 564/8490 [00:00<00:04, 1804.53it/s]  9%|▉         | 756/8490 [00:00<00:04, 1824.24it/s] 11%|█         | 948/8490 [00:00<00:04, 1852.47it/s] 13%|█▎        | 1134/8490 [00:00<00:04, 1832.44it/s] 16%|█▌        | 1320/8490 [00:00<00:03, 1818.63it/s] 18%|█▊        | 1524/8490 [00:00<00:03, 1855.46it/s] 20%|██        | 1728/8490 [00:00<00:03, 1886.77it/s] 23%|██▎       | 1932/8490 [00:01<00:03, 1917.73it/s] 25%|██▌       | 2136/8490 [00:01<00:03, 1935.42it/s] 28%|██▊       | 2352/8490 [00:01<00:03, 2001.03it/s] 31%|███       | 2628/8490 [00:01<00:02, 2207.97it/s] 34%|███▍      | 2904/8490 [00:01<00:02, 2357.28it/s] 38%|███▊      | 3204/8490 [00:01<00:02, 2518.91it/s] 41%|████      | 3468/8490 [00:01<00:01, 2554.25it/s] 44%|████▍     | 3756/8490 [00:01<00:01, 2648.99it/s] 47%|████▋     | 4032/8490 [00:01<00:01, 2655.04it/s] 51%|█████     | 4308/8490 [00:01<00:01, 2667.69it/s] 54%|█████▍    | 4584/8490 [00:02<00:01, 2665.30it/s] 57%|█████▋    | 4860/8490 [00:02<00:01, 2675.25it/s] 60%|██████    | 5128/8490 [00:02<00:01, 2554.90it/s] 64%|██████▍   | 5436/8490 [00:02<00:01, 2683.66it/s] 68%|██████▊   | 5736/8490 [00:02<00:01, 2741.17it/s] 71%|███████   | 6036/8490 [00:02<00:00, 2796.24it/s] 75%|███████▍  | 6360/8490 [00:02<00:00, 2910.03it/s] 78%|███████▊  | 6660/8490 [00:02<00:00, 2909.24it/s] 82%|████████▏ | 6952/8490 [00:02<00:00, 2770.11it/s] 85%|████████▌ | 7236/8490 [00:03<00:00, 2776.39it/s] 89%|████████▉ | 7572/8490 [00:03<00:00, 2916.37it/s] 93%|█████████▎| 7872/8490 [00:03<00:00, 2931.21it/s] 96%|█████████▌| 8166/8490 [00:03<00:00, 2895.72it/s]100%|█████████▉| 8457/8490 [00:03<00:00, 2853.13it/s]100%|██████████| 8490/8490 [00:03<00:00, 2468.40it/s]
Size of transfer function: 1.36 MB. 

Size of integrand: 28.57 MB. Time to calculate integrand: 0.018142223358154297 s

Getting spherical harmonics
  0%|          | 0/308150 [00:00<?, ?it/s]  2%|▏         | 4824/308150 [00:00<00:06, 46598.44it/s]  3%|▎         | 10050/308150 [00:00<00:06, 48224.91it/s]  5%|▍         | 14871/308150 [00:00<00:06, 47938.00it/s]  6%|▋         | 19664/308150 [00:00<00:06, 44612.49it/s]  8%|▊         | 24152/308150 [00:00<00:06, 43181.46it/s]  9%|▉         | 28488/308150 [00:00<00:06, 42453.18it/s] 11%|█         | 32743/308150 [00:00<00:07, 38864.50it/s] 12%|█▏        | 36677/308150 [00:00<00:06, 38985.44it/s] 13%|█▎        | 40609/308150 [00:00<00:07, 37850.42it/s] 14%|█▍        | 44622/308150 [00:01<00:06, 38439.50it/s] 16%|█▌        | 49446/308150 [00:01<00:06, 39992.00it/s] 17%|█▋        | 53868/308150 [00:01<00:06, 40618.34it/s] 19%|█▉        | 57939/308150 [00:01<00:06, 39783.73it/s] 20%|██        | 61924/308150 [00:01<00:06, 37390.34it/s] 22%|██▏       | 66330/308150 [00:01<00:06, 38885.56it/s] 23%|██▎       | 71958/308150 [00:01<00:05, 43641.93it/s] 25%|██▍       | 76368/308150 [00:01<00:05, 41285.53it/s] 26%|██▌       | 80802/308150 [00:01<00:05, 42103.55it/s] 28%|██▊       | 85055/308150 [00:02<00:05, 38989.88it/s] 29%|██▉       | 89655/308150 [00:02<00:05, 40902.33it/s] 31%|███       | 94470/308150 [00:02<00:04, 42916.16it/s] 32%|███▏      | 100098/308150 [00:02<00:04, 46518.35it/s] 35%|███▍      | 106897/308150 [00:02<00:03, 52724.20it/s] 36%|███▋      | 112232/308150 [00:02<00:03, 51754.99it/s] 38%|███▊      | 117454/308150 [00:02<00:03, 48224.44it/s] 40%|████      | 124218/308150 [00:02<00:03, 52956.54it/s] 42%|████▏     | 130248/308150 [00:02<00:03, 54473.70it/s] 44%|████▍     | 135753/308150 [00:03<00:03, 53368.54it/s] 46%|████▌     | 141131/308150 [00:03<00:03, 53395.82it/s] 48%|████▊     | 146500/308150 [00:03<00:03, 50791.17it/s] 49%|████▉     | 152358/308150 [00:03<00:02, 52013.40it/s] 51%|█████▏    | 158388/308150 [00:03<00:02, 54125.72it/s] 53%|█████▎    | 164820/308150 [00:03<00:02, 56974.09it/s] 56%|█████▌    | 171654/308150 [00:03<00:02, 60181.48it/s] 58%|█████▊    | 177706/308150 [00:03<00:02, 59879.67it/s] 60%|█████▉    | 183717/308150 [00:03<00:02, 56949.12it/s] 61%|██████▏   | 189454/308150 [00:04<00:02, 54982.41it/s] 63%|██████▎   | 194989/308150 [00:04<00:02, 48865.13it/s] 65%|██████▌   | 200598/308150 [00:04<00:02, 50271.21it/s] 67%|██████▋   | 206226/308150 [00:04<00:01, 51470.57it/s] 69%|██████▉   | 212658/308150 [00:04<00:01, 53973.44it/s] 71%|███████   | 218286/308150 [00:04<00:01, 54403.52it/s] 73%|███████▎  | 223776/308150 [00:04<00:01, 52568.78it/s] 74%|███████▍  | 229542/308150 [00:04<00:01, 53397.79it/s] 76%|███████▋  | 235572/308150 [00:04<00:01, 54627.09it/s] 78%|███████▊  | 241200/308150 [00:04<00:01, 54887.70it/s] 80%|████████  | 247632/308150 [00:05<00:01, 57451.26it/s] 83%|████████▎ | 254466/308150 [00:05<00:00, 59908.72it/s] 85%|████████▍ | 260471/308150 [00:05<00:00, 59241.50it/s] 86%|████████▋ | 266405/308150 [00:05<00:00, 58341.60it/s] 88%|████████▊ | 272247/308150 [00:05<00:00, 56889.72it/s] 91%|█████████ | 279792/308150 [00:05<00:00, 61843.17it/s] 93%|█████████▎| 287430/308150 [00:05<00:00, 64879.78it/s] 95%|█████████▌| 293928/308150 [00:05<00:00, 58242.93it/s] 97%|█████████▋| 299874/308150 [00:05<00:00, 57296.08it/s] 99%|█████████▉| 306324/308150 [00:06<00:00, 58115.77it/s]100%|██████████| 308150/308150 [00:06<00:00, 50480.65it/s]
The spherical harmonics array is 271.54 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 82.74338293075562 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 24.008525182840874
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.0002, 'pow_max': 0.00025, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 13.62it/s] 21%|██        | 4/19 [00:00<00:01, 14.88it/s] 32%|███▏      | 6/19 [00:00<00:00, 15.90it/s] 42%|████▏     | 8/19 [00:00<00:00, 16.93it/s] 58%|█████▊    | 11/19 [00:00<00:00, 18.42it/s] 74%|███████▎  | 14/19 [00:00<00:00, 19.77it/s] 89%|████████▉ | 17/19 [00:00<00:00, 20.65it/s]100%|██████████| 19/19 [00:00<00:00, 19.03it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4307060 Minimum k_amp 0.00022499170162760515 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 0.5040044784545898 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07154532325994994
Ratio of unique |k|: 0.0019711821985298555
Time to get unique k and theta: 0.9529092311859131 seconds

Getting transfer functions
  0%|          | 0/8490 [00:00<?, ?it/s]  2%|▏         | 204/8490 [00:00<00:04, 1937.29it/s]  5%|▍         | 420/8490 [00:00<00:04, 1999.39it/s]  8%|▊         | 648/8490 [00:00<00:03, 2087.20it/s] 10%|█         | 888/8490 [00:00<00:03, 2175.38it/s] 13%|█▎        | 1116/8490 [00:00<00:03, 2172.05it/s] 16%|█▌        | 1356/8490 [00:00<00:03, 2213.98it/s] 19%|█▉        | 1596/8490 [00:00<00:03, 2244.20it/s] 21%|██▏       | 1821/8490 [00:00<00:02, 2236.91it/s] 24%|██▍       | 2045/8490 [00:00<00:02, 2220.31it/s] 27%|██▋       | 2268/8490 [00:01<00:02, 2221.37it/s] 30%|███       | 2568/8490 [00:01<00:02, 2435.32it/s] 34%|███▍      | 2880/8490 [00:01<00:02, 2616.63it/s] 37%|███▋      | 3180/8490 [00:01<00:01, 2724.72it/s] 41%|████▏     | 3504/8490 [00:01<00:01, 2839.97it/s] 45%|████▌     | 3828/8490 [00:01<00:01, 2935.16it/s] 49%|████▉     | 4152/8490 [00:01<00:01, 3011.03it/s] 52%|█████▏    | 4454/8490 [00:01<00:01, 2970.45it/s] 56%|█████▌    | 4764/8490 [00:01<00:01, 2996.72it/s] 60%|█████▉    | 5088/8490 [00:01<00:01, 3039.91it/s] 64%|██████▎   | 5393/8490 [00:02<00:01, 3025.87it/s] 67%|██████▋   | 5700/8490 [00:02<00:00, 3021.29it/s] 71%|███████   | 6024/8490 [00:02<00:00, 3073.47it/s] 75%|███████▍  | 6348/8490 [00:02<00:00, 3106.80it/s] 79%|███████▊  | 6672/8490 [00:02<00:00, 3113.80it/s] 82%|████████▏ | 6984/8490 [00:02<00:00, 3088.32it/s] 86%|████████▌ | 7296/8490 [00:02<00:00, 3088.61it/s] 90%|████████▉ | 7632/8490 [00:02<00:00, 3139.58it/s] 94%|█████████▎| 7956/8490 [00:02<00:00, 3143.99it/s] 98%|█████████▊| 8280/8490 [00:02<00:00, 3157.46it/s]100%|██████████| 8490/8490 [00:03<00:00, 2780.79it/s]
Size of transfer function: 1.36 MB. 

Size of integrand: 28.57 MB. Time to calculate integrand: 0.018680095672607422 s

Getting spherical harmonics
  0%|          | 0/308150 [00:00<?, ?it/s]  2%|▏         | 5226/308150 [00:00<00:05, 51068.54it/s]  4%|▎         | 10854/308150 [00:00<00:05, 52758.45it/s]  5%|▌         | 16129/308150 [00:00<00:05, 50990.88it/s]  7%|▋         | 21232/308150 [00:00<00:05, 48170.56it/s]  8%|▊         | 26130/308150 [00:00<00:05, 47171.23it/s] 10%|█         | 30954/308150 [00:00<00:05, 46881.71it/s] 12%|█▏        | 35648/308150 [00:00<00:05, 46150.23it/s] 13%|█▎        | 40266/308150 [00:00<00:06, 44447.64it/s] 15%|█▍        | 44719/308150 [00:00<00:06, 43696.01it/s] 16%|█▌        | 49093/308150 [00:01<00:06, 41073.38it/s] 17%|█▋        | 53225/308150 [00:01<00:06, 39214.55it/s] 19%|█▊        | 57169/308150 [00:01<00:06, 36514.21it/s] 20%|██        | 62310/308150 [00:01<00:06, 39446.43it/s] 22%|██▏       | 66330/308150 [00:01<00:06, 39621.56it/s] 23%|██▎       | 71154/308150 [00:01<00:05, 41403.23it/s] 24%|██▍       | 75322/308150 [00:01<00:05, 40486.55it/s] 26%|██▌       | 79390/308150 [00:01<00:05, 38958.42it/s] 28%|██▊       | 85224/308150 [00:01<00:05, 44274.57it/s] 29%|██▉       | 90852/308150 [00:02<00:04, 47161.55it/s] 31%|███       | 95610/308150 [00:02<00:04, 44067.59it/s] 33%|███▎      | 100902/308150 [00:02<00:04, 46336.23it/s] 34%|███▍      | 105596/308150 [00:02<00:04, 43190.87it/s] 36%|███▋      | 111756/308150 [00:02<00:04, 47690.93it/s] 38%|███▊      | 118188/308150 [00:02<00:03, 51566.80it/s] 40%|████      | 123419/308150 [00:02<00:03, 51271.77it/s] 42%|████▏     | 129444/308150 [00:02<00:03, 53781.25it/s] 44%|████▍     | 134871/308150 [00:02<00:03, 48366.00it/s] 46%|████▌     | 140298/308150 [00:03<00:03, 49773.17it/s] 47%|████▋     | 145926/308150 [00:03<00:03, 51336.53it/s] 49%|████▉     | 151554/308150 [00:03<00:03, 52120.35it/s] 51%|█████     | 156826/308150 [00:03<00:03, 46453.08it/s] 52%|█████▏    | 161615/308150 [00:03<00:03, 45305.44it/s] 54%|█████▍    | 166830/308150 [00:03<00:03, 45819.91it/s] 56%|█████▌    | 171482/308150 [00:03<00:03, 40589.40it/s] 57%|█████▋    | 176076/308150 [00:03<00:03, 41568.19it/s] 59%|█████▊    | 180340/308150 [00:04<00:03, 41429.81it/s] 60%|█████▉    | 184557/308150 [00:04<00:03, 39521.68it/s] 62%|██████▏   | 191754/308150 [00:04<00:02, 47744.58it/s] 64%|██████▍   | 197382/308150 [00:04<00:02, 49420.79it/s] 66%|██████▌   | 203010/308150 [00:04<00:02, 50870.74it/s] 68%|██████▊   | 209442/308150 [00:04<00:01, 54183.85it/s] 70%|███████   | 216276/308150 [00:04<00:01, 57143.75it/s] 72%|███████▏  | 222306/308150 [00:04<00:01, 57263.67it/s] 74%|███████▍  | 228060/308150 [00:04<00:01, 54041.02it/s] 76%|███████▌  | 233562/308150 [00:04<00:01, 53985.98it/s] 78%|███████▊  | 238994/308150 [00:05<00:01, 54013.04it/s] 80%|███████▉  | 245622/308150 [00:05<00:01, 56912.32it/s] 82%|████████▏ | 252054/308150 [00:05<00:00, 57941.23it/s] 84%|████████▎ | 257862/308150 [00:05<00:00, 53050.97it/s] 85%|████████▌ | 263245/308150 [00:05<00:00, 50634.54it/s] 87%|████████▋ | 269340/308150 [00:05<00:00, 52681.83it/s] 89%|████████▉ | 274666/308150 [00:05<00:00, 49796.46it/s] 91%|█████████ | 279702/308150 [00:05<00:00, 42936.52it/s] 92%|█████████▏| 284616/308150 [00:06<00:00, 42986.92it/s] 94%|█████████▍| 290244/308150 [00:06<00:00, 45670.37it/s] 96%|█████████▌| 294929/308150 [00:06<00:00, 45810.72it/s] 97%|█████████▋| 299595/308150 [00:06<00:00, 45960.59it/s] 99%|█████████▉| 305922/308150 [00:06<00:00, 50298.36it/s]100%|██████████| 308150/308150 [00:06<00:00, 47468.33it/s]
The spherical harmonics array is 271.54 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 77.88381218910217 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 24.89798418501253
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.0003, 'pow_max': 0.00035, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 17.88it/s] 21%|██        | 4/19 [00:00<00:00, 18.83it/s] 37%|███▋      | 7/19 [00:00<00:00, 20.07it/s] 53%|█████▎    | 10/19 [00:00<00:00, 21.28it/s] 68%|██████▊   | 13/19 [00:00<00:00, 22.07it/s] 84%|████████▍ | 16/19 [00:00<00:00, 22.54it/s]100%|██████████| 19/19 [00:00<00:00, 22.83it/s]100%|██████████| 19/19 [00:00<00:00, 21.83it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4307060 Minimum k_amp 0.00022499170162760515 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 0.4888277053833008 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07154532325994994
Ratio of unique |k|: 0.0019711821985298555
Time to get unique k and theta: 0.949786901473999 seconds

Getting transfer functions
  0%|          | 0/8490 [00:00<?, ?it/s]  2%|▏         | 180/8490 [00:00<00:04, 1734.30it/s]  5%|▍         | 396/8490 [00:00<00:04, 1964.42it/s]  7%|▋         | 593/8490 [00:00<00:04, 1961.65it/s]  9%|▉         | 790/8490 [00:00<00:03, 1947.71it/s] 12%|█▏        | 1008/8490 [00:00<00:03, 1995.86it/s] 15%|█▍        | 1236/8490 [00:00<00:03, 2069.04it/s] 17%|█▋        | 1452/8490 [00:00<00:03, 2062.46it/s] 20%|█▉        | 1659/8490 [00:00<00:03, 2047.67it/s] 22%|██▏       | 1884/8490 [00:00<00:03, 2089.06it/s] 25%|██▌       | 2124/8490 [00:01<00:02, 2142.19it/s] 28%|██▊       | 2339/8490 [00:01<00:02, 2114.60it/s] 31%|███       | 2652/8490 [00:01<00:02, 2391.04it/s] 35%|███▍      | 2940/8490 [00:01<00:02, 2522.75it/s] 38%|███▊      | 3240/8490 [00:01<00:01, 2647.96it/s] 42%|████▏     | 3552/8490 [00:01<00:01, 2781.51it/s] 46%|████▌     | 3876/8490 [00:01<00:01, 2917.02it/s] 49%|████▉     | 4169/8490 [00:01<00:01, 2832.49it/s] 52%|█████▏    | 4454/8490 [00:01<00:01, 2815.01it/s] 56%|█████▌    | 4740/8490 [00:01<00:01, 2826.48it/s] 60%|█████▉    | 5052/8490 [00:02<00:01, 2912.48it/s] 63%|██████▎   | 5376/8490 [00:02<00:01, 2986.78it/s] 67%|██████▋   | 5724/8490 [00:02<00:00, 3110.53it/s] 71%|███████   | 6036/8490 [00:02<00:00, 3056.15it/s] 75%|███████▍  | 6342/8490 [00:02<00:00, 3001.35it/s] 78%|███████▊  | 6648/8490 [00:02<00:00, 2992.59it/s] 82%|████████▏ | 6948/8490 [00:02<00:00, 2968.26it/s] 86%|████████▌ | 7296/8490 [00:02<00:00, 3103.64it/s] 90%|████████▉ | 7608/8490 [00:02<00:00, 3071.34it/s] 93%|█████████▎| 7916/8490 [00:02<00:00, 3058.65it/s] 97%|█████████▋| 8232/8490 [00:03<00:00, 3064.01it/s]100%|██████████| 8490/8490 [00:03<00:00, 2674.92it/s]
Size of transfer function: 1.36 MB. 

Size of integrand: 28.57 MB. Time to calculate integrand: 0.02221393585205078 s

Getting spherical harmonics
  0%|          | 0/308150 [00:00<?, ?it/s]  2%|▏         | 5226/308150 [00:00<00:05, 50860.93it/s]  3%|▎         | 10313/308150 [00:00<00:05, 49912.84it/s]  5%|▍         | 15305/308150 [00:00<00:06, 44144.66it/s]  6%|▋         | 19783/308150 [00:00<00:06, 42784.83it/s]  8%|▊         | 24522/308150 [00:00<00:06, 43799.96it/s]  9%|▉         | 28944/308150 [00:00<00:06, 42879.44it/s] 11%|█         | 33366/308150 [00:00<00:06, 42658.88it/s] 12%|█▏        | 37788/308150 [00:00<00:06, 41078.01it/s] 14%|█▎        | 42210/308150 [00:00<00:06, 41320.22it/s] 15%|█▌        | 47034/308150 [00:01<00:06, 43290.28it/s] 17%|█▋        | 51858/308150 [00:01<00:05, 43236.17it/s] 18%|█▊        | 56280/308150 [00:01<00:05, 42507.17it/s] 20%|█▉        | 61506/308150 [00:01<00:05, 44847.81it/s] 22%|██▏       | 66732/308150 [00:01<00:05, 45658.48it/s] 23%|██▎       | 71556/308150 [00:01<00:05, 45910.91it/s] 25%|██▍       | 76154/308150 [00:01<00:05, 43130.08it/s] 27%|██▋       | 82812/308150 [00:01<00:04, 49086.69it/s] 28%|██▊       | 87771/308150 [00:01<00:04, 48515.46it/s] 30%|███       | 93264/308150 [00:02<00:04, 50337.49it/s] 32%|███▏      | 98332/308150 [00:02<00:04, 49232.60it/s] 34%|███▍      | 104922/308150 [00:02<00:03, 53194.81it/s] 36%|███▌      | 111354/308150 [00:02<00:03, 55639.31it/s] 38%|███▊      | 118188/308150 [00:02<00:03, 59251.81it/s] 40%|████      | 124139/308150 [00:02<00:03, 57716.75it/s] 42%|████▏     | 129934/308150 [00:02<00:03, 57758.11it/s] 44%|████▍     | 135727/308150 [00:02<00:03, 56654.15it/s] 46%|████▌     | 141906/308150 [00:02<00:02, 57306.38it/s] 48%|████▊     | 147936/308150 [00:02<00:02, 57229.49it/s] 50%|████▉     | 153966/308150 [00:03<00:02, 57099.94it/s] 52%|█████▏    | 161202/308150 [00:03<00:02, 60804.95it/s] 54%|█████▍    | 167290/308150 [00:03<00:02, 58689.54it/s] 56%|█████▌    | 173174/308150 [00:03<00:02, 54520.42it/s] 58%|█████▊    | 178682/308150 [00:03<00:02, 53029.97it/s] 60%|██████    | 185322/308150 [00:03<00:02, 56326.71it/s] 62%|██████▏   | 192156/308150 [00:03<00:01, 59213.30it/s] 64%|██████▍   | 198186/308150 [00:03<00:01, 58434.89it/s] 66%|██████▋   | 204618/308150 [00:03<00:01, 59962.08it/s] 68%|██████▊   | 210644/308150 [00:04<00:01, 57110.82it/s] 70%|███████   | 216397/308150 [00:04<00:01, 52891.68it/s] 72%|███████▏  | 221904/308150 [00:04<00:01, 53430.23it/s] 74%|███████▍  | 229140/308150 [00:04<00:01, 58270.52it/s] 76%|███████▋  | 235034/308150 [00:04<00:01, 56368.62it/s] 78%|███████▊  | 240724/308150 [00:04<00:01, 51520.89it/s] 80%|███████▉  | 245976/308150 [00:04<00:01, 47647.36it/s] 81%|████████▏ | 250848/308150 [00:04<00:01, 47733.98it/s] 84%|████████▎ | 257682/308150 [00:05<00:00, 52877.87it/s] 85%|████████▌ | 263310/308150 [00:05<00:00, 53703.00it/s] 87%|████████▋ | 268753/308150 [00:05<00:00, 53901.85it/s] 89%|████████▉ | 274196/308150 [00:05<00:00, 34966.05it/s] 90%|█████████ | 278570/308150 [00:05<00:00, 34570.11it/s] 92%|█████████▏| 282635/308150 [00:05<00:00, 32950.91it/s] 93%|█████████▎| 287832/308150 [00:05<00:00, 37088.08it/s] 95%|█████████▌| 293862/308150 [00:05<00:00, 42620.27it/s] 97%|█████████▋| 299892/308150 [00:06<00:00, 46791.30it/s] 99%|█████████▉| 304932/308150 [00:06<00:00, 43866.94it/s]100%|██████████| 308150/308150 [00:06<00:00, 49132.12it/s]
The spherical harmonics array is 271.54 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 73.87211894989014 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 26.035558508097196
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.0004, 'pow_max': 0.00045000000000000004, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 17.86it/s] 26%|██▋       | 5/19 [00:00<00:00, 19.58it/s] 42%|████▏     | 8/19 [00:00<00:00, 20.85it/s] 58%|█████▊    | 11/19 [00:00<00:00, 21.80it/s] 74%|███████▎  | 14/19 [00:00<00:00, 21.95it/s] 89%|████████▉ | 17/19 [00:00<00:00, 22.38it/s]100%|██████████| 19/19 [00:00<00:00, 21.80it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4307060 Minimum k_amp 0.00022499170162760515 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 0.49193811416625977 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07154532325994994
Ratio of unique |k|: 0.0019711821985298555
Time to get unique k and theta: 0.9448056221008301 seconds

Getting transfer functions
  0%|          | 0/8490 [00:00<?, ?it/s]  2%|▏         | 180/8490 [00:00<00:04, 1795.50it/s]  5%|▍         | 384/8490 [00:00<00:04, 1914.27it/s]  7%|▋         | 600/8490 [00:00<00:03, 1984.95it/s]  9%|▉         | 804/8490 [00:00<00:03, 1972.81it/s] 12%|█▏        | 1032/8490 [00:00<00:03, 2070.21it/s] 15%|█▍        | 1260/8490 [00:00<00:03, 2125.76it/s] 18%|█▊        | 1488/8490 [00:00<00:03, 2153.56it/s] 20%|██        | 1716/8490 [00:00<00:03, 2189.83it/s] 23%|██▎       | 1944/8490 [00:00<00:02, 2185.62it/s] 26%|██▌       | 2172/8490 [00:01<00:02, 2205.36it/s] 29%|██▊       | 2424/8490 [00:01<00:02, 2290.36it/s] 32%|███▏      | 2724/8490 [00:01<00:02, 2500.92it/s] 35%|███▌      | 2988/8490 [00:01<00:02, 2538.24it/s] 39%|███▊      | 3276/8490 [00:01<00:01, 2635.21it/s] 42%|████▏     | 3552/8490 [00:01<00:01, 2655.92it/s] 45%|████▌     | 3828/8490 [00:01<00:01, 2679.39it/s] 49%|████▉     | 4140/8490 [00:01<00:01, 2785.53it/s] 52%|█████▏    | 4419/8490 [00:01<00:01, 2782.99it/s] 56%|█████▌    | 4716/8490 [00:01<00:01, 2811.69it/s] 59%|█████▉    | 5016/8490 [00:02<00:01, 2830.14it/s] 63%|██████▎   | 5316/8490 [00:02<00:01, 2849.14it/s] 66%|██████▋   | 5628/8490 [00:02<00:00, 2907.56it/s] 70%|███████   | 5952/8490 [00:02<00:00, 2971.58it/s] 74%|███████▎  | 6252/8490 [00:02<00:00, 2961.61it/s] 77%|███████▋  | 6564/8490 [00:02<00:00, 2988.41it/s] 81%|████████  | 6864/8490 [00:02<00:00, 2976.19it/s] 85%|████████▍ | 7176/8490 [00:02<00:00, 3000.91it/s] 88%|████████▊ | 7477/8490 [00:02<00:00, 2923.79it/s] 92%|█████████▏| 7812/8490 [00:02<00:00, 3017.27it/s] 96%|█████████▌| 8115/8490 [00:03<00:00, 2933.62it/s] 99%|█████████▉| 8436/8490 [00:03<00:00, 3002.42it/s]100%|██████████| 8490/8490 [00:03<00:00, 2652.13it/s]
Size of transfer function: 1.36 MB. 

Size of integrand: 28.57 MB. Time to calculate integrand: 0.021363496780395508 s

Getting spherical harmonics
  0%|          | 0/308150 [00:00<?, ?it/s]  2%|▏         | 4824/308150 [00:00<00:06, 46036.30it/s]  3%|▎         | 9428/308150 [00:00<00:06, 44563.86it/s]  5%|▍         | 14472/308150 [00:00<00:06, 45929.43it/s]  6%|▌         | 19065/308150 [00:00<00:06, 45478.07it/s]  8%|▊         | 23612/308150 [00:00<00:06, 41732.42it/s]  9%|▉         | 27825/308150 [00:00<00:06, 40606.94it/s] 11%|█         | 32562/308150 [00:00<00:06, 41950.92it/s] 12%|█▏        | 37206/308150 [00:00<00:06, 43292.47it/s] 13%|█▎        | 41559/308150 [00:00<00:06, 42099.14it/s] 15%|█▌        | 46230/308150 [00:01<00:06, 43199.51it/s] 17%|█▋        | 51456/308150 [00:01<00:05, 45377.30it/s] 18%|█▊        | 56280/308150 [00:01<00:05, 44966.79it/s] 20%|█▉        | 60789/308150 [00:01<00:05, 42044.33it/s] 21%|██▏       | 65526/308150 [00:01<00:05, 43298.19it/s] 23%|██▎       | 69948/308150 [00:01<00:05, 43215.20it/s] 24%|██▍       | 74294/308150 [00:01<00:05, 43262.00it/s] 26%|██▌       | 79194/308150 [00:01<00:05, 44706.51it/s] 27%|██▋       | 84018/308150 [00:01<00:04, 45173.83it/s] 29%|██▉       | 89646/308150 [00:02<00:04, 47648.23it/s] 31%|███       | 95676/308150 [00:02<00:04, 50982.95it/s] 33%|███▎      | 100902/308150 [00:02<00:04, 50695.47it/s] 35%|███▍      | 106932/308150 [00:02<00:03, 52731.17it/s] 36%|███▋      | 112209/308150 [00:02<00:04, 45759.53it/s] 38%|███▊      | 116941/308150 [00:02<00:05, 34722.75it/s] 39%|███▉      | 120887/308150 [00:02<00:07, 25986.95it/s] 40%|████      | 124088/308150 [00:03<00:07, 23133.64it/s] 41%|████      | 126829/308150 [00:03<00:09, 18573.41it/s] 42%|████▏     | 129070/308150 [00:03<00:11, 16160.99it/s] 42%|████▏     | 130957/308150 [00:03<00:10, 16610.50it/s] 44%|████▍     | 136680/308150 [00:03<00:07, 24479.32it/s] 46%|████▌     | 141856/308150 [00:03<00:05, 30419.63it/s] 48%|████▊     | 147132/308150 [00:04<00:04, 35448.77it/s] 50%|████▉     | 153966/308150 [00:04<00:03, 42816.72it/s] 52%|█████▏    | 160800/308150 [00:04<00:02, 49354.25it/s] 54%|█████▍    | 166164/308150 [00:04<00:03, 47135.36it/s] 56%|█████▌    | 171191/308150 [00:04<00:02, 45957.69it/s] 57%|█████▋    | 176005/308150 [00:04<00:02, 45759.45it/s] 59%|█████▉    | 181302/308150 [00:04<00:02, 47685.28it/s] 61%|██████    | 187734/308150 [00:04<00:02, 51503.63it/s] 63%|██████▎   | 192983/308150 [00:04<00:02, 49580.96it/s] 65%|██████▍   | 199794/308150 [00:05<00:02, 53849.77it/s] 67%|██████▋   | 205247/308150 [00:05<00:01, 52707.21it/s] 68%|██████▊   | 210648/308150 [00:05<00:01, 52950.99it/s] 70%|███████   | 215978/308150 [00:05<00:01, 50961.83it/s] 72%|███████▏  | 221904/308150 [00:05<00:01, 53037.08it/s] 74%|███████▍  | 228336/308150 [00:05<00:01, 55090.21it/s] 76%|███████▌  | 234768/308150 [00:05<00:01, 57691.94it/s] 78%|███████▊  | 240566/308150 [00:05<00:01, 57541.55it/s] 80%|███████▉  | 246340/308150 [00:05<00:01, 55462.32it/s] 82%|████████▏ | 252054/308150 [00:05<00:01, 55194.78it/s] 84%|████████▎ | 257682/308150 [00:06<00:00, 55111.98it/s] 86%|████████▌ | 263712/308150 [00:06<00:00, 56137.45it/s] 88%|████████▊ | 269742/308150 [00:06<00:00, 56183.20it/s] 90%|████████▉ | 276174/308150 [00:06<00:00, 58303.36it/s] 92%|█████████▏| 282435/308150 [00:06<00:00, 59558.09it/s] 94%|█████████▎| 288402/308150 [00:06<00:00, 57236.74it/s] 95%|█████████▌| 294150/308150 [00:06<00:00, 56031.01it/s] 97%|█████████▋| 299771/308150 [00:06<00:00, 53780.20it/s] 99%|█████████▉| 306324/308150 [00:06<00:00, 56774.81it/s]100%|██████████| 308150/308150 [00:06<00:00, 44211.90it/s]
The spherical harmonics array is 271.54 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 76.440514087677 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 27.10848428161212
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.0005, 'pow_max': 0.00055, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 16%|█▌        | 3/19 [00:00<00:00, 21.23it/s] 32%|███▏      | 6/19 [00:00<00:00, 22.31it/s] 47%|████▋     | 9/19 [00:00<00:00, 21.85it/s] 63%|██████▎   | 12/19 [00:00<00:00, 22.37it/s] 79%|███████▉  | 15/19 [00:00<00:00, 22.65it/s] 95%|█████████▍| 18/19 [00:00<00:00, 22.24it/s]100%|██████████| 19/19 [00:00<00:00, 22.26it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4307060 Minimum k_amp 0.00022499170162760515 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 0.5123791694641113 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07154532325994994
Ratio of unique |k|: 0.0019711821985298555
Time to get unique k and theta: 1.010467767715454 seconds

Getting transfer functions
  0%|          | 0/8490 [00:00<?, ?it/s]  0%|          | 12/8490 [00:00<02:11, 64.61it/s]  3%|▎         | 228/8490 [00:00<00:08, 969.00it/s]  5%|▌         | 444/8490 [00:00<00:05, 1421.71it/s]  8%|▊         | 672/8490 [00:00<00:04, 1704.71it/s] 11%|█         | 900/8490 [00:00<00:04, 1869.55it/s] 13%|█▎        | 1140/8490 [00:00<00:03, 2004.88it/s] 16%|█▌        | 1368/8490 [00:00<00:03, 2070.01it/s] 19%|█▊        | 1582/8490 [00:00<00:03, 2044.44it/s] 21%|██        | 1800/8490 [00:01<00:03, 2075.95it/s] 24%|██▍       | 2040/8490 [00:01<00:03, 2137.11it/s] 27%|██▋       | 2268/8490 [00:01<00:02, 2159.71it/s] 30%|███       | 2568/8490 [00:01<00:02, 2390.47it/s] 33%|███▎      | 2844/8490 [00:01<00:02, 2491.81it/s] 37%|███▋      | 3132/8490 [00:01<00:02, 2572.78it/s] 40%|████      | 3420/8490 [00:01<00:01, 2642.55it/s] 44%|████▍     | 3732/8490 [00:01<00:01, 2773.17it/s] 47%|████▋     | 4010/8490 [00:01<00:01, 2768.78it/s] 51%|█████     | 4288/8490 [00:01<00:01, 2745.77it/s] 54%|█████▍    | 4572/8490 [00:02<00:01, 2757.23it/s] 57%|█████▋    | 4872/8490 [00:02<00:01, 2807.09it/s] 61%|██████    | 5153/8490 [00:02<00:01, 2804.39it/s] 64%|██████▍   | 5460/8490 [00:02<00:01, 2870.10it/s] 68%|██████▊   | 5760/8490 [00:02<00:00, 2891.24it/s] 72%|███████▏  | 6096/8490 [00:02<00:00, 3004.02it/s] 75%|███████▌  | 6397/8490 [00:02<00:00, 2962.52it/s] 79%|███████▉  | 6696/8490 [00:02<00:00, 2932.17it/s] 83%|████████▎ | 7020/8490 [00:02<00:00, 2999.20it/s] 86%|████████▋ | 7332/8490 [00:02<00:00, 3017.75it/s] 90%|████████▉ | 7634/8490 [00:03<00:00, 2930.98it/s] 93%|█████████▎| 7928/8490 [00:03<00:00, 2925.33it/s] 97%|█████████▋| 8221/8490 [00:03<00:00, 2878.16it/s]100%|██████████| 8490/8490 [00:03<00:00, 2514.89it/s]
Size of transfer function: 1.36 MB. 

Size of integrand: 28.57 MB. Time to calculate integrand: 0.019571781158447266 s

Getting spherical harmonics
  0%|          | 0/308150 [00:00<?, ?it/s]  0%|          | 402/308150 [00:00<01:32, 3315.13it/s]  2%|▏         | 5226/308150 [00:00<00:11, 27365.53it/s]  3%|▎         | 10050/308150 [00:00<00:08, 35989.49it/s]  4%|▍         | 13785/308150 [00:00<00:09, 31441.32it/s]  6%|▌         | 17688/308150 [00:00<00:08, 33536.44it/s]  7%|▋         | 21708/308150 [00:00<00:08, 35171.50it/s]  8%|▊         | 25326/308150 [00:00<00:07, 35357.21it/s]  9%|▉         | 28924/308150 [00:00<00:07, 35400.68it/s] 11%|█         | 32562/308150 [00:00<00:07, 35656.58it/s] 12%|█▏        | 37788/308150 [00:01<00:06, 40246.53it/s] 14%|█▎        | 42210/308150 [00:01<00:06, 39209.98it/s] 15%|█▍        | 46157/308150 [00:01<00:06, 38439.66it/s] 16%|█▋        | 50652/308150 [00:01<00:06, 40254.91it/s] 18%|█▊        | 54700/308150 [00:01<00:06, 39430.59it/s] 19%|█▉        | 58692/308150 [00:01<00:06, 38736.13it/s] 20%|██        | 62712/308150 [00:01<00:06, 38414.93it/s] 22%|██▏       | 66732/308150 [00:01<00:06, 37534.66it/s] 23%|██▎       | 71331/308150 [00:01<00:05, 39929.69it/s] 24%|██▍       | 75345/308150 [00:02<00:06, 38794.60it/s] 26%|██▌       | 79243/308150 [00:02<00:06, 36382.73it/s] 27%|██▋       | 82917/308150 [00:02<00:06, 34193.94it/s] 29%|██▉       | 88842/308150 [00:02<00:05, 40927.44it/s] 30%|███       | 93264/308150 [00:02<00:05, 41490.67it/s] 32%|███▏      | 99294/308150 [00:02<00:04, 46291.07it/s] 34%|███▍      | 104520/308150 [00:02<00:04, 47921.27it/s] 36%|███▌      | 110148/308150 [00:02<00:04, 49286.58it/s] 37%|███▋      | 115113/308150 [00:02<00:04, 46790.07it/s] 39%|███▉      | 121002/308150 [00:03<00:03, 48551.96it/s] 41%|████      | 125887/308150 [00:03<00:03, 46797.61it/s] 43%|████▎     | 132660/308150 [00:03<00:03, 52481.29it/s] 45%|████▌     | 138690/308150 [00:03<00:03, 54332.66it/s] 47%|████▋     | 145524/308150 [00:03<00:02, 57621.77it/s] 49%|████▉     | 151554/308150 [00:03<00:02, 57788.50it/s] 51%|█████▏    | 158388/308150 [00:03<00:02, 59448.69it/s] 53%|█████▎    | 164350/308150 [00:03<00:02, 52931.94it/s] 55%|█████▌    | 169773/308150 [00:03<00:02, 52720.13it/s] 58%|█████▊    | 177282/308150 [00:04<00:02, 58076.10it/s] 59%|█████▉    | 183182/308150 [00:04<00:02, 56836.18it/s] 61%|██████▏   | 188929/308150 [00:04<00:02, 54300.01it/s] 63%|██████▎   | 194568/308150 [00:04<00:02, 54373.08it/s] 65%|██████▍   | 200196/308150 [00:04<00:01, 54180.78it/s] 67%|██████▋   | 205641/308150 [00:04<00:01, 53067.28it/s] 68%|██████▊   | 210967/308150 [00:04<00:01, 52726.64it/s] 71%|███████   | 217482/308150 [00:04<00:01, 55753.87it/s] 72%|███████▏  | 223110/308150 [00:04<00:01, 54578.75it/s] 74%|███████▍  | 228581/308150 [00:05<00:01, 51852.36it/s] 76%|███████▌  | 233795/308150 [00:05<00:01, 50859.66it/s] 78%|███████▊  | 239592/308150 [00:05<00:01, 52118.96it/s] 80%|███████▉  | 245220/308150 [00:05<00:01, 52725.55it/s] 82%|████████▏ | 251250/308150 [00:05<00:01, 54824.56it/s] 83%|████████▎ | 256878/308150 [00:05<00:00, 54891.96it/s] 85%|████████▌ | 262381/308150 [00:05<00:00, 51851.91it/s] 87%|████████▋ | 267605/308150 [00:05<00:00, 51171.39it/s] 89%|████████▊ | 273360/308150 [00:05<00:00, 52546.12it/s] 90%|█████████ | 278637/308150 [00:05<00:00, 52354.65it/s] 92%|█████████▏| 283888/308150 [00:06<00:00, 50350.40it/s] 94%|█████████▍| 288945/308150 [00:06<00:00, 49298.51it/s] 95%|█████████▌| 294264/308150 [00:06<00:00, 49458.69it/s] 97%|█████████▋| 299221/308150 [00:06<00:00, 47279.95it/s] 99%|█████████▉| 305922/308150 [00:06<00:00, 52224.54it/s]100%|██████████| 308150/308150 [00:06<00:00, 46987.46it/s]
The spherical harmonics array is 271.54 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 83.44538140296936 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 27.84734613825286
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.0006, 'pow_max': 0.00065, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 15.31it/s] 21%|██        | 4/19 [00:00<00:00, 16.66it/s] 32%|███▏      | 6/19 [00:00<00:00, 17.58it/s] 42%|████▏     | 8/19 [00:00<00:00, 18.43it/s] 58%|█████▊    | 11/19 [00:00<00:00, 19.76it/s] 74%|███████▎  | 14/19 [00:00<00:00, 20.99it/s] 89%|████████▉ | 17/19 [00:00<00:00, 21.76it/s]100%|██████████| 19/19 [00:00<00:00, 20.36it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4307060 Minimum k_amp 0.00022499170162760515 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 0.49185895919799805 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07154532325994994
Ratio of unique |k|: 0.0019711821985298555
Time to get unique k and theta: 0.9752757549285889 seconds

Getting transfer functions
  0%|          | 0/8490 [00:00<?, ?it/s]  2%|▏         | 180/8490 [00:00<00:04, 1746.62it/s]  5%|▍         | 384/8490 [00:00<00:04, 1871.51it/s]  7%|▋         | 588/8490 [00:00<00:04, 1922.72it/s]  9%|▉         | 781/8490 [00:00<00:04, 1921.68it/s] 12%|█▏        | 984/8490 [00:00<00:03, 1957.81it/s] 14%|█▍        | 1200/8490 [00:00<00:03, 1991.15it/s] 17%|█▋        | 1416/8490 [00:00<00:03, 2006.14it/s] 19%|█▉        | 1632/8490 [00:00<00:03, 2020.33it/s] 22%|██▏       | 1848/8490 [00:00<00:03, 2030.64it/s] 24%|██▍       | 2052/8490 [00:01<00:03, 1985.56it/s] 27%|██▋       | 2268/8490 [00:01<00:03, 2015.23it/s] 30%|██▉       | 2544/8490 [00:01<00:02, 2225.72it/s] 33%|███▎      | 2820/8490 [00:01<00:02, 2381.24it/s] 37%|███▋      | 3120/8490 [00:01<00:02, 2560.42it/s] 40%|████      | 3396/8490 [00:01<00:01, 2615.21it/s] 44%|████▎     | 3696/8490 [00:01<00:01, 2693.98it/s] 47%|████▋     | 4008/8490 [00:01<00:01, 2811.90it/s] 51%|█████     | 4290/8490 [00:01<00:01, 2801.46it/s] 54%|█████▍    | 4596/8490 [00:01<00:01, 2867.89it/s] 58%|█████▊    | 4896/8490 [00:02<00:01, 2893.99it/s] 61%|██████    | 5186/8490 [00:02<00:01, 2868.38it/s] 64%|██████▍   | 5473/8490 [00:02<00:01, 2798.96it/s] 68%|██████▊   | 5772/8490 [00:02<00:00, 2849.54it/s] 72%|███████▏  | 6088/8490 [00:02<00:00, 2940.72it/s] 75%|███████▌  | 6408/8490 [00:02<00:00, 2995.52it/s] 79%|███████▉  | 6708/8490 [00:02<00:00, 2946.61it/s] 82%|████████▏ | 7003/8490 [00:02<00:00, 2943.06it/s] 86%|████████▌ | 7320/8490 [00:02<00:00, 2984.40it/s] 90%|████████▉ | 7620/8490 [00:02<00:00, 2957.57it/s] 93%|█████████▎| 7916/8490 [00:03<00:00, 2897.98it/s] 97%|█████████▋| 8208/8490 [00:03<00:00, 2892.61it/s]100%|██████████| 8490/8490 [00:03<00:00, 2578.09it/s]
Size of transfer function: 1.36 MB. 

Size of integrand: 28.57 MB. Time to calculate integrand: 0.01664423942565918 s

Getting spherical harmonics
  0%|          | 0/308150 [00:00<?, ?it/s]  2%|▏         | 5226/308150 [00:00<00:06, 47949.48it/s]  3%|▎         | 10050/308150 [00:00<00:06, 47249.60it/s]  5%|▍         | 14774/308150 [00:00<00:06, 42955.78it/s]  6%|▌         | 19101/308150 [00:00<00:06, 41347.18it/s]  8%|▊         | 23316/308150 [00:00<00:06, 40779.27it/s]  9%|▉         | 28140/308150 [00:00<00:06, 42782.68it/s] 11%|█         | 32562/308150 [00:00<00:06, 42494.94it/s] 12%|█▏        | 36822/308150 [00:00<00:06, 42358.16it/s] 13%|█▎        | 41065/308150 [00:00<00:06, 42199.13it/s] 15%|█▍        | 45289/308150 [00:01<00:06, 42159.61it/s] 16%|█▋        | 50250/308150 [00:01<00:05, 43838.34it/s] 18%|█▊        | 55476/308150 [00:01<00:05, 45249.34it/s] 19%|█▉        | 59997/308150 [00:01<00:06, 40342.81it/s] 21%|██        | 64722/308150 [00:01<00:05, 40811.05it/s] 22%|██▏       | 68864/308150 [00:01<00:06, 37047.96it/s] 24%|██▎       | 72657/308150 [00:01<00:06, 37041.17it/s] 25%|██▍       | 76782/308150 [00:01<00:06, 36284.31it/s] 27%|██▋       | 82410/308150 [00:01<00:05, 41005.64it/s] 28%|██▊       | 87234/308150 [00:02<00:05, 42444.74it/s] 30%|███       | 93264/308150 [00:02<00:04, 47122.58it/s] 32%|███▏      | 98893/308150 [00:02<00:04, 49720.52it/s] 34%|███▎      | 103927/308150 [00:02<00:04, 48521.64it/s] 35%|███▌      | 109344/308150 [00:02<00:04, 49662.25it/s] 38%|███▊      | 116178/308150 [00:02<00:03, 54904.10it/s] 39%|███▉      | 121712/308150 [00:02<00:03, 50901.73it/s] 41%|████      | 126884/308150 [00:02<00:03, 50132.46it/s] 43%|████▎     | 131953/308150 [00:02<00:03, 48374.41it/s] 44%|████▍     | 137082/308150 [00:03<00:03, 48939.41it/s] 46%|████▌     | 142308/308150 [00:03<00:03, 47946.04it/s] 48%|████▊     | 147130/308150 [00:03<00:03, 45740.43it/s] 49%|████▉     | 151733/308150 [00:03<00:03, 45555.49it/s] 51%|█████     | 157584/308150 [00:03<00:03, 43365.39it/s] 53%|█████▎    | 162408/308150 [00:03<00:03, 44489.84it/s] 55%|█████▍    | 169242/308150 [00:03<00:02, 50434.74it/s] 57%|█████▋    | 174468/308150 [00:03<00:02, 50512.94it/s] 58%|█████▊    | 179694/308150 [00:03<00:02, 50296.29it/s] 60%|██████    | 186126/308150 [00:04<00:02, 53649.67it/s] 62%|██████▏   | 191754/308150 [00:04<00:02, 53147.04it/s] 64%|██████▍   | 197095/308150 [00:04<00:02, 46994.32it/s] 66%|██████▌   | 201928/308150 [00:04<00:02, 47011.01it/s] 68%|██████▊   | 208236/308150 [00:04<00:01, 50852.13it/s] 69%|██████▉   | 213864/308150 [00:04<00:01, 51517.93it/s] 71%|███████   | 219083/308150 [00:04<00:01, 49266.55it/s] 73%|███████▎  | 224068/308150 [00:04<00:02, 39509.55it/s] 74%|███████▍  | 229542/308150 [00:05<00:01, 43113.93it/s] 76%|███████▋  | 235170/308150 [00:05<00:01, 46382.37it/s] 79%|███████▊  | 242004/308150 [00:05<00:01, 51382.57it/s] 80%|████████  | 247373/308150 [00:05<00:01, 51972.58it/s] 82%|████████▏ | 253260/308150 [00:05<00:01, 53541.98it/s] 84%|████████▍ | 259813/308150 [00:05<00:00, 56950.70it/s] 86%|████████▌ | 265615/308150 [00:05<00:00, 55126.85it/s] 88%|████████▊ | 271211/308150 [00:05<00:00, 38344.67it/s] 89%|████████▉ | 275784/308150 [00:06<00:00, 36360.35it/s] 91%|█████████ | 279930/308150 [00:06<00:00, 30283.06it/s] 93%|█████████▎| 285420/308150 [00:06<00:00, 34802.45it/s] 94%|█████████▍| 290646/308150 [00:06<00:00, 38351.80it/s] 97%|█████████▋| 297480/308150 [00:06<00:00, 45172.08it/s] 98%|█████████▊| 302706/308150 [00:06<00:00, 46936.61it/s]100%|██████████| 308150/308150 [00:06<00:00, 45496.78it/s]
The spherical harmonics array is 271.54 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 82.91638159751892 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 28.417339243279326
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.0007, 'pow_max': 0.00075, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 18.84it/s] 26%|██▋       | 5/19 [00:00<00:00, 20.01it/s] 42%|████▏     | 8/19 [00:00<00:00, 21.24it/s] 58%|█████▊    | 11/19 [00:00<00:00, 21.56it/s] 74%|███████▎  | 14/19 [00:00<00:00, 22.14it/s] 89%|████████▉ | 17/19 [00:00<00:00, 22.51it/s]100%|██████████| 19/19 [00:00<00:00, 21.77it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4307060 Minimum k_amp 0.00022499170162760515 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 0.5190379619598389 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07154532325994994
Ratio of unique |k|: 0.0019711821985298555
Time to get unique k and theta: 0.98663330078125 seconds

Getting transfer functions
  0%|          | 0/8490 [00:00<?, ?it/s]  2%|▏         | 192/8490 [00:00<00:04, 1878.91it/s]  5%|▍         | 396/8490 [00:00<00:04, 1963.51it/s]  7%|▋         | 600/8490 [00:00<00:03, 1987.37it/s] 10%|▉         | 828/8490 [00:00<00:03, 2088.14it/s] 13%|█▎        | 1068/8490 [00:00<00:03, 2149.31it/s] 15%|█▌        | 1283/8490 [00:00<00:03, 2143.71it/s] 18%|█▊        | 1498/8490 [00:00<00:03, 2141.96it/s] 20%|██        | 1713/8490 [00:00<00:03, 2074.82it/s] 23%|██▎       | 1932/8490 [00:00<00:03, 2094.92it/s] 26%|██▌       | 2172/8490 [00:01<00:02, 2156.59it/s] 29%|██▊       | 2436/8490 [00:01<00:02, 2292.67it/s] 33%|███▎      | 2760/8490 [00:01<00:02, 2553.49it/s] 36%|███▌      | 3072/8490 [00:01<00:02, 2695.97it/s] 40%|███▉      | 3372/8490 [00:01<00:01, 2751.12it/s] 43%|████▎     | 3648/8490 [00:01<00:01, 2733.24it/s] 46%|████▌     | 3924/8490 [00:01<00:01, 2731.72it/s] 49%|████▉     | 4200/8490 [00:01<00:01, 2736.02it/s] 53%|█████▎    | 4512/8490 [00:01<00:01, 2817.75it/s] 57%|█████▋    | 4812/8490 [00:01<00:01, 2841.36it/s] 60%|██████    | 5124/8490 [00:02<00:01, 2917.11it/s] 64%|██████▍   | 5436/8490 [00:02<00:01, 2970.57it/s] 68%|██████▊   | 5736/8490 [00:02<00:00, 2975.99it/s] 71%|███████   | 6036/8490 [00:02<00:00, 2952.53it/s] 75%|███████▍  | 6348/8490 [00:02<00:00, 2958.02it/s] 78%|███████▊  | 6644/8490 [00:02<00:00, 2953.70it/s] 82%|████████▏ | 6960/8490 [00:02<00:00, 3014.28it/s] 86%|████████▌ | 7262/8490 [00:02<00:00, 3007.54it/s] 89%|████████▉ | 7572/8490 [00:02<00:00, 3004.61it/s] 93%|█████████▎| 7896/8490 [00:02<00:00, 3070.15it/s] 97%|█████████▋| 8204/8490 [00:03<00:00, 2874.43it/s]100%|██████████| 8490/8490 [00:03<00:00, 2648.64it/s]
Size of transfer function: 1.36 MB. 

Size of integrand: 28.57 MB. Time to calculate integrand: 0.025146961212158203 s

Getting spherical harmonics
  0%|          | 0/308150 [00:00<?, ?it/s]  2%|▏         | 5628/308150 [00:00<00:05, 53398.47it/s]  4%|▎         | 10968/308150 [00:00<00:06, 46930.66it/s]  5%|▌         | 15701/308150 [00:00<00:07, 38382.34it/s]  6%|▋         | 19698/308150 [00:00<00:07, 38140.75it/s]  8%|▊         | 23591/308150 [00:00<00:07, 38164.91it/s]  9%|▉         | 27458/308150 [00:00<00:09, 30625.92it/s] 11%|█         | 32562/308150 [00:00<00:07, 35852.20it/s] 12%|█▏        | 37788/308150 [00:00<00:06, 39728.46it/s] 14%|█▎        | 42210/308150 [00:01<00:06, 40047.66it/s] 15%|█▌        | 47034/308150 [00:01<00:06, 41957.77it/s] 17%|█▋        | 51858/308150 [00:01<00:05, 43012.51it/s] 18%|█▊        | 56682/308150 [00:01<00:05, 44429.22it/s] 20%|██        | 61908/308150 [00:01<00:05, 45369.55it/s] 22%|██▏       | 66496/308150 [00:01<00:05, 44816.92it/s] 23%|██▎       | 71154/308150 [00:01<00:05, 44282.54it/s] 25%|██▍       | 75978/308150 [00:01<00:05, 45166.24it/s] 27%|██▋       | 82812/308150 [00:01<00:04, 51476.67it/s] 29%|██▉       | 88842/308150 [00:02<00:04, 53650.72it/s] 31%|███       | 94231/308150 [00:02<00:04, 53035.41it/s] 32%|███▏      | 99551/308150 [00:02<00:04, 51175.22it/s] 34%|███▍      | 105726/308150 [00:02<00:03, 54040.46it/s] 36%|███▋      | 111756/308150 [00:02<00:03, 54254.69it/s] 38%|███▊      | 118590/308150 [00:02<00:03, 57598.23it/s] 40%|████      | 124368/308150 [00:02<00:03, 57346.03it/s] 42%|████▏     | 130115/308150 [00:02<00:03, 53831.02it/s] 44%|████▍     | 135543/308150 [00:02<00:03, 52847.55it/s] 46%|████▌     | 140858/308150 [00:03<00:03, 50524.84it/s] 47%|████▋     | 146289/308150 [00:03<00:03, 51574.11it/s] 49%|████▉     | 151477/308150 [00:03<00:03, 47343.85it/s] 51%|█████     | 156378/308150 [00:03<00:03, 47528.89it/s] 52%|█████▏    | 161186/308150 [00:03<00:03, 46361.66it/s] 54%|█████▍    | 167223/308150 [00:03<00:02, 50262.64it/s] 56%|█████▌    | 172458/308150 [00:03<00:02, 50296.37it/s] 58%|█████▊    | 179292/308150 [00:03<00:02, 55277.21it/s] 60%|██████    | 186126/308150 [00:03<00:02, 58633.39it/s] 62%|██████▏   | 192156/308150 [00:03<00:01, 58711.51it/s] 64%|██████▍   | 198054/308150 [00:04<00:01, 57179.36it/s] 67%|██████▋   | 205422/308150 [00:04<00:01, 60873.05it/s] 69%|██████▊   | 211525/308150 [00:04<00:01, 58830.31it/s] 71%|███████   | 217428/308150 [00:04<00:01, 58295.47it/s] 72%|███████▏  | 223270/308150 [00:04<00:01, 56076.70it/s] 75%|███████▍  | 229944/308150 [00:04<00:01, 58600.65it/s] 77%|███████▋  | 235828/308150 [00:04<00:01, 57681.30it/s] 79%|███████▉  | 243612/308150 [00:04<00:01, 62616.70it/s] 81%|████████  | 249892/308150 [00:04<00:00, 61705.68it/s] 83%|████████▎ | 256075/308150 [00:05<00:00, 60739.17it/s] 85%|████████▌ | 262158/308150 [00:05<00:00, 60719.51it/s] 87%|████████▋ | 268536/308150 [00:05<00:00, 60669.20it/s] 89%|████████▉ | 274968/308150 [00:05<00:00, 61115.46it/s] 91%|█████████ | 281083/308150 [00:05<00:00, 61034.20it/s] 93%|█████████▎| 287189/308150 [00:05<00:00, 59016.43it/s] 95%|█████████▌| 294264/308150 [00:05<00:00, 61940.70it/s] 98%|█████████▊| 301098/308150 [00:05<00:00, 62200.52it/s]100%|█████████▉| 307328/308150 [00:05<00:00, 58541.55it/s]100%|██████████| 308150/308150 [00:05<00:00, 52179.88it/s]
The spherical harmonics array is 271.54 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 82.89015173912048 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 28.895606709595132
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.0008, 'pow_max': 0.0008500000000000001, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 11.81it/s] 21%|██        | 4/19 [00:00<00:01, 13.07it/s] 32%|███▏      | 6/19 [00:00<00:00, 14.00it/s] 42%|████▏     | 8/19 [00:00<00:00, 14.78it/s] 53%|█████▎    | 10/19 [00:00<00:00, 15.76it/s] 63%|██████▎   | 12/19 [00:00<00:00, 16.84it/s] 79%|███████▉  | 15/19 [00:00<00:00, 18.46it/s] 95%|█████████▍| 18/19 [00:01<00:00, 19.80it/s]100%|██████████| 19/19 [00:01<00:00, 17.31it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4307060 Minimum k_amp 0.00022499170162760515 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 0.5295529365539551 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07154532325994994
Ratio of unique |k|: 0.0019711821985298555
Time to get unique k and theta: 1.0908112525939941 seconds

Getting transfer functions
  0%|          | 0/8490 [00:00<?, ?it/s]  1%|          | 72/8490 [00:00<00:11, 719.15it/s]  3%|▎         | 264/8490 [00:00<00:05, 1405.30it/s]  5%|▌         | 456/8490 [00:00<00:05, 1542.11it/s]  8%|▊         | 648/8490 [00:00<00:04, 1660.81it/s] 10%|▉         | 840/8490 [00:00<00:04, 1738.75it/s] 12%|█▏        | 1032/8490 [00:00<00:04, 1782.86it/s] 15%|█▍        | 1236/8490 [00:00<00:03, 1826.27it/s] 17%|█▋        | 1428/8490 [00:00<00:03, 1829.55it/s] 19%|█▉        | 1632/8490 [00:00<00:03, 1859.69it/s] 22%|██▏       | 1836/8490 [00:01<00:03, 1895.36it/s] 24%|██▍       | 2026/8490 [00:01<00:03, 1872.14it/s] 26%|██▌       | 2214/8490 [00:01<00:03, 1871.90it/s] 29%|██▊       | 2424/8490 [00:01<00:03, 1931.67it/s] 32%|███▏      | 2712/8490 [00:01<00:02, 2207.22it/s] 35%|███▌      | 2976/8490 [00:01<00:02, 2311.37it/s] 38%|███▊      | 3252/8490 [00:01<00:02, 2435.54it/s] 42%|████▏     | 3540/8490 [00:01<00:01, 2538.42it/s] 45%|████▌     | 3840/8490 [00:01<00:01, 2635.78it/s] 48%|████▊     | 4116/8490 [00:01<00:01, 2654.13it/s] 52%|█████▏    | 4392/8490 [00:02<00:01, 2681.53it/s] 55%|█████▌    | 4692/8490 [00:02<00:01, 2730.95it/s] 59%|█████▉    | 4992/8490 [00:02<00:01, 2779.73it/s] 62%|██████▏   | 5280/8490 [00:02<00:01, 2808.54it/s] 66%|██████▌   | 5561/8490 [00:02<00:01, 2802.22it/s] 69%|██████▉   | 5842/8490 [00:02<00:00, 2788.50it/s] 72%|███████▏  | 6121/8490 [00:02<00:00, 2777.23it/s] 76%|███████▌  | 6420/8490 [00:02<00:00, 2821.03it/s] 79%|███████▉  | 6720/8490 [00:02<00:00, 2831.22it/s] 83%|████████▎ | 7032/8490 [00:02<00:00, 2908.58it/s] 87%|████████▋ | 7356/8490 [00:03<00:00, 2991.28it/s] 90%|█████████ | 7656/8490 [00:03<00:00, 2987.21it/s] 94%|█████████▎| 7956/8490 [00:03<00:00, 2915.86it/s] 97%|█████████▋| 8248/8490 [00:03<00:00, 2828.77it/s]100%|██████████| 8490/8490 [00:03<00:00, 2431.15it/s]
Size of transfer function: 1.36 MB. 

Size of integrand: 28.57 MB. Time to calculate integrand: 0.015137672424316406 s

Getting spherical harmonics
  0%|          | 0/308150 [00:00<?, ?it/s]  0%|          | 402/308150 [00:00<01:32, 3324.12it/s]  2%|▏         | 5226/308150 [00:00<00:11, 26767.82it/s]  4%|▎         | 10854/308150 [00:00<00:07, 38639.12it/s]  5%|▌         | 15678/308150 [00:00<00:07, 41338.69it/s]  7%|▋         | 20100/308150 [00:00<00:06, 42113.12it/s]  8%|▊         | 24522/308150 [00:00<00:06, 42597.67it/s]  9%|▉         | 28944/308150 [00:00<00:06, 42490.59it/s] 11%|█         | 33768/308150 [00:00<00:06, 44084.07it/s] 12%|█▏        | 38383/308150 [00:00<00:06, 44714.72it/s] 14%|█▍        | 43014/308150 [00:01<00:06, 44085.01it/s] 16%|█▌        | 47838/308150 [00:01<00:05, 44401.87it/s] 17%|█▋        | 52662/308150 [00:01<00:05, 44859.19it/s] 19%|█▉        | 57888/308150 [00:01<00:05, 46354.35it/s] 20%|██        | 62528/308150 [00:01<00:05, 45440.65it/s] 22%|██▏       | 67134/308150 [00:01<00:05, 44746.68it/s] 23%|██▎       | 71612/308150 [00:01<00:05, 44238.30it/s] 25%|██▍       | 76038/308150 [00:01<00:06, 38579.04it/s] 26%|██▋       | 81606/308150 [00:01<00:05, 42605.90it/s] 28%|██▊       | 86832/308150 [00:02<00:04, 44628.81it/s] 30%|███       | 92862/308150 [00:02<00:04, 48464.25it/s] 32%|███▏      | 97799/308150 [00:02<00:04, 48447.30it/s] 33%|███▎      | 102912/308150 [00:02<00:04, 49201.93it/s] 35%|███▌      | 107880/308150 [00:02<00:04, 48867.83it/s] 37%|███▋      | 112800/308150 [00:02<00:04, 48430.14it/s] 38%|███▊      | 117786/308150 [00:02<00:03, 47995.32it/s] 40%|████      | 123414/308150 [00:02<00:03, 49522.68it/s] 42%|████▏     | 128377/308150 [00:02<00:03, 48375.09it/s] 43%|████▎     | 133464/308150 [00:02<00:03, 48366.37it/s] 45%|████▌     | 139092/308150 [00:03<00:03, 50218.79it/s] 47%|████▋     | 144123/308150 [00:03<00:03, 44287.16it/s] 48%|████▊     | 148676/308150 [00:03<00:03, 44262.79it/s] 50%|████▉     | 153189/308150 [00:03<00:03, 44111.85it/s] 51%|█████▏    | 158388/308150 [00:03<00:03, 45696.97it/s] 53%|█████▎    | 164016/308150 [00:03<00:02, 48690.38it/s] 55%|█████▌    | 170046/308150 [00:03<00:02, 51360.93it/s] 57%|█████▋    | 175674/308150 [00:03<00:02, 52457.31it/s] 59%|█████▉    | 181302/308150 [00:03<00:02, 52418.07it/s] 61%|██████    | 187734/308150 [00:04<00:02, 55824.39it/s] 63%|██████▎   | 194166/308150 [00:04<00:01, 57233.85it/s] 65%|██████▍   | 199906/308150 [00:04<00:01, 56922.10it/s] 67%|██████▋   | 205610/308150 [00:04<00:01, 52156.09it/s] 68%|██████▊   | 210904/308150 [00:04<00:01, 50552.98it/s] 70%|███████   | 216015/308150 [00:04<00:01, 48220.60it/s] 72%|███████▏  | 221502/308150 [00:04<00:01, 49636.92it/s] 74%|███████▎  | 227130/308150 [00:04<00:01, 50034.90it/s] 75%|███████▌  | 232165/308150 [00:04<00:01, 49414.29it/s] 77%|███████▋  | 237984/308150 [00:05<00:01, 51803.07it/s] 80%|███████▉  | 245220/308150 [00:05<00:01, 57132.55it/s] 82%|████████▏ | 251250/308150 [00:05<00:00, 57884.05it/s] 83%|████████▎ | 257063/308150 [00:05<00:00, 56272.85it/s] 85%|████████▌ | 262714/308150 [00:05<00:00, 54894.04it/s] 87%|████████▋ | 268223/308150 [00:05<00:01, 36194.79it/s] 88%|████████▊ | 272667/308150 [00:05<00:00, 35687.23it/s] 90%|████████▉ | 276805/308150 [00:06<00:00, 32913.09it/s] 91%|█████████ | 280998/308150 [00:06<00:00, 34767.17it/s] 94%|█████████▎| 288234/308150 [00:06<00:00, 43218.24it/s] 95%|█████████▌| 294264/308150 [00:06<00:00, 46976.45it/s] 97%|█████████▋| 299490/308150 [00:06<00:00, 47419.33it/s] 99%|█████████▉| 304483/308150 [00:06<00:00, 47627.66it/s]100%|██████████| 308150/308150 [00:06<00:00, 44986.49it/s]
The spherical harmonics array is 271.54 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 90.10564923286438 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 28.553284802873918
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.0009, 'pow_max': 0.00095, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 16.62it/s] 21%|██        | 4/19 [00:00<00:00, 17.03it/s] 37%|███▋      | 7/19 [00:00<00:00, 18.87it/s] 53%|█████▎    | 10/19 [00:00<00:00, 20.39it/s] 68%|██████▊   | 13/19 [00:00<00:00, 20.33it/s] 84%|████████▍ | 16/19 [00:00<00:00, 21.21it/s]100%|██████████| 19/19 [00:00<00:00, 21.86it/s]100%|██████████| 19/19 [00:00<00:00, 20.62it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519265089295892
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4307060 Minimum k_amp 0.00022499170162760515 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 0.5324046611785889 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07154532325994994
Ratio of unique |k|: 0.0019711821985298555
Time to get unique k and theta: 0.9932477474212646 seconds

Getting transfer functions
  0%|          | 0/8490 [00:00<?, ?it/s]  1%|▏         | 120/8490 [00:00<00:07, 1158.78it/s]  4%|▎         | 312/8490 [00:00<00:05, 1570.79it/s]  6%|▌         | 528/8490 [00:00<00:04, 1826.30it/s]  9%|▉         | 756/8490 [00:00<00:03, 1961.14it/s] 11%|█▏        | 972/8490 [00:00<00:03, 2028.47it/s] 14%|█▍        | 1200/8490 [00:00<00:03, 2076.98it/s] 17%|█▋        | 1428/8490 [00:00<00:03, 2121.85it/s] 20%|█▉        | 1656/8490 [00:00<00:03, 2140.40it/s] 22%|██▏       | 1896/8490 [00:00<00:02, 2201.82it/s] 25%|██▍       | 2117/8490 [00:01<00:02, 2190.16it/s] 28%|██▊       | 2352/8490 [00:01<00:02, 2229.38it/s] 31%|███       | 2652/8490 [00:01<00:02, 2448.07it/s] 34%|███▍      | 2928/8490 [00:01<00:02, 2511.77it/s] 38%|███▊      | 3216/8490 [00:01<00:02, 2596.17it/s] 42%|████▏     | 3540/8490 [00:01<00:01, 2758.92it/s] 45%|████▌     | 3852/8490 [00:01<00:01, 2847.00it/s] 49%|████▉     | 4140/8490 [00:01<00:01, 2852.89it/s] 52%|█████▏    | 4428/8490 [00:01<00:01, 2843.85it/s] 56%|█████▌    | 4713/8490 [00:01<00:01, 2831.87it/s] 59%|█████▉    | 5004/8490 [00:02<00:01, 2826.47it/s] 62%|██████▏   | 5304/8490 [00:02<00:01, 2869.65it/s] 66%|██████▌   | 5616/8490 [00:02<00:00, 2939.95it/s] 70%|██████▉   | 5940/8490 [00:02<00:00, 3005.57it/s] 74%|███████▎  | 6252/8490 [00:02<00:00, 3006.13it/s] 77%|███████▋  | 6553/8490 [00:02<00:00, 2937.98it/s] 81%|████████  | 6848/8490 [00:02<00:00, 2930.66it/s] 84%|████████▍ | 7142/8490 [00:02<00:00, 2886.22it/s] 88%|████████▊ | 7452/8490 [00:02<00:00, 2927.56it/s] 91%|█████████▏| 7752/8490 [00:02<00:00, 2917.49it/s] 95%|█████████▍| 8052/8490 [00:03<00:00, 2919.10it/s] 98%|█████████▊| 8352/8490 [00:03<00:00, 2942.11it/s]100%|██████████| 8490/8490 [00:03<00:00, 2635.77it/s]
Size of transfer function: 1.36 MB. 

Size of integrand: 28.57 MB. Time to calculate integrand: 0.016234159469604492 s

Getting spherical harmonics
  0%|          | 0/308150 [00:00<?, ?it/s]  2%|▏         | 5226/308150 [00:00<00:06, 48410.57it/s]  3%|▎         | 10068/308150 [00:00<00:06, 46034.35it/s]  5%|▍         | 14673/308150 [00:00<00:07, 41808.13it/s]  6%|▌         | 18882/308150 [00:00<00:07, 40491.60it/s]  7%|▋         | 22944/308150 [00:00<00:07, 39615.46it/s]  9%|▉         | 27336/308150 [00:00<00:06, 40978.76it/s] 10%|█         | 31758/308150 [00:00<00:06, 41518.30it/s] 12%|█▏        | 35920/308150 [00:00<00:06, 40881.17it/s] 13%|█▎        | 40602/308150 [00:00<00:06, 41591.14it/s] 15%|█▍        | 44765/308150 [00:01<00:07, 37156.77it/s] 16%|█▋        | 50250/308150 [00:01<00:06, 40251.87it/s] 18%|█▊        | 54331/308150 [00:01<00:06, 40048.08it/s] 19%|█▉        | 59496/308150 [00:01<00:05, 42761.40it/s] 21%|██        | 64722/308150 [00:01<00:05, 44807.19it/s] 22%|██▏       | 69238/308150 [00:01<00:05, 40320.70it/s] 24%|██▍       | 73366/308150 [00:01<00:06, 38460.46it/s] 26%|██▌       | 78792/308150 [00:01<00:05, 42272.49it/s] 27%|██▋       | 83214/308150 [00:02<00:05, 42544.72it/s] 29%|██▉       | 89244/308150 [00:02<00:04, 45988.56it/s] 31%|███       | 95274/308150 [00:02<00:04, 49043.57it/s] 33%|███▎      | 100216/308150 [00:02<00:04, 49009.51it/s] 34%|███▍      | 105144/308150 [00:02<00:04, 48836.17it/s] 36%|███▌      | 110227/308150 [00:02<00:04, 49410.92it/s] 37%|███▋      | 115183/308150 [00:02<00:03, 48624.85it/s] 39%|███▉      | 120057/308150 [00:02<00:04, 45942.81it/s] 41%|████      | 126228/308150 [00:02<00:03, 50291.95it/s] 43%|████▎     | 131454/308150 [00:02<00:03, 50795.15it/s] 45%|████▍     | 137484/308150 [00:03<00:03, 52939.61it/s] 46%|████▋     | 142805/308150 [00:03<00:03, 51134.06it/s] 48%|████▊     | 148338/308150 [00:03<00:03, 51683.00it/s] 50%|█████     | 154369/308150 [00:03<00:02, 54161.39it/s] 52%|█████▏    | 159811/308150 [00:03<00:03, 42955.95it/s] 54%|█████▎    | 165624/308150 [00:03<00:03, 46122.57it/s] 56%|█████▌    | 171654/308150 [00:03<00:02, 47774.50it/s] 57%|█████▋    | 176880/308150 [00:03<00:02, 48796.64it/s] 59%|█████▉    | 182435/308150 [00:03<00:02, 50630.80it/s] 61%|██████    | 187734/308150 [00:04<00:02, 51099.91it/s] 63%|██████▎   | 192960/308150 [00:04<00:02, 50020.77it/s] 64%|██████▍   | 198186/308150 [00:04<00:02, 49645.56it/s] 66%|██████▌   | 203201/308150 [00:04<00:02, 47385.75it/s] 68%|██████▊   | 208236/308150 [00:04<00:02, 47700.20it/s] 70%|██████▉   | 214266/308150 [00:04<00:01, 50799.18it/s] 72%|███████▏  | 220698/308150 [00:04<00:01, 53638.03it/s] 73%|███████▎  | 226089/308150 [00:04<00:01, 53166.70it/s] 75%|███████▌  | 231424/308150 [00:04<00:01, 52577.27it/s] 77%|███████▋  | 237582/308150 [00:05<00:01, 51319.69it/s] 79%|███████▉  | 243612/308150 [00:05<00:01, 53506.27it/s] 81%|████████  | 250044/308150 [00:05<00:01, 55932.38it/s] 83%|████████▎ | 255667/308150 [00:05<00:00, 53428.88it/s] 85%|████████▍ | 261045/308150 [00:05<00:01, 41572.36it/s] 86%|████████▌ | 265606/308150 [00:05<00:01, 29443.23it/s] 87%|████████▋ | 269274/308150 [00:06<00:01, 24678.76it/s] 88%|████████▊ | 272318/308150 [00:06<00:01, 22327.53it/s] 89%|████████▉ | 274943/308150 [00:06<00:01, 22153.53it/s] 90%|█████████ | 277426/308150 [00:06<00:01, 19450.80it/s] 91%|█████████ | 279570/308150 [00:06<00:01, 18446.93it/s] 91%|█████████▏| 281536/308150 [00:06<00:01, 17302.13it/s] 92%|█████████▏| 283410/308150 [00:06<00:01, 17216.79it/s] 93%|█████████▎| 285420/308150 [00:07<00:01, 16966.41it/s] 93%|█████████▎| 287147/308150 [00:07<00:01, 16800.00it/s] 94%|█████████▎| 288845/308150 [00:07<00:01, 16453.14it/s] 94%|█████████▍| 290646/308150 [00:07<00:01, 16247.43it/s] 95%|█████████▍| 292276/308150 [00:07<00:01, 15675.88it/s] 95%|█████████▌| 293862/308150 [00:07<00:00, 15216.20it/s] 96%|█████████▌| 295872/308150 [00:07<00:00, 15897.11it/s] 97%|█████████▋| 298284/308150 [00:07<00:00, 17946.29it/s] 99%|█████████▉| 304314/308150 [00:08<00:00, 29259.11it/s]100%|██████████| 308150/308150 [00:08<00:00, 38207.82it/s]
The spherical harmonics array is 271.54 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 90.68793201446533 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 28.37020962491814
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.001, 'pow_max': 0.00105, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 18.17it/s] 26%|██▋       | 5/19 [00:00<00:00, 19.61it/s] 42%|████▏     | 8/19 [00:00<00:00, 20.64it/s] 58%|█████▊    | 11/19 [00:00<00:00, 21.34it/s] 74%|███████▎  | 14/19 [00:00<00:00, 21.95it/s] 89%|████████▉ | 17/19 [00:00<00:00, 22.34it/s]100%|██████████| 19/19 [00:00<00:00, 21.71it/s]
Done. k_max for TT ell_max = 0.02261894553888885 k_max for EE ell_max = 0.08519989272692324
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4256996 Minimum k_amp 0.00022499170162760515 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 0.5298523902893066 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.071583106960871
Ratio of unique |k|: 0.0019788602103455112
Time to get unique k and theta: 1.0107438564300537 seconds

Getting transfer functions
  0%|          | 0/8424 [00:00<?, ?it/s]  1%|          | 66/8424 [00:00<00:12, 649.73it/s]  3%|▎         | 275/8424 [00:00<00:05, 1451.64it/s]  6%|▌         | 484/8424 [00:00<00:04, 1703.93it/s]  8%|▊         | 682/8424 [00:00<00:04, 1809.43it/s] 11%|█         | 902/8424 [00:00<00:03, 1914.95it/s] 13%|█▎        | 1122/8424 [00:00<00:03, 1996.63it/s] 16%|█▌        | 1322/8424 [00:00<00:03, 1984.89it/s] 18%|█▊        | 1529/8424 [00:00<00:03, 2008.04it/s] 21%|██        | 1738/8424 [00:00<00:03, 2014.56it/s] 23%|██▎       | 1947/8424 [00:01<00:03, 2029.40it/s] 26%|██▌       | 2178/8424 [00:01<00:02, 2089.27it/s] 29%|██▉       | 2453/8424 [00:01<00:02, 2281.12it/s] 32%|███▏      | 2717/8424 [00:01<00:02, 2379.11it/s] 35%|███▌      | 2981/8424 [00:01<00:02, 2455.37it/s] 39%|███▊      | 3256/8424 [00:01<00:02, 2535.54it/s] 42%|████▏     | 3520/8424 [00:01<00:01, 2535.38it/s] 45%|████▌     | 3806/8424 [00:01<00:01, 2606.30it/s] 48%|████▊     | 4081/8424 [00:01<00:01, 2627.07it/s] 52%|█████▏    | 4356/8424 [00:01<00:01, 2658.88it/s] 55%|█████▍    | 4631/8424 [00:02<00:01, 2682.95it/s] 59%|█████▊    | 4939/8424 [00:02<00:01, 2778.73it/s] 62%|██████▏   | 5217/8424 [00:02<00:01, 2708.58it/s] 65%|██████▌   | 5489/8424 [00:02<00:01, 2647.58it/s] 68%|██████▊   | 5755/8424 [00:02<00:01, 2621.10it/s] 72%|███████▏  | 6039/8424 [00:02<00:00, 2670.32it/s] 75%|███████▌  | 6325/8424 [00:02<00:00, 2724.28it/s] 78%|███████▊  | 6598/8424 [00:02<00:00, 2677.92it/s] 82%|████████▏ | 6867/8424 [00:02<00:00, 2671.46it/s] 85%|████████▍ | 7150/8424 [00:02<00:00, 2686.03it/s] 88%|████████▊ | 7425/8424 [00:03<00:00, 2676.60it/s] 91%|█████████▏| 7700/8424 [00:03<00:00, 2697.65it/s] 95%|█████████▍| 7975/8424 [00:03<00:00, 2711.99it/s] 98%|█████████▊| 8250/8424 [00:03<00:00, 2707.65it/s]100%|██████████| 8424/8424 [00:03<00:00, 2443.75it/s]
Size of transfer function: 1.35 MB. 

Size of integrand: 28.34 MB. Time to calculate integrand: 0.014503240585327148 s

Getting spherical harmonics
  0%|          | 0/304729 [00:00<?, ?it/s]  1%|          | 3176/304729 [00:00<00:10, 29916.66it/s]  3%|▎         | 8337/304729 [00:00<00:07, 41876.81it/s]  4%|▍         | 13101/304729 [00:00<00:07, 40460.36it/s]  6%|▌         | 18262/304729 [00:00<00:06, 43319.44it/s]  7%|▋         | 22629/304729 [00:00<00:06, 42940.48it/s]  9%|▉         | 26935/304729 [00:00<00:06, 40951.46it/s] 10%|█         | 31363/304729 [00:00<00:06, 40946.82it/s] 12%|█▏        | 35469/304729 [00:00<00:07, 38146.79it/s] 13%|█▎        | 39315/304729 [00:00<00:07, 37881.22it/s] 15%|█▍        | 44464/304729 [00:01<00:06, 41060.65it/s] 17%|█▋        | 50419/304729 [00:01<00:05, 45544.65it/s] 18%|█▊        | 55183/304729 [00:01<00:05, 45834.55it/s] 20%|█▉        | 60344/304729 [00:01<00:05, 46772.61it/s] 21%|██▏       | 65108/304729 [00:01<00:05, 46277.20it/s] 23%|██▎       | 69746/304729 [00:01<00:05, 43040.67it/s] 24%|██▍       | 74093/304729 [00:01<00:05, 38749.20it/s] 26%|██▌       | 79003/304729 [00:01<00:05, 41314.87it/s] 27%|██▋       | 83370/304729 [00:01<00:05, 41933.35it/s] 29%|██▉       | 88134/304729 [00:02<00:05, 43106.31it/s] 30%|███       | 92898/304729 [00:02<00:04, 43858.23it/s] 32%|███▏      | 98456/304729 [00:02<00:04, 46204.23it/s] 34%|███▍      | 103220/304729 [00:02<00:04, 45766.55it/s] 35%|███▌      | 107984/304729 [00:02<00:04, 46235.88it/s] 37%|███▋      | 112832/304729 [00:02<00:04, 46885.00it/s] 39%|███▊      | 117535/304729 [00:02<00:04, 46566.81it/s] 40%|████      | 122276/304729 [00:02<00:03, 46479.62it/s] 42%|████▏     | 127040/304729 [00:02<00:03, 46750.51it/s] 43%|████▎     | 131804/304729 [00:03<00:03, 46624.27it/s] 45%|████▌     | 138156/304729 [00:03<00:03, 50892.74it/s] 47%|████▋     | 143714/304729 [00:03<00:03, 52250.36it/s] 49%|████▉     | 149272/304729 [00:03<00:02, 52941.85it/s] 51%|█████     | 154567/304729 [00:03<00:02, 52826.59it/s] 53%|█████▎    | 159991/304729 [00:03<00:02, 52453.82it/s] 54%|█████▍    | 165549/304729 [00:03<00:02, 51850.40it/s] 56%|█████▌    | 171107/304729 [00:03<00:02, 51622.58it/s] 58%|█████▊    | 176665/304729 [00:03<00:02, 52691.72it/s] 60%|█████▉    | 182223/304729 [00:03<00:02, 52324.77it/s] 62%|██████▏   | 187461/304729 [00:04<00:02, 48872.20it/s] 63%|██████▎   | 192942/304729 [00:04<00:02, 50264.78it/s] 66%|██████▌   | 200088/304729 [00:04<00:01, 55758.59it/s] 68%|██████▊   | 205710/304729 [00:04<00:01, 53951.95it/s] 69%|██████▉   | 211204/304729 [00:04<00:01, 53626.00it/s] 72%|███████▏  | 218350/304729 [00:04<00:01, 57147.14it/s] 74%|███████▎  | 224702/304729 [00:04<00:01, 58230.17it/s] 76%|███████▌  | 230657/304729 [00:04<00:01, 58517.09it/s] 78%|███████▊  | 236518/304729 [00:04<00:01, 52821.35it/s] 79%|███████▉  | 242170/304729 [00:05<00:01, 53647.21it/s] 82%|████████▏ | 248795/304729 [00:05<00:00, 57162.13it/s] 84%|████████▎ | 254592/304729 [00:05<00:00, 57164.11it/s] 85%|████████▌ | 260365/304729 [00:05<00:00, 56725.77it/s] 88%|████████▊ | 266784/304729 [00:05<00:00, 57546.02it/s] 89%|████████▉ | 272565/304729 [00:05<00:00, 56625.76it/s] 91%|█████████▏| 278246/304729 [00:05<00:00, 55947.34it/s] 93%|█████████▎| 283855/304729 [00:05<00:00, 55213.64it/s] 95%|█████████▍| 289385/304729 [00:05<00:00, 54533.24it/s] 97%|█████████▋| 294971/304729 [00:05<00:00, 54480.55it/s] 99%|█████████▊| 300423/304729 [00:06<00:00, 53857.27it/s]100%|██████████| 304729/304729 [00:06<00:00, 49298.62it/s]
The spherical harmonics array is 268.53 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 93.07057905197144 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 27.994743034691442
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.0015, 'pow_max': 0.00155, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 15.06it/s] 21%|██        | 4/19 [00:00<00:00, 16.29it/s] 32%|███▏      | 6/19 [00:00<00:00, 17.37it/s] 47%|████▋     | 9/19 [00:00<00:00, 18.83it/s] 63%|██████▎   | 12/19 [00:00<00:00, 20.05it/s] 79%|███████▉  | 15/19 [00:00<00:00, 20.49it/s] 95%|█████████▍| 18/19 [00:00<00:00, 21.03it/s]100%|██████████| 19/19 [00:00<00:00, 19.83it/s]
Done. k_max for TT ell_max = 0.009880133605414064 k_max for EE ell_max = 0.08519563282459129
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 1533490 Minimum k_amp 0.00022499170162760515 n_x_max 72 n_z_max 72
Time to get list of k, phi, theta: 0.18742942810058594 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07497016609172541
Ratio of unique |k|: 0.0027818896764895762
Time to get unique k and theta: 0.3162851333618164 seconds

Getting transfer functions
  0%|          | 0/4266 [00:00<?, ?it/s]  2%|▏         | 96/4266 [00:00<00:04, 940.79it/s]  5%|▍         | 198/4266 [00:00<00:04, 982.93it/s]  7%|▋         | 318/4266 [00:00<00:03, 1080.84it/s] 10%|█         | 438/4266 [00:00<00:03, 1124.91it/s] 13%|█▎        | 552/4266 [00:00<00:03, 1128.79it/s] 16%|█▌        | 672/4266 [00:00<00:03, 1135.34it/s] 19%|█▊        | 792/4266 [00:00<00:03, 1147.53it/s] 22%|██▏       | 918/4266 [00:00<00:02, 1165.12it/s] 24%|██▍       | 1038/4266 [00:00<00:02, 1173.28it/s] 27%|██▋       | 1164/4266 [00:01<00:02, 1192.14it/s] 31%|███▏      | 1338/4266 [00:01<00:02, 1342.56it/s] 36%|███▌      | 1530/4266 [00:01<00:01, 1510.67it/s] 40%|███▉      | 1692/4266 [00:01<00:01, 1543.07it/s] 44%|████▎     | 1866/4266 [00:01<00:01, 1601.82it/s] 48%|████▊     | 2064/4266 [00:01<00:01, 1708.63it/s] 52%|█████▏    | 2235/4266 [00:01<00:01, 1702.56it/s] 57%|█████▋    | 2424/4266 [00:01<00:01, 1756.56it/s] 61%|██████▏   | 2616/4266 [00:01<00:00, 1791.01it/s] 66%|██████▌   | 2796/4266 [00:01<00:00, 1751.36it/s] 70%|██████▉   | 2972/4266 [00:02<00:00, 1751.79it/s] 74%|███████▍  | 3150/4266 [00:02<00:00, 1753.32it/s] 78%|███████▊  | 3336/4266 [00:02<00:00, 1783.40it/s] 82%|████████▏ | 3515/4266 [00:02<00:00, 1775.73it/s] 87%|████████▋ | 3693/4266 [00:02<00:00, 1718.45it/s] 91%|█████████ | 3866/4266 [00:02<00:00, 1717.31it/s] 95%|█████████▌| 4068/4266 [00:02<00:00, 1795.95it/s]100%|█████████▉| 4248/4266 [00:02<00:00, 1777.02it/s]100%|██████████| 4266/4266 [00:02<00:00, 1541.03it/s]
Size of transfer function: 0.68 MB. 

Size of integrand: 14.35 MB. Time to calculate integrand: 0.010029077529907227 s

Getting spherical harmonics
  0%|          | 0/114966 [00:00<?, ?it/s]  3%|▎         | 3900/114966 [00:00<00:02, 38580.05it/s]  7%|▋         | 7759/114966 [00:00<00:02, 37709.17it/s] 10%|█         | 11850/114966 [00:00<00:02, 38274.06it/s] 14%|█▎        | 15678/114966 [00:00<00:02, 35315.67it/s] 17%|█▋        | 19950/114966 [00:00<00:02, 37278.06it/s] 21%|██        | 23703/114966 [00:00<00:02, 36813.01it/s] 24%|██▍       | 27750/114966 [00:00<00:02, 37695.16it/s] 27%|██▋       | 31533/114966 [00:00<00:02, 35840.92it/s] 32%|███▏      | 36300/114966 [00:00<00:02, 39305.98it/s] 36%|███▌      | 41550/114966 [00:01<00:01, 42592.96it/s] 40%|███▉      | 45838/114966 [00:01<00:01, 40020.03it/s] 45%|████▍     | 51450/114966 [00:01<00:01, 43982.30it/s] 49%|████▊     | 55896/114966 [00:01<00:01, 43480.88it/s] 53%|█████▎    | 60450/114966 [00:01<00:01, 43732.16it/s] 57%|█████▋    | 66000/114966 [00:01<00:01, 46795.94it/s] 61%|██████▏   | 70704/114966 [00:01<00:00, 46307.75it/s] 66%|██████▌   | 75352/114966 [00:01<00:00, 45276.35it/s] 70%|███████   | 80550/114966 [00:01<00:00, 46889.11it/s] 74%|███████▍  | 85253/114966 [00:02<00:00, 46613.69it/s] 78%|███████▊  | 89924/114966 [00:02<00:00, 43502.87it/s] 82%|████████▏ | 94650/114966 [00:02<00:00, 44387.19it/s] 86%|████████▌ | 99124/114966 [00:02<00:00, 42566.87it/s] 90%|████████▉ | 103415/114966 [00:02<00:00, 41208.13it/s] 94%|█████████▎| 107562/114966 [00:02<00:00, 38878.23it/s] 98%|█████████▊| 112200/114966 [00:02<00:00, 40775.11it/s]100%|██████████| 114966/114966 [00:02<00:00, 41781.14it/s]
The spherical harmonics array is 101.31 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 78.81024956703186 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 25.944399390472405
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.002, 'pow_max': 0.00205, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 16%|█▌        | 3/19 [00:00<00:00, 21.44it/s] 32%|███▏      | 6/19 [00:00<00:00, 22.24it/s] 47%|████▋     | 9/19 [00:00<00:00, 22.67it/s] 63%|██████▎   | 12/19 [00:00<00:00, 22.27it/s] 79%|███████▉  | 15/19 [00:00<00:00, 22.53it/s] 95%|█████████▍| 18/19 [00:00<00:00, 22.76it/s]100%|██████████| 19/19 [00:00<00:00, 22.37it/s]
Done. k_max for TT ell_max = 0.012366638596575524 k_max for EE ell_max = 0.08519733678552407
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 1913734 Minimum k_amp 0.00022499170162760515 n_x_max 78 n_z_max 78
Time to get list of k, phi, theta: 0.23531293869018555 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0741942192593119
Ratio of unique |k|: 0.002583953673812557
Time to get unique k and theta: 0.4158449172973633 seconds

Getting transfer functions
  0%|          | 0/4945 [00:00<?, ?it/s]  2%|▏         | 112/4945 [00:00<00:04, 1099.48it/s]  5%|▍         | 245/4945 [00:00<00:03, 1232.79it/s]  7%|▋         | 369/4945 [00:00<00:03, 1204.76it/s] 10%|█         | 497/4945 [00:00<00:03, 1218.25it/s] 13%|█▎        | 623/4945 [00:00<00:03, 1220.79it/s] 15%|█▌        | 756/4945 [00:00<00:03, 1253.14it/s] 18%|█▊        | 882/4945 [00:00<00:03, 1248.00it/s] 20%|██        | 1008/4945 [00:00<00:03, 1236.26it/s] 23%|██▎       | 1132/4945 [00:00<00:03, 1230.48it/s] 25%|██▌       | 1256/4945 [00:01<00:03, 1203.23it/s] 28%|██▊       | 1393/4945 [00:01<00:02, 1238.27it/s] 33%|███▎      | 1617/4945 [00:01<00:02, 1518.69it/s] 37%|███▋      | 1841/4945 [00:01<00:01, 1714.64it/s] 41%|████      | 2016/4945 [00:01<00:01, 1721.11it/s] 45%|████▌     | 2226/4945 [00:01<00:01, 1812.32it/s] 49%|████▉     | 2436/4945 [00:01<00:01, 1883.07it/s] 53%|█████▎    | 2639/4945 [00:01<00:01, 1911.81it/s] 58%|█████▊    | 2849/4945 [00:01<00:01, 1951.54it/s] 62%|██████▏   | 3052/4945 [00:01<00:00, 1961.81it/s] 66%|██████▌   | 3255/4945 [00:02<00:00, 1966.29it/s] 70%|██████▉   | 3452/4945 [00:02<00:00, 1891.94it/s] 74%|███████▍  | 3661/4945 [00:02<00:00, 1936.33it/s] 78%|███████▊  | 3871/4945 [00:02<00:00, 1975.71it/s] 82%|████████▏ | 4069/4945 [00:02<00:00, 1954.56it/s] 86%|████████▌ | 4265/4945 [00:02<00:00, 1940.69it/s] 91%|█████████ | 4487/4945 [00:02<00:00, 2011.29it/s] 95%|█████████▍| 4689/4945 [00:02<00:00, 1998.68it/s] 99%|█████████▉| 4893/4945 [00:02<00:00, 1995.45it/s]100%|██████████| 4945/4945 [00:02<00:00, 1696.56it/s]
Size of transfer function: 0.79 MB. 

Size of integrand: 16.64 MB. Time to calculate integrand: 0.010235786437988281 s

Getting spherical harmonics
  0%|          | 0/141988 [00:00<?, ?it/s]  3%|▎         | 4070/141988 [00:00<00:03, 40432.05it/s]  6%|▌         | 8114/141988 [00:00<00:04, 29265.89it/s]  8%|▊         | 11220/141988 [00:00<00:05, 25783.52it/s] 10%|▉         | 13902/141988 [00:00<00:05, 24908.70it/s] 12%|█▏        | 17390/141988 [00:00<00:04, 27900.99it/s] 14%|█▍        | 20535/141988 [00:00<00:04, 28848.10it/s] 17%|█▋        | 23491/141988 [00:00<00:04, 28237.93it/s] 19%|█▉        | 26825/141988 [00:00<00:04, 28602.15it/s] 21%|██        | 29970/141988 [00:01<00:03, 29408.63it/s] 24%|██▎       | 33485/141988 [00:01<00:03, 31030.45it/s] 26%|██▌       | 36815/141988 [00:01<00:03, 31676.85it/s] 29%|██▉       | 40885/141988 [00:01<00:02, 33880.28it/s] 32%|███▏      | 45510/141988 [00:01<00:02, 37152.12it/s] 35%|███▌      | 49950/141988 [00:01<00:02, 39218.69it/s] 38%|███▊      | 54390/141988 [00:01<00:02, 40733.35it/s] 41%|████      | 58477/141988 [00:01<00:02, 38515.93it/s] 44%|████▍     | 62361/141988 [00:01<00:02, 35940.36it/s] 46%|████▋     | 66004/141988 [00:02<00:02, 34864.07it/s] 50%|█████     | 71410/141988 [00:02<00:01, 39483.11it/s] 54%|█████▎    | 76035/141988 [00:02<00:01, 41210.43it/s] 56%|█████▋    | 80199/141988 [00:02<00:01, 40418.08it/s] 60%|█████▉    | 84545/141988 [00:02<00:01, 41215.69it/s] 63%|██████▎   | 89540/141988 [00:02<00:01, 43410.98it/s] 67%|██████▋   | 95090/141988 [00:02<00:01, 46734.84it/s] 70%|███████   | 99787/141988 [00:02<00:00, 45400.22it/s] 73%|███████▎  | 104350/141988 [00:02<00:00, 41324.50it/s] 77%|███████▋  | 109335/141988 [00:02<00:00, 43612.04it/s] 80%|████████  | 113775/141988 [00:03<00:00, 43484.70it/s] 84%|████████▍ | 118955/141988 [00:03<00:00, 45776.50it/s] 87%|████████▋ | 123765/141988 [00:03<00:00, 46035.47it/s] 91%|█████████ | 128760/141988 [00:03<00:00, 47101.94it/s] 94%|█████████▍| 133940/141988 [00:03<00:00, 48248.09it/s] 98%|█████████▊| 138786/141988 [00:03<00:00, 46722.25it/s]100%|██████████| 141988/141988 [00:03<00:00, 38820.92it/s]
The spherical harmonics array is 125.12 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 80.37835049629211 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 24.48602003767168
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.0001, 'pow_max': 0.00015000000000000001, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 16.69it/s] 26%|██▋       | 5/19 [00:00<00:00, 19.66it/s] 42%|████▏     | 8/19 [00:00<00:00, 20.76it/s] 58%|█████▊    | 11/19 [00:00<00:00, 21.31it/s] 74%|███████▎  | 14/19 [00:00<00:00, 21.27it/s] 89%|████████▉ | 17/19 [00:00<00:00, 21.55it/s]100%|██████████| 19/19 [00:00<00:00, 21.13it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4307060 Minimum k_amp 0.00022499170162760515 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 0.5227200984954834 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07154532325994994
Ratio of unique |k|: 0.0019711821985298555
Time to get unique k and theta: 0.9776902198791504 seconds

Getting transfer functions
  0%|          | 0/8490 [00:00<?, ?it/s]  2%|▏         | 156/8490 [00:00<00:05, 1467.71it/s]  4%|▍         | 360/8490 [00:00<00:04, 1753.89it/s]  7%|▋         | 552/8490 [00:00<00:04, 1818.48it/s]  9%|▉         | 744/8490 [00:00<00:04, 1855.02it/s] 11%|█         | 948/8490 [00:00<00:03, 1915.42it/s] 14%|█▎        | 1152/8490 [00:00<00:03, 1927.60it/s] 16%|█▌        | 1356/8490 [00:00<00:03, 1947.79it/s] 19%|█▊        | 1572/8490 [00:00<00:03, 2004.24it/s] 21%|██        | 1788/8490 [00:00<00:03, 2033.87it/s] 24%|██▎       | 2004/8490 [00:01<00:03, 2046.41it/s] 26%|██▌       | 2209/8490 [00:01<00:03, 2028.09it/s] 29%|██▉       | 2472/8490 [00:01<00:02, 2205.06it/s] 33%|███▎      | 2772/8490 [00:01<00:02, 2434.61it/s] 36%|███▌      | 3060/8490 [00:01<00:02, 2559.18it/s] 40%|███▉      | 3372/8490 [00:01<00:01, 2707.73it/s] 43%|████▎     | 3672/8490 [00:01<00:01, 2790.66it/s] 47%|████▋     | 3972/8490 [00:01<00:01, 2821.81it/s] 50%|█████     | 4284/8490 [00:01<00:01, 2893.06it/s] 54%|█████▍    | 4584/8490 [00:01<00:01, 2911.73it/s] 58%|█████▊    | 4884/8490 [00:02<00:01, 2907.69it/s] 61%|██████    | 5184/8490 [00:02<00:01, 2899.01it/s] 65%|██████▍   | 5484/8490 [00:02<00:01, 2919.26it/s] 68%|██████▊   | 5796/8490 [00:02<00:00, 2948.02it/s] 72%|███████▏  | 6096/8490 [00:02<00:00, 2962.28it/s] 76%|███████▌  | 6432/8490 [00:02<00:00, 3039.21it/s] 79%|███████▉  | 6744/8490 [00:02<00:00, 3044.67it/s] 83%|████████▎ | 7049/8490 [00:02<00:00, 3030.63it/s] 87%|████████▋ | 7353/8490 [00:02<00:00, 2963.88it/s] 90%|█████████ | 7656/8490 [00:02<00:00, 2951.75it/s] 94%|█████████▎| 7952/8490 [00:03<00:00, 2939.38it/s] 97%|█████████▋| 8247/8490 [00:03<00:00, 2911.60it/s]100%|██████████| 8490/8490 [00:03<00:00, 2600.82it/s]
Size of transfer function: 1.36 MB. 

Size of integrand: 28.57 MB. Time to calculate integrand: 0.01586437225341797 s

Getting spherical harmonics
  0%|          | 0/308150 [00:00<?, ?it/s]  1%|          | 2814/308150 [00:00<00:11, 27300.50it/s]  3%|▎         | 8040/308150 [00:00<00:07, 41434.22it/s]  4%|▍         | 12609/308150 [00:00<00:06, 43353.60it/s]  6%|▌         | 16952/308150 [00:00<00:07, 37571.33it/s]  7%|▋         | 20810/308150 [00:00<00:09, 31017.19it/s]  8%|▊         | 25326/308150 [00:00<00:08, 34066.65it/s] 10%|▉         | 29748/308150 [00:00<00:07, 35729.78it/s] 11%|█         | 34170/308150 [00:00<00:07, 37452.98it/s] 13%|█▎        | 38592/308150 [00:01<00:07, 38473.27it/s] 14%|█▍        | 42612/308150 [00:01<00:06, 38398.69it/s] 15%|█▌        | 46632/308150 [00:01<00:06, 38217.29it/s] 17%|█▋        | 51858/308150 [00:01<00:06, 41176.78it/s] 18%|█▊        | 56004/308150 [00:01<00:06, 41182.16it/s] 20%|█▉        | 60300/308150 [00:01<00:05, 41528.21it/s] 21%|██        | 64556/308150 [00:01<00:05, 41827.09it/s] 22%|██▏       | 68751/308150 [00:01<00:05, 40275.18it/s] 24%|██▎       | 72796/308150 [00:01<00:06, 35629.95it/s] 25%|██▌       | 77988/308150 [00:02<00:05, 39458.66it/s] 28%|██▊       | 85224/308150 [00:02<00:04, 47957.60it/s] 30%|██▉       | 91254/308150 [00:02<00:04, 50949.22it/s] 31%|███▏      | 96459/308150 [00:02<00:04, 43854.76it/s] 33%|███▎      | 101304/308150 [00:02<00:04, 44648.46it/s] 34%|███▍      | 105945/308150 [00:02<00:04, 44391.87it/s] 36%|███▌      | 111692/308150 [00:02<00:04, 47957.27it/s] 38%|███▊      | 116982/308150 [00:02<00:03, 48787.39it/s] 40%|███▉      | 121949/308150 [00:02<00:04, 44836.13it/s] 41%|████▏     | 127434/308150 [00:03<00:03, 46842.51it/s] 43%|████▎     | 133464/308150 [00:03<00:03, 50000.06it/s] 45%|████▌     | 138690/308150 [00:03<00:03, 50334.53it/s] 47%|████▋     | 144318/308150 [00:03<00:03, 50808.81it/s] 49%|████▉     | 150348/308150 [00:03<00:02, 53054.59it/s] 51%|█████     | 155691/308150 [00:03<00:02, 51811.36it/s] 53%|█████▎    | 162006/308150 [00:03<00:02, 54393.87it/s] 54%|█████▍    | 167471/308150 [00:03<00:02, 52685.32it/s] 56%|█████▌    | 172763/308150 [00:03<00:02, 50066.34it/s] 58%|█████▊    | 178890/308150 [00:04<00:02, 52075.37it/s] 60%|█████▉    | 184518/308150 [00:04<00:02, 52875.81it/s] 62%|██████▏   | 190548/308150 [00:04<00:02, 53549.76it/s] 64%|██████▎   | 196176/308150 [00:04<00:02, 53589.14it/s] 66%|██████▌   | 202206/308150 [00:04<00:01, 54707.20it/s] 67%|██████▋   | 207687/308150 [00:04<00:01, 51815.27it/s] 69%|██████▉   | 213462/308150 [00:04<00:01, 53295.96it/s] 71%|███████   | 218822/308150 [00:04<00:01, 52628.90it/s] 73%|███████▎  | 224105/308150 [00:04<00:01, 49404.20it/s] 74%|███████▍  | 229089/308150 [00:04<00:01, 49201.94it/s] 76%|███████▌  | 234039/308150 [00:05<00:01, 48789.36it/s] 78%|███████▊  | 238937/308150 [00:05<00:01, 47633.43it/s] 79%|███████▉  | 243715/308150 [00:05<00:01, 47380.16it/s] 81%|████████  | 248463/308150 [00:05<00:01, 46231.24it/s] 82%|████████▏ | 253662/308150 [00:05<00:01, 47513.44it/s] 84%|████████▍ | 259692/308150 [00:05<00:00, 50462.30it/s] 86%|████████▌ | 265320/308150 [00:05<00:00, 50949.07it/s] 88%|████████▊ | 270420/308150 [00:05<00:00, 50091.26it/s] 89%|████████▉ | 275772/308150 [00:05<00:00, 50211.70it/s] 91%|█████████ | 280998/308150 [00:06<00:00, 50783.44it/s] 93%|█████████▎| 286224/308150 [00:06<00:00, 50985.11it/s] 95%|█████████▍| 291852/308150 [00:06<00:00, 51658.61it/s] 97%|█████████▋| 297480/308150 [00:06<00:00, 52329.27it/s] 98%|█████████▊| 302714/308150 [00:06<00:00, 48310.02it/s]100%|█████████▉| 307932/308150 [00:06<00:00, 48452.22it/s]100%|██████████| 308150/308150 [00:06<00:00, 46725.54it/s]
The spherical harmonics array is 271.54 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 87.907550573349 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 24.309477892906543
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.0002, 'pow_max': 0.00025, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 12.28it/s] 21%|██        | 4/19 [00:00<00:01, 13.12it/s] 32%|███▏      | 6/19 [00:00<00:00, 13.92it/s] 42%|████▏     | 8/19 [00:00<00:00, 14.77it/s] 53%|█████▎    | 10/19 [00:00<00:00, 15.74it/s] 63%|██████▎   | 12/19 [00:00<00:00, 16.78it/s] 79%|███████▉  | 15/19 [00:00<00:00, 18.34it/s] 95%|█████████▍| 18/19 [00:01<00:00, 19.64it/s]100%|██████████| 19/19 [00:01<00:00, 17.23it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4307060 Minimum k_amp 0.00022499170162760515 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 0.48932671546936035 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07154532325994994
Ratio of unique |k|: 0.0019711821985298555
Time to get unique k and theta: 0.9431965351104736 seconds

Getting transfer functions
  0%|          | 0/8490 [00:00<?, ?it/s]  1%|▏         | 120/8490 [00:00<00:07, 1175.04it/s]  4%|▎         | 312/8490 [00:00<00:05, 1548.85it/s]  6%|▌         | 516/8490 [00:00<00:04, 1743.98it/s]  8%|▊         | 720/8490 [00:00<00:04, 1848.23it/s] 11%|█         | 924/8490 [00:00<00:03, 1911.46it/s] 13%|█▎        | 1128/8490 [00:00<00:03, 1935.91it/s] 16%|█▌        | 1332/8490 [00:00<00:03, 1952.17it/s] 18%|█▊        | 1548/8490 [00:00<00:03, 2009.67it/s] 21%|██        | 1776/8490 [00:00<00:03, 2077.32it/s] 23%|██▎       | 1992/8490 [00:01<00:03, 2080.16it/s] 26%|██▌       | 2208/8490 [00:01<00:03, 2072.84it/s] 29%|██▉       | 2460/8490 [00:01<00:02, 2203.02it/s] 33%|███▎      | 2760/8490 [00:01<00:02, 2417.32it/s] 36%|███▌      | 3036/8490 [00:01<00:02, 2506.51it/s] 39%|███▉      | 3336/8490 [00:01<00:01, 2647.05it/s] 43%|████▎     | 3636/8490 [00:01<00:01, 2744.52it/s] 46%|████▌     | 3924/8490 [00:01<00:01, 2753.29it/s] 50%|████▉     | 4236/8490 [00:01<00:01, 2835.22it/s] 53%|█████▎    | 4524/8490 [00:01<00:01, 2841.18it/s] 57%|█████▋    | 4824/8490 [00:02<00:01, 2877.63it/s] 60%|██████    | 5112/8490 [00:02<00:01, 2856.81it/s] 64%|██████▎   | 5412/8490 [00:02<00:01, 2870.46it/s] 67%|██████▋   | 5700/8490 [00:02<00:00, 2834.26it/s] 71%|███████   | 6012/8490 [00:02<00:00, 2890.85it/s] 74%|███████▍  | 6324/8490 [00:02<00:00, 2957.87it/s] 78%|███████▊  | 6636/8490 [00:02<00:00, 2992.82it/s] 82%|████████▏ | 6936/8490 [00:02<00:00, 2982.68it/s] 85%|████████▌ | 7248/8490 [00:02<00:00, 3016.29it/s] 89%|████████▉ | 7550/8490 [00:02<00:00, 2990.16it/s] 93%|█████████▎| 7860/8490 [00:03<00:00, 3004.36it/s] 96%|█████████▋| 8184/8490 [00:03<00:00, 3049.52it/s]100%|█████████▉| 8489/8490 [00:03<00:00, 2991.74it/s]100%|██████████| 8490/8490 [00:03<00:00, 2588.23it/s]
Size of transfer function: 1.36 MB. 

Size of integrand: 28.57 MB. Time to calculate integrand: 0.02920675277709961 s

Getting spherical harmonics
  0%|          | 0/308150 [00:00<?, ?it/s]  0%|          | 1206/308150 [00:00<00:26, 11434.77it/s]  2%|▏         | 6432/308150 [00:00<00:09, 33275.92it/s]  3%|▎         | 10050/308150 [00:00<00:08, 33694.38it/s]  5%|▍         | 14070/308150 [00:00<00:08, 35707.77it/s]  6%|▌         | 18090/308150 [00:00<00:07, 37137.38it/s]  7%|▋         | 21805/308150 [00:00<00:08, 33273.48it/s]  8%|▊         | 26130/308150 [00:00<00:07, 35505.79it/s] 10%|▉         | 29748/308150 [00:00<00:07, 35584.34it/s] 11%|█         | 33768/308150 [00:00<00:07, 36547.72it/s] 12%|█▏        | 38190/308150 [00:01<00:06, 38634.82it/s] 14%|█▍        | 42612/308150 [00:01<00:06, 39777.79it/s] 15%|█▌        | 46632/308150 [00:01<00:06, 39358.25it/s] 17%|█▋        | 51456/308150 [00:01<00:06, 41818.94it/s] 18%|█▊        | 55878/308150 [00:01<00:05, 42520.35it/s] 20%|█▉        | 60300/308150 [00:01<00:05, 41994.59it/s] 21%|██        | 64511/308150 [00:01<00:06, 39222.56it/s] 22%|██▏       | 68742/308150 [00:01<00:06, 39307.69it/s] 24%|██▎       | 72762/308150 [00:01<00:06, 38880.93it/s] 25%|██▍       | 76669/308150 [00:02<00:07, 30165.22it/s] 27%|██▋       | 82741/308150 [00:02<00:06, 37463.99it/s] 29%|██▊       | 88063/308150 [00:02<00:05, 41472.02it/s] 30%|███       | 93264/308150 [00:02<00:04, 43859.62it/s] 32%|███▏      | 97917/308150 [00:02<00:04, 42661.31it/s] 33%|███▎      | 102912/308150 [00:02<00:04, 43910.76it/s] 35%|███▌      | 108138/308150 [00:02<00:04, 45619.43it/s] 37%|███▋      | 113364/308150 [00:02<00:04, 47344.49it/s] 38%|███▊      | 118590/308150 [00:02<00:03, 48538.75it/s] 40%|████      | 124218/308150 [00:03<00:03, 49916.27it/s] 42%|████▏     | 129254/308150 [00:03<00:03, 49015.76it/s] 44%|████▎     | 134268/308150 [00:03<00:03, 48942.14it/s] 45%|████▌     | 139185/308150 [00:03<00:03, 48706.92it/s] 47%|████▋     | 144318/308150 [00:03<00:03, 48468.49it/s] 48%|████▊     | 149176/308150 [00:03<00:03, 45665.42it/s] 50%|█████     | 155172/308150 [00:03<00:03, 49211.81it/s] 52%|█████▏    | 160800/308150 [00:03<00:02, 50037.32it/s] 54%|█████▍    | 165832/308150 [00:03<00:02, 49504.54it/s] 55%|█████▌    | 170801/308150 [00:04<00:02, 47374.61it/s] 57%|█████▋    | 175674/308150 [00:04<00:02, 47690.26it/s] 59%|█████▊    | 180900/308150 [00:04<00:02, 48812.97it/s] 60%|██████    | 185800/308150 [00:04<00:02, 48689.85it/s] 62%|██████▏   | 190950/308150 [00:04<00:02, 49044.25it/s] 64%|██████▎   | 195864/308150 [00:04<00:02, 48657.28it/s] 65%|██████▌   | 201000/308150 [00:04<00:02, 48910.18it/s] 67%|██████▋   | 207030/308150 [00:04<00:01, 52151.50it/s] 69%|██████▉   | 212255/308150 [00:04<00:01, 51406.14it/s] 71%|███████   | 217404/308150 [00:04<00:01, 50306.65it/s] 72%|███████▏  | 223110/308150 [00:05<00:01, 52193.17it/s] 74%|███████▍  | 229140/308150 [00:05<00:01, 53521.27it/s] 77%|███████▋  | 236778/308150 [00:05<00:01, 57137.83it/s] 79%|███████▊  | 242466/308150 [00:05<00:01, 54735.33it/s] 80%|████████  | 248034/308150 [00:05<00:01, 54742.16it/s] 82%|████████▏ | 253503/308150 [00:05<00:01, 53536.58it/s] 84%|████████▍ | 258853/308150 [00:05<00:01, 48199.79it/s] 86%|████████▌ | 263754/308150 [00:05<00:00, 47994.66it/s] 87%|████████▋ | 269340/308150 [00:05<00:00, 49897.68it/s] 89%|████████▉ | 274968/308150 [00:06<00:00, 51398.41it/s] 91%|█████████ | 280596/308150 [00:06<00:00, 51858.00it/s] 93%|█████████▎| 285814/308150 [00:06<00:00, 51547.53it/s] 94%|█████████▍| 290990/308150 [00:06<00:00, 49799.87it/s] 96%|█████████▌| 295993/308150 [00:06<00:00, 49435.23it/s] 98%|█████████▊| 300951/308150 [00:06<00:00, 49013.89it/s] 99%|█████████▉| 305862/308150 [00:06<00:00, 48514.64it/s]100%|██████████| 308150/308150 [00:06<00:00, 45733.35it/s]
The spherical harmonics array is 271.54 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 84.74696731567383 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 26.11454237991364
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.0003, 'pow_max': 0.00035, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 18.88it/s] 26%|██▋       | 5/19 [00:00<00:00, 20.91it/s] 42%|████▏     | 8/19 [00:00<00:00, 21.40it/s] 58%|█████▊    | 11/19 [00:00<00:00, 21.55it/s] 74%|███████▎  | 14/19 [00:00<00:00, 21.73it/s] 89%|████████▉ | 17/19 [00:00<00:00, 21.86it/s]100%|██████████| 19/19 [00:00<00:00, 21.61it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4307060 Minimum k_amp 0.00022499170162760515 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 0.5527691841125488 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07154532325994994
Ratio of unique |k|: 0.0019711821985298555
Time to get unique k and theta: 1.0934436321258545 seconds

Getting transfer functions
  0%|          | 0/8490 [00:00<?, ?it/s]  2%|▏         | 156/8490 [00:00<00:05, 1502.83it/s]  4%|▍         | 360/8490 [00:00<00:04, 1785.49it/s]  7%|▋         | 564/8490 [00:00<00:04, 1854.37it/s]  9%|▉         | 768/8490 [00:00<00:04, 1892.07it/s] 11%|█▏        | 972/8490 [00:00<00:03, 1927.48it/s] 14%|█▍        | 1176/8490 [00:00<00:03, 1955.77it/s] 16%|█▋        | 1380/8490 [00:00<00:03, 1978.47it/s] 19%|█▊        | 1584/8490 [00:00<00:03, 1974.88it/s] 21%|██        | 1800/8490 [00:00<00:03, 2002.54it/s] 24%|██▎       | 2016/8490 [00:01<00:03, 2022.82it/s] 26%|██▌       | 2220/8490 [00:01<00:03, 2023.76it/s] 29%|██▉       | 2484/8490 [00:01<00:02, 2206.03it/s] 33%|███▎      | 2808/8490 [00:01<00:02, 2494.71it/s] 36%|███▋      | 3096/8490 [00:01<00:02, 2603.26it/s] 40%|████      | 3432/8490 [00:01<00:01, 2819.49it/s] 44%|████▍     | 3732/8490 [00:01<00:01, 2845.08it/s] 47%|████▋     | 4020/8490 [00:01<00:01, 2832.90it/s] 51%|█████     | 4308/8490 [00:01<00:01, 2819.63it/s] 54%|█████▍    | 4620/8490 [00:01<00:01, 2900.85it/s] 58%|█████▊    | 4932/8490 [00:02<00:01, 2950.21it/s] 62%|██████▏   | 5232/8490 [00:02<00:01, 2944.68it/s] 65%|██████▌   | 5532/8490 [00:02<00:01, 2946.50it/s] 69%|██████▊   | 5827/8490 [00:02<00:00, 2925.98it/s] 72%|███████▏  | 6144/8490 [00:02<00:00, 2993.85it/s] 76%|███████▌  | 6456/8490 [00:02<00:00, 2997.25it/s] 80%|███████▉  | 6756/8490 [00:02<00:00, 2928.59it/s] 83%|████████▎ | 7056/8490 [00:02<00:00, 2923.39it/s] 87%|████████▋ | 7356/8490 [00:02<00:00, 2910.67it/s] 90%|█████████ | 7648/8490 [00:02<00:00, 2879.12it/s] 93%|█████████▎| 7937/8490 [00:03<00:00, 2797.32it/s] 97%|█████████▋| 8232/8490 [00:03<00:00, 2833.70it/s]100%|██████████| 8490/8490 [00:03<00:00, 2586.67it/s]
Size of transfer function: 1.36 MB. 

Size of integrand: 28.57 MB. Time to calculate integrand: 0.02212977409362793 s

Getting spherical harmonics
  0%|          | 0/308150 [00:00<?, ?it/s]  0%|          | 402/308150 [00:00<02:16, 2261.78it/s]  1%|          | 3618/308150 [00:00<00:19, 15296.71it/s]  3%|▎         | 8844/308150 [00:00<00:10, 28486.04it/s]  4%|▍         | 12064/308150 [00:00<00:10, 29283.85it/s]  5%|▍         | 15225/308150 [00:00<00:10, 27929.21it/s]  7%|▋         | 20100/308150 [00:00<00:08, 33356.34it/s]  8%|▊         | 23570/308150 [00:00<00:11, 24743.57it/s]  9%|▊         | 26415/308150 [00:01<00:14, 20062.49it/s]  9%|▉         | 28772/308150 [00:01<00:15, 17599.43it/s] 10%|▉         | 30787/308150 [00:01<00:16, 16686.86it/s] 11%|█         | 32617/308150 [00:01<00:17, 15382.56it/s] 11%|█▏        | 35376/308150 [00:01<00:15, 17871.84it/s] 13%|█▎        | 39798/308150 [00:01<00:11, 23946.95it/s] 14%|█▍        | 42490/308150 [00:01<00:10, 24251.82it/s] 15%|█▌        | 46230/308150 [00:02<00:09, 27570.66it/s] 16%|█▌        | 49187/308150 [00:02<00:10, 24885.58it/s] 17%|█▋        | 53466/308150 [00:02<00:08, 29143.23it/s] 19%|█▊        | 57084/308150 [00:02<00:08, 30779.46it/s] 20%|█▉        | 61506/308150 [00:02<00:07, 33773.58it/s] 21%|██        | 65003/308150 [00:02<00:08, 27211.12it/s] 22%|██▏       | 68340/308150 [00:02<00:09, 26494.79it/s] 23%|██▎       | 71181/308150 [00:02<00:09, 25650.93it/s] 25%|██▍       | 76380/308150 [00:03<00:07, 31483.60it/s] 26%|██▋       | 81204/308150 [00:03<00:06, 35058.01it/s] 28%|██▊       | 84871/308150 [00:03<00:09, 24273.40it/s] 29%|██▊       | 87838/308150 [00:03<00:09, 22511.11it/s] 29%|██▉       | 90464/308150 [00:03<00:12, 18039.09it/s] 30%|███       | 92629/308150 [00:03<00:11, 18441.87it/s] 31%|███       | 94747/308150 [00:04<00:11, 18264.10it/s] 31%|███▏      | 96761/308150 [00:04<00:12, 16756.82it/s] 32%|███▏      | 99696/308150 [00:04<00:10, 19435.76it/s] 33%|███▎      | 101821/308150 [00:04<00:10, 19624.39it/s] 34%|███▍      | 104118/308150 [00:04<00:10, 20192.77it/s] 35%|███▍      | 106530/308150 [00:04<00:09, 20551.63it/s] 36%|███▌      | 111354/308150 [00:04<00:07, 27786.79it/s] 37%|███▋      | 114264/308150 [00:04<00:07, 25202.30it/s] 39%|███▊      | 119394/308150 [00:05<00:05, 31770.97it/s] 40%|████      | 123816/308150 [00:05<00:05, 33764.93it/s] 41%|████▏     | 127319/308150 [00:05<00:05, 33800.60it/s] 42%|████▏     | 130788/308150 [00:05<00:05, 30747.30it/s] 43%|████▎     | 133966/308150 [00:05<00:05, 30177.96it/s] 45%|████▍     | 137886/308150 [00:05<00:05, 31657.29it/s] 46%|████▌     | 141906/308150 [00:05<00:04, 33819.69it/s] 47%|████▋     | 145347/308150 [00:05<00:04, 32600.84it/s] 48%|████▊     | 148651/308150 [00:05<00:05, 31332.11it/s] 49%|████▉     | 151818/308150 [00:06<00:05, 31163.76it/s] 51%|█████     | 156780/308150 [00:06<00:04, 35750.61it/s] 53%|█████▎    | 162408/308150 [00:06<00:03, 41215.99it/s] 54%|█████▍    | 167232/308150 [00:06<00:03, 42540.69it/s] 56%|█████▌    | 172056/308150 [00:06<00:03, 40602.01it/s] 57%|█████▋    | 176478/308150 [00:06<00:03, 41379.57it/s] 59%|█████▊    | 180900/308150 [00:06<00:03, 41830.21it/s] 60%|██████    | 185113/308150 [00:06<00:02, 41658.46it/s] 62%|██████▏   | 191352/308150 [00:06<00:02, 45859.45it/s] 64%|██████▍   | 196980/308150 [00:06<00:02, 48284.80it/s] 65%|██████▌   | 201814/308150 [00:07<00:02, 46436.33it/s] 67%|██████▋   | 206469/308150 [00:07<00:02, 46072.24it/s] 69%|██████▊   | 211083/308150 [00:07<00:02, 46044.53it/s] 70%|██████▉   | 215692/308150 [00:07<00:02, 44775.88it/s] 72%|███████▏  | 220698/308150 [00:07<00:01, 45186.03it/s] 73%|███████▎  | 225221/308150 [00:07<00:01, 42287.16it/s] 75%|███████▍  | 230748/308150 [00:07<00:01, 45427.01it/s] 76%|███████▋  | 235331/308150 [00:07<00:01, 43358.45it/s] 78%|███████▊  | 241602/308150 [00:07<00:01, 48473.99it/s] 80%|████████  | 247230/308150 [00:08<00:01, 49521.69it/s] 82%|████████▏ | 252858/308150 [00:08<00:01, 50962.28it/s] 84%|████████▍ | 259692/308150 [00:08<00:00, 54876.15it/s] 86%|████████▌ | 265207/308150 [00:08<00:00, 53140.54it/s] 88%|████████▊ | 270546/308150 [00:08<00:00, 52917.87it/s] 90%|████████▉ | 276174/308150 [00:08<00:00, 51926.99it/s] 91%|█████████▏| 281382/308150 [00:08<00:00, 51588.74it/s] 93%|█████████▎| 287028/308150 [00:08<00:00, 52378.44it/s] 95%|█████████▌| 293460/308150 [00:08<00:00, 54628.72it/s] 97%|█████████▋| 299490/308150 [00:09<00:00, 53203.08it/s] 99%|█████████▉| 304824/308150 [00:09<00:00, 50586.32it/s]100%|██████████| 308150/308150 [00:09<00:00, 32856.55it/s]
The spherical harmonics array is 271.54 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 85.11621308326721 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 28.788179633489356
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.0004, 'pow_max': 0.00045000000000000004, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 19.99it/s] 26%|██▋       | 5/19 [00:00<00:00, 21.48it/s] 42%|████▏     | 8/19 [00:00<00:00, 21.83it/s] 58%|█████▊    | 11/19 [00:00<00:00, 21.97it/s] 74%|███████▎  | 14/19 [00:00<00:00, 22.08it/s] 89%|████████▉ | 17/19 [00:00<00:00, 22.13it/s]100%|██████████| 19/19 [00:00<00:00, 21.97it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4307060 Minimum k_amp 0.00022499170162760515 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 0.4873030185699463 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07154532325994994
Ratio of unique |k|: 0.0019711821985298555
Time to get unique k and theta: 0.9716103076934814 seconds

Getting transfer functions
  0%|          | 0/8490 [00:00<?, ?it/s]  2%|▏         | 168/8490 [00:00<00:05, 1663.79it/s]  5%|▍         | 384/8490 [00:00<00:04, 1933.87it/s]  7%|▋         | 578/8490 [00:00<00:04, 1913.95it/s]  9%|▉         | 770/8490 [00:00<00:04, 1915.47it/s] 11%|█▏        | 972/8490 [00:00<00:03, 1930.71it/s] 14%|█▍        | 1212/8490 [00:00<00:03, 2063.28it/s] 17%|█▋        | 1440/8490 [00:00<00:03, 2123.34it/s] 20%|█▉        | 1668/8490 [00:00<00:03, 2142.83it/s] 22%|██▏       | 1908/8490 [00:00<00:02, 2198.83it/s] 25%|██▌       | 2128/8490 [00:01<00:02, 2184.05it/s] 28%|██▊       | 2388/8490 [00:01<00:02, 2285.81it/s] 32%|███▏      | 2724/8490 [00:01<00:02, 2590.37it/s] 36%|███▌      | 3072/8490 [00:01<00:01, 2834.51it/s] 40%|███▉      | 3384/8490 [00:01<00:01, 2911.31it/s] 43%|████▎     | 3676/8490 [00:01<00:01, 2904.13it/s] 47%|████▋     | 3967/8490 [00:01<00:01, 2899.92it/s] 50%|█████     | 4260/8490 [00:01<00:01, 2894.25it/s] 54%|█████▍    | 4584/8490 [00:01<00:01, 2960.45it/s] 58%|█████▊    | 4908/8490 [00:01<00:01, 3035.02it/s] 62%|██████▏   | 5232/8490 [00:02<00:01, 3073.64it/s] 66%|██████▌   | 5580/8490 [00:02<00:00, 3168.25it/s] 70%|██████▉   | 5916/8490 [00:02<00:00, 3196.42it/s] 74%|███████▎  | 6252/8490 [00:02<00:00, 3204.37it/s] 77%|███████▋  | 6573/8490 [00:02<00:00, 3198.12it/s] 81%|████████  | 6893/8490 [00:02<00:00, 3147.58it/s] 85%|████████▌ | 7248/8490 [00:02<00:00, 3229.12it/s] 89%|████████▉ | 7571/8490 [00:02<00:00, 3164.76it/s] 93%|█████████▎| 7888/8490 [00:02<00:00, 3127.74it/s] 97%|█████████▋| 8201/8490 [00:02<00:00, 3082.94it/s]100%|██████████| 8490/8490 [00:03<00:00, 2751.46it/s]
Size of transfer function: 1.36 MB. 

Size of integrand: 28.57 MB. Time to calculate integrand: 0.021110057830810547 s

Getting spherical harmonics
  0%|          | 0/308150 [00:00<?, ?it/s]  2%|▏         | 4824/308150 [00:00<00:06, 47126.90it/s]  3%|▎         | 9648/308150 [00:00<00:06, 46662.37it/s]  5%|▍         | 14315/308150 [00:00<00:07, 41436.48it/s]  6%|▌         | 18514/308150 [00:00<00:06, 41570.05it/s]  8%|▊         | 23316/308150 [00:00<00:06, 42738.53it/s]  9%|▉         | 27738/308150 [00:00<00:06, 43214.55it/s] 11%|█         | 32562/308150 [00:00<00:06, 44603.97it/s] 12%|█▏        | 37386/308150 [00:00<00:05, 45340.66it/s] 14%|█▎        | 41932/308150 [00:00<00:06, 43766.45it/s] 15%|█▌        | 47436/308150 [00:01<00:05, 46875.60it/s] 17%|█▋        | 52145/308150 [00:01<00:05, 44462.53it/s] 18%|█▊        | 56626/308150 [00:01<00:05, 43469.23it/s] 20%|█▉        | 60997/308150 [00:01<00:05, 42372.34it/s] 21%|██        | 65252/308150 [00:01<00:05, 41595.34it/s] 23%|██▎       | 70350/308150 [00:01<00:05, 43379.84it/s] 24%|██▍       | 74698/308150 [00:01<00:05, 41383.80it/s] 26%|██▌       | 78854/308150 [00:01<00:05, 41252.46it/s] 27%|██▋       | 82991/308150 [00:01<00:05, 40935.26it/s] 29%|██▉       | 89646/308150 [00:02<00:04, 46888.74it/s] 31%|███       | 94325/308150 [00:02<00:04, 45320.49it/s] 32%|███▏      | 99294/308150 [00:02<00:04, 45563.58it/s] 34%|███▍      | 104520/308150 [00:02<00:04, 46988.02it/s] 35%|███▌      | 109344/308150 [00:02<00:04, 47113.03it/s] 37%|███▋      | 115374/308150 [00:02<00:03, 50371.95it/s] 39%|███▉      | 120600/308150 [00:02<00:03, 50897.49it/s] 41%|████      | 127032/308150 [00:02<00:03, 54502.31it/s] 43%|████▎     | 133062/308150 [00:02<00:03, 54397.24it/s] 45%|████▌     | 139092/308150 [00:02<00:03, 55822.75it/s] 47%|████▋     | 144720/308150 [00:03<00:02, 55052.60it/s] 49%|████▉     | 150750/308150 [00:03<00:02, 56131.70it/s] 51%|█████     | 156369/308150 [00:03<00:02, 54130.32it/s] 53%|█████▎    | 161797/308150 [00:03<00:02, 49280.79it/s] 54%|█████▍    | 167232/308150 [00:03<00:02, 50034.18it/s] 56%|█████▌    | 172860/308150 [00:03<00:02, 51543.45it/s] 58%|█████▊    | 178069/308150 [00:03<00:03, 43238.40it/s] 59%|█████▉    | 182639/308150 [00:03<00:02, 43409.04it/s] 61%|██████    | 187155/308150 [00:04<00:02, 42655.47it/s] 63%|██████▎   | 194166/308150 [00:04<00:02, 48852.62it/s] 65%|██████▍   | 199794/308150 [00:04<00:02, 50734.51it/s] 67%|██████▋   | 205824/308150 [00:04<00:01, 52040.06it/s] 69%|██████▊   | 211099/308150 [00:04<00:01, 49940.20it/s] 70%|███████   | 216678/308150 [00:04<00:01, 50190.57it/s] 72%|███████▏  | 222306/308150 [00:04<00:01, 51706.65it/s] 74%|███████▍  | 228173/308150 [00:04<00:01, 53678.68it/s] 76%|███████▌  | 233580/308150 [00:04<00:01, 49210.51it/s] 77%|███████▋  | 238591/308150 [00:05<00:01, 48130.86it/s] 79%|███████▉  | 244014/308150 [00:05<00:01, 48981.46it/s] 81%|████████  | 249642/308150 [00:05<00:01, 50834.56it/s] 83%|████████▎ | 255270/308150 [00:05<00:01, 52256.24it/s] 85%|████████▍ | 260534/308150 [00:05<00:00, 52239.46it/s] 86%|████████▋ | 266124/308150 [00:05<00:00, 52778.96it/s] 88%|████████▊ | 271421/308150 [00:05<00:00, 52406.45it/s] 90%|████████▉ | 276978/308150 [00:05<00:00, 52431.80it/s] 92%|█████████▏| 282231/308150 [00:05<00:00, 50264.87it/s] 93%|█████████▎| 287430/308150 [00:05<00:00, 49142.42it/s] 95%|█████████▌| 293058/308150 [00:06<00:00, 49989.53it/s] 97%|█████████▋| 298070/308150 [00:06<00:00, 40878.88it/s] 99%|█████████▉| 304716/308150 [00:06<00:00, 46806.85it/s]100%|██████████| 308150/308150 [00:06<00:00, 48000.73it/s]
The spherical harmonics array is 271.54 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 77.76756882667542 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 31.034906037869764
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.0005, 'pow_max': 0.00055, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 14.11it/s] 21%|██        | 4/19 [00:00<00:00, 15.09it/s] 32%|███▏      | 6/19 [00:00<00:00, 16.02it/s] 42%|████▏     | 8/19 [00:00<00:00, 17.01it/s] 53%|█████▎    | 10/19 [00:00<00:00, 17.66it/s] 68%|██████▊   | 13/19 [00:00<00:00, 19.23it/s] 84%|████████▍ | 16/19 [00:00<00:00, 19.95it/s]100%|██████████| 19/19 [00:01<00:00, 20.63it/s]100%|██████████| 19/19 [00:01<00:00, 18.78it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4307060 Minimum k_amp 0.00022499170162760515 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 0.5598561763763428 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07154532325994994
Ratio of unique |k|: 0.0019711821985298555
Time to get unique k and theta: 1.1270294189453125 seconds

Getting transfer functions
  0%|          | 0/8490 [00:00<?, ?it/s]  2%|▏         | 144/8490 [00:00<00:06, 1380.38it/s]  4%|▍         | 348/8490 [00:00<00:04, 1728.89it/s]  7%|▋         | 576/8490 [00:00<00:04, 1928.34it/s]  9%|▉         | 792/8490 [00:00<00:03, 1982.36it/s] 12%|█▏        | 1008/8490 [00:00<00:03, 2026.73it/s] 15%|█▍        | 1236/8490 [00:00<00:03, 2085.42it/s] 17%|█▋        | 1445/8490 [00:00<00:03, 2037.25it/s] 20%|█▉        | 1680/8490 [00:00<00:03, 2115.66it/s] 22%|██▏       | 1896/8490 [00:00<00:03, 2126.47it/s] 25%|██▍       | 2109/8490 [00:01<00:03, 2088.91it/s] 27%|██▋       | 2319/8490 [00:01<00:02, 2074.62it/s] 31%|███       | 2640/8490 [00:01<00:02, 2403.39it/s] 34%|███▍      | 2928/8490 [00:01<00:02, 2516.77it/s] 38%|███▊      | 3228/8490 [00:01<00:01, 2657.82it/s] 42%|████▏     | 3528/8490 [00:01<00:01, 2749.32it/s] 45%|████▌     | 3828/8490 [00:01<00:01, 2796.96it/s] 48%|████▊     | 4108/8490 [00:01<00:01, 2787.21it/s] 52%|█████▏    | 4387/8490 [00:01<00:01, 2783.44it/s] 55%|█████▌    | 4680/8490 [00:01<00:01, 2819.11it/s] 59%|█████▊    | 4980/8490 [00:02<00:01, 2853.37it/s] 62%|██████▏   | 5280/8490 [00:02<00:01, 2894.68it/s] 66%|██████▌   | 5580/8490 [00:02<00:01, 2908.04it/s] 70%|██████▉   | 5904/8490 [00:02<00:00, 2993.21it/s] 73%|███████▎  | 6204/8490 [00:02<00:00, 2943.14it/s] 77%|███████▋  | 6528/8490 [00:02<00:00, 3005.61it/s] 81%|████████  | 6840/8490 [00:02<00:00, 3031.51it/s] 85%|████████▍ | 7188/8490 [00:02<00:00, 3131.93it/s] 88%|████████▊ | 7502/8490 [00:02<00:00, 2940.16it/s] 92%|█████████▏| 7799/8490 [00:03<00:00, 2919.63it/s] 96%|█████████▌| 8112/8490 [00:03<00:00, 2952.40it/s] 99%|█████████▉| 8412/8490 [00:03<00:00, 2934.47it/s]100%|██████████| 8490/8490 [00:03<00:00, 2625.59it/s]
Size of transfer function: 1.36 MB. 

Size of integrand: 28.57 MB. Time to calculate integrand: 0.019318819046020508 s

Getting spherical harmonics
  0%|          | 0/308150 [00:00<?, ?it/s]  0%|          | 402/308150 [00:00<03:03, 1675.51it/s]  1%|▏         | 4174/308150 [00:00<00:20, 15127.09it/s]  3%|▎         | 8040/308150 [00:00<00:13, 22787.77it/s]  4%|▎         | 10940/308150 [00:00<00:12, 24332.18it/s]  5%|▌         | 16080/308150 [00:00<00:09, 32125.85it/s]  6%|▋         | 19624/308150 [00:00<00:09, 31369.23it/s]  8%|▊         | 24522/308150 [00:00<00:07, 36258.71it/s]  9%|▉         | 28345/308150 [00:01<00:08, 33487.13it/s] 11%|█         | 32964/308150 [00:01<00:07, 36536.39it/s] 12%|█▏        | 38190/308150 [00:01<00:06, 40162.78it/s] 14%|█▍        | 44220/308150 [00:01<00:05, 45240.49it/s] 16%|█▌        | 48852/308150 [00:01<00:05, 43453.91it/s] 17%|█▋        | 53868/308150 [00:01<00:05, 45006.55it/s] 19%|█▉        | 58437/308150 [00:01<00:05, 44840.22it/s] 20%|██        | 62968/308150 [00:01<00:05, 43149.57it/s] 22%|██▏       | 67323/308150 [00:01<00:05, 41785.61it/s] 23%|██▎       | 71533/308150 [00:01<00:05, 40603.26it/s] 25%|██▍       | 75616/308150 [00:02<00:07, 30914.33it/s] 26%|██▋       | 81606/308150 [00:02<00:06, 37371.94it/s] 28%|██▊       | 86832/308150 [00:02<00:05, 40788.10it/s] 30%|██▉       | 91257/308150 [00:02<00:05, 41295.36it/s] 31%|███▏      | 96882/308150 [00:02<00:04, 44124.58it/s] 33%|███▎      | 102510/308150 [00:02<00:04, 46292.98it/s] 35%|███▍      | 107736/308150 [00:02<00:04, 47635.35it/s] 37%|███▋      | 113766/308150 [00:02<00:03, 50960.63it/s] 39%|███▊      | 118955/308150 [00:03<00:03, 50982.57it/s] 40%|████      | 124620/308150 [00:03<00:03, 52078.11it/s] 42%|████▏     | 130248/308150 [00:03<00:03, 53157.66it/s] 44%|████▍     | 135600/308150 [00:03<00:03, 52819.35it/s] 46%|████▌     | 141906/308150 [00:03<00:03, 55293.20it/s] 48%|████▊     | 147454/308150 [00:03<00:03, 53384.24it/s] 50%|████▉     | 152816/308150 [00:03<00:02, 52201.16it/s] 51%|█████▏    | 158110/308150 [00:03<00:02, 52411.67it/s] 53%|█████▎    | 164820/308150 [00:03<00:02, 55672.97it/s] 55%|█████▌    | 170394/308150 [00:03<00:02, 55280.89it/s] 57%|█████▋    | 175926/308150 [00:04<00:02, 54151.75it/s] 59%|█████▉    | 181346/308150 [00:04<00:02, 53564.37it/s] 61%|██████    | 186706/308150 [00:04<00:02, 53205.80it/s] 63%|██████▎   | 193362/308150 [00:04<00:02, 56437.72it/s] 65%|██████▍   | 199007/308150 [00:04<00:01, 54793.36it/s] 66%|██████▋   | 204618/308150 [00:04<00:01, 54935.68it/s] 68%|██████▊   | 210246/308150 [00:04<00:01, 54598.56it/s] 70%|███████   | 217080/308150 [00:04<00:01, 58055.47it/s] 72%|███████▏  | 222892/308150 [00:04<00:01, 57026.19it/s] 74%|███████▍  | 228601/308150 [00:05<00:01, 55128.67it/s] 76%|███████▌  | 234768/308150 [00:05<00:01, 55340.69it/s] 78%|███████▊  | 240311/308150 [00:05<00:01, 51506.73it/s] 80%|███████▉  | 245622/308150 [00:05<00:01, 51131.45it/s] 81%|████████▏ | 250765/308150 [00:05<00:01, 50988.35it/s] 83%|████████▎ | 256476/308150 [00:05<00:00, 52343.40it/s] 85%|████████▌ | 262908/308150 [00:05<00:00, 55322.13it/s] 88%|████████▊ | 270546/308150 [00:05<00:00, 59849.93it/s] 90%|████████▉ | 276536/308150 [00:05<00:00, 58988.05it/s] 92%|█████████▏| 282438/308150 [00:06<00:00, 57713.34it/s] 94%|█████████▎| 288213/308150 [00:06<00:00, 55625.25it/s] 96%|█████████▌| 294666/308150 [00:06<00:00, 57697.40it/s] 98%|█████████▊| 300696/308150 [00:06<00:00, 57626.52it/s]100%|█████████▉| 306726/308150 [00:06<00:00, 57874.17it/s]100%|██████████| 308150/308150 [00:06<00:00, 47799.10it/s]
The spherical harmonics array is 271.54 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 84.76465773582458 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 32.21553005963582
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.0006, 'pow_max': 0.00065, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 19.27it/s] 26%|██▋       | 5/19 [00:00<00:00, 21.25it/s] 42%|████▏     | 8/19 [00:00<00:00, 21.59it/s] 58%|█████▊    | 11/19 [00:00<00:00, 21.78it/s] 74%|███████▎  | 14/19 [00:00<00:00, 21.97it/s] 89%|████████▉ | 17/19 [00:00<00:00, 22.09it/s]100%|██████████| 19/19 [00:00<00:00, 21.85it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4307060 Minimum k_amp 0.00022499170162760515 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 0.5224499702453613 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07154532325994994
Ratio of unique |k|: 0.0019711821985298555
Time to get unique k and theta: 0.9772317409515381 seconds

Getting transfer functions
  0%|          | 0/8490 [00:00<?, ?it/s]  0%|          | 12/8490 [00:00<01:22, 102.82it/s]  2%|▏         | 192/8490 [00:00<00:08, 1032.31it/s]  5%|▍         | 420/8490 [00:00<00:05, 1557.25it/s]  7%|▋         | 624/8490 [00:00<00:04, 1737.62it/s] 10%|█         | 852/8490 [00:00<00:04, 1909.21it/s] 13%|█▎        | 1080/8490 [00:00<00:03, 2019.85it/s] 15%|█▌        | 1308/8490 [00:00<00:03, 2097.37it/s] 18%|█▊        | 1548/8490 [00:00<00:03, 2167.37it/s] 21%|██        | 1788/8490 [00:00<00:03, 2205.93it/s] 24%|██▎       | 2016/8490 [00:01<00:02, 2216.06it/s] 27%|██▋       | 2256/8490 [00:01<00:02, 2238.36it/s] 30%|███       | 2568/8490 [00:01<00:02, 2494.23it/s] 34%|███▍      | 2880/8490 [00:01<00:02, 2679.29it/s] 37%|███▋      | 3168/8490 [00:01<00:01, 2728.14it/s] 41%|████      | 3456/8490 [00:01<00:01, 2752.17it/s] 44%|████▍     | 3744/8490 [00:01<00:01, 2787.59it/s] 48%|████▊     | 4044/8490 [00:01<00:01, 2820.29it/s] 51%|█████▏    | 4368/8490 [00:01<00:01, 2935.58it/s] 55%|█████▌    | 4680/8490 [00:01<00:01, 2964.62it/s] 59%|█████▉    | 5016/8490 [00:02<00:01, 3043.89it/s] 63%|██████▎   | 5321/8490 [00:02<00:01, 3028.76it/s] 66%|██████▌   | 5624/8490 [00:02<00:00, 2998.80it/s] 70%|███████   | 5952/8490 [00:02<00:00, 3051.63it/s] 74%|███████▎  | 6258/8490 [00:02<00:00, 3018.26it/s] 78%|███████▊  | 6588/8490 [00:02<00:00, 3076.98it/s] 81%|████████▏ | 6900/8490 [00:02<00:00, 3056.82it/s] 85%|████████▍ | 7206/8490 [00:02<00:00, 3057.35it/s] 89%|████████▉ | 7536/8490 [00:02<00:00, 3114.72it/s] 93%|█████████▎| 7872/8490 [00:02<00:00, 3151.61it/s] 97%|█████████▋| 8196/8490 [00:03<00:00, 3145.38it/s]100%|██████████| 8490/8490 [00:03<00:00, 2665.17it/s]
Size of transfer function: 1.36 MB. 

Size of integrand: 28.57 MB. Time to calculate integrand: 0.022957324981689453 s

Getting spherical harmonics
  0%|          | 0/308150 [00:00<?, ?it/s]  0%|          | 402/308150 [00:00<01:53, 2721.01it/s]  2%|▏         | 6030/308150 [00:00<00:10, 27644.64it/s]  4%|▎         | 10854/308150 [00:00<00:08, 35440.73it/s]  5%|▍         | 14680/308150 [00:00<00:08, 35556.69it/s]  6%|▌         | 18407/308150 [00:00<00:08, 36033.05it/s]  7%|▋         | 22124/308150 [00:00<00:08, 33695.94it/s]  8%|▊         | 25589/308150 [00:00<00:08, 32218.36it/s]  9%|▉         | 28879/308150 [00:01<00:12, 22017.44it/s] 10%|█         | 31519/308150 [00:01<00:14, 18477.56it/s] 11%|█         | 33724/308150 [00:01<00:16, 16546.16it/s] 12%|█▏        | 35627/308150 [00:01<00:18, 14620.83it/s] 12%|█▏        | 37266/308150 [00:01<00:18, 14679.51it/s] 13%|█▎        | 38860/308150 [00:01<00:21, 12699.17it/s] 13%|█▎        | 40236/308150 [00:02<00:22, 12132.54it/s] 14%|█▎        | 41808/308150 [00:02<00:21, 12277.42it/s] 14%|█▍        | 43416/308150 [00:02<00:20, 12993.91it/s] 15%|█▍        | 44768/308150 [00:02<00:20, 13008.57it/s] 15%|█▌        | 46230/308150 [00:02<00:20, 12750.56it/s] 15%|█▌        | 47531/308150 [00:02<00:20, 12728.74it/s] 16%|█▌        | 49044/308150 [00:02<00:19, 13119.07it/s] 16%|█▋        | 50371/308150 [00:02<00:19, 13153.44it/s] 17%|█▋        | 52260/308150 [00:02<00:18, 13858.00it/s] 17%|█▋        | 53868/308150 [00:03<00:19, 13042.45it/s] 18%|█▊        | 55476/308150 [00:03<00:18, 13634.61it/s] 19%|█▊        | 57084/308150 [00:03<00:18, 13656.72it/s] 19%|█▉        | 58692/308150 [00:03<00:18, 13856.10it/s] 20%|█▉        | 60300/308150 [00:03<00:17, 14131.31it/s] 20%|██        | 61908/308150 [00:03<00:17, 13964.36it/s] 21%|██        | 63516/308150 [00:03<00:17, 14365.53it/s] 21%|██        | 65124/308150 [00:03<00:16, 14532.71it/s] 22%|██▏       | 66732/308150 [00:03<00:16, 14372.97it/s] 22%|██▏       | 68340/308150 [00:04<00:16, 14164.05it/s] 23%|██▎       | 69948/308150 [00:04<00:16, 14276.74it/s] 23%|██▎       | 71958/308150 [00:04<00:15, 14880.35it/s] 24%|██▍       | 73566/308150 [00:04<00:15, 14968.96it/s] 24%|██▍       | 75174/308150 [00:04<00:15, 15073.88it/s] 25%|██▍       | 76782/308150 [00:04<00:15, 14944.24it/s] 26%|██▌       | 79194/308150 [00:04<00:13, 16743.62it/s] 26%|██▋       | 81606/308150 [00:04<00:12, 18216.42it/s] 27%|██▋       | 83424/308150 [00:05<00:13, 16923.55it/s] 28%|██▊       | 85125/308150 [00:05<00:14, 15738.57it/s] 28%|██▊       | 86713/308150 [00:05<00:14, 15603.57it/s] 29%|██▊       | 88440/308150 [00:05<00:14, 15530.41it/s] 29%|██▉       | 90852/308150 [00:05<00:12, 16978.83it/s] 30%|███       | 92550/308150 [00:05<00:13, 15750.65it/s] 31%|███       | 94470/308150 [00:05<00:12, 16531.87it/s] 31%|███       | 96139/308150 [00:05<00:13, 16238.46it/s] 32%|███▏      | 97772/308150 [00:05<00:13, 15275.94it/s] 32%|███▏      | 99312/308150 [00:06<00:14, 14386.65it/s] 33%|███▎      | 100902/308150 [00:06<00:14, 14456.72it/s] 33%|███▎      | 102912/308150 [00:06<00:13, 15141.15it/s] 34%|███▍      | 104520/308150 [00:06<00:13, 15326.90it/s] 34%|███▍      | 106128/308150 [00:06<00:13, 15234.90it/s] 35%|███▍      | 107655/308150 [00:06<00:13, 15219.35it/s] 35%|███▌      | 109180/308150 [00:06<00:14, 14191.47it/s] 36%|███▌      | 110611/308150 [00:06<00:14, 13470.06it/s] 36%|███▋      | 112158/308150 [00:06<00:14, 13928.37it/s] 37%|███▋      | 113766/308150 [00:07<00:13, 14443.10it/s] 37%|███▋      | 115468/308150 [00:07<00:12, 15172.05it/s] 38%|███▊      | 117384/308150 [00:07<00:12, 15810.48it/s] 39%|███▊      | 118992/308150 [00:07<00:12, 14735.86it/s] 39%|███▉      | 120600/308150 [00:07<00:12, 15051.23it/s] 40%|███▉      | 122208/308150 [00:07<00:12, 15211.50it/s] 40%|████      | 123816/308150 [00:07<00:12, 15295.49it/s] 41%|████      | 125424/308150 [00:07<00:12, 14735.93it/s] 41%|████      | 127032/308150 [00:07<00:12, 14101.77it/s] 42%|████▏     | 128640/308150 [00:08<00:12, 14575.72it/s] 42%|████▏     | 130248/308150 [00:08<00:12, 14817.16it/s] 43%|████▎     | 131740/308150 [00:08<00:11, 14754.89it/s] 43%|████▎     | 133223/308150 [00:08<00:12, 13872.42it/s] 44%|████▎     | 134670/308150 [00:08<00:12, 13678.05it/s] 44%|████▍     | 136278/308150 [00:08<00:12, 14317.11it/s] 45%|████▍     | 137886/308150 [00:08<00:11, 14618.42it/s] 45%|████▌     | 139494/308150 [00:08<00:11, 14830.41it/s] 47%|████▋     | 146328/308150 [00:08<00:05, 29976.72it/s] 48%|████▊     | 149369/308150 [00:09<00:05, 28333.57it/s] 49%|████▉     | 152248/308150 [00:09<00:07, 20847.07it/s] 50%|█████     | 154639/308150 [00:09<00:08, 18387.65it/s] 51%|█████     | 156721/308150 [00:09<00:08, 17505.35it/s] 51%|█████▏    | 158634/308150 [00:09<00:09, 15054.58it/s] 52%|█████▏    | 160285/308150 [00:09<00:09, 15253.57it/s] 53%|█████▎    | 162006/308150 [00:09<00:09, 15471.64it/s] 53%|█████▎    | 163635/308150 [00:10<00:09, 15611.63it/s] 54%|█████▎    | 165257/308150 [00:10<00:09, 14963.00it/s] 54%|█████▍    | 166795/308150 [00:10<00:09, 14900.32it/s] 55%|█████▍    | 168314/308150 [00:10<00:09, 14315.94it/s] 55%|█████▌    | 169766/308150 [00:10<00:09, 14162.48it/s] 56%|█████▌    | 171252/308150 [00:10<00:09, 13921.35it/s] 56%|█████▌    | 173262/308150 [00:10<00:09, 14612.11it/s] 57%|█████▋    | 174870/308150 [00:10<00:09, 14579.33it/s] 57%|█████▋    | 176478/308150 [00:11<00:10, 13140.39it/s] 58%|█████▊    | 178890/308150 [00:11<00:08, 14584.86it/s] 59%|█████▊    | 180359/308150 [00:11<00:09, 13816.32it/s] 59%|█████▉    | 181745/308150 [00:11<00:09, 13781.23it/s] 59%|█████▉    | 183312/308150 [00:11<00:09, 13412.40it/s] 60%|██████    | 184920/308150 [00:11<00:08, 13897.26it/s] 60%|██████    | 186317/308150 [00:11<00:08, 13735.30it/s] 61%|██████    | 188136/308150 [00:11<00:08, 13861.98it/s] 62%|██████▏   | 190146/308150 [00:11<00:07, 15154.57it/s] 62%|██████▏   | 192156/308150 [00:12<00:07, 16175.48it/s] 63%|██████▎   | 193785/308150 [00:12<00:07, 14333.57it/s] 64%|██████▎   | 195774/308150 [00:12<00:07, 15608.83it/s] 64%|██████▍   | 197784/308150 [00:12<00:06, 16524.94it/s] 65%|██████▍   | 199474/308150 [00:12<00:06, 16575.93it/s] 65%|██████▌   | 201158/308150 [00:12<00:06, 15741.61it/s] 66%|██████▌   | 202756/308150 [00:12<00:07, 14390.27it/s] 66%|██████▋   | 204618/308150 [00:12<00:07, 14362.89it/s] 67%|██████▋   | 206628/308150 [00:13<00:06, 14918.56it/s] 68%|██████▊   | 208236/308150 [00:13<00:06, 15028.33it/s] 68%|██████▊   | 209844/308150 [00:13<00:06, 14949.70it/s] 69%|██████▊   | 211452/308150 [00:13<00:06, 14747.54it/s] 69%|██████▉   | 213462/308150 [00:13<00:06, 15435.08it/s] 70%|██████▉   | 215008/308150 [00:13<00:06, 15039.87it/s] 70%|███████   | 216513/308150 [00:13<00:06, 13889.00it/s] 71%|███████   | 217913/308150 [00:13<00:06, 13828.12it/s] 71%|███████   | 219492/308150 [00:13<00:06, 14041.42it/s] 72%|███████▏  | 221100/308150 [00:14<00:06, 13917.37it/s] 72%|███████▏  | 222708/308150 [00:14<00:06, 13589.03it/s] 73%|███████▎  | 224718/308150 [00:14<00:05, 15175.06it/s] 73%|███████▎  | 226326/308150 [00:14<00:05, 15289.79it/s] 74%|███████▍  | 228336/308150 [00:14<00:05, 15274.76it/s] 75%|███████▍  | 230346/308150 [00:14<00:05, 14774.47it/s] 75%|███████▌  | 231954/308150 [00:14<00:05, 14857.38it/s] 76%|███████▌  | 233964/308150 [00:14<00:04, 15863.67it/s] 76%|███████▋  | 235565/308150 [00:14<00:04, 15603.21it/s] 77%|███████▋  | 237134/308150 [00:15<00:04, 15307.83it/s] 77%|███████▋  | 238788/308150 [00:15<00:04, 15310.50it/s] 78%|███████▊  | 240323/308150 [00:15<00:04, 14247.57it/s] 78%|███████▊  | 241760/308150 [00:15<00:05, 12374.55it/s] 79%|███████▉  | 243612/308150 [00:15<00:04, 13047.44it/s] 80%|███████▉  | 245622/308150 [00:15<00:04, 14463.24it/s] 80%|████████  | 247106/308150 [00:15<00:04, 13778.52it/s] 81%|████████  | 248838/308150 [00:15<00:04, 14468.75it/s] 81%|████████  | 250311/308150 [00:16<00:04, 13655.92it/s] 82%|████████▏ | 251698/308150 [00:16<00:04, 13002.55it/s] 82%|████████▏ | 253662/308150 [00:16<00:03, 14640.99it/s] 83%|████████▎ | 255672/308150 [00:16<00:03, 14719.34it/s] 83%|████████▎ | 257164/308150 [00:16<00:03, 14493.05it/s] 84%|████████▍ | 258626/308150 [00:16<00:03, 14489.25it/s] 85%|████████▍ | 261300/308150 [00:16<00:02, 16111.11it/s] 85%|████████▌ | 262908/308150 [00:16<00:02, 15764.50it/s] 86%|████████▌ | 264516/308150 [00:17<00:03, 14350.27it/s] 86%|████████▋ | 265957/308150 [00:17<00:03, 13595.95it/s] 87%|████████▋ | 267330/308150 [00:17<00:03, 13443.33it/s] 87%|████████▋ | 269340/308150 [00:17<00:02, 14780.36it/s] 88%|████████▊ | 271752/308150 [00:17<00:02, 16795.34it/s] 89%|████████▊ | 273442/308150 [00:17<00:02, 15452.50it/s] 89%|████████▉ | 275008/308150 [00:17<00:02, 14311.81it/s] 90%|█████████ | 277380/308150 [00:17<00:02, 15242.20it/s] 91%|█████████ | 278913/308150 [00:17<00:01, 14812.23it/s] 91%|█████████ | 280396/308150 [00:18<00:02, 13251.95it/s] 91%|█████████▏| 281740/308150 [00:18<00:02, 12489.33it/s] 92%|█████████▏| 283812/308150 [00:18<00:01, 14263.79it/s] 93%|█████████▎| 285271/308150 [00:18<00:01, 14115.04it/s] 93%|█████████▎| 287832/308150 [00:18<00:01, 16586.50it/s] 94%|█████████▍| 289842/308150 [00:18<00:01, 16525.64it/s] 95%|█████████▍| 291852/308150 [00:18<00:01, 15770.98it/s] 95%|█████████▌| 293448/308150 [00:18<00:00, 15496.49it/s] 96%|█████████▌| 295008/308150 [00:19<00:00, 14729.02it/s] 96%|█████████▌| 296489/308150 [00:19<00:00, 14397.86it/s] 97%|█████████▋| 297932/308150 [00:19<00:00, 13976.29it/s] 97%|█████████▋| 299490/308150 [00:19<00:00, 14098.58it/s] 98%|█████████▊| 300901/308150 [00:19<00:00, 13993.99it/s] 98%|█████████▊| 302304/308150 [00:19<00:00, 13729.49it/s] 99%|█████████▉| 304314/308150 [00:19<00:00, 14966.51it/s] 99%|█████████▉| 305808/308150 [00:19<00:00, 14775.33it/s]100%|██████████| 308150/308150 [00:19<00:00, 15487.27it/s]
The spherical harmonics array is 271.54 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 102.12723088264465 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 33.2577042558912
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.0007, 'pow_max': 0.00075, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 14.08it/s] 21%|██        | 4/19 [00:00<00:00, 15.45it/s] 32%|███▏      | 6/19 [00:00<00:00, 16.09it/s] 42%|████▏     | 8/19 [00:00<00:00, 17.34it/s] 58%|█████▊    | 11/19 [00:00<00:00, 19.02it/s] 74%|███████▎  | 14/19 [00:00<00:00, 19.85it/s] 89%|████████▉ | 17/19 [00:00<00:00, 20.63it/s]100%|██████████| 19/19 [00:00<00:00, 19.20it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4307060 Minimum k_amp 0.00022499170162760515 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 0.4999978542327881 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07154532325994994
Ratio of unique |k|: 0.0019711821985298555
Time to get unique k and theta: 0.9835422039031982 seconds

Getting transfer functions
  0%|          | 0/8490 [00:00<?, ?it/s]  2%|▏         | 192/8490 [00:00<00:04, 1828.90it/s]  5%|▍         | 396/8490 [00:00<00:04, 1912.29it/s]  7%|▋         | 624/8490 [00:00<00:03, 2026.59it/s] 10%|▉         | 840/8490 [00:00<00:03, 2063.20it/s] 12%|█▏        | 1056/8490 [00:00<00:03, 2084.97it/s] 15%|█▍        | 1272/8490 [00:00<00:03, 2058.03it/s] 18%|█▊        | 1500/8490 [00:00<00:03, 2098.42it/s] 20%|██        | 1740/8490 [00:00<00:03, 2158.86it/s] 23%|██▎       | 1968/8490 [00:00<00:02, 2176.18it/s] 26%|██▌       | 2186/8490 [00:01<00:02, 2158.03it/s] 29%|██▉       | 2460/8490 [00:01<00:02, 2303.82it/s] 33%|███▎      | 2784/8490 [00:01<00:02, 2548.55it/s] 36%|███▋      | 3096/8490 [00:01<00:01, 2711.50it/s] 40%|████      | 3396/8490 [00:01<00:01, 2793.73it/s] 44%|████▍     | 3720/8490 [00:01<00:01, 2909.54it/s] 47%|████▋     | 4012/8490 [00:01<00:01, 2885.25it/s] 51%|█████     | 4301/8490 [00:01<00:01, 2831.82it/s] 54%|█████▍    | 4585/8490 [00:01<00:01, 2707.63it/s] 58%|█████▊    | 4920/8490 [00:01<00:01, 2856.61it/s] 61%|██████▏   | 5208/8490 [00:02<00:01, 2838.43it/s] 65%|██████▌   | 5556/8490 [00:02<00:00, 3001.18it/s] 69%|██████▉   | 5868/8490 [00:02<00:00, 3016.74it/s] 73%|███████▎  | 6180/8490 [00:02<00:00, 3040.37it/s] 76%|███████▋  | 6485/8490 [00:02<00:00, 3037.93it/s] 80%|███████▉  | 6790/8490 [00:02<00:00, 3036.24it/s] 84%|████████▍ | 7116/8490 [00:02<00:00, 3062.95it/s] 87%|████████▋ | 7423/8490 [00:02<00:00, 2977.59it/s] 91%|█████████ | 7722/8490 [00:02<00:00, 2950.95it/s] 95%|█████████▍| 8040/8490 [00:03<00:00, 3001.71it/s] 98%|█████████▊| 8352/8490 [00:03<00:00, 3033.40it/s]100%|██████████| 8490/8490 [00:03<00:00, 2688.08it/s]
Size of transfer function: 1.36 MB. 

Size of integrand: 28.57 MB. Time to calculate integrand: 0.019161462783813477 s

Getting spherical harmonics
  0%|          | 0/308150 [00:00<?, ?it/s]  2%|▏         | 4824/308150 [00:00<00:06, 46010.13it/s]  3%|▎         | 10050/308150 [00:00<00:06, 48756.69it/s]  5%|▍         | 14928/308150 [00:00<00:06, 47944.56it/s]  6%|▋         | 19724/308150 [00:00<00:06, 44885.07it/s]  8%|▊         | 24236/308150 [00:00<00:06, 41120.97it/s]  9%|▉         | 28397/308150 [00:00<00:07, 39469.06it/s] 11%|█         | 32562/308150 [00:00<00:06, 39457.41it/s] 12%|█▏        | 36529/308150 [00:00<00:07, 38439.33it/s] 13%|█▎        | 40602/308150 [00:00<00:06, 38420.56it/s] 15%|█▍        | 45024/308150 [00:01<00:06, 39913.33it/s] 16%|█▌        | 49446/308150 [00:01<00:06, 40994.80it/s] 18%|█▊        | 54270/308150 [00:01<00:05, 42924.72it/s] 19%|█▉        | 59094/308150 [00:01<00:05, 44067.14it/s] 21%|██        | 63512/308150 [00:01<00:05, 44000.55it/s] 22%|██▏       | 67920/308150 [00:01<00:05, 42542.12it/s] 23%|██▎       | 72360/308150 [00:01<00:05, 42262.29it/s] 25%|██▍       | 76596/308150 [00:01<00:05, 40559.54it/s] 27%|██▋       | 82008/308150 [00:01<00:05, 44346.04it/s] 28%|██▊       | 87234/308150 [00:02<00:05, 42556.66it/s] 30%|██▉       | 91656/308150 [00:02<00:05, 42888.36it/s] 32%|███▏      | 97686/308150 [00:02<00:04, 47448.38it/s] 34%|███▎      | 103314/308150 [00:02<00:04, 49001.41it/s] 35%|███▌      | 109344/308150 [00:02<00:03, 51109.58it/s] 37%|███▋      | 114481/308150 [00:02<00:04, 47943.78it/s] 39%|███▊      | 119323/308150 [00:02<00:03, 47367.60it/s] 40%|████      | 124218/308150 [00:02<00:03, 47459.42it/s] 42%|████▏     | 128986/308150 [00:02<00:03, 47412.94it/s] 44%|████▎     | 134268/308150 [00:03<00:03, 48116.39it/s] 46%|████▌     | 140700/308150 [00:03<00:03, 51726.37it/s] 47%|████▋     | 145878/308150 [00:03<00:03, 49903.81it/s] 49%|████▉     | 151152/308150 [00:03<00:03, 49724.88it/s] 51%|█████     | 156132/308150 [00:03<00:03, 44657.84it/s] 52%|█████▏    | 161202/308150 [00:03<00:03, 45176.07it/s] 54%|█████▍    | 167634/308150 [00:03<00:02, 50314.25it/s] 56%|█████▌    | 172860/308150 [00:03<00:02, 50736.24it/s] 58%|█████▊    | 178488/308150 [00:03<00:02, 52308.16it/s] 60%|█████▉    | 183777/308150 [00:04<00:02, 51719.90it/s] 61%|██████▏   | 189342/308150 [00:04<00:02, 51721.89it/s] 63%|██████▎   | 194543/308150 [00:04<00:03, 36784.08it/s] 65%|██████▍   | 198829/308150 [00:04<00:03, 29962.36it/s] 66%|██████▌   | 202411/308150 [00:04<00:04, 25344.73it/s] 67%|██████▋   | 205423/308150 [00:05<00:05, 20242.80it/s] 67%|██████▋   | 207884/308150 [00:05<00:05, 19130.48it/s] 68%|██████▊   | 210648/308150 [00:05<00:05, 18473.58it/s] 69%|██████▉   | 212686/308150 [00:05<00:05, 17494.77it/s] 70%|██████▉   | 214549/308150 [00:05<00:05, 16708.06it/s] 70%|███████   | 216282/308150 [00:05<00:06, 15108.36it/s] 71%|███████   | 217884/308150 [00:05<00:05, 15206.18it/s] 71%|███████   | 219492/308150 [00:06<00:06, 14524.07it/s] 72%|███████▏  | 221100/308150 [00:06<00:06, 14097.30it/s] 73%|███████▎  | 225120/308150 [00:06<00:04, 20249.53it/s] 75%|███████▍  | 230346/308150 [00:06<00:02, 28307.94it/s] 77%|███████▋  | 237180/308150 [00:06<00:01, 38023.18it/s] 79%|███████▊  | 242004/308150 [00:06<00:01, 39543.10it/s] 80%|████████  | 247632/308150 [00:06<00:01, 44045.68it/s] 82%|████████▏ | 252858/308150 [00:06<00:01, 45439.47it/s] 84%|████████▎ | 258043/308150 [00:06<00:01, 47244.04it/s] 85%|████████▌ | 262850/308150 [00:07<00:01, 34253.71it/s] 87%|████████▋ | 266830/308150 [00:07<00:01, 23283.12it/s] 88%|████████▊ | 269978/308150 [00:07<00:01, 21572.77it/s] 88%|████████▊ | 272697/308150 [00:07<00:01, 18309.68it/s] 89%|████████▉ | 274956/308150 [00:07<00:01, 17860.44it/s] 90%|████████▉ | 277027/308150 [00:08<00:01, 17205.48it/s] 91%|█████████ | 278931/308150 [00:08<00:01, 17499.71it/s] 91%|█████████ | 280823/308150 [00:08<00:01, 15114.20it/s] 92%|█████████▏| 282462/308150 [00:08<00:01, 15062.86it/s] 92%|█████████▏| 284056/308150 [00:08<00:01, 14992.77it/s] 93%|█████████▎| 285615/308150 [00:08<00:01, 14771.26it/s] 93%|█████████▎| 287832/308150 [00:08<00:01, 15698.64it/s] 94%|█████████▍| 289431/308150 [00:08<00:01, 15378.25it/s] 94%|█████████▍| 290986/308150 [00:09<00:01, 15011.95it/s] 95%|█████████▍| 292497/308150 [00:09<00:01, 13489.77it/s] 96%|█████████▌| 295470/308150 [00:09<00:00, 17527.15it/s] 98%|█████████▊| 301902/308150 [00:09<00:00, 29562.44it/s]100%|█████████▉| 307932/308150 [00:09<00:00, 37612.27it/s]100%|██████████| 308150/308150 [00:09<00:00, 32287.49it/s]
The spherical harmonics array is 271.54 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 85.33439135551453 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 34.25198309827701
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.0008, 'pow_max': 0.0008500000000000001, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 13.45it/s] 21%|██        | 4/19 [00:00<00:01, 14.47it/s] 32%|███▏      | 6/19 [00:00<00:00, 15.43it/s] 42%|████▏     | 8/19 [00:00<00:00, 16.42it/s] 53%|█████▎    | 10/19 [00:00<00:00, 17.44it/s] 68%|██████▊   | 13/19 [00:00<00:00, 19.01it/s] 84%|████████▍ | 16/19 [00:00<00:00, 20.18it/s]100%|██████████| 19/19 [00:01<00:00, 20.88it/s]100%|██████████| 19/19 [00:01<00:00, 18.64it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4307060 Minimum k_amp 0.00022499170162760515 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 0.4874083995819092 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07154532325994994
Ratio of unique |k|: 0.0019711821985298555
Time to get unique k and theta: 0.9571130275726318 seconds

Getting transfer functions
  0%|          | 0/8490 [00:00<?, ?it/s]  2%|▏         | 192/8490 [00:00<00:04, 1844.84it/s]  5%|▍         | 408/8490 [00:00<00:04, 2009.17it/s]  7%|▋         | 624/8490 [00:00<00:03, 2048.11it/s] 10%|▉         | 829/8490 [00:00<00:03, 1973.27it/s] 12%|█▏        | 1056/8490 [00:00<00:03, 2046.70it/s] 15%|█▍        | 1272/8490 [00:00<00:03, 2044.37it/s] 18%|█▊        | 1500/8490 [00:00<00:03, 2097.83it/s] 20%|██        | 1716/8490 [00:00<00:03, 2106.15it/s] 23%|██▎       | 1932/8490 [00:00<00:03, 2103.40it/s] 25%|██▌       | 2143/8490 [00:01<00:03, 2040.32it/s] 28%|██▊       | 2381/8490 [00:01<00:02, 2140.29it/s] 32%|███▏      | 2676/8490 [00:01<00:02, 2353.09it/s] 35%|███▍      | 2952/8490 [00:01<00:02, 2459.96it/s] 38%|███▊      | 3240/8490 [00:01<00:02, 2572.84it/s] 42%|████▏     | 3528/8490 [00:01<00:01, 2653.27it/s] 45%|████▍     | 3804/8490 [00:01<00:01, 2667.95it/s] 48%|████▊     | 4116/8490 [00:01<00:01, 2770.53it/s] 52%|█████▏    | 4404/8490 [00:01<00:01, 2781.55it/s] 55%|█████▌    | 4704/8490 [00:01<00:01, 2839.59it/s] 59%|█████▉    | 5004/8490 [00:02<00:01, 2859.02it/s] 63%|██████▎   | 5328/8490 [00:02<00:01, 2947.36it/s] 67%|██████▋   | 5652/8490 [00:02<00:00, 3005.18it/s] 70%|███████   | 5953/8490 [00:02<00:00, 3006.27it/s] 74%|███████▎  | 6254/8490 [00:02<00:00, 3000.26it/s] 78%|███████▊  | 6588/8490 [00:02<00:00, 3065.62it/s] 82%|████████▏ | 6936/8490 [00:02<00:00, 3165.23it/s] 85%|████████▌ | 7253/8490 [00:02<00:00, 3113.38it/s] 89%|████████▉ | 7572/8490 [00:02<00:00, 3103.48it/s] 93%|█████████▎| 7908/8490 [00:02<00:00, 3168.58it/s] 97%|█████████▋| 8256/8490 [00:03<00:00, 3235.96it/s]100%|██████████| 8490/8490 [00:03<00:00, 2679.47it/s]
Size of transfer function: 1.36 MB. 

Size of integrand: 28.57 MB. Time to calculate integrand: 0.015424251556396484 s

Getting spherical harmonics
  0%|          | 0/308150 [00:00<?, ?it/s]  2%|▏         | 4824/308150 [00:00<00:06, 48234.64it/s]  3%|▎         | 10135/308150 [00:00<00:05, 51099.75it/s]  5%|▍         | 15245/308150 [00:00<00:06, 42920.00it/s]  6%|▋         | 19668/308150 [00:00<00:06, 41429.78it/s]  8%|▊         | 23886/308150 [00:00<00:07, 37314.00it/s] 10%|▉         | 29346/308150 [00:00<00:06, 41242.24it/s] 11%|█         | 33768/308150 [00:00<00:06, 42047.63it/s] 13%|█▎        | 38592/308150 [00:00<00:06, 43279.94it/s] 14%|█▍        | 43416/308150 [00:01<00:06, 43783.11it/s] 16%|█▌        | 48240/308150 [00:01<00:05, 44848.83it/s] 17%|█▋        | 52757/308150 [00:01<00:05, 43140.34it/s] 19%|█▊        | 57101/308150 [00:01<00:06, 40547.48it/s] 20%|█▉        | 61197/308150 [00:01<00:06, 40021.86it/s] 22%|██▏       | 67134/308150 [00:01<00:05, 44658.63it/s] 23%|██▎       | 71633/308150 [00:01<00:05, 44234.76it/s] 25%|██▍       | 76782/308150 [00:01<00:05, 45978.32it/s] 27%|██▋       | 82008/308150 [00:01<00:04, 47071.12it/s] 28%|██▊       | 86731/308150 [00:01<00:04, 46175.62it/s] 30%|██▉       | 91361/308150 [00:02<00:06, 34247.89it/s] 31%|███       | 95228/308150 [00:02<00:06, 30985.43it/s] 32%|███▏      | 99696/308150 [00:02<00:06, 34002.82it/s] 34%|███▎      | 103426/308150 [00:02<00:05, 34495.29it/s] 35%|███▍      | 107116/308150 [00:02<00:07, 27060.29it/s] 36%|███▌      | 111354/308150 [00:02<00:06, 30097.43it/s] 38%|███▊      | 116982/308150 [00:03<00:05, 34380.93it/s] 40%|███▉      | 121806/308150 [00:03<00:04, 37467.29it/s] 41%|████      | 125820/308150 [00:03<00:04, 36468.97it/s] 42%|████▏     | 129651/308150 [00:03<00:05, 30695.55it/s] 43%|████▎     | 133062/308150 [00:03<00:05, 30354.97it/s] 44%|████▍     | 136272/308150 [00:03<00:05, 29537.65it/s] 45%|████▌     | 139341/308150 [00:03<00:05, 28759.55it/s] 47%|████▋     | 144720/308150 [00:03<00:04, 33857.20it/s] 49%|████▉     | 150750/308150 [00:03<00:03, 40642.40it/s] 51%|█████     | 155976/308150 [00:04<00:03, 43497.57it/s] 52%|█████▏    | 161604/308150 [00:04<00:03, 46829.37it/s] 54%|█████▍    | 167232/308150 [00:04<00:02, 48975.83it/s] 56%|█████▌    | 173262/308150 [00:04<00:02, 51337.65it/s] 58%|█████▊    | 178458/308150 [00:04<00:02, 50552.69it/s] 60%|█████▉    | 183557/308150 [00:04<00:02, 46774.74it/s] 61%|██████    | 188311/308150 [00:04<00:03, 36650.33it/s] 63%|██████▎   | 193362/308150 [00:04<00:02, 39511.92it/s] 65%|██████▍   | 200196/308150 [00:05<00:02, 46442.40it/s] 67%|██████▋   | 206226/308150 [00:05<00:02, 49540.03it/s] 69%|██████▉   | 211854/308150 [00:05<00:01, 51163.16it/s] 71%|███████   | 217884/308150 [00:05<00:01, 53032.19it/s] 73%|███████▎  | 224138/308150 [00:05<00:01, 55705.33it/s] 75%|███████▍  | 230748/308150 [00:05<00:01, 58171.47it/s] 77%|███████▋  | 237984/308150 [00:05<00:01, 61698.94it/s] 79%|███████▉  | 244228/308150 [00:05<00:01, 60264.67it/s] 81%|████████  | 250311/308150 [00:05<00:01, 57832.37it/s] 83%|████████▎ | 256148/308150 [00:05<00:00, 56121.14it/s] 85%|████████▌ | 262104/308150 [00:06<00:00, 56619.81it/s] 87%|████████▋ | 268134/308150 [00:06<00:00, 57137.22it/s] 89%|████████▉ | 274566/308150 [00:06<00:00, 58642.49it/s] 91%|█████████ | 280450/308150 [00:06<00:00, 58473.14it/s] 93%|█████████▎| 287028/308150 [00:06<00:00, 59777.85it/s] 95%|█████████▌| 293058/308150 [00:06<00:00, 59798.09it/s] 97%|█████████▋| 299044/308150 [00:06<00:00, 59784.83it/s] 99%|█████████▉| 305928/308150 [00:06<00:00, 62455.85it/s]100%|██████████| 308150/308150 [00:06<00:00, 45094.88it/s]
The spherical harmonics array is 271.54 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 77.22504019737244 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 33.300085561545984
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.0009, 'pow_max': 0.00095, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 16%|█▌        | 3/19 [00:00<00:00, 21.29it/s] 32%|███▏      | 6/19 [00:00<00:00, 21.74it/s] 47%|████▋     | 9/19 [00:00<00:00, 21.98it/s] 63%|██████▎   | 12/19 [00:00<00:00, 22.09it/s] 79%|███████▉  | 15/19 [00:00<00:00, 22.13it/s] 95%|█████████▍| 18/19 [00:00<00:00, 22.14it/s]100%|██████████| 19/19 [00:00<00:00, 22.04it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519179891249254
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4307060 Minimum k_amp 0.00022499170162760515 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 0.4866018295288086 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07154532325994994
Ratio of unique |k|: 0.0019711821985298555
Time to get unique k and theta: 0.9541015625 seconds

Getting transfer functions
  0%|          | 0/8490 [00:00<?, ?it/s]  3%|▎         | 216/8490 [00:00<00:03, 2104.88it/s]  5%|▌         | 432/8490 [00:00<00:03, 2113.46it/s]  8%|▊         | 648/8490 [00:00<00:03, 2090.37it/s] 10%|█         | 864/8490 [00:00<00:03, 2090.85it/s] 13%|█▎        | 1092/8490 [00:00<00:03, 2120.21it/s] 15%|█▌        | 1308/8490 [00:00<00:03, 2122.59it/s] 18%|█▊        | 1548/8490 [00:00<00:03, 2196.89it/s] 21%|██        | 1776/8490 [00:00<00:03, 2216.36it/s] 24%|██▎       | 2004/8490 [00:00<00:02, 2215.22it/s] 26%|██▋       | 2232/8490 [00:01<00:02, 2209.51it/s] 30%|██▉       | 2532/8490 [00:01<00:02, 2416.63it/s] 34%|███▎      | 2856/8490 [00:01<00:02, 2640.43it/s] 37%|███▋      | 3156/8490 [00:01<00:01, 2723.73it/s] 41%|████      | 3444/8490 [00:01<00:01, 2757.91it/s] 44%|████▍     | 3744/8490 [00:01<00:01, 2814.73it/s] 48%|████▊     | 4044/8490 [00:01<00:01, 2839.90it/s] 51%|█████     | 4344/8490 [00:01<00:01, 2883.04it/s] 55%|█████▍    | 4656/8490 [00:01<00:01, 2920.31it/s] 59%|█████▊    | 4980/8490 [00:01<00:01, 3008.92it/s] 63%|██████▎   | 5316/8490 [00:02<00:01, 3110.78it/s] 66%|██████▋   | 5628/8490 [00:02<00:00, 3065.53it/s] 70%|██████▉   | 5935/8490 [00:02<00:00, 3059.28it/s] 74%|███████▍  | 6264/8490 [00:02<00:00, 3120.47it/s] 77%|███████▋  | 6577/8490 [00:02<00:00, 3101.43it/s] 81%|████████▏ | 6900/8490 [00:02<00:00, 3131.93it/s] 85%|████████▌ | 7236/8490 [00:02<00:00, 3196.01it/s] 89%|████████▉ | 7584/8490 [00:02<00:00, 3273.25it/s] 93%|█████████▎| 7912/8490 [00:02<00:00, 3236.82it/s] 97%|█████████▋| 8236/8490 [00:02<00:00, 3194.03it/s]100%|██████████| 8490/8490 [00:03<00:00, 2776.47it/s]
Size of transfer function: 1.36 MB. 

Size of integrand: 28.57 MB. Time to calculate integrand: 0.01705765724182129 s

Getting spherical harmonics
  0%|          | 0/308150 [00:00<?, ?it/s]  2%|▏         | 5226/308150 [00:00<00:06, 48194.70it/s]  3%|▎         | 10046/308150 [00:00<00:07, 40390.35it/s]  5%|▍         | 14147/308150 [00:00<00:07, 38354.23it/s]  6%|▌         | 18894/308150 [00:00<00:07, 40871.33it/s]  8%|▊         | 23316/308150 [00:00<00:06, 41776.74it/s]  9%|▉         | 27738/308150 [00:00<00:06, 41248.07it/s] 10%|█         | 31883/308150 [00:00<00:06, 40809.74it/s] 12%|█▏        | 36180/308150 [00:00<00:06, 39967.01it/s] 13%|█▎        | 41004/308150 [00:00<00:06, 41970.37it/s] 15%|█▍        | 45426/308150 [00:01<00:06, 41470.94it/s] 16%|█▌        | 49585/308150 [00:01<00:06, 41155.74it/s] 18%|█▊        | 54000/308150 [00:01<00:06, 42026.55it/s] 19%|█▉        | 58212/308150 [00:01<00:05, 42012.41it/s] 20%|██        | 62712/308150 [00:01<00:05, 42352.99it/s] 22%|██▏       | 67536/308150 [00:01<00:05, 43703.59it/s] 23%|██▎       | 71958/308150 [00:01<00:05, 43547.72it/s] 25%|██▍       | 76380/308150 [00:01<00:05, 43309.36it/s] 27%|██▋       | 82410/308150 [00:01<00:04, 47518.41it/s] 29%|██▊       | 88038/308150 [00:02<00:04, 49219.73it/s] 31%|███       | 94872/308150 [00:02<00:03, 54397.48it/s] 33%|███▎      | 100902/308150 [00:02<00:03, 55703.69it/s] 35%|███▍      | 106530/308150 [00:02<00:03, 55583.90it/s] 36%|███▋      | 112091/308150 [00:02<00:03, 54278.79it/s] 38%|███▊      | 117525/308150 [00:02<00:03, 53515.49it/s] 40%|████      | 123414/308150 [00:02<00:03, 54354.56it/s] 42%|████▏     | 128853/308150 [00:02<00:03, 53991.42it/s] 44%|████▍     | 135474/308150 [00:02<00:03, 57297.32it/s] 46%|████▌     | 141211/308150 [00:02<00:03, 52875.91it/s] 48%|████▊     | 146565/308150 [00:03<00:03, 52323.70it/s] 50%|████▉     | 153597/308150 [00:03<00:02, 57397.62it/s] 52%|█████▏    | 159400/308150 [00:03<00:02, 56374.97it/s] 54%|█████▎    | 165083/308150 [00:03<00:02, 53984.04it/s] 55%|█████▌    | 170850/308150 [00:03<00:02, 54919.73it/s] 57%|█████▋    | 176380/308150 [00:03<00:02, 53453.79it/s] 59%|█████▉    | 182508/308150 [00:03<00:02, 55458.48it/s] 61%|██████    | 188084/308150 [00:03<00:02, 53926.66it/s] 63%|██████▎   | 194166/308150 [00:03<00:02, 55202.39it/s] 65%|██████▌   | 200598/308150 [00:04<00:01, 57720.60it/s] 67%|██████▋   | 206395/308150 [00:04<00:01, 53461.47it/s] 69%|██████▊   | 211813/308150 [00:04<00:01, 50649.02it/s] 71%|███████   | 217482/308150 [00:04<00:01, 51818.61it/s] 72%|███████▏  | 222719/308150 [00:04<00:01, 50959.49it/s] 74%|███████▍  | 228336/308150 [00:04<00:01, 51531.44it/s] 76%|███████▋  | 235170/308150 [00:04<00:01, 52663.66it/s] 79%|███████▊  | 242004/308150 [00:04<00:01, 56449.17it/s] 81%|████████  | 248838/308150 [00:04<00:00, 59343.02it/s] 83%|████████▎ | 254868/308150 [00:05<00:00, 58957.17it/s] 85%|████████▍ | 260790/308150 [00:05<00:00, 57718.68it/s] 87%|████████▋ | 266581/308150 [00:05<00:00, 52693.52it/s] 88%|████████▊ | 272556/308150 [00:05<00:00, 53958.75it/s] 91%|█████████ | 278988/308150 [00:05<00:00, 56616.93it/s] 92%|█████████▏| 284717/308150 [00:05<00:00, 53292.89it/s] 94%|█████████▍| 291048/308150 [00:05<00:00, 55682.95it/s] 96%|█████████▋| 296686/308150 [00:05<00:00, 53450.85it/s] 98%|█████████▊| 303108/308150 [00:05<00:00, 56265.90it/s]100%|██████████| 308150/308150 [00:06<00:00, 51181.40it/s]
The spherical harmonics array is 271.54 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 77.86410593986511 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 32.734786433992745
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.001, 'pow_max': 0.00105, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 15.17it/s] 21%|██        | 4/19 [00:00<00:00, 16.42it/s] 32%|███▏      | 6/19 [00:00<00:00, 17.41it/s] 47%|████▋     | 9/19 [00:00<00:00, 18.84it/s] 63%|██████▎   | 12/19 [00:00<00:00, 20.26it/s] 79%|███████▉  | 15/19 [00:00<00:00, 21.33it/s] 95%|█████████▍| 18/19 [00:00<00:00, 22.02it/s]100%|██████████| 19/19 [00:00<00:00, 20.42it/s]
Done. k_max for TT ell_max = 0.02259977597839506 k_max for EE ell_max = 0.08519861475622366
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4245012 Minimum k_amp 0.00022499170162760515 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 0.4806399345397949 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07160286001547228
Ratio of unique |k|: 0.001981148698755151
Time to get unique k and theta: 0.9332287311553955 seconds

Getting transfer functions
  0%|          | 0/8410 [00:00<?, ?it/s]  2%|▏         | 176/8410 [00:00<00:04, 1714.25it/s]  4%|▍         | 363/8410 [00:00<00:04, 1801.04it/s]  6%|▋         | 544/8410 [00:00<00:04, 1777.49it/s]  9%|▊         | 726/8410 [00:00<00:04, 1793.56it/s] 11%|█         | 935/8410 [00:00<00:03, 1871.59it/s] 14%|█▎        | 1144/8410 [00:00<00:03, 1914.70it/s] 16%|█▌        | 1353/8410 [00:00<00:03, 1970.48it/s] 18%|█▊        | 1551/8410 [00:00<00:03, 1947.38it/s] 21%|██        | 1760/8410 [00:00<00:03, 1985.00it/s] 23%|██▎       | 1959/8410 [00:01<00:03, 1789.66it/s] 26%|██▌       | 2145/8410 [00:01<00:03, 1792.54it/s] 29%|██▉       | 2420/8410 [00:01<00:02, 2058.53it/s] 32%|███▏      | 2673/8410 [00:01<00:02, 2188.46it/s] 34%|███▍      | 2895/8410 [00:01<00:02, 2157.56it/s] 38%|███▊      | 3179/8410 [00:01<00:02, 2337.13it/s] 41%|████      | 3443/8410 [00:01<00:02, 2424.46it/s] 44%|████▍     | 3718/8410 [00:01<00:01, 2495.83it/s] 48%|████▊     | 4004/8410 [00:01<00:01, 2585.76it/s] 51%|█████     | 4301/8410 [00:01<00:01, 2693.00it/s] 54%|█████▍    | 4576/8410 [00:02<00:01, 2688.04it/s] 58%|█████▊    | 4851/8410 [00:02<00:01, 2691.90it/s] 61%|██████    | 5121/8410 [00:02<00:01, 2664.33it/s] 64%|██████▍   | 5388/8410 [00:02<00:01, 2665.85it/s] 68%|██████▊   | 5687/8410 [00:02<00:01, 2712.35it/s] 71%|███████   | 5973/8410 [00:02<00:00, 2748.87it/s] 74%|███████▍  | 6259/8410 [00:02<00:00, 2778.33it/s] 78%|███████▊  | 6545/8410 [00:02<00:00, 2789.14it/s] 81%|████████▏ | 6853/8410 [00:02<00:00, 2858.26it/s] 85%|████████▌ | 7150/8410 [00:03<00:00, 2863.11it/s] 88%|████████▊ | 7437/8410 [00:03<00:00, 2853.01it/s] 92%|█████████▏| 7723/8410 [00:03<00:00, 2798.50it/s] 95%|█████████▌| 8004/8410 [00:03<00:00, 2751.52it/s] 98%|█████████▊| 8280/8410 [00:03<00:00, 2690.86it/s]100%|██████████| 8410/8410 [00:03<00:00, 2421.19it/s]
Size of transfer function: 1.35 MB. 

Size of integrand: 28.3 MB. Time to calculate integrand: 0.01619124412536621 s

Getting spherical harmonics
  0%|          | 0/303955 [00:00<?, ?it/s]  2%|▏         | 5148/303955 [00:00<00:06, 49669.05it/s]  3%|▎         | 10296/303955 [00:00<00:05, 49844.88it/s]  5%|▌         | 15281/303955 [00:00<00:06, 44832.64it/s]  7%|▋         | 19812/303955 [00:00<00:07, 40420.38it/s]  8%|▊         | 24552/303955 [00:00<00:06, 41742.85it/s] 10%|▉         | 29304/303955 [00:00<00:06, 43393.93it/s] 11%|█         | 34056/303955 [00:00<00:06, 44039.33it/s] 13%|█▎        | 38497/303955 [00:00<00:06, 44029.71it/s] 14%|█▍        | 42925/303955 [00:00<00:06, 42709.34it/s] 16%|█▌        | 47916/303955 [00:01<00:05, 44352.26it/s] 18%|█▊        | 53460/303955 [00:01<00:05, 47051.84it/s] 19%|█▉        | 58608/303955 [00:01<00:05, 47885.99it/s] 21%|██        | 63756/303955 [00:01<00:05, 47887.47it/s] 23%|██▎       | 68555/303955 [00:01<00:05, 43526.21it/s] 24%|██▍       | 73656/303955 [00:01<00:05, 44881.16it/s] 26%|██▌       | 78203/303955 [00:01<00:05, 44696.39it/s] 27%|██▋       | 83160/303955 [00:01<00:04, 45628.36it/s] 30%|██▉       | 90684/303955 [00:01<00:04, 52504.97it/s] 32%|███▏      | 95943/303955 [00:02<00:03, 52345.45it/s] 33%|███▎      | 101183/303955 [00:02<00:03, 51734.73it/s] 35%|███▌      | 106524/303955 [00:02<00:03, 51393.45it/s] 37%|███▋      | 111672/303955 [00:02<00:03, 51369.86it/s] 39%|███▊      | 117216/303955 [00:02<00:03, 52097.33it/s] 41%|████      | 123156/303955 [00:02<00:03, 54090.15it/s] 42%|████▏     | 128570/303955 [00:02<00:03, 49976.63it/s] 44%|████▍     | 133848/303955 [00:02<00:03, 49211.34it/s] 46%|████▌     | 139392/303955 [00:02<00:03, 50374.27it/s] 48%|████▊     | 144936/303955 [00:03<00:03, 51583.08it/s] 49%|████▉     | 150125/303955 [00:03<00:03, 51173.57it/s] 52%|█████▏    | 157608/303955 [00:03<00:02, 56844.15it/s] 54%|█████▍    | 163944/303955 [00:03<00:02, 58220.93it/s] 56%|█████▌    | 170676/303955 [00:03<00:02, 60310.13it/s] 58%|█████▊    | 176717/303955 [00:03<00:02, 51816.70it/s] 61%|██████    | 184140/303955 [00:03<00:02, 56187.83it/s] 63%|██████▎   | 191268/303955 [00:03<00:01, 60034.55it/s] 65%|██████▌   | 197604/303955 [00:03<00:01, 60389.92it/s] 67%|██████▋   | 205128/303955 [00:04<00:01, 61718.48it/s] 70%|██████▉   | 211376/303955 [00:04<00:01, 58766.78it/s] 71%|███████▏  | 217319/303955 [00:04<00:01, 56817.79it/s] 74%|███████▎  | 223740/303955 [00:04<00:01, 58640.98it/s] 76%|███████▌  | 229653/303955 [00:04<00:01, 52890.75it/s] 77%|███████▋  | 235062/303955 [00:04<00:01, 50004.05it/s] 80%|███████▉  | 241887/303955 [00:04<00:01, 54788.10it/s] 82%|████████▏ | 248292/303955 [00:04<00:00, 57128.65it/s] 84%|████████▍ | 254628/303955 [00:04<00:00, 58214.71it/s] 86%|████████▌ | 260535/303955 [00:05<00:00, 56197.30it/s] 88%|████████▊ | 266222/303955 [00:05<00:00, 53806.97it/s] 90%|████████▉ | 272448/303955 [00:05<00:00, 55631.41it/s] 91%|█████████▏| 278062/303955 [00:05<00:00, 51472.00it/s] 93%|█████████▎| 283536/303955 [00:05<00:00, 51974.03it/s] 95%|█████████▌| 288795/303955 [00:05<00:00, 50845.99it/s] 97%|█████████▋| 294675/303955 [00:05<00:00, 53060.29it/s] 99%|█████████▊| 300027/303955 [00:05<00:00, 52167.69it/s]100%|██████████| 303955/303955 [00:05<00:00, 51452.74it/s]
The spherical harmonics array is 267.84 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 76.34691429138184 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 31.83705955285051
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.0015, 'pow_max': 0.00155, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 16%|█▌        | 3/19 [00:00<00:00, 20.99it/s] 32%|███▏      | 6/19 [00:00<00:00, 21.68it/s] 47%|████▋     | 9/19 [00:00<00:00, 21.86it/s] 63%|██████▎   | 12/19 [00:00<00:00, 21.96it/s] 79%|███████▉  | 15/19 [00:00<00:00, 22.05it/s] 95%|█████████▍| 18/19 [00:00<00:00, 22.10it/s]100%|██████████| 19/19 [00:00<00:00, 21.96it/s]
Done. k_max for TT ell_max = 0.007820044837681183 k_max for EE ell_max = 0.08518711301992739
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 1230520 Minimum k_amp 0.00022499170162760515 n_x_max 67 n_z_max 67
Time to get list of k, phi, theta: 0.14510369300842285 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07570864350030881
Ratio of unique |k|: 0.0029946689204563923
Time to get unique k and theta: 0.24172210693359375 seconds

Getting transfer functions
  0%|          | 0/3685 [00:00<?, ?it/s]  2%|▏         | 85/3685 [00:00<00:04, 819.17it/s]  5%|▍         | 175/3685 [00:00<00:04, 865.10it/s]  7%|▋         | 265/3685 [00:00<00:03, 874.46it/s] 10%|▉         | 353/3685 [00:00<00:03, 860.07it/s] 12%|█▏        | 450/3685 [00:00<00:03, 893.19it/s] 15%|█▍        | 550/3685 [00:00<00:03, 920.31it/s] 18%|█▊        | 650/3685 [00:00<00:03, 941.00it/s] 20%|██        | 750/3685 [00:00<00:03, 950.47it/s] 23%|██▎       | 846/3685 [00:00<00:03, 943.53it/s] 26%|██▌       | 955/3685 [00:01<00:02, 972.90it/s] 29%|██▉       | 1075/3685 [00:01<00:02, 1033.88it/s] 33%|███▎      | 1210/3685 [00:01<00:02, 1121.60it/s] 37%|███▋      | 1350/3685 [00:01<00:01, 1197.67it/s] 41%|████      | 1515/3685 [00:01<00:01, 1323.64it/s] 45%|████▌     | 1660/3685 [00:01<00:01, 1355.56it/s] 49%|████▉     | 1800/3685 [00:01<00:01, 1355.90it/s] 53%|█████▎    | 1960/3685 [00:01<00:01, 1422.17it/s] 57%|█████▋    | 2103/3685 [00:01<00:01, 1403.87it/s] 61%|██████    | 2245/3685 [00:01<00:01, 1396.13it/s] 65%|██████▍   | 2395/3685 [00:02<00:00, 1416.18it/s] 69%|██████▉   | 2537/3685 [00:02<00:00, 1413.88it/s] 73%|███████▎  | 2679/3685 [00:02<00:00, 1410.63it/s] 77%|███████▋  | 2821/3685 [00:02<00:00, 1396.73it/s] 80%|████████  | 2961/3685 [00:02<00:00, 1385.12it/s] 84%|████████▍ | 3100/3685 [00:02<00:00, 1366.05it/s] 88%|████████▊ | 3245/3685 [00:02<00:00, 1373.71it/s] 92%|█████████▏| 3385/3685 [00:02<00:00, 1374.79it/s] 96%|█████████▌| 3525/3685 [00:02<00:00, 1381.07it/s]100%|█████████▉| 3675/3685 [00:02<00:00, 1412.88it/s]100%|██████████| 3685/3685 [00:02<00:00, 1236.52it/s]
Size of transfer function: 0.59 MB. 

Size of integrand: 12.4 MB. Time to calculate integrand: 0.008301734924316406 s

Getting spherical harmonics
  0%|          | 0/93161 [00:00<?, ?it/s]  4%|▍         | 3538/93161 [00:00<00:02, 34883.76it/s]  8%|▊         | 7027/93161 [00:00<00:02, 29910.93it/s] 11%|█         | 10248/93161 [00:00<00:02, 30509.37it/s] 14%|█▍        | 13327/93161 [00:00<00:02, 29089.38it/s] 18%|█▊        | 17080/93161 [00:00<00:02, 30776.52it/s] 22%|██▏       | 20740/93161 [00:00<00:02, 32594.35it/s] 26%|██▌       | 24278/93161 [00:00<00:02, 33358.41it/s] 30%|██▉       | 27694/93161 [00:00<00:01, 33451.47it/s] 34%|███▎      | 31354/93161 [00:00<00:01, 33656.23it/s] 38%|███▊      | 35136/93161 [00:01<00:01, 34793.45it/s] 42%|████▏     | 38918/93161 [00:01<00:01, 35623.58it/s] 46%|████▋     | 43310/93161 [00:01<00:01, 37972.97it/s] 51%|█████     | 47336/93161 [00:01<00:01, 38539.99it/s] 55%|█████▍    | 51197/93161 [00:01<00:01, 33990.61it/s] 59%|█████▊    | 54696/93161 [00:01<00:01, 33592.79it/s] 64%|██████▎   | 59292/93161 [00:01<00:00, 36730.46it/s] 68%|██████▊   | 63440/93161 [00:01<00:00, 37963.62it/s] 73%|███████▎  | 67979/93161 [00:01<00:00, 40089.32it/s] 78%|███████▊  | 72590/93161 [00:02<00:00, 41793.12it/s] 83%|████████▎ | 77470/93161 [00:02<00:00, 43706.53it/s] 88%|████████▊ | 81872/93161 [00:02<00:00, 42749.83it/s] 92%|█████████▏| 86173/93161 [00:02<00:00, 39060.44it/s] 97%|█████████▋| 90153/93161 [00:02<00:00, 36777.80it/s]100%|██████████| 93161/93161 [00:02<00:00, 34993.27it/s]
The spherical harmonics array is 82.09 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 72.95229196548462 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 27.744594285990825
Cubic Torus
Running - E1 l_max=20, Lx=27926
Running {'topology': 'E1', 'Lx': 1.01, 'Ly': 1.01, 'Lz': 1.01, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.002, 'pow_max': 0.00205, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 16%|█▌        | 3/19 [00:00<00:00, 20.92it/s] 32%|███▏      | 6/19 [00:00<00:00, 21.62it/s] 47%|████▋     | 9/19 [00:00<00:00, 21.89it/s] 63%|██████▎   | 12/19 [00:00<00:00, 22.06it/s] 79%|███████▉  | 15/19 [00:00<00:00, 22.13it/s] 95%|█████████▍| 18/19 [00:00<00:00, 22.17it/s]100%|██████████| 19/19 [00:00<00:00, 22.02it/s]
Done. k_max for TT ell_max = 0.01028013843438453 k_max for EE ell_max = 0.08518796500039377
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 1468880 Minimum k_amp 0.00022499170162760515 n_x_max 71 n_z_max 71
Time to get list of k, phi, theta: 0.171187162399292 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07507761015195251
Ratio of unique |k|: 0.00282323947497413
Time to get unique k and theta: 0.2822725772857666 seconds

Getting transfer functions
  0%|          | 0/4147 [00:00<?, ?it/s]  2%|▏         | 96/4147 [00:00<00:04, 954.94it/s]  5%|▍         | 204/4147 [00:00<00:03, 995.10it/s]  8%|▊         | 318/4147 [00:00<00:03, 1038.61it/s] 11%|█         | 438/4147 [00:00<00:03, 1080.90it/s] 13%|█▎        | 552/4147 [00:00<00:03, 1085.77it/s] 16%|█▌        | 661/4147 [00:00<00:03, 1073.48it/s] 19%|█▊        | 774/4147 [00:00<00:03, 1081.69it/s] 22%|██▏       | 894/4147 [00:00<00:02, 1112.30it/s] 25%|██▍       | 1020/4147 [00:00<00:02, 1139.99it/s] 27%|██▋       | 1140/4147 [00:01<00:02, 1156.78it/s] 31%|███▏      | 1296/4147 [00:01<00:02, 1274.84it/s] 35%|███▌      | 1458/4147 [00:01<00:01, 1375.94it/s] 40%|███▉      | 1650/4147 [00:01<00:01, 1531.54it/s] 44%|████▎     | 1812/4147 [00:01<00:01, 1549.59it/s] 48%|████▊     | 2004/4147 [00:01<00:01, 1648.48it/s] 53%|█████▎    | 2178/4147 [00:01<00:01, 1672.03it/s] 57%|█████▋    | 2370/4147 [00:01<00:01, 1731.18it/s] 62%|██████▏   | 2562/4147 [00:01<00:00, 1774.94it/s] 66%|██████▌   | 2742/4147 [00:01<00:00, 1764.27it/s] 70%|███████   | 2919/4147 [00:02<00:00, 1757.73it/s] 75%|███████▍  | 3096/4147 [00:02<00:00, 1754.51it/s] 79%|███████▉  | 3282/4147 [00:02<00:00, 1772.38it/s] 83%|████████▎ | 3460/4147 [00:02<00:00, 1743.22it/s] 88%|████████▊ | 3635/4147 [00:02<00:00, 1728.88it/s] 92%|█████████▏| 3808/4147 [00:02<00:00, 1716.10it/s] 96%|█████████▌| 3980/4147 [00:02<00:00, 1686.39it/s]100%|██████████| 4147/4147 [00:02<00:00, 1492.75it/s]
Size of transfer function: 0.66 MB. 

Size of integrand: 13.95 MB. Time to calculate integrand: 0.01014566421508789 s

Getting spherical harmonics
  0%|          | 0/110280 [00:00<?, ?it/s]  4%|▎         | 4032/110280 [00:00<00:02, 38141.47it/s]  7%|▋         | 7847/110280 [00:00<00:02, 35610.34it/s] 10%|█         | 11520/110280 [00:00<00:02, 34835.12it/s] 14%|█▎        | 15007/110280 [00:00<00:02, 33896.95it/s] 17%|█▋        | 19296/110280 [00:00<00:02, 36843.15it/s] 21%|██        | 22995/110280 [00:00<00:02, 36507.65it/s] 25%|██▍       | 27504/110280 [00:00<00:02, 38921.01it/s] 28%|██▊       | 31406/110280 [00:00<00:02, 37795.48it/s] 33%|███▎      | 36288/110280 [00:00<00:01, 39443.89it/s] 36%|███▋      | 40232/110280 [00:01<00:01, 38573.98it/s] 41%|████      | 44721/110280 [00:01<00:01, 40401.72it/s] 45%|████▍     | 49104/110280 [00:01<00:01, 41101.07it/s] 49%|████▊     | 53712/110280 [00:01<00:01, 42503.97it/s] 53%|█████▎    | 58464/110280 [00:01<00:01, 43503.59it/s] 58%|█████▊    | 63504/110280 [00:01<00:01, 45520.69it/s] 62%|██████▏   | 68688/110280 [00:01<00:00, 47375.52it/s] 67%|██████▋   | 74016/110280 [00:01<00:00, 49097.72it/s] 72%|███████▏  | 78935/110280 [00:01<00:00, 45997.70it/s] 76%|███████▋  | 84096/110280 [00:02<00:00, 46917.92it/s] 81%|████████  | 89424/110280 [00:02<00:00, 48636.13it/s] 86%|████████▌ | 94318/110280 [00:02<00:00, 45240.95it/s] 90%|████████▉ | 99072/110280 [00:02<00:00, 45698.39it/s] 94%|█████████▍| 103689/110280 [00:02<00:00, 41397.21it/s] 98%|█████████▊| 108432/110280 [00:02<00:00, 42087.45it/s]100%|██████████| 110280/110280 [00:02<00:00, 42154.78it/s]
The spherical harmonics array is 97.18 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 64.93800973892212 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 25.073453323753533
