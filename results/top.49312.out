Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.0001, 'pow_max': 0.00015000000000000001, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  6.83it/s] 16%|█▌        | 3/19 [00:00<00:01, 10.38it/s] 26%|██▋       | 5/19 [00:00<00:01, 11.57it/s] 37%|███▋      | 7/19 [00:00<00:00, 12.32it/s] 47%|████▋     | 9/19 [00:00<00:00, 13.10it/s] 58%|█████▊    | 11/19 [00:00<00:00, 13.98it/s] 68%|██████▊   | 13/19 [00:00<00:00, 14.94it/s] 79%|███████▉  | 15/19 [00:01<00:00, 15.98it/s] 89%|████████▉ | 17/19 [00:01<00:00, 16.84it/s]100%|██████████| 19/19 [00:01<00:00, 14.75it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6356712 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 3.15358567237854 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07026981873647886
Ratio of unique |k|: 0.0017317128729443774
Time to get unique k and theta: 1.4538562297821045 seconds

Getting transfer functions
  0%|          | 0/11008 [00:00<?, ?it/s]  2%|▏         | 255/11008 [00:00<00:04, 2490.18it/s]  5%|▌         | 555/11008 [00:00<00:03, 2773.51it/s]  8%|▊         | 833/11008 [00:00<00:03, 2743.06it/s] 10%|█         | 1110/11008 [00:00<00:03, 2738.02it/s] 13%|█▎        | 1384/11008 [00:00<00:03, 2712.91it/s] 15%|█▌        | 1665/11008 [00:00<00:03, 2701.37it/s] 18%|█▊        | 1936/11008 [00:00<00:03, 2690.74it/s] 20%|██        | 2250/11008 [00:00<00:03, 2782.08it/s] 23%|██▎       | 2535/11008 [00:00<00:03, 2787.78it/s] 26%|██▌       | 2820/11008 [00:01<00:02, 2796.66it/s] 29%|██▉       | 3165/11008 [00:01<00:02, 2979.48it/s] 32%|███▏      | 3555/11008 [00:01<00:02, 3225.91it/s] 36%|███▌      | 3945/11008 [00:01<00:02, 3373.31it/s] 39%|███▉      | 4305/11008 [00:01<00:01, 3435.68it/s] 43%|████▎     | 4695/11008 [00:01<00:01, 3554.89it/s] 46%|████▌     | 5085/11008 [00:01<00:01, 3643.15it/s] 50%|████▉     | 5450/11008 [00:01<00:01, 3644.35it/s] 53%|█████▎    | 5835/11008 [00:01<00:01, 3663.06it/s] 56%|█████▋    | 6210/11008 [00:01<00:01, 3645.89it/s] 60%|█████▉    | 6585/11008 [00:02<00:01, 3671.56it/s] 64%|██████▎   | 7005/11008 [00:02<00:01, 3800.38it/s] 67%|██████▋   | 7410/11008 [00:02<00:00, 3865.76it/s] 71%|███████   | 7797/11008 [00:02<00:00, 3838.16it/s] 74%|███████▍  | 8181/11008 [00:02<00:00, 3824.90it/s] 78%|███████▊  | 8564/11008 [00:02<00:00, 3776.11it/s] 81%|████████  | 8942/11008 [00:02<00:00, 3743.17it/s] 85%|████████▌ | 9375/11008 [00:02<00:00, 3910.37it/s] 89%|████████▉ | 9780/11008 [00:02<00:00, 3912.48it/s] 92%|█████████▏| 10172/11008 [00:02<00:00, 3843.72it/s] 96%|█████████▌| 10557/11008 [00:03<00:00, 3780.95it/s] 99%|█████████▉| 10936/11008 [00:03<00:00, 3773.88it/s]100%|██████████| 11008/11008 [00:03<00:00, 3446.26it/s]
Size of transfer function: 1.76 MB. 

Size of integrand: 37.04 MB. Time to calculate integrand: 0.6456186771392822 s

Getting spherical harmonics
  0%|          | 0/446685 [00:00<?, ?it/s]  1%|▏         | 5820/446685 [00:00<00:08, 53546.30it/s]  3%|▎         | 11175/446685 [00:00<00:09, 45149.67it/s]  4%|▎         | 16296/446685 [00:00<00:09, 46120.83it/s]  5%|▍         | 20952/446685 [00:00<00:09, 45781.24it/s]  6%|▌         | 26772/446685 [00:00<00:08, 48650.61it/s]  7%|▋         | 32006/446685 [00:00<00:08, 49826.27it/s]  8%|▊         | 37009/446685 [00:00<00:08, 48799.18it/s]  9%|▉         | 41903/446685 [00:00<00:08, 48741.63it/s] 11%|█         | 47142/446685 [00:00<00:08, 48435.06it/s] 12%|█▏        | 51993/446685 [00:01<00:09, 40996.65it/s] 13%|█▎        | 57036/446685 [00:01<00:09, 42149.86it/s] 14%|█▎        | 61385/446685 [00:01<00:09, 41720.99it/s] 15%|█▍        | 65766/446685 [00:01<00:09, 41246.28it/s] 16%|█▌        | 70422/446685 [00:01<00:08, 42132.30it/s] 17%|█▋        | 75660/446685 [00:01<00:08, 43151.62it/s] 18%|█▊        | 81480/446685 [00:01<00:07, 46474.76it/s] 19%|█▉        | 86162/446685 [00:01<00:08, 43791.32it/s] 20%|██        | 90792/446685 [00:02<00:08, 43935.95it/s] 21%|██▏       | 96030/446685 [00:02<00:07, 45486.99it/s] 23%|██▎       | 101268/446685 [00:02<00:07, 46469.02it/s] 24%|██▎       | 105936/446685 [00:02<00:07, 45055.90it/s] 25%|██▍       | 110580/446685 [00:02<00:07, 44045.48it/s] 26%|██▌       | 116400/446685 [00:02<00:06, 47201.90it/s] 27%|██▋       | 122220/446685 [00:02<00:06, 49401.43it/s] 29%|██▉       | 129204/446685 [00:02<00:05, 54656.09it/s] 30%|███       | 135606/446685 [00:02<00:05, 57193.67it/s] 32%|███▏      | 141356/446685 [00:02<00:05, 56623.42it/s] 33%|███▎      | 147040/446685 [00:03<00:05, 53553.17it/s] 34%|███▍      | 152438/446685 [00:03<00:05, 52938.17it/s] 35%|███▌      | 157760/446685 [00:03<00:05, 51376.87it/s] 36%|███▋      | 162921/446685 [00:03<00:05, 49182.49it/s] 38%|███▊      | 169944/446685 [00:03<00:05, 54257.05it/s] 39%|███▉      | 175408/446685 [00:03<00:05, 53742.39it/s] 41%|████      | 181584/446685 [00:03<00:04, 55150.77it/s] 42%|████▏     | 187119/446685 [00:03<00:04, 52559.03it/s] 43%|████▎     | 192642/446685 [00:03<00:04, 52211.50it/s] 44%|████▍     | 198462/446685 [00:04<00:04, 52639.65it/s] 46%|████▌     | 204864/446685 [00:04<00:04, 54989.26it/s] 47%|████▋     | 211266/446685 [00:04<00:04, 56793.12it/s] 49%|████▊     | 217668/446685 [00:04<00:04, 54171.38it/s] 50%|█████     | 224070/446685 [00:04<00:03, 56135.49it/s] 51%|█████▏    | 229890/446685 [00:04<00:03, 55080.43it/s] 53%|█████▎    | 235428/446685 [00:04<00:04, 50904.55it/s] 54%|█████▍    | 241530/446685 [00:04<00:03, 52613.51it/s] 55%|█████▌    | 247350/446685 [00:04<00:03, 53665.10it/s] 57%|█████▋    | 252763/446685 [00:05<00:03, 53208.70it/s] 58%|█████▊    | 259572/446685 [00:05<00:03, 56482.21it/s] 59%|█████▉    | 265392/446685 [00:05<00:03, 56002.40it/s] 61%|██████    | 271011/446685 [00:05<00:03, 55540.66it/s] 62%|██████▏   | 277614/446685 [00:05<00:02, 56995.56it/s] 64%|██████▎   | 284016/446685 [00:05<00:02, 58669.92it/s] 65%|██████▍   | 289893/446685 [00:05<00:02, 58318.66it/s] 66%|██████▌   | 295731/446685 [00:05<00:02, 57086.99it/s] 68%|██████▊   | 302058/446685 [00:05<00:02, 57380.30it/s] 69%|██████▉   | 308460/446685 [00:06<00:02, 59263.45it/s] 70%|███████   | 314862/446685 [00:06<00:02, 59636.13it/s] 72%|███████▏  | 321846/446685 [00:06<00:02, 61999.39it/s] 74%|███████▍  | 329994/446685 [00:06<00:01, 66642.09it/s] 75%|███████▌  | 336978/446685 [00:06<00:01, 65684.06it/s] 77%|███████▋  | 345126/446685 [00:06<00:01, 68308.75it/s] 79%|███████▉  | 351955/446685 [00:06<00:01, 66423.32it/s] 80%|████████  | 358599/446685 [00:06<00:01, 60885.52it/s] 82%|████████▏ | 366078/446685 [00:06<00:01, 64466.82it/s] 83%|████████▎ | 372610/446685 [00:07<00:01, 61546.58it/s] 85%|████████▍ | 378882/446685 [00:07<00:01, 61083.28it/s] 86%|████████▋ | 385866/446685 [00:07<00:00, 63210.77it/s] 88%|████████▊ | 392234/446685 [00:07<00:00, 62716.83it/s] 89%|████████▉ | 398537/446685 [00:07<00:00, 61311.24it/s] 91%|█████████ | 405072/446685 [00:07<00:00, 61807.84it/s] 93%|█████████▎| 413220/446685 [00:07<00:00, 66468.29it/s] 94%|█████████▍| 419883/446685 [00:07<00:00, 65484.51it/s] 96%|█████████▌| 427188/446685 [00:07<00:00, 67045.89it/s] 97%|█████████▋| 434172/446685 [00:07<00:00, 67749.32it/s] 99%|█████████▊| 440957/446685 [00:08<00:00, 65325.43it/s]100%|██████████| 446685/446685 [00:08<00:00, 54742.72it/s]
The spherical harmonics array is 393.62 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 30.987534284591675 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 0.7175889210364206
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.0002, 'pow_max': 0.00025, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 14.22it/s] 21%|██        | 4/19 [00:00<00:00, 15.86it/s] 32%|███▏      | 6/19 [00:00<00:00, 17.28it/s] 47%|████▋     | 9/19 [00:00<00:00, 18.93it/s] 63%|██████▎   | 12/19 [00:00<00:00, 20.09it/s] 79%|███████▉  | 15/19 [00:00<00:00, 21.39it/s] 95%|█████████▍| 18/19 [00:00<00:00, 22.28it/s]100%|██████████| 19/19 [00:00<00:00, 20.43it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6356712 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 0.697312593460083 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07026981873647886
Ratio of unique |k|: 0.0017317128729443774
Time to get unique k and theta: 1.470693588256836 seconds

Getting transfer functions
  0%|          | 0/11008 [00:00<?, ?it/s]  2%|▏         | 195/11008 [00:00<00:05, 1931.46it/s]  4%|▍         | 420/11008 [00:00<00:05, 2057.51it/s]  6%|▋         | 690/11008 [00:00<00:04, 2286.11it/s]  8%|▊         | 930/11008 [00:00<00:04, 2282.16it/s] 11%|█         | 1185/11008 [00:00<00:04, 2354.56it/s] 13%|█▎        | 1455/11008 [00:00<00:03, 2418.97it/s] 15%|█▌        | 1697/11008 [00:00<00:03, 2409.75it/s] 18%|█▊        | 1938/11008 [00:00<00:03, 2395.08it/s] 20%|█▉        | 2190/11008 [00:00<00:03, 2402.83it/s] 22%|██▏       | 2431/11008 [00:01<00:03, 2375.56it/s] 25%|██▍       | 2700/11008 [00:01<00:03, 2429.18it/s] 27%|██▋       | 2970/11008 [00:01<00:03, 2505.59it/s] 30%|██▉       | 3285/11008 [00:01<00:02, 2692.33it/s] 33%|███▎      | 3600/11008 [00:01<00:02, 2826.32it/s] 36%|███▌      | 3990/11008 [00:01<00:02, 3120.71it/s] 40%|███▉      | 4365/11008 [00:01<00:02, 3302.03it/s] 43%|████▎     | 4755/11008 [00:01<00:01, 3442.96it/s] 47%|████▋     | 5145/11008 [00:01<00:01, 3544.13it/s] 50%|█████     | 5535/11008 [00:01<00:01, 3632.88it/s] 54%|█████▍    | 5925/11008 [00:02<00:01, 3666.11it/s] 57%|█████▋    | 6300/11008 [00:02<00:01, 3657.07it/s] 61%|██████    | 6675/11008 [00:02<00:01, 3680.28it/s] 64%|██████▍   | 7065/11008 [00:02<00:01, 3733.44it/s] 68%|██████▊   | 7455/11008 [00:02<00:00, 3771.99it/s] 71%|███████   | 7833/11008 [00:02<00:00, 3764.96it/s] 75%|███████▍  | 8220/11008 [00:02<00:00, 3764.09it/s] 78%|███████▊  | 8597/11008 [00:02<00:00, 3760.30it/s] 82%|████████▏ | 8974/11008 [00:02<00:00, 3755.08it/s] 85%|████████▌ | 9360/11008 [00:02<00:00, 3754.01it/s] 89%|████████▊ | 9750/11008 [00:03<00:00, 3754.63it/s] 93%|█████████▎| 10185/11008 [00:03<00:00, 3922.51it/s] 96%|█████████▌| 10578/11008 [00:03<00:00, 3882.51it/s]100%|█████████▉| 10967/11008 [00:03<00:00, 3839.25it/s]100%|██████████| 11008/11008 [00:03<00:00, 3243.55it/s]
Size of transfer function: 1.76 MB. 

Size of integrand: 37.04 MB. Time to calculate integrand: 0.018967866897583008 s

Getting spherical harmonics
  0%|          | 0/446685 [00:00<?, ?it/s]  1%|          | 5238/446685 [00:00<00:08, 51283.66it/s]  2%|▏         | 10956/446685 [00:00<00:07, 54719.04it/s]  4%|▎         | 16431/446685 [00:00<00:08, 50940.72it/s]  5%|▍         | 21555/446685 [00:00<00:08, 48977.18it/s]  6%|▌         | 26772/446685 [00:00<00:08, 49812.13it/s]  7%|▋         | 32010/446685 [00:00<00:08, 49278.11it/s]  8%|▊         | 37248/446685 [00:00<00:08, 49047.58it/s]  9%|▉         | 42162/446685 [00:00<00:08, 48389.56it/s] 11%|█         | 47006/446685 [00:00<00:08, 47694.87it/s] 12%|█▏        | 51778/446685 [00:01<00:12, 30960.26it/s] 12%|█▏        | 55599/446685 [00:01<00:19, 20565.93it/s] 13%|█▎        | 58567/446685 [00:01<00:20, 19024.62it/s] 14%|█▎        | 61089/446685 [00:01<00:21, 18142.09it/s] 14%|█▍        | 63315/446685 [00:02<00:21, 18249.15it/s] 15%|█▍        | 65766/446685 [00:02<00:19, 19307.34it/s] 16%|█▌        | 70422/446685 [00:02<00:14, 25184.22it/s] 17%|█▋        | 75660/446685 [00:02<00:11, 31362.51it/s] 18%|█▊        | 80898/446685 [00:02<00:10, 35687.98it/s] 19%|█▉        | 85554/446685 [00:02<00:09, 38458.73it/s] 20%|██        | 90792/446685 [00:02<00:08, 40665.31it/s] 21%|██▏       | 95448/446685 [00:02<00:08, 41392.08it/s] 22%|██▏       | 100104/446685 [00:02<00:08, 42034.18it/s] 24%|██▎       | 105342/446685 [00:03<00:07, 43585.04it/s] 25%|██▍       | 109998/446685 [00:03<00:07, 43727.89it/s] 26%|██▌       | 115818/446685 [00:03<00:07, 46994.90it/s] 27%|██▋       | 122220/446685 [00:03<00:06, 51246.35it/s] 29%|██▉       | 128622/446685 [00:03<00:05, 54757.61it/s] 30%|███       | 135024/446685 [00:03<00:05, 56750.02it/s] 32%|███▏      | 140733/446685 [00:03<00:06, 50573.63it/s] 33%|███▎      | 145929/446685 [00:03<00:06, 48155.33it/s] 34%|███▍      | 150849/446685 [00:03<00:06, 44846.72it/s] 35%|███▌      | 157722/446685 [00:04<00:05, 50886.22it/s] 37%|███▋      | 163542/446685 [00:04<00:05, 51880.16it/s] 38%|███▊      | 170526/446685 [00:04<00:04, 56443.19it/s] 39%|███▉      | 176346/446685 [00:04<00:04, 56101.25it/s] 41%|████      | 183330/446685 [00:04<00:04, 59850.03it/s] 43%|████▎     | 190314/446685 [00:04<00:04, 62117.58it/s] 44%|████▍     | 196716/446685 [00:04<00:04, 62343.54it/s] 45%|████▌     | 203118/446685 [00:04<00:03, 62457.04it/s] 47%|████▋     | 209392/446685 [00:04<00:03, 59531.68it/s] 48%|████▊     | 215389/446685 [00:05<00:04, 57549.92it/s] 50%|████▉     | 222324/446685 [00:05<00:03, 59107.55it/s] 51%|█████     | 228260/446685 [00:05<00:03, 57591.78it/s] 53%|█████▎    | 235128/446685 [00:05<00:03, 59603.49it/s] 54%|█████▍    | 241105/446685 [00:05<00:03, 55576.80it/s] 55%|█████▌    | 246768/446685 [00:05<00:03, 54835.39it/s] 56%|█████▋    | 252283/446685 [00:05<00:03, 54508.84it/s] 58%|█████▊    | 259572/446685 [00:05<00:03, 58875.85it/s] 60%|█████▉    | 266556/446685 [00:05<00:03, 59524.75it/s] 61%|██████    | 273540/446685 [00:06<00:02, 62000.27it/s] 63%|██████▎   | 279764/446685 [00:06<00:02, 61421.90it/s] 64%|██████▍   | 285922/446685 [00:06<00:02, 57045.30it/s] 65%|██████▌   | 291687/446685 [00:06<00:03, 49767.60it/s] 66%|██████▋   | 296844/446685 [00:06<00:03, 38147.58it/s] 67%|██████▋   | 301144/446685 [00:06<00:04, 31949.89it/s] 68%|██████▊   | 304785/446685 [00:06<00:04, 31413.16it/s] 69%|██████▉   | 308224/446685 [00:07<00:04, 29867.05it/s] 70%|██████▉   | 311952/446685 [00:07<00:04, 30505.48it/s] 71%|███████▏  | 318936/446685 [00:07<00:03, 39379.51it/s] 73%|███████▎  | 324756/446685 [00:07<00:02, 43995.19it/s] 74%|███████▍  | 331740/446685 [00:07<00:02, 50322.29it/s] 76%|███████▌  | 338142/446685 [00:07<00:02, 52829.02it/s] 77%|███████▋  | 343636/446685 [00:07<00:01, 51709.42it/s] 78%|███████▊  | 349200/446685 [00:07<00:01, 51934.76it/s] 80%|███████▉  | 355602/446685 [00:07<00:01, 53553.92it/s] 81%|████████  | 361422/446685 [00:08<00:02, 31150.48it/s] 82%|████████▏ | 366660/446685 [00:08<00:02, 35032.78it/s] 83%|████████▎ | 371898/446685 [00:08<00:01, 38047.86it/s] 85%|████████▍ | 377718/446685 [00:08<00:01, 42471.02it/s] 86%|████████▌ | 384120/446685 [00:08<00:01, 47451.30it/s] 88%|████████▊ | 391104/446685 [00:08<00:01, 52563.34it/s] 89%|████████▉ | 396854/446685 [00:08<00:00, 53232.81it/s] 90%|█████████ | 403270/446685 [00:09<00:00, 56217.05it/s] 92%|█████████▏| 409167/446685 [00:09<00:00, 54076.22it/s] 93%|█████████▎| 414779/446685 [00:09<00:00, 54414.31it/s] 94%|█████████▍| 420367/446685 [00:09<00:00, 53032.41it/s] 95%|█████████▌| 426024/446685 [00:09<00:00, 52781.75it/s] 97%|█████████▋| 432426/446685 [00:09<00:00, 55050.17it/s] 98%|█████████▊| 439226/446685 [00:09<00:00, 58716.74it/s]100%|█████████▉| 445230/446685 [00:09<00:00, 57734.84it/s]100%|██████████| 446685/446685 [00:09<00:00, 45534.67it/s]
The spherical harmonics array is 393.62 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 59.80321741104126 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 0.7597687159697472
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.0003, 'pow_max': 0.00035, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 18.67it/s] 26%|██▋       | 5/19 [00:00<00:00, 20.32it/s] 42%|████▏     | 8/19 [00:00<00:00, 21.39it/s] 58%|█████▊    | 11/19 [00:00<00:00, 22.17it/s] 74%|███████▎  | 14/19 [00:00<00:00, 22.59it/s] 89%|████████▉ | 17/19 [00:00<00:00, 22.85it/s]100%|██████████| 19/19 [00:00<00:00, 22.29it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6356712 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 0.6754209995269775 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07026981873647886
Ratio of unique |k|: 0.0017317128729443774
Time to get unique k and theta: 1.4846999645233154 seconds

Getting transfer functions
  0%|          | 0/11008 [00:00<?, ?it/s]  2%|▏         | 225/11008 [00:00<00:04, 2177.47it/s]  4%|▍         | 495/11008 [00:00<00:04, 2461.42it/s]  7%|▋         | 765/11008 [00:00<00:04, 2554.91it/s]  9%|▉         | 1021/11008 [00:00<00:04, 2491.28it/s] 12%|█▏        | 1271/11008 [00:00<00:03, 2489.01it/s] 14%|█▍        | 1521/11008 [00:00<00:03, 2396.00it/s] 16%|█▌        | 1762/11008 [00:00<00:03, 2364.21it/s] 18%|█▊        | 1999/11008 [00:00<00:03, 2357.23it/s] 20%|██        | 2235/11008 [00:00<00:03, 2342.05it/s] 22%|██▏       | 2475/11008 [00:01<00:03, 2341.63it/s] 25%|██▍       | 2715/11008 [00:01<00:03, 2356.36it/s] 27%|██▋       | 3000/11008 [00:01<00:03, 2495.57it/s] 31%|███       | 3405/11008 [00:01<00:02, 2927.86it/s] 35%|███▍      | 3810/11008 [00:01<00:02, 3246.70it/s] 38%|███▊      | 4185/11008 [00:01<00:02, 3366.20it/s] 41%|████▏     | 4560/11008 [00:01<00:01, 3460.20it/s] 45%|████▍     | 4920/11008 [00:01<00:01, 3479.88it/s] 48%|████▊     | 5310/11008 [00:01<00:01, 3583.17it/s] 52%|█████▏    | 5670/11008 [00:01<00:01, 3569.38it/s] 55%|█████▍    | 6045/11008 [00:02<00:01, 3618.28it/s] 58%|█████▊    | 6435/11008 [00:02<00:01, 3689.39it/s] 62%|██████▏   | 6825/11008 [00:02<00:01, 3725.69it/s] 66%|██████▌   | 7230/11008 [00:02<00:01, 3774.19it/s] 69%|██████▉   | 7650/11008 [00:02<00:00, 3866.92it/s] 73%|███████▎  | 8037/11008 [00:02<00:00, 3788.07it/s] 76%|███████▋  | 8416/11008 [00:02<00:00, 3635.24it/s] 80%|███████▉  | 8781/11008 [00:02<00:00, 3509.24it/s] 83%|████████▎ | 9165/11008 [00:02<00:00, 3586.94it/s] 87%|████████▋ | 9570/11008 [00:03<00:00, 3685.24it/s] 90%|█████████ | 9960/11008 [00:03<00:00, 3727.32it/s] 94%|█████████▍| 10334/11008 [00:03<00:00, 3708.07it/s] 97%|█████████▋| 10710/11008 [00:03<00:00, 3704.08it/s]100%|██████████| 11008/11008 [00:03<00:00, 3252.52it/s]
Size of transfer function: 1.76 MB. 

Size of integrand: 37.04 MB. Time to calculate integrand: 0.017287731170654297 s

Getting spherical harmonics
  0%|          | 0/446685 [00:00<?, ?it/s]  1%|▏         | 5820/446685 [00:00<00:07, 55425.54it/s]  3%|▎         | 11363/446685 [00:00<00:08, 52069.28it/s]  4%|▍         | 17460/446685 [00:00<00:08, 52858.05it/s]  5%|▌         | 22749/446685 [00:00<00:09, 45702.60it/s]  6%|▌         | 27417/446685 [00:00<00:09, 44516.56it/s]  7%|▋         | 32592/446685 [00:00<00:09, 45583.02it/s]  9%|▊         | 38412/446685 [00:00<00:08, 48259.65it/s] 10%|▉         | 43280/446685 [00:00<00:08, 47408.09it/s] 11%|█         | 48306/446685 [00:01<00:08, 46712.41it/s] 12%|█▏        | 54126/446685 [00:01<00:07, 49244.41it/s] 13%|█▎        | 59072/446685 [00:01<00:07, 48955.64it/s] 14%|█▍        | 63981/446685 [00:01<00:08, 47722.59it/s] 15%|█▌        | 68765/446685 [00:01<00:08, 45716.46it/s] 16%|█▋        | 73354/446685 [00:01<00:08, 44102.76it/s] 18%|█▊        | 78570/446685 [00:01<00:08, 44601.16it/s] 19%|█▊        | 83040/446685 [00:01<00:08, 42777.73it/s] 20%|█▉        | 87329/446685 [00:01<00:08, 41953.26it/s] 21%|██        | 91956/446685 [00:02<00:08, 42937.07it/s] 22%|██▏       | 97194/446685 [00:02<00:07, 44988.01it/s] 23%|██▎       | 102432/446685 [00:02<00:07, 45517.61it/s] 24%|██▍       | 107670/446685 [00:02<00:07, 45946.20it/s] 25%|██▌       | 112908/446685 [00:02<00:07, 46795.67it/s] 27%|██▋       | 119310/446685 [00:02<00:06, 51651.53it/s] 28%|██▊       | 125130/446685 [00:02<00:06, 52310.65it/s] 30%|██▉       | 132696/446685 [00:02<00:05, 58636.69it/s] 31%|███▏      | 139680/446685 [00:02<00:05, 60923.57it/s] 33%|███▎      | 145798/446685 [00:02<00:05, 56440.38it/s] 34%|███▍      | 151515/446685 [00:03<00:05, 56052.06it/s] 35%|███▌      | 157170/446685 [00:03<00:05, 55919.23it/s] 37%|███▋      | 164124/446685 [00:03<00:04, 59109.86it/s] 38%|███▊      | 171181/446685 [00:03<00:04, 62400.18it/s] 40%|███▉      | 177457/446685 [00:03<00:04, 58433.81it/s] 41%|████      | 183370/446685 [00:03<00:04, 55580.89it/s] 42%|████▏     | 189150/446685 [00:03<00:04, 55832.74it/s] 44%|████▍     | 196716/446685 [00:03<00:04, 60377.82it/s] 45%|████▌     | 203118/446685 [00:03<00:04, 60262.57it/s] 47%|████▋     | 209175/446685 [00:04<00:04, 58509.70it/s] 48%|████▊     | 216504/446685 [00:04<00:03, 61227.67it/s] 50%|█████     | 224070/446685 [00:04<00:03, 63780.04it/s] 52%|█████▏    | 230472/446685 [00:04<00:03, 62458.73it/s] 54%|█████▎    | 239784/446685 [00:04<00:02, 70210.58it/s] 55%|█████▌    | 246831/446685 [00:04<00:02, 69602.11it/s] 57%|█████▋    | 254916/446685 [00:04<00:02, 71695.34it/s] 59%|█████▊    | 262098/446685 [00:04<00:02, 69591.94it/s] 60%|██████    | 269073/446685 [00:04<00:02, 62923.70it/s] 62%|██████▏   | 275478/446685 [00:05<00:02, 61907.14it/s] 63%|██████▎   | 282852/446685 [00:05<00:02, 65108.87it/s] 65%|██████▌   | 290418/446685 [00:05<00:02, 66670.15it/s] 67%|██████▋   | 297145/446685 [00:05<00:02, 64961.99it/s] 68%|██████▊   | 304968/446685 [00:05<00:02, 67792.90it/s] 70%|██████▉   | 311952/446685 [00:05<00:01, 68366.26it/s] 71%|███████▏  | 318820/446685 [00:05<00:02, 61441.96it/s] 73%|███████▎  | 325338/446685 [00:05<00:01, 61673.29it/s] 74%|███████▍  | 331605/446685 [00:05<00:01, 60776.29it/s] 76%|███████▌  | 339306/446685 [00:06<00:01, 64661.46it/s] 78%|███████▊  | 346290/446685 [00:06<00:01, 65740.44it/s] 79%|███████▉  | 352915/446685 [00:06<00:01, 64246.55it/s] 80%|████████  | 359378/446685 [00:06<00:01, 63714.35it/s] 82%|████████▏ | 367242/446685 [00:06<00:01, 66751.69it/s] 84%|████████▎ | 373934/446685 [00:06<00:01, 63276.57it/s] 85%|████████▌ | 380628/446685 [00:06<00:01, 63292.18it/s] 87%|████████▋ | 386985/446685 [00:06<00:00, 62126.37it/s] 88%|████████▊ | 394596/446685 [00:06<00:00, 65989.58it/s] 90%|████████▉ | 401229/446685 [00:07<00:00, 61323.23it/s] 91%|█████████ | 407439/446685 [00:07<00:00, 58964.59it/s] 93%|█████████▎| 414966/446685 [00:07<00:00, 62168.51it/s] 94%|█████████▍| 421237/446685 [00:07<00:00, 61124.91it/s] 96%|█████████▌| 427770/446685 [00:07<00:00, 62190.19it/s] 97%|█████████▋| 434172/446685 [00:07<00:00, 62219.92it/s] 99%|█████████▊| 440416/446685 [00:07<00:00, 61585.28it/s]100%|█████████▉| 446590/446685 [00:07<00:00, 59585.25it/s]100%|██████████| 446685/446685 [00:07<00:00, 57539.67it/s]
The spherical harmonics array is 393.62 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 60.20403790473938 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 0.7427090724455064
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.0004, 'pow_max': 0.00045000000000000004, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 11.79it/s] 21%|██        | 4/19 [00:00<00:01, 12.56it/s] 32%|███▏      | 6/19 [00:00<00:00, 13.13it/s] 42%|████▏     | 8/19 [00:00<00:00, 13.74it/s] 53%|█████▎    | 10/19 [00:00<00:00, 14.61it/s] 63%|██████▎   | 12/19 [00:00<00:00, 15.54it/s] 74%|███████▎  | 14/19 [00:00<00:00, 16.60it/s] 89%|████████▉ | 17/19 [00:01<00:00, 18.19it/s]100%|██████████| 19/19 [00:01<00:00, 16.26it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6356712 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 0.7475569248199463 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07026981873647886
Ratio of unique |k|: 0.0017317128729443774
Time to get unique k and theta: 1.5569891929626465 seconds

Getting transfer functions
  0%|          | 0/11008 [00:00<?, ?it/s]  1%|▏         | 165/11008 [00:00<00:06, 1622.14it/s]  4%|▎         | 390/11008 [00:00<00:05, 1946.86it/s]  6%|▌         | 660/11008 [00:00<00:04, 2247.87it/s]  8%|▊         | 915/11008 [00:00<00:04, 2351.77it/s] 11%|█         | 1185/11008 [00:00<00:04, 2444.72it/s] 13%|█▎        | 1440/11008 [00:00<00:03, 2469.18it/s] 16%|█▌        | 1710/11008 [00:00<00:03, 2513.00it/s] 18%|█▊        | 1962/11008 [00:00<00:03, 2373.08it/s] 20%|█▉        | 2201/11008 [00:00<00:03, 2323.12it/s] 22%|██▏       | 2435/11008 [00:01<00:03, 2295.25it/s] 24%|██▍       | 2666/11008 [00:01<00:03, 2285.87it/s] 26%|██▋       | 2895/11008 [00:01<00:03, 2257.37it/s] 30%|██▉       | 3300/11008 [00:01<00:02, 2775.34it/s] 33%|███▎      | 3660/11008 [00:01<00:02, 3017.61it/s] 36%|███▋      | 4005/11008 [00:01<00:02, 3132.44it/s] 40%|███▉      | 4350/11008 [00:01<00:02, 3225.99it/s] 43%|████▎     | 4695/11008 [00:01<00:01, 3270.68it/s] 46%|████▌     | 5025/11008 [00:01<00:01, 3258.22it/s] 49%|████▉     | 5370/11008 [00:01<00:01, 3312.19it/s] 52%|█████▏    | 5715/11008 [00:02<00:01, 3330.32it/s] 55%|█████▌    | 6075/11008 [00:02<00:01, 3399.78it/s] 58%|█████▊    | 6416/11008 [00:02<00:01, 3388.76it/s] 61%|██████▏   | 6756/11008 [00:02<00:01, 3363.07it/s] 64%|██████▍   | 7093/11008 [00:02<00:01, 3320.79it/s] 67%|██████▋   | 7426/11008 [00:02<00:01, 3175.78it/s] 70%|███████   | 7755/11008 [00:02<00:01, 3196.22it/s] 73%|███████▎  | 8085/11008 [00:02<00:00, 3224.72it/s] 76%|███████▋  | 8415/11008 [00:02<00:00, 3231.24it/s] 79%|███████▉  | 8739/11008 [00:03<00:00, 3179.79it/s] 83%|████████▎ | 9135/11008 [00:03<00:00, 3365.67it/s] 86%|████████▌ | 9480/11008 [00:03<00:00, 3353.42it/s] 89%|████████▉ | 9840/11008 [00:03<00:00, 3416.66it/s] 93%|█████████▎| 10215/11008 [00:03<00:00, 3498.26it/s] 96%|█████████▌| 10566/11008 [00:03<00:00, 3443.30it/s] 99%|█████████▉| 10920/11008 [00:03<00:00, 3444.87it/s]100%|██████████| 11008/11008 [00:03<00:00, 3024.96it/s]
Size of transfer function: 1.76 MB. 

Size of integrand: 37.04 MB. Time to calculate integrand: 0.02280569076538086 s

Getting spherical harmonics
  0%|          | 0/446685 [00:00<?, ?it/s]  1%|          | 4656/446685 [00:00<00:10, 43718.93it/s]  2%|▏         | 9894/446685 [00:00<00:09, 45324.86it/s]  3%|▎         | 15132/446685 [00:00<00:09, 46225.70it/s]  5%|▍         | 20370/446685 [00:00<00:09, 46321.71it/s]  6%|▌         | 25608/446685 [00:00<00:08, 48146.78it/s]  7%|▋         | 30434/446685 [00:00<00:11, 36154.79it/s]  8%|▊         | 34428/446685 [00:00<00:11, 35755.63it/s]  9%|▊         | 38994/446685 [00:00<00:10, 38150.12it/s] 10%|▉         | 43027/446685 [00:01<00:10, 37417.09it/s] 11%|█         | 47724/446685 [00:01<00:10, 38460.64it/s] 12%|█▏        | 52380/446685 [00:01<00:09, 39679.27it/s] 13%|█▎        | 56454/446685 [00:01<00:09, 39429.13it/s] 14%|█▍        | 62274/446685 [00:01<00:08, 43603.87it/s] 15%|█▍        | 66681/446685 [00:01<00:08, 42882.82it/s] 16%|█▌        | 71000/446685 [00:01<00:08, 42388.62it/s] 17%|█▋        | 75259/446685 [00:01<00:09, 40848.82it/s] 18%|█▊        | 80898/446685 [00:01<00:08, 44091.70it/s] 19%|█▉        | 86136/446685 [00:02<00:07, 45262.30it/s] 20%|██        | 91353/446685 [00:02<00:07, 47206.22it/s] 22%|██▏       | 96612/446685 [00:02<00:07, 48040.13it/s] 23%|██▎       | 101969/446685 [00:02<00:06, 49629.28it/s] 24%|██▍       | 107088/446685 [00:02<00:06, 49210.39it/s] 25%|██▌       | 112908/446685 [00:02<00:06, 50855.42it/s] 27%|██▋       | 118728/446685 [00:02<00:06, 52133.87it/s] 28%|██▊       | 125712/446685 [00:02<00:05, 56709.68it/s] 30%|██▉       | 132114/446685 [00:02<00:05, 58270.48it/s] 31%|███       | 137950/446685 [00:02<00:05, 57029.72it/s] 32%|███▏      | 143662/446685 [00:03<00:05, 56837.91it/s] 33%|███▎      | 149352/446685 [00:03<00:05, 54161.40it/s] 35%|███▍      | 154793/446685 [00:03<00:08, 36424.47it/s] 36%|███▌      | 160050/446685 [00:03<00:07, 39222.75it/s] 37%|███▋      | 165870/446685 [00:03<00:06, 43579.43it/s] 38%|███▊      | 171108/446685 [00:03<00:06, 44506.55it/s] 39%|███▉      | 175966/446685 [00:03<00:06, 42523.79it/s] 40%|████      | 180508/446685 [00:04<00:06, 41661.94it/s] 42%|████▏     | 186341/446685 [00:04<00:05, 45987.43it/s] 43%|████▎     | 193224/446685 [00:04<00:04, 51190.41it/s] 45%|████▍     | 199626/446685 [00:04<00:04, 54015.95it/s] 46%|████▋     | 206610/446685 [00:04<00:04, 57848.59it/s] 48%|████▊     | 213594/446685 [00:04<00:03, 60160.55it/s] 49%|████▉     | 220578/446685 [00:04<00:03, 61896.47it/s] 51%|█████     | 226828/446685 [00:04<00:03, 59883.67it/s] 52%|█████▏    | 232866/446685 [00:04<00:03, 57018.11it/s] 54%|█████▍    | 240366/446685 [00:05<00:03, 60713.13it/s] 55%|█████▌    | 246483/446685 [00:05<00:03, 60243.00it/s] 57%|█████▋    | 253170/446685 [00:05<00:03, 61200.22it/s] 58%|█████▊    | 259313/446685 [00:05<00:03, 60715.12it/s] 59%|█████▉    | 265400/446685 [00:05<00:03, 55312.25it/s] 61%|██████    | 272376/446685 [00:05<00:03, 58057.46it/s] 62%|██████▏   | 278257/446685 [00:05<00:02, 57854.72it/s] 64%|██████▍   | 285180/446685 [00:05<00:02, 60654.37it/s] 65%|██████▌   | 291582/446685 [00:05<00:02, 61606.28it/s] 67%|██████▋   | 297984/446685 [00:05<00:02, 61208.09it/s] 68%|██████▊   | 304968/446685 [00:06<00:02, 63467.18it/s] 70%|██████▉   | 311370/446685 [00:06<00:02, 62296.77it/s] 71%|███████   | 317621/446685 [00:06<00:02, 61839.65it/s] 72%|███████▏  | 323819/446685 [00:06<00:02, 57038.19it/s] 74%|███████▍  | 329597/446685 [00:06<00:02, 55535.58it/s] 75%|███████▌  | 335232/446685 [00:06<00:02, 55286.20it/s] 76%|███████▋  | 341052/446685 [00:06<00:01, 55845.38it/s] 78%|███████▊  | 348036/446685 [00:06<00:01, 59309.90it/s] 80%|███████▉  | 355602/446685 [00:06<00:01, 62655.32it/s] 81%|████████  | 362004/446685 [00:07<00:01, 62893.54it/s] 83%|████████▎ | 368988/446685 [00:07<00:01, 62916.83it/s] 84%|████████▍ | 375390/446685 [00:07<00:01, 62366.61it/s] 85%|████████▌ | 381632/446685 [00:07<00:01, 57794.70it/s] 87%|████████▋ | 387612/446685 [00:07<00:01, 57800.55it/s] 88%|████████▊ | 394596/446685 [00:07<00:00, 60824.15it/s] 90%|████████▉ | 401580/446685 [00:07<00:00, 62488.08it/s] 91%|█████████▏| 408564/446685 [00:07<00:00, 63803.28it/s] 93%|█████████▎| 416130/446685 [00:07<00:00, 66075.33it/s] 95%|█████████▍| 422756/446685 [00:08<00:00, 59261.66it/s] 96%|█████████▌| 428812/446685 [00:08<00:00, 58410.81it/s] 97%|█████████▋| 435336/446685 [00:08<00:00, 60274.74it/s] 99%|█████████▉| 442902/446685 [00:08<00:00, 64086.86it/s]100%|██████████| 446685/446685 [00:08<00:00, 53021.30it/s]
The spherical harmonics array is 393.62 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 61.73475909233093 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 0.7679955596373422
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.0005, 'pow_max': 0.00055, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 14.32it/s] 21%|██        | 4/19 [00:00<00:00, 16.07it/s] 32%|███▏      | 6/19 [00:00<00:00, 17.26it/s] 47%|████▋     | 9/19 [00:00<00:00, 18.73it/s] 63%|██████▎   | 12/19 [00:00<00:00, 20.28it/s] 79%|███████▉  | 15/19 [00:00<00:00, 21.29it/s] 95%|█████████▍| 18/19 [00:00<00:00, 21.96it/s]100%|██████████| 19/19 [00:00<00:00, 20.27it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6356712 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 0.7753653526306152 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07026981873647886
Ratio of unique |k|: 0.0017317128729443774
Time to get unique k and theta: 1.5588738918304443 seconds

Getting transfer functions
  0%|          | 0/11008 [00:00<?, ?it/s]  0%|          | 15/11008 [00:00<02:11, 83.82it/s]  1%|          | 135/11008 [00:00<00:19, 569.27it/s]  3%|▎         | 375/11008 [00:00<00:08, 1265.29it/s]  6%|▌         | 615/11008 [00:00<00:06, 1648.86it/s]  8%|▊         | 870/11008 [00:00<00:05, 1917.81it/s] 10%|█         | 1125/11008 [00:00<00:04, 2077.73it/s] 12%|█▏        | 1365/11008 [00:00<00:04, 2140.31it/s] 15%|█▍        | 1620/11008 [00:00<00:04, 2220.03it/s] 17%|█▋        | 1875/11008 [00:01<00:03, 2287.32it/s] 19%|█▉        | 2130/11008 [00:01<00:03, 2330.67it/s] 22%|██▏       | 2370/11008 [00:01<00:03, 2330.34it/s] 24%|██▎       | 2610/11008 [00:01<00:03, 2332.24it/s] 26%|██▌       | 2865/11008 [00:01<00:03, 2380.77it/s] 29%|██▉       | 3210/11008 [00:01<00:02, 2688.99it/s] 32%|███▏      | 3570/11008 [00:01<00:02, 2940.28it/s] 36%|███▌      | 3930/11008 [00:01<00:02, 3104.62it/s] 39%|███▉      | 4275/11008 [00:01<00:02, 3195.30it/s] 42%|████▏     | 4620/11008 [00:01<00:01, 3227.53it/s] 45%|████▍     | 4944/11008 [00:02<00:01, 3219.28it/s] 48%|████▊     | 5267/11008 [00:02<00:01, 3220.66it/s] 51%|█████     | 5595/11008 [00:02<00:01, 3212.84it/s] 54%|█████▍    | 5940/11008 [00:02<00:01, 3271.64it/s] 57%|█████▋    | 6268/11008 [00:02<00:01, 3258.75it/s] 60%|█████▉    | 6594/11008 [00:02<00:01, 3238.74it/s] 63%|██████▎   | 6960/11008 [00:02<00:01, 3339.98it/s] 66%|██████▋   | 7305/11008 [00:02<00:01, 3370.82it/s] 70%|██████▉   | 7695/11008 [00:02<00:00, 3522.39it/s] 73%|███████▎  | 8048/11008 [00:02<00:00, 3503.68it/s] 76%|███████▋  | 8400/11008 [00:03<00:00, 3470.73it/s] 79%|███████▉  | 8748/11008 [00:03<00:00, 3463.26it/s] 83%|████████▎ | 9095/11008 [00:03<00:00, 3399.77it/s] 86%|████████▌ | 9436/11008 [00:03<00:00, 3376.82it/s] 89%|████████▉ | 9825/11008 [00:03<00:00, 3475.89it/s] 92%|█████████▏| 10173/11008 [00:03<00:00, 3439.96it/s] 96%|█████████▌| 10560/11008 [00:03<00:00, 3544.51it/s] 99%|█████████▉| 10920/11008 [00:03<00:00, 3547.37it/s]100%|██████████| 11008/11008 [00:03<00:00, 2897.13it/s]
Size of transfer function: 1.76 MB. 

Size of integrand: 37.04 MB. Time to calculate integrand: 0.02273869514465332 s

Getting spherical harmonics
  0%|          | 0/446685 [00:00<?, ?it/s]  1%|          | 4074/446685 [00:00<00:11, 37345.69it/s]  2%|▏         | 9312/446685 [00:00<00:09, 45856.88it/s]  3%|▎         | 13968/446685 [00:00<00:09, 44330.08it/s]  4%|▍         | 18624/446685 [00:00<00:09, 43695.15it/s]  5%|▌         | 23008/446685 [00:00<00:12, 34349.15it/s]  6%|▌         | 26692/446685 [00:00<00:16, 25222.68it/s]  7%|▋         | 29646/446685 [00:00<00:17, 24120.60it/s]  8%|▊         | 34338/446685 [00:01<00:14, 29040.44it/s]  9%|▉         | 39576/446685 [00:01<00:11, 34563.35it/s] 10%|▉         | 44232/446685 [00:01<00:10, 37158.15it/s] 11%|█         | 48306/446685 [00:01<00:10, 37541.06it/s] 12%|█▏        | 52962/446685 [00:01<00:10, 39136.21it/s] 13%|█▎        | 57041/446685 [00:01<00:12, 32443.89it/s] 14%|█▎        | 60572/446685 [00:01<00:12, 32046.38it/s] 14%|█▍        | 64602/446685 [00:01<00:11, 33729.99it/s] 15%|█▌        | 68676/446685 [00:02<00:10, 34835.83it/s] 17%|█▋        | 73914/446685 [00:02<00:09, 37845.87it/s] 18%|█▊        | 78570/446685 [00:02<00:09, 39786.68it/s] 19%|█▊        | 82644/446685 [00:02<00:09, 39661.36it/s] 20%|█▉        | 87300/446685 [00:02<00:08, 40785.41it/s] 20%|██        | 91419/446685 [00:02<00:08, 39733.43it/s] 21%|██▏       | 96030/446685 [00:02<00:08, 40373.04it/s] 23%|██▎       | 100686/446685 [00:02<00:08, 41446.42it/s] 24%|██▎       | 105342/446685 [00:02<00:08, 41284.98it/s] 25%|██▍       | 109998/446685 [00:02<00:08, 41923.09it/s] 26%|██▌       | 116400/446685 [00:03<00:06, 47250.16it/s] 27%|██▋       | 122220/446685 [00:03<00:06, 49290.82it/s] 29%|██▊       | 128040/446685 [00:03<00:06, 51677.52it/s] 30%|███       | 135024/446685 [00:03<00:05, 54353.61it/s] 32%|███▏      | 142008/446685 [00:03<00:05, 57521.02it/s] 33%|███▎      | 147763/446685 [00:03<00:05, 57152.04it/s] 35%|███▍      | 155394/446685 [00:03<00:04, 61827.57it/s] 36%|███▋      | 162378/446685 [00:03<00:04, 63647.12it/s] 38%|███▊      | 168780/446685 [00:03<00:04, 61506.04it/s] 39%|███▉      | 174947/446685 [00:04<00:04, 59263.95it/s] 41%|████      | 181584/446685 [00:04<00:04, 60802.74it/s] 42%|████▏     | 188568/446685 [00:04<00:04, 62447.86it/s] 44%|████▍     | 195552/446685 [00:04<00:04, 61923.49it/s] 45%|████▌     | 201954/446685 [00:04<00:03, 62480.19it/s] 47%|████▋     | 208356/446685 [00:04<00:03, 61100.75it/s] 48%|████▊     | 215922/446685 [00:04<00:03, 64401.46it/s] 50%|████▉     | 222378/446685 [00:04<00:03, 64357.09it/s] 51%|█████     | 228825/446685 [00:04<00:03, 58650.22it/s] 53%|█████▎    | 234784/446685 [00:05<00:03, 57229.68it/s] 54%|█████▍    | 242112/446685 [00:05<00:03, 61056.78it/s] 56%|█████▌    | 248514/446685 [00:05<00:03, 61168.38it/s] 57%|█████▋    | 254916/446685 [00:05<00:03, 60916.66it/s] 58%|█████▊    | 261041/446685 [00:05<00:03, 54033.20it/s] 60%|█████▉    | 266593/446685 [00:05<00:03, 50507.44it/s] 61%|██████    | 272958/446685 [00:05<00:03, 53650.91it/s] 63%|██████▎   | 281688/446685 [00:05<00:02, 62665.66it/s] 65%|██████▍   | 288672/446685 [00:05<00:02, 62609.21it/s] 66%|██████▌   | 295074/446685 [00:06<00:02, 62344.66it/s] 67%|██████▋   | 301476/446685 [00:06<00:02, 61886.78it/s] 69%|██████▉   | 307728/446685 [00:06<00:02, 58595.99it/s] 70%|███████   | 314280/446685 [00:06<00:02, 59881.14it/s] 72%|███████▏  | 320323/446685 [00:06<00:02, 57663.91it/s] 73%|███████▎  | 327084/446685 [00:06<00:02, 58849.05it/s] 75%|███████▍  | 333486/446685 [00:06<00:01, 59918.37it/s] 76%|███████▌  | 339507/446685 [00:06<00:01, 58870.47it/s] 77%|███████▋  | 345708/446685 [00:06<00:01, 58407.92it/s] 79%|███████▉  | 352110/446685 [00:07<00:01, 58425.77it/s] 80%|████████  | 359094/446685 [00:07<00:01, 61142.54it/s] 82%|████████▏ | 365225/446685 [00:07<00:01, 59424.76it/s] 83%|████████▎ | 371898/446685 [00:07<00:01, 60824.81it/s] 85%|████████▍ | 378882/446685 [00:07<00:01, 61886.06it/s] 86%|████████▌ | 385080/446685 [00:07<00:01, 60995.44it/s] 88%|████████▊ | 392850/446685 [00:07<00:00, 64227.33it/s] 89%|████████▉ | 399273/446685 [00:07<00:00, 63314.63it/s] 91%|█████████ | 406818/446685 [00:07<00:00, 66154.10it/s] 93%|█████████▎| 413439/446685 [00:07<00:00, 65073.85it/s] 94%|█████████▍| 419951/446685 [00:08<00:00, 53981.03it/s] 96%|█████████▌| 426606/446685 [00:08<00:00, 56032.72it/s] 97%|█████████▋| 434754/446685 [00:08<00:00, 62560.87it/s] 99%|█████████▉| 441738/446685 [00:08<00:00, 63553.51it/s]100%|██████████| 446685/446685 [00:08<00:00, 52317.70it/s]
The spherical harmonics array is 393.62 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 84.186119556427 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 0.7447949159031434
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.0006, 'pow_max': 0.00065, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 19.56it/s] 26%|██▋       | 5/19 [00:00<00:00, 21.15it/s] 42%|████▏     | 8/19 [00:00<00:00, 22.08it/s] 58%|█████▊    | 11/19 [00:00<00:00, 22.06it/s] 74%|███████▎  | 14/19 [00:00<00:00, 22.33it/s] 89%|████████▉ | 17/19 [00:00<00:00, 22.48it/s]100%|██████████| 19/19 [00:00<00:00, 22.18it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6356712 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 0.7630898952484131 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07026981873647886
Ratio of unique |k|: 0.0017317128729443774
Time to get unique k and theta: 1.5762889385223389 seconds

Getting transfer functions
  0%|          | 0/11008 [00:00<?, ?it/s]  1%|          | 75/11008 [00:00<00:15, 715.19it/s]  3%|▎         | 330/11008 [00:00<00:06, 1725.32it/s]  5%|▌         | 555/11008 [00:00<00:05, 1948.58it/s]  7%|▋         | 810/11008 [00:00<00:04, 2175.89it/s] 10%|▉         | 1065/11008 [00:00<00:04, 2282.08it/s] 12%|█▏        | 1320/11008 [00:00<00:04, 2332.32it/s] 14%|█▍        | 1575/11008 [00:00<00:03, 2361.91it/s] 17%|█▋        | 1830/11008 [00:00<00:03, 2417.23it/s] 19%|█▉        | 2085/11008 [00:00<00:03, 2445.66it/s] 21%|██▏       | 2355/11008 [00:01<00:03, 2473.55it/s] 24%|██▎       | 2610/11008 [00:01<00:03, 2451.46it/s] 26%|██▌       | 2865/11008 [00:01<00:03, 2447.20it/s] 29%|██▉       | 3225/11008 [00:01<00:02, 2743.83it/s] 33%|███▎      | 3585/11008 [00:01<00:02, 2975.35it/s] 36%|███▌      | 3930/11008 [00:01<00:02, 3097.78it/s] 39%|███▉      | 4275/11008 [00:01<00:02, 3166.06it/s] 42%|████▏     | 4605/11008 [00:01<00:02, 3193.96it/s] 45%|████▍     | 4950/11008 [00:01<00:01, 3261.44it/s] 48%|████▊     | 5295/11008 [00:01<00:01, 3307.60it/s] 51%|█████     | 5626/11008 [00:02<00:01, 3279.39it/s] 54%|█████▍    | 5985/11008 [00:02<00:01, 3349.23it/s] 57%|█████▋    | 6321/11008 [00:02<00:01, 3344.21it/s] 60%|██████    | 6656/11008 [00:02<00:01, 3318.34it/s] 63%|██████▎   | 6990/11008 [00:02<00:01, 3301.20it/s] 67%|██████▋   | 7321/11008 [00:02<00:01, 3228.25it/s] 70%|██████▉   | 7665/11008 [00:02<00:01, 3264.22it/s] 73%|███████▎  | 8010/11008 [00:02<00:00, 3285.69it/s] 76%|███████▌  | 8340/11008 [00:02<00:00, 3276.21it/s] 79%|███████▉  | 8685/11008 [00:02<00:00, 3296.26it/s] 82%|████████▏ | 9015/11008 [00:03<00:00, 3274.87it/s] 85%|████████▍ | 9345/11008 [00:03<00:00, 3245.79it/s] 88%|████████▊ | 9735/11008 [00:03<00:00, 3407.64it/s] 92%|█████████▏| 10095/11008 [00:03<00:00, 3436.26it/s] 95%|█████████▍| 10455/11008 [00:03<00:00, 3435.22it/s] 98%|█████████▊| 10800/11008 [00:03<00:00, 3415.92it/s]100%|██████████| 11008/11008 [00:03<00:00, 2999.92it/s]
Size of transfer function: 1.76 MB. 

Size of integrand: 37.04 MB. Time to calculate integrand: 0.022121191024780273 s

Getting spherical harmonics
  0%|          | 0/446685 [00:00<?, ?it/s]  1%|          | 4656/446685 [00:00<00:10, 40354.60it/s]  2%|▏         | 9894/446685 [00:00<00:09, 44922.44it/s]  3%|▎         | 14399/446685 [00:00<00:09, 43928.11it/s]  4%|▍         | 18796/446685 [00:00<00:09, 43711.19it/s]  5%|▌         | 23280/446685 [00:00<00:09, 43399.03it/s]  6%|▋         | 27936/446685 [00:00<00:09, 43686.14it/s]  7%|▋         | 32306/446685 [00:00<00:14, 28514.75it/s]  8%|▊         | 35779/446685 [00:01<00:14, 27872.86it/s]  9%|▉         | 40158/446685 [00:01<00:13, 30821.30it/s] 10%|█         | 45396/446685 [00:01<00:11, 35513.49it/s] 11%|█         | 50052/446685 [00:01<00:10, 37937.68it/s] 12%|█▏        | 54708/446685 [00:01<00:10, 38334.45it/s] 13%|█▎        | 58735/446685 [00:01<00:10, 36622.44it/s] 14%|█▍        | 62856/446685 [00:01<00:10, 36716.45it/s] 15%|█▌        | 67512/446685 [00:01<00:09, 39261.20it/s] 16%|█▌        | 72218/446685 [00:01<00:09, 41412.80it/s] 17%|█▋        | 76824/446685 [00:02<00:08, 42715.88it/s] 18%|█▊        | 82062/446685 [00:02<00:08, 44305.00it/s] 20%|█▉        | 87300/446685 [00:02<00:07, 45299.22it/s] 21%|██        | 91956/446685 [00:02<00:07, 44748.21it/s] 22%|██▏       | 96452/446685 [00:02<00:07, 43974.20it/s] 23%|██▎       | 100864/446685 [00:02<00:08, 40949.27it/s] 24%|██▎       | 105342/446685 [00:02<00:08, 41312.96it/s] 25%|██▍       | 109998/446685 [00:02<00:08, 41870.15it/s] 26%|██▌       | 114654/446685 [00:02<00:07, 42513.62it/s] 27%|██▋       | 119892/446685 [00:03<00:07, 42664.87it/s] 28%|██▊       | 126294/446685 [00:03<00:06, 47509.69it/s] 30%|██▉       | 133278/446685 [00:03<00:05, 52716.56it/s] 31%|███       | 139098/446685 [00:03<00:05, 52516.04it/s] 32%|███▏      | 144918/446685 [00:03<00:05, 53287.19it/s] 34%|███▍      | 151320/446685 [00:03<00:05, 55405.61it/s] 35%|███▌      | 157722/446685 [00:03<00:05, 56156.63it/s] 37%|███▋      | 163349/446685 [00:03<00:05, 56027.55it/s] 38%|███▊      | 169362/446685 [00:03<00:04, 56404.37it/s] 39%|███▉      | 175008/446685 [00:03<00:05, 52927.04it/s] 40%|████      | 180338/446685 [00:04<00:05, 52116.02it/s] 42%|████▏     | 185658/446685 [00:04<00:05, 52187.81it/s] 43%|████▎     | 191478/446685 [00:04<00:04, 52101.48it/s] 44%|████▍     | 197066/446685 [00:04<00:04, 53168.62it/s] 45%|████▌     | 203173/446685 [00:04<00:04, 55440.91it/s] 47%|████▋     | 208738/446685 [00:04<00:04, 51891.16it/s] 48%|████▊     | 213981/446685 [00:04<00:04, 51216.56it/s] 50%|████▉     | 221160/446685 [00:04<00:03, 56691.91it/s] 51%|█████     | 226880/446685 [00:04<00:03, 56334.53it/s] 52%|█████▏    | 233382/446685 [00:05<00:03, 58325.15it/s] 54%|█████▎    | 239242/446685 [00:05<00:03, 55545.08it/s] 55%|█████▍    | 245022/446685 [00:05<00:03, 54588.85it/s] 56%|█████▌    | 250842/446685 [00:05<00:03, 54603.23it/s] 57%|█████▋    | 256662/446685 [00:05<00:03, 55359.54it/s] 59%|█████▊    | 262216/446685 [00:05<00:03, 51088.74it/s] 60%|██████    | 268884/446685 [00:05<00:03, 54580.38it/s] 62%|██████▏   | 275286/446685 [00:05<00:02, 57171.06it/s] 63%|██████▎   | 281068/446685 [00:05<00:02, 55967.27it/s] 64%|██████▍   | 286711/446685 [00:06<00:02, 54463.76it/s] 66%|██████▌   | 292746/446685 [00:06<00:02, 56043.16it/s] 67%|██████▋   | 298566/446685 [00:06<00:02, 56487.32it/s] 69%|██████▊   | 306132/446685 [00:06<00:02, 58173.28it/s] 70%|███████   | 313674/446685 [00:06<00:02, 63000.77it/s] 72%|███████▏  | 320009/446685 [00:06<00:02, 59957.34it/s] 73%|███████▎  | 326049/446685 [00:06<00:02, 58385.14it/s] 74%|███████▍  | 331919/446685 [00:06<00:02, 54598.37it/s] 76%|███████▌  | 338724/446685 [00:06<00:01, 57093.56it/s] 77%|███████▋  | 344483/446685 [00:07<00:01, 57094.02it/s] 79%|███████▊  | 350946/446685 [00:07<00:01, 58920.59it/s] 81%|████████  | 360258/446685 [00:07<00:01, 68130.66it/s] 82%|████████▏ | 367120/446685 [00:07<00:01, 66190.33it/s] 84%|████████▎ | 373780/446685 [00:07<00:01, 63653.08it/s] 85%|████████▌ | 380185/446685 [00:07<00:01, 61609.76it/s] 86%|████████▋ | 386378/446685 [00:07<00:00, 61627.80it/s] 88%|████████▊ | 392563/446685 [00:07<00:00, 61160.40it/s] 89%|████████▉ | 399252/446685 [00:07<00:00, 62554.02it/s] 91%|█████████ | 406818/446685 [00:07<00:00, 65892.16it/s] 93%|█████████▎| 413423/446685 [00:08<00:00, 65834.08it/s] 94%|█████████▍| 420017/446685 [00:08<00:00, 59708.01it/s] 95%|█████████▌| 426098/446685 [00:08<00:00, 52908.18it/s] 97%|█████████▋| 434172/446685 [00:08<00:00, 58588.86it/s] 99%|█████████▊| 440215/446685 [00:08<00:00, 58413.31it/s]100%|██████████| 446685/446685 [00:08<00:00, 51475.78it/s]
The spherical harmonics array is 393.62 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 73.60572791099548 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 0.7283686115060475
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.0007, 'pow_max': 0.00075, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 15.95it/s] 21%|██        | 4/19 [00:00<00:00, 17.10it/s] 32%|███▏      | 6/19 [00:00<00:00, 18.15it/s] 47%|████▋     | 9/19 [00:00<00:00, 19.64it/s] 63%|██████▎   | 12/19 [00:00<00:00, 20.98it/s] 79%|███████▉  | 15/19 [00:00<00:00, 21.80it/s] 95%|█████████▍| 18/19 [00:00<00:00, 22.16it/s]100%|██████████| 19/19 [00:00<00:00, 20.86it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6356712 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 0.7569084167480469 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07026981873647886
Ratio of unique |k|: 0.0017317128729443774
Time to get unique k and theta: 1.5721056461334229 seconds

Getting transfer functions
  0%|          | 0/11008 [00:00<?, ?it/s]  1%|          | 75/11008 [00:00<00:15, 704.15it/s]  3%|▎         | 300/11008 [00:00<00:06, 1584.16it/s]  5%|▍         | 540/11008 [00:00<00:05, 1939.52it/s]  7%|▋         | 795/11008 [00:00<00:04, 2173.28it/s]  9%|▉         | 1035/11008 [00:00<00:04, 2212.55it/s] 12%|█▏        | 1305/11008 [00:00<00:04, 2324.83it/s] 14%|█▍        | 1560/11008 [00:00<00:03, 2364.77it/s] 16%|█▋        | 1815/11008 [00:00<00:03, 2415.47it/s] 19%|█▊        | 2057/11008 [00:00<00:03, 2412.20it/s] 21%|██        | 2325/11008 [00:01<00:03, 2486.20it/s] 23%|██▎       | 2580/11008 [00:01<00:03, 2492.02it/s] 26%|██▌       | 2830/11008 [00:01<00:03, 2473.26it/s] 29%|██▉       | 3165/11008 [00:01<00:02, 2721.07it/s] 32%|███▏      | 3510/11008 [00:01<00:02, 2911.62it/s] 35%|███▌      | 3870/11008 [00:01<00:02, 3106.53it/s] 38%|███▊      | 4200/11008 [00:01<00:02, 3135.44it/s] 41%|████▏     | 4545/11008 [00:01<00:02, 3191.38it/s] 45%|████▍     | 4905/11008 [00:01<00:01, 3296.24it/s] 48%|████▊     | 5235/11008 [00:01<00:01, 3284.68it/s] 51%|█████     | 5565/11008 [00:02<00:01, 3265.97it/s] 54%|█████▎    | 5910/11008 [00:02<00:01, 3279.39it/s] 57%|█████▋    | 6255/11008 [00:02<00:01, 3320.23it/s] 60%|█████▉    | 6588/11008 [00:02<00:01, 3310.99it/s] 63%|██████▎   | 6961/11008 [00:02<00:01, 3434.89it/s] 66%|██████▋   | 7305/11008 [00:02<00:01, 3404.85it/s] 70%|██████▉   | 7695/11008 [00:02<00:00, 3517.16it/s] 73%|███████▎  | 8047/11008 [00:02<00:00, 3502.82it/s] 76%|███████▋  | 8400/11008 [00:02<00:00, 3488.15it/s] 80%|███████▉  | 8760/11008 [00:02<00:00, 3492.68it/s] 83%|████████▎ | 9110/11008 [00:03<00:00, 3451.67it/s] 86%|████████▌ | 9480/11008 [00:03<00:00, 3502.86it/s] 90%|████████▉ | 9870/11008 [00:03<00:00, 3602.22it/s] 93%|█████████▎| 10231/11008 [00:03<00:00, 3577.58it/s] 96%|█████████▌| 10590/11008 [00:03<00:00, 3549.61it/s] 99%|█████████▉| 10950/11008 [00:03<00:00, 3550.35it/s]100%|██████████| 11008/11008 [00:03<00:00, 3059.09it/s]
Size of transfer function: 1.76 MB. 

Size of integrand: 37.04 MB. Time to calculate integrand: 0.023860931396484375 s

Getting spherical harmonics
  0%|          | 0/446685 [00:00<?, ?it/s]  1%|▏         | 5820/446685 [00:00<00:08, 55026.24it/s]  3%|▎         | 11323/446685 [00:00<00:08, 54220.43it/s]  4%|▍         | 16992/446685 [00:00<00:07, 55321.64it/s]  5%|▌         | 22526/446685 [00:00<00:08, 53008.25it/s]  6%|▌         | 27840/446685 [00:00<00:08, 46992.58it/s]  7%|▋         | 33174/446685 [00:00<00:08, 48119.89it/s]  9%|▊         | 38058/446685 [00:00<00:08, 46279.33it/s] 10%|▉         | 42736/446685 [00:00<00:08, 45206.25it/s] 11%|█         | 47288/446685 [00:00<00:08, 45042.43it/s] 12%|█▏        | 52380/446685 [00:01<00:08, 46745.80it/s] 13%|█▎        | 57080/446685 [00:01<00:08, 46396.18it/s] 14%|█▍        | 62856/446685 [00:01<00:07, 48330.28it/s] 15%|█▌        | 68676/446685 [00:01<00:07, 48808.45it/s] 16%|█▋        | 73558/446685 [00:01<00:07, 48801.73it/s] 18%|█▊        | 78570/446685 [00:01<00:07, 49057.61it/s] 19%|█▉        | 83808/446685 [00:01<00:07, 49058.61it/s] 20%|█▉        | 89046/446685 [00:01<00:07, 48755.80it/s] 21%|██        | 93924/446685 [00:01<00:07, 48267.39it/s] 22%|██▏       | 98751/446685 [00:02<00:07, 46035.13it/s] 23%|██▎       | 103370/446685 [00:02<00:07, 45550.45it/s] 24%|██▍       | 107934/446685 [00:02<00:07, 44460.48it/s] 25%|██▌       | 112388/446685 [00:02<00:07, 43411.46it/s] 27%|██▋       | 119310/446685 [00:02<00:06, 49865.03it/s] 28%|██▊       | 125712/446685 [00:02<00:06, 53338.79it/s] 30%|██▉       | 132696/446685 [00:02<00:05, 57065.95it/s] 31%|███▏      | 139680/446685 [00:02<00:05, 60568.01it/s] 33%|███▎      | 147828/446685 [00:02<00:04, 65261.23it/s] 35%|███▍      | 154362/446685 [00:03<00:04, 61490.84it/s] 36%|███▌      | 160632/446685 [00:03<00:04, 60635.99it/s] 37%|███▋      | 167034/446685 [00:03<00:04, 60915.05it/s] 39%|███▉      | 173436/446685 [00:03<00:04, 61523.57it/s] 41%|████      | 181002/446685 [00:03<00:04, 65188.93it/s] 42%|████▏     | 187986/446685 [00:03<00:03, 66261.27it/s] 44%|████▎     | 194970/446685 [00:03<00:03, 66181.02it/s] 45%|████▌     | 203118/446685 [00:03<00:03, 69452.73it/s] 47%|████▋     | 210102/446685 [00:03<00:03, 68950.51it/s] 49%|████▊     | 217001/446685 [00:03<00:03, 64594.68it/s] 50%|█████     | 223510/446685 [00:04<00:03, 63748.81it/s] 52%|█████▏    | 230472/446685 [00:04<00:03, 63437.31it/s] 53%|█████▎    | 238038/446685 [00:04<00:03, 66147.80it/s] 55%|█████▍    | 245022/446685 [00:04<00:03, 64464.34it/s] 56%|█████▋    | 251494/446685 [00:04<00:03, 64045.49it/s] 58%|█████▊    | 259572/446685 [00:04<00:02, 67772.70it/s] 60%|█████▉    | 267720/446685 [00:04<00:02, 70872.15it/s] 62%|██████▏   | 275868/446685 [00:04<00:02, 73174.70it/s] 63%|██████▎   | 283434/446685 [00:04<00:02, 71976.27it/s] 65%|██████▌   | 290647/446685 [00:05<00:02, 69931.09it/s] 67%|██████▋   | 297656/446685 [00:05<00:02, 62533.96it/s] 68%|██████▊   | 304386/446685 [00:05<00:02, 63708.23it/s] 70%|██████▉   | 311370/446685 [00:05<00:02, 63946.46it/s] 71%|███████▏  | 318354/446685 [00:05<00:01, 64931.04it/s] 73%|███████▎  | 325920/446685 [00:05<00:01, 67393.59it/s] 74%|███████▍  | 332711/446685 [00:05<00:01, 65495.96it/s] 76%|███████▋  | 341052/446685 [00:05<00:01, 68837.46it/s] 78%|███████▊  | 347963/446685 [00:05<00:01, 66926.16it/s] 79%|███████▉  | 354678/446685 [00:06<00:01, 61473.42it/s] 81%|████████  | 360907/446685 [00:06<00:01, 59285.48it/s] 83%|████████▎ | 369570/446685 [00:06<00:01, 65792.01it/s] 84%|████████▍ | 376235/446685 [00:06<00:01, 65457.15it/s] 86%|████████▌ | 382956/446685 [00:06<00:00, 65861.58it/s] 88%|████████▊ | 391104/446685 [00:06<00:00, 69170.82it/s] 89%|████████▉ | 398054/446685 [00:06<00:00, 68656.33it/s] 91%|█████████ | 404941/446685 [00:06<00:00, 63428.96it/s] 92%|█████████▏| 411366/446685 [00:06<00:00, 62697.91it/s] 94%|█████████▎| 417876/446685 [00:07<00:00, 62820.65it/s] 95%|█████████▌| 425442/446685 [00:07<00:00, 66449.00it/s] 97%|█████████▋| 434172/446685 [00:07<00:00, 70791.13it/s] 99%|█████████▉| 441278/446685 [00:07<00:00, 69353.61it/s]100%|██████████| 446685/446685 [00:07<00:00, 59990.19it/s]
The spherical harmonics array is 393.62 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 71.9139130115509 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 0.6988758439694785
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.0008, 'pow_max': 0.0008500000000000001, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 15.61it/s] 26%|██▋       | 5/19 [00:00<00:00, 18.68it/s] 42%|████▏     | 8/19 [00:00<00:00, 20.39it/s] 58%|█████▊    | 11/19 [00:00<00:00, 21.18it/s] 74%|███████▎  | 14/19 [00:00<00:00, 21.90it/s] 89%|████████▉ | 17/19 [00:00<00:00, 22.33it/s]100%|██████████| 19/19 [00:00<00:00, 21.37it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6356712 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 0.7545530796051025 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07026981873647886
Ratio of unique |k|: 0.0017317128729443774
Time to get unique k and theta: 1.5259082317352295 seconds

Getting transfer functions
  0%|          | 0/11008 [00:00<?, ?it/s]  2%|▏         | 225/11008 [00:00<00:04, 2168.13it/s]  4%|▍         | 495/11008 [00:00<00:04, 2425.39it/s]  7%|▋         | 765/11008 [00:00<00:04, 2509.93it/s]  9%|▉         | 1020/11008 [00:00<00:04, 2477.66it/s] 12%|█▏        | 1320/11008 [00:00<00:03, 2652.38it/s] 14%|█▍        | 1590/11008 [00:00<00:03, 2662.72it/s] 17%|█▋        | 1857/11008 [00:00<00:03, 2649.33it/s] 19%|█▉        | 2123/11008 [00:00<00:03, 2566.23it/s] 22%|██▏       | 2381/11008 [00:00<00:03, 2553.63it/s] 24%|██▍       | 2655/11008 [00:01<00:03, 2561.90it/s] 26%|██▋       | 2912/11008 [00:01<00:03, 2520.62it/s] 30%|██▉       | 3300/11008 [00:01<00:02, 2886.71it/s] 33%|███▎      | 3630/11008 [00:01<00:02, 3002.37it/s] 36%|███▌      | 3975/11008 [00:01<00:02, 3097.13it/s] 39%|███▉      | 4320/11008 [00:01<00:02, 3167.84it/s] 43%|████▎     | 4680/11008 [00:01<00:01, 3258.23it/s] 46%|████▌     | 5025/11008 [00:01<00:01, 3296.76it/s] 49%|████▉     | 5415/11008 [00:01<00:01, 3426.58it/s] 52%|█████▏    | 5758/11008 [00:01<00:01, 3389.69it/s] 55%|█████▌    | 6097/11008 [00:02<00:01, 3311.82it/s] 58%|█████▊    | 6429/11008 [00:02<00:01, 3267.11it/s] 61%|██████▏   | 6765/11008 [00:02<00:01, 3269.98it/s] 64%|██████▍   | 7095/11008 [00:02<00:01, 3275.92it/s] 68%|██████▊   | 7455/11008 [00:02<00:01, 3341.16it/s] 71%|███████   | 7815/11008 [00:02<00:00, 3395.11it/s] 74%|███████▍  | 8190/11008 [00:02<00:00, 3484.06it/s] 78%|███████▊  | 8539/11008 [00:02<00:00, 3383.18it/s] 81%|████████  | 8880/11008 [00:02<00:00, 3383.55it/s] 84%|████████▍ | 9255/11008 [00:03<00:00, 3468.15it/s] 87%|████████▋ | 9615/11008 [00:03<00:00, 3478.67it/s] 91%|█████████ | 9964/11008 [00:03<00:00, 3309.47it/s] 94%|█████████▍| 10335/11008 [00:03<00:00, 3404.86it/s] 97%|█████████▋| 10710/11008 [00:03<00:00, 3480.34it/s]100%|██████████| 11008/11008 [00:03<00:00, 3132.33it/s]
Size of transfer function: 1.76 MB. 

Size of integrand: 37.04 MB. Time to calculate integrand: 0.019443988800048828 s

Getting spherical harmonics
  0%|          | 0/446685 [00:00<?, ?it/s]  1%|          | 5238/446685 [00:00<00:09, 48333.32it/s]  2%|▏         | 11058/446685 [00:00<00:08, 51880.83it/s]  4%|▎         | 16296/446685 [00:00<00:08, 50361.27it/s]  5%|▍         | 21334/446685 [00:00<00:09, 46803.99it/s]  6%|▌         | 26038/446685 [00:00<00:09, 43907.57it/s]  7%|▋         | 30456/446685 [00:00<00:09, 42558.91it/s]  8%|▊         | 36084/446685 [00:00<00:08, 45710.34it/s]  9%|▉         | 40740/446685 [00:00<00:09, 44303.49it/s] 10%|█         | 46560/446685 [00:01<00:08, 46432.20it/s] 11%|█▏        | 51212/446685 [00:01<00:08, 45382.68it/s] 12%|█▏        | 55754/446685 [00:01<00:08, 44999.88it/s] 13%|█▎        | 60255/446685 [00:01<00:08, 43575.09it/s] 14%|█▍        | 64615/446685 [00:01<00:08, 43236.67it/s] 16%|█▌        | 69258/446685 [00:01<00:08, 43812.38it/s] 16%|█▋        | 73642/446685 [00:01<00:08, 42907.61it/s] 18%|█▊        | 79734/446685 [00:01<00:07, 47404.31it/s] 19%|█▉        | 84972/446685 [00:01<00:07, 47809.86it/s] 20%|██        | 89757/446685 [00:01<00:07, 46851.17it/s] 21%|██        | 94866/446685 [00:02<00:07, 46732.34it/s] 22%|██▏       | 100104/446685 [00:02<00:07, 47505.67it/s] 23%|██▎       | 104857/446685 [00:02<00:07, 46929.95it/s] 25%|██▍       | 109998/446685 [00:02<00:07, 46647.36it/s] 26%|██▌       | 115236/446685 [00:02<00:06, 48152.80it/s] 27%|██▋       | 121056/446685 [00:02<00:06, 50294.28it/s] 29%|██▊       | 128040/446685 [00:02<00:05, 54594.88it/s] 30%|██▉       | 133497/446685 [00:02<00:05, 53396.31it/s] 31%|███       | 139098/446685 [00:02<00:05, 52932.16it/s] 32%|███▏      | 144391/446685 [00:03<00:06, 48974.93it/s] 34%|███▍      | 151320/446685 [00:03<00:05, 53462.43it/s] 35%|███▌      | 157140/446685 [00:03<00:05, 54398.48it/s] 37%|███▋      | 163542/446685 [00:03<00:05, 56161.77it/s] 38%|███▊      | 169362/446685 [00:03<00:05, 55105.95it/s] 39%|███▉      | 175182/446685 [00:03<00:04, 54553.52it/s] 40%|████      | 180655/446685 [00:03<00:05, 52618.09it/s] 42%|████▏     | 186822/446685 [00:03<00:04, 54283.01it/s] 43%|████▎     | 192268/446685 [00:03<00:04, 54109.16it/s] 44%|████▍     | 198048/446685 [00:04<00:04, 55165.65it/s] 46%|████▌     | 203578/446685 [00:04<00:04, 54735.73it/s] 47%|████▋     | 209520/446685 [00:04<00:04, 55307.82it/s] 48%|████▊     | 215340/446685 [00:04<00:04, 56122.13it/s] 50%|████▉     | 222324/446685 [00:04<00:03, 58337.86it/s] 51%|█████     | 228726/446685 [00:04<00:03, 59122.40it/s] 53%|█████▎    | 235710/446685 [00:04<00:03, 60352.01it/s] 54%|█████▍    | 241739/446685 [00:04<00:03, 59453.30it/s] 55%|█████▌    | 247679/446685 [00:04<00:03, 59033.57it/s] 57%|█████▋    | 253578/446685 [00:04<00:03, 56239.34it/s] 58%|█████▊    | 259219/446685 [00:05<00:03, 54179.75it/s] 59%|█████▉    | 264810/446685 [00:05<00:03, 54236.87it/s] 61%|██████    | 272958/446685 [00:05<00:02, 61054.91it/s] 63%|██████▎   | 279942/446685 [00:05<00:02, 61216.77it/s] 64%|██████▍   | 286078/446685 [00:05<00:02, 58014.62it/s] 65%|██████▌   | 291910/446685 [00:05<00:02, 56543.48it/s] 67%|██████▋   | 297584/446685 [00:05<00:02, 56385.48it/s] 68%|██████▊   | 303235/446685 [00:05<00:02, 53934.51it/s] 69%|██████▉   | 308649/446685 [00:05<00:02, 52938.16it/s] 70%|███████   | 313955/446685 [00:06<00:02, 50303.96it/s] 72%|███████▏  | 320682/446685 [00:06<00:02, 54937.56it/s] 73%|███████▎  | 326502/446685 [00:06<00:02, 54745.45it/s] 75%|███████▍  | 332904/446685 [00:06<00:02, 55549.14it/s] 76%|███████▌  | 338485/446685 [00:06<00:02, 52959.81it/s] 77%|███████▋  | 343812/446685 [00:06<00:01, 52946.16it/s] 79%|███████▊  | 350946/446685 [00:06<00:01, 57870.88it/s] 80%|███████▉  | 356772/446685 [00:06<00:01, 56027.34it/s] 81%|████████▏ | 363750/446685 [00:06<00:01, 59708.80it/s] 83%|████████▎ | 371316/446685 [00:07<00:01, 63346.78it/s] 85%|████████▍ | 378300/446685 [00:07<00:01, 65097.50it/s] 86%|████████▌ | 384838/446685 [00:07<00:00, 64325.03it/s] 88%|████████▊ | 391291/446685 [00:07<00:00, 61821.03it/s] 89%|████████▉ | 397502/446685 [00:07<00:00, 59041.22it/s] 90%|█████████ | 403443/446685 [00:07<00:00, 55693.50it/s] 92%|█████████▏| 409728/446685 [00:07<00:00, 54589.69it/s] 93%|█████████▎| 416130/446685 [00:07<00:00, 56252.47it/s] 94%|█████████▍| 421793/446685 [00:07<00:00, 55133.04it/s] 96%|█████████▌| 427330/446685 [00:08<00:00, 54973.51it/s] 97%|█████████▋| 433008/446685 [00:08<00:00, 55449.11it/s] 98%|█████████▊| 438828/446685 [00:08<00:00, 54842.44it/s]100%|█████████▉| 445230/446685 [00:08<00:00, 55978.76it/s]100%|██████████| 446685/446685 [00:08<00:00, 53326.73it/s]
The spherical harmonics array is 393.62 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 81.16516327857971 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 0.7073773623696554
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.0009, 'pow_max': 0.00095, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 14.27it/s] 21%|██        | 4/19 [00:00<00:00, 15.99it/s] 32%|███▏      | 6/19 [00:00<00:00, 17.05it/s] 47%|████▋     | 9/19 [00:00<00:00, 18.83it/s] 63%|██████▎   | 12/19 [00:00<00:00, 20.14it/s] 79%|███████▉  | 15/19 [00:00<00:00, 21.22it/s] 95%|█████████▍| 18/19 [00:00<00:00, 21.78it/s]100%|██████████| 19/19 [00:00<00:00, 20.18it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519392886365851
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6356712 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 0.7631058692932129 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07026981873647886
Ratio of unique |k|: 0.0017317128729443774
Time to get unique k and theta: 1.55924654006958 seconds

Getting transfer functions
  0%|          | 0/11008 [00:00<?, ?it/s]  2%|▏         | 180/11008 [00:00<00:06, 1754.98it/s]  4%|▍         | 425/11008 [00:00<00:04, 2159.44it/s]  6%|▌         | 642/11008 [00:00<00:05, 1914.78it/s]  8%|▊         | 885/11008 [00:00<00:04, 2069.90it/s] 10%|█         | 1140/11008 [00:00<00:04, 2192.28it/s] 13%|█▎        | 1395/11008 [00:00<00:04, 2262.06it/s] 15%|█▍        | 1650/11008 [00:00<00:04, 2310.03it/s] 17%|█▋        | 1890/11008 [00:00<00:03, 2330.69it/s] 19%|█▉        | 2145/11008 [00:00<00:03, 2378.56it/s] 22%|██▏       | 2400/11008 [00:01<00:03, 2400.39it/s] 24%|██▍       | 2641/11008 [00:01<00:03, 2342.63it/s] 26%|██▌       | 2876/11008 [00:01<00:03, 2337.80it/s] 29%|██▉       | 3240/11008 [00:01<00:02, 2706.22it/s] 33%|███▎      | 3600/11008 [00:01<00:02, 2933.10it/s] 36%|███▌      | 3960/11008 [00:01<00:02, 3127.97it/s] 40%|███▉      | 4350/11008 [00:01<00:02, 3313.74it/s] 43%|████▎     | 4682/11008 [00:01<00:01, 3246.71it/s] 46%|████▌     | 5010/11008 [00:01<00:01, 3246.15it/s] 48%|████▊     | 5335/11008 [00:01<00:01, 3159.38it/s] 51%|█████▏    | 5655/11008 [00:02<00:01, 3156.56it/s] 55%|█████▍    | 6000/11008 [00:02<00:01, 3215.53it/s] 58%|█████▊    | 6330/11008 [00:02<00:01, 3237.33it/s] 61%|██████    | 6690/11008 [00:02<00:01, 3315.91it/s] 64%|██████▍   | 7035/11008 [00:02<00:01, 3331.69it/s] 67%|██████▋   | 7369/11008 [00:02<00:01, 3316.29it/s] 70%|██████▉   | 7701/11008 [00:02<00:01, 3184.68it/s] 73%|███████▎  | 8055/11008 [00:02<00:00, 3257.45it/s] 76%|███████▋  | 8400/11008 [00:02<00:00, 3311.15it/s] 80%|███████▉  | 8790/11008 [00:03<00:00, 3460.79it/s] 84%|████████▎ | 9195/11008 [00:03<00:00, 3632.33it/s] 87%|████████▋ | 9570/11008 [00:03<00:00, 3652.21it/s] 90%|█████████ | 9960/11008 [00:03<00:00, 3713.21it/s] 94%|█████████▍| 10332/11008 [00:03<00:00, 3609.04it/s] 97%|█████████▋| 10694/11008 [00:03<00:00, 3524.64it/s]100%|██████████| 11008/11008 [00:03<00:00, 3004.86it/s]
Size of transfer function: 1.76 MB. 

Size of integrand: 37.04 MB. Time to calculate integrand: 0.033776283264160156 s

Getting spherical harmonics
  0%|          | 0/446685 [00:00<?, ?it/s]  1%|          | 5238/446685 [00:00<00:08, 49980.92it/s]  3%|▎         | 11640/446685 [00:00<00:07, 56232.11it/s]  4%|▍         | 17262/446685 [00:00<00:08, 52098.81it/s]  5%|▌         | 22495/446685 [00:00<00:08, 50818.03it/s]  6%|▌         | 27588/446685 [00:00<00:08, 49488.39it/s]  7%|▋         | 32592/446685 [00:00<00:08, 49109.50it/s]  8%|▊         | 37506/446685 [00:00<00:09, 44905.18it/s] 10%|▉         | 42486/446685 [00:00<00:08, 45148.69it/s] 11%|█         | 47724/446685 [00:00<00:08, 46938.68it/s] 12%|█▏        | 52962/446685 [00:01<00:08, 48474.41it/s] 13%|█▎        | 57846/446685 [00:01<00:08, 48305.11it/s] 14%|█▍        | 62856/446685 [00:01<00:08, 47710.19it/s] 15%|█▌        | 67645/446685 [00:01<00:08, 47083.31it/s] 16%|█▋        | 72750/446685 [00:01<00:07, 47668.33it/s] 18%|█▊        | 78230/446685 [00:01<00:07, 49740.51it/s] 19%|█▊        | 83218/446685 [00:01<00:07, 46730.46it/s] 20%|█▉        | 87933/446685 [00:01<00:08, 44047.80it/s] 21%|██        | 92538/446685 [00:01<00:08, 42943.29it/s] 22%|██▏       | 97194/446685 [00:02<00:08, 42401.71it/s] 23%|██▎       | 102432/446685 [00:02<00:07, 44039.06it/s] 24%|██▍       | 107670/446685 [00:02<00:07, 45521.69it/s] 25%|██▌       | 113490/446685 [00:02<00:06, 48684.21it/s] 27%|██▋       | 121056/446685 [00:02<00:05, 56185.39it/s] 28%|██▊       | 126876/446685 [00:02<00:05, 56647.62it/s] 30%|██▉       | 132584/446685 [00:02<00:05, 56645.26it/s] 31%|███       | 138279/446685 [00:02<00:05, 55520.63it/s] 32%|███▏      | 143856/446685 [00:02<00:05, 51362.86it/s] 33%|███▎      | 149063/446685 [00:03<00:05, 50201.05it/s] 35%|███▍      | 154230/446685 [00:03<00:05, 50343.34it/s] 36%|███▌      | 159468/446685 [00:03<00:05, 49707.09it/s] 37%|███▋      | 167034/446685 [00:03<00:04, 56859.78it/s] 39%|███▉      | 173436/446685 [00:03<00:04, 57508.89it/s] 40%|████      | 179838/446685 [00:03<00:04, 58346.13it/s] 42%|████▏     | 186240/446685 [00:03<00:04, 59803.14it/s] 43%|████▎     | 192244/446685 [00:03<00:04, 56050.76it/s] 44%|████▍     | 197906/446685 [00:03<00:04, 54755.30it/s] 46%|████▋     | 206610/446685 [00:04<00:03, 63162.95it/s] 48%|████▊     | 214176/446685 [00:04<00:03, 66510.66it/s] 49%|████▉     | 220890/446685 [00:04<00:03, 61615.09it/s] 51%|█████     | 227562/446685 [00:04<00:03, 61741.82it/s] 52%|█████▏    | 233810/446685 [00:04<00:03, 59869.14it/s] 54%|█████▎    | 239850/446685 [00:04<00:03, 58873.70it/s] 55%|█████▌    | 245772/446685 [00:04<00:03, 53443.07it/s] 56%|█████▋    | 252006/446685 [00:04<00:03, 55208.10it/s] 58%|█████▊    | 257613/446685 [00:04<00:03, 54730.74it/s] 59%|█████▉    | 263143/446685 [00:05<00:03, 54237.45it/s] 60%|██████    | 269466/446685 [00:05<00:03, 55587.12it/s] 62%|██████▏   | 277614/446685 [00:05<00:02, 61311.03it/s] 64%|██████▎   | 283763/446685 [00:05<00:02, 54975.43it/s] 65%|██████▍   | 289836/446685 [00:05<00:02, 55953.18it/s] 66%|██████▋   | 296238/446685 [00:05<00:02, 58149.59it/s] 68%|██████▊   | 302138/446685 [00:05<00:02, 58311.97it/s] 69%|██████▉   | 308030/446685 [00:05<00:02, 57356.61it/s] 70%|███████   | 313808/446685 [00:05<00:02, 55636.39it/s] 72%|███████▏  | 320100/446685 [00:06<00:02, 56825.63it/s] 73%|███████▎  | 325920/446685 [00:06<00:02, 56883.51it/s] 74%|███████▍  | 331740/446685 [00:06<00:02, 56028.97it/s] 76%|███████▌  | 337357/446685 [00:06<00:01, 56007.71it/s] 77%|███████▋  | 343962/446685 [00:06<00:01, 57949.59it/s] 79%|███████▊  | 350946/446685 [00:06<00:01, 58545.12it/s] 80%|███████▉  | 356800/446685 [00:06<00:01, 58389.77it/s] 81%|████████▏ | 363168/446685 [00:06<00:01, 58802.08it/s] 83%|████████▎ | 369048/446685 [00:06<00:01, 58322.28it/s] 84%|████████▍ | 374879/446685 [00:06<00:01, 58072.42it/s] 85%|████████▌ | 380685/446685 [00:07<00:01, 55924.46it/s] 87%|████████▋ | 388776/446685 [00:07<00:00, 60676.85it/s] 88%|████████▊ | 395178/446685 [00:07<00:00, 61274.74it/s] 90%|█████████ | 402162/446685 [00:07<00:00, 63586.74it/s] 91%|█████████▏| 408527/446685 [00:07<00:00, 60009.41it/s] 93%|█████████▎| 414966/446685 [00:07<00:00, 60548.23it/s] 94%|█████████▍| 421049/446685 [00:07<00:00, 60580.04it/s] 96%|█████████▌| 427127/446685 [00:07<00:00, 55598.50it/s] 97%|█████████▋| 433008/446685 [00:07<00:00, 56015.82it/s] 99%|█████████▊| 439992/446685 [00:08<00:00, 59289.61it/s]100%|█████████▉| 445978/446685 [00:08<00:00, 54500.38it/s]100%|██████████| 446685/446685 [00:08<00:00, 54598.60it/s]
The spherical harmonics array is 393.62 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 81.6537926197052 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 0.7020263661068348
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.001, 'pow_max': 0.00105, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 18.97it/s] 26%|██▋       | 5/19 [00:00<00:00, 20.13it/s] 42%|████▏     | 8/19 [00:00<00:00, 21.30it/s] 58%|█████▊    | 11/19 [00:00<00:00, 22.06it/s] 74%|███████▎  | 14/19 [00:00<00:00, 22.51it/s] 89%|████████▉ | 17/19 [00:00<00:00, 22.77it/s]100%|██████████| 19/19 [00:00<00:00, 22.22it/s]
Done. k_max for TT ell_max = 0.022696475761330413 k_max for EE ell_max = 0.08518711301992739
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6346392 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 0.719111442565918 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07027236893025203
Ratio of unique |k|: 0.0017326380091239244
Time to get unique k and theta: 1.4999043941497803 seconds

Getting transfer functions
  0%|          | 0/10996 [00:00<?, ?it/s]  2%|▏         | 210/10996 [00:00<00:05, 2083.86it/s]  4%|▍         | 480/10996 [00:00<00:04, 2390.04it/s]  7%|▋         | 765/10996 [00:00<00:04, 2548.34it/s]  9%|▉         | 1035/10996 [00:00<00:03, 2584.59it/s] 12%|█▏        | 1305/10996 [00:00<00:03, 2607.34it/s] 14%|█▍        | 1575/10996 [00:00<00:03, 2612.96it/s] 17%|█▋        | 1845/10996 [00:00<00:03, 2614.53it/s] 19%|█▉        | 2115/10996 [00:00<00:03, 2628.85it/s] 22%|██▏       | 2378/10996 [00:00<00:03, 2609.08it/s] 24%|██▍       | 2640/10996 [00:01<00:03, 2568.02it/s] 27%|██▋       | 2940/10996 [00:01<00:02, 2689.07it/s] 30%|██▉       | 3285/10996 [00:01<00:02, 2881.51it/s] 33%|███▎      | 3600/10996 [00:01<00:02, 2960.02it/s] 36%|███▌      | 3945/10996 [00:01<00:02, 3054.88it/s] 39%|███▉      | 4290/10996 [00:01<00:02, 3143.65it/s] 42%|████▏     | 4650/10996 [00:01<00:01, 3252.99it/s] 45%|████▌     | 4980/10996 [00:01<00:01, 3255.59it/s] 48%|████▊     | 5325/10996 [00:01<00:01, 3291.75it/s] 51%|█████▏    | 5655/10996 [00:01<00:01, 3219.05it/s] 55%|█████▍    | 6000/10996 [00:02<00:01, 3258.27it/s] 58%|█████▊    | 6375/10996 [00:02<00:01, 3365.85it/s] 61%|██████    | 6720/10996 [00:02<00:01, 3368.81it/s] 64%|██████▍   | 7057/10996 [00:02<00:01, 3362.91it/s] 67%|██████▋   | 7395/10996 [00:02<00:01, 3361.64it/s] 70%|███████   | 7740/10996 [00:02<00:00, 3358.10it/s] 73%|███████▎  | 8076/10996 [00:02<00:00, 3193.88it/s] 77%|███████▋  | 8415/10996 [00:02<00:00, 3248.31it/s] 80%|███████▉  | 8790/10996 [00:02<00:00, 3365.21it/s] 83%|████████▎ | 9165/10996 [00:02<00:00, 3466.21it/s] 87%|████████▋ | 9513/10996 [00:03<00:00, 3385.50it/s] 90%|████████▉ | 9870/10996 [00:03<00:00, 3429.46it/s] 93%|█████████▎| 10245/10996 [00:03<00:00, 3507.81it/s] 96%|█████████▋| 10605/10996 [00:03<00:00, 3481.19it/s]100%|█████████▉| 10954/10996 [00:03<00:00, 3473.66it/s]100%|██████████| 10996/10996 [00:03<00:00, 3123.81it/s]
Size of transfer function: 1.76 MB. 

Size of integrand: 37.0 MB. Time to calculate integrand: 0.023305654525756836 s

Getting spherical harmonics
  0%|          | 0/445976 [00:00<?, ?it/s]  1%|▏         | 5810/445976 [00:00<00:08, 54244.13it/s]  3%|▎         | 11235/445976 [00:00<00:08, 52798.18it/s]  4%|▎         | 16514/445976 [00:00<00:08, 49874.20it/s]  5%|▍         | 21512/445976 [00:00<00:10, 42361.01it/s]  6%|▌         | 27307/445976 [00:00<00:09, 46498.15it/s]  7%|▋         | 32086/445976 [00:00<00:08, 46190.47it/s]  8%|▊         | 36788/445976 [00:00<00:08, 45818.91it/s]  9%|▉         | 41424/445976 [00:00<00:08, 45375.85it/s] 11%|█         | 47061/445976 [00:00<00:08, 47922.40it/s] 12%|█▏        | 51883/445976 [00:01<00:08, 47146.54it/s] 13%|█▎        | 56938/445976 [00:01<00:08, 47258.34it/s] 14%|█▍        | 61678/445976 [00:01<00:08, 47089.42it/s] 15%|█▍        | 66396/445976 [00:01<00:08, 45199.49it/s] 16%|█▌        | 71463/445976 [00:01<00:08, 44909.57it/s] 17%|█▋        | 76692/445976 [00:01<00:08, 44741.48it/s] 18%|█▊        | 81340/445976 [00:01<00:08, 44137.40it/s] 19%|█▉        | 85988/445976 [00:01<00:08, 44470.79it/s] 21%|██        | 91798/445976 [00:01<00:07, 47706.77it/s] 22%|██▏       | 97608/445976 [00:02<00:06, 50070.03it/s] 23%|██▎       | 103418/445976 [00:02<00:06, 51548.76it/s] 24%|██▍       | 108795/445976 [00:02<00:06, 52186.15it/s] 26%|██▌       | 114457/445976 [00:02<00:06, 52230.99it/s] 28%|██▊       | 123172/445976 [00:02<00:05, 60376.12it/s] 29%|██▉       | 130725/445976 [00:02<00:04, 63990.51it/s] 31%|███       | 137116/445976 [00:02<00:05, 57704.41it/s] 32%|███▏      | 142982/445976 [00:02<00:05, 52886.39it/s] 33%|███▎      | 148387/445976 [00:02<00:05, 52800.73it/s] 34%|███▍      | 153747/445976 [00:03<00:05, 49964.29it/s] 36%|███▌      | 158811/445976 [00:03<00:05, 50083.72it/s] 37%|███▋      | 165585/445976 [00:03<00:05, 53738.71it/s] 39%|███▉      | 173138/445976 [00:03<00:04, 59211.78it/s] 40%|████      | 179120/445976 [00:03<00:04, 59370.42it/s] 42%|████▏     | 187663/445976 [00:03<00:03, 65835.41it/s] 44%|████▍     | 195216/445976 [00:03<00:03, 67439.19it/s] 45%|████▌     | 201984/445976 [00:03<00:04, 59158.71it/s] 47%|████▋     | 208084/445976 [00:04<00:04, 55095.46it/s] 48%|████▊     | 214970/445976 [00:04<00:03, 58533.91it/s] 50%|████▉     | 220985/445976 [00:04<00:03, 58420.43it/s] 51%|█████     | 226939/445976 [00:04<00:03, 56074.31it/s] 53%|█████▎    | 234724/445976 [00:04<00:03, 60839.60it/s] 54%|█████▍    | 241115/445976 [00:04<00:03, 60896.58it/s] 56%|█████▌    | 248087/445976 [00:04<00:03, 60741.55it/s] 57%|█████▋    | 255640/445976 [00:04<00:02, 63539.91it/s] 59%|█████▉    | 262030/445976 [00:04<00:03, 56058.24it/s] 60%|██████    | 268422/445976 [00:05<00:03, 57370.12it/s] 62%|██████▏   | 274813/445976 [00:05<00:02, 58053.27it/s] 63%|██████▎   | 280711/445976 [00:05<00:02, 57354.15it/s] 64%|██████▍   | 287014/445976 [00:05<00:02, 58086.25it/s] 66%|██████▌   | 294458/445976 [00:05<00:02, 62683.04it/s] 67%|██████▋   | 300790/445976 [00:05<00:02, 62718.14it/s] 69%|██████▉   | 307106/445976 [00:05<00:02, 59000.29it/s] 70%|███████   | 313075/445976 [00:05<00:02, 59043.69it/s] 72%|███████▏  | 319028/445976 [00:05<00:02, 51932.67it/s] 73%|███████▎  | 324394/445976 [00:06<00:02, 49443.38it/s] 74%|███████▍  | 331170/445976 [00:06<00:02, 53573.98it/s] 76%|███████▌  | 339304/445976 [00:06<00:01, 57670.54it/s] 77%|███████▋  | 345149/445976 [00:06<00:01, 57540.94it/s] 79%|███████▉  | 352086/445976 [00:06<00:01, 58826.22it/s] 81%|████████  | 359058/445976 [00:06<00:01, 60492.81it/s] 82%|████████▏ | 366030/445976 [00:06<00:01, 62664.50it/s] 84%|████████▎ | 372421/445976 [00:06<00:01, 60778.03it/s] 85%|████████▌ | 379393/445976 [00:06<00:01, 62485.77it/s] 87%|████████▋ | 386365/445976 [00:07<00:00, 63647.19it/s] 88%|████████▊ | 392752/445976 [00:07<00:00, 61583.97it/s] 89%|████████▉ | 398932/445976 [00:07<00:00, 56962.66it/s] 91%|█████████ | 404957/445976 [00:07<00:00, 56832.65it/s] 92%|█████████▏| 410767/445976 [00:07<00:00, 55352.86it/s] 93%|█████████▎| 416334/445976 [00:07<00:00, 55335.34it/s] 95%|█████████▍| 421890/445976 [00:07<00:00, 54559.44it/s] 96%|█████████▌| 428778/445976 [00:07<00:00, 58588.21it/s] 98%|█████████▊| 436331/445976 [00:07<00:00, 62044.00it/s]100%|█████████▉| 443884/445976 [00:07<00:00, 64409.78it/s]100%|██████████| 445976/445976 [00:08<00:00, 55653.39it/s]
The spherical harmonics array is 392.99 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 85.78182625770569 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 0.69996046843886
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.0015, 'pow_max': 0.00155, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 15.40it/s] 21%|██        | 4/19 [00:00<00:00, 17.19it/s] 37%|███▋      | 7/19 [00:00<00:00, 18.59it/s] 53%|█████▎    | 10/19 [00:00<00:00, 20.10it/s] 68%|██████▊   | 13/19 [00:00<00:00, 21.22it/s] 84%|████████▍ | 16/19 [00:00<00:00, 21.92it/s]100%|██████████| 19/19 [00:00<00:00, 22.37it/s]100%|██████████| 19/19 [00:00<00:00, 20.91it/s]
Done. k_max for TT ell_max = 0.01422693794493977 k_max for EE ell_max = 0.08518839099062697
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 3095000 Minimum k_amp 0.00019760140751641845 n_x_max 91 n_z_max 91
Time to get list of k, phi, theta: 0.3804142475128174 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07261873990306947
Ratio of unique |k|: 0.002201292407108239
Time to get unique k and theta: 0.6868364810943604 seconds

Getting transfer functions
  0%|          | 0/6813 [00:00<?, ?it/s]  2%|▏         | 135/6813 [00:00<00:04, 1337.90it/s]  4%|▍         | 288/6813 [00:00<00:04, 1424.79it/s]  7%|▋         | 459/6813 [00:00<00:04, 1533.93it/s]  9%|▉         | 613/6813 [00:00<00:04, 1530.87it/s] 12%|█▏        | 792/6813 [00:00<00:03, 1607.08it/s] 14%|█▍        | 972/6813 [00:00<00:03, 1649.86it/s] 17%|█▋        | 1137/6813 [00:00<00:03, 1640.73it/s] 19%|█▉        | 1323/6813 [00:00<00:03, 1695.03it/s] 22%|██▏       | 1503/6813 [00:00<00:03, 1709.40it/s] 25%|██▍       | 1674/6813 [00:01<00:03, 1664.16it/s] 28%|██▊       | 1899/6813 [00:01<00:02, 1831.35it/s] 31%|███▏      | 2142/6813 [00:01<00:02, 1993.63it/s] 35%|███▍      | 2376/6813 [00:01<00:02, 2075.04it/s] 38%|███▊      | 2610/6813 [00:01<00:01, 2143.64it/s] 42%|████▏     | 2853/6813 [00:01<00:01, 2223.01it/s] 45%|████▌     | 3078/6813 [00:01<00:01, 2224.25it/s] 49%|████▉     | 3330/6813 [00:01<00:01, 2293.13it/s] 52%|█████▏    | 3573/6813 [00:01<00:01, 2309.80it/s] 56%|█████▌    | 3807/6813 [00:01<00:01, 2318.51it/s] 60%|█████▉    | 4068/6813 [00:02<00:01, 2392.38it/s] 63%|██████▎   | 4308/6813 [00:02<00:01, 2333.79it/s] 67%|██████▋   | 4572/6813 [00:02<00:00, 2402.67it/s] 71%|███████   | 4824/6813 [00:02<00:00, 2414.70it/s] 75%|███████▍  | 5085/6813 [00:02<00:00, 2452.31it/s] 78%|███████▊  | 5346/6813 [00:02<00:00, 2471.30it/s] 82%|████████▏ | 5594/6813 [00:02<00:00, 2455.79it/s] 86%|████████▌ | 5841/6813 [00:02<00:00, 2451.35it/s] 89%|████████▉ | 6087/6813 [00:02<00:00, 2406.01it/s] 93%|█████████▎| 6328/6813 [00:02<00:00, 2387.63it/s] 97%|█████████▋| 6588/6813 [00:03<00:00, 2444.59it/s]100%|██████████| 6813/6813 [00:03<00:00, 2144.51it/s]
Size of transfer function: 1.09 MB. 

Size of integrand: 22.92 MB. Time to calculate integrand: 0.014814138412475586 s

Getting spherical harmonics
  0%|          | 0/224755 [00:00<?, ?it/s]  2%|▏         | 4688/224755 [00:00<00:04, 44868.18it/s]  4%|▍         | 9175/224755 [00:00<00:06, 32316.68it/s]  6%|▌         | 12601/224755 [00:00<00:06, 32295.24it/s]  8%|▊         | 16994/224755 [00:00<00:05, 36190.82it/s] 10%|▉         | 21682/224755 [00:00<00:05, 37882.00it/s] 11%|█▏        | 25549/224755 [00:00<00:05, 37088.90it/s] 13%|█▎        | 29593/224755 [00:00<00:05, 37607.92it/s] 15%|█▍        | 33402/224755 [00:00<00:05, 36995.04it/s] 17%|█▋        | 38383/224755 [00:01<00:04, 38890.82it/s] 19%|█▉        | 43657/224755 [00:01<00:04, 42625.07it/s] 21%|██▏       | 47950/224755 [00:01<00:04, 42468.93it/s] 24%|██▎       | 53326/224755 [00:01<00:03, 45427.45it/s] 26%|██▌       | 58600/224755 [00:01<00:03, 47220.64it/s] 28%|██▊       | 63341/224755 [00:01<00:05, 31280.17it/s] 30%|██▉       | 67172/224755 [00:02<00:07, 21441.21it/s] 31%|███       | 70184/224755 [00:02<00:08, 19298.48it/s] 32%|███▏      | 72719/224755 [00:02<00:07, 20064.17it/s] 34%|███▍      | 75887/224755 [00:02<00:06, 21981.86it/s] 35%|███▍      | 78509/224755 [00:02<00:07, 20559.17it/s] 37%|███▋      | 83505/224755 [00:02<00:05, 26395.26it/s] 39%|███▉      | 88486/224755 [00:02<00:04, 31795.22it/s] 41%|████▏     | 93174/224755 [00:02<00:03, 35454.13it/s] 44%|████▍     | 99620/224755 [00:03<00:02, 42823.65it/s] 46%|████▋     | 104262/224755 [00:03<00:02, 42799.20it/s] 48%|████▊     | 108794/224755 [00:03<00:02, 41817.84it/s] 51%|█████     | 114270/224755 [00:03<00:02, 45084.28it/s] 53%|█████▎    | 119837/224755 [00:03<00:02, 46711.95it/s] 56%|█████▌    | 124818/224755 [00:03<00:02, 46893.54it/s] 58%|█████▊    | 129582/224755 [00:03<00:02, 46445.32it/s] 60%|██████    | 135073/224755 [00:03<00:01, 48228.78it/s] 63%|██████▎   | 140933/224755 [00:03<00:01, 48966.48it/s] 65%|██████▍   | 145853/224755 [00:04<00:01, 45531.97it/s] 67%|██████▋   | 150602/224755 [00:04<00:01, 45644.98it/s] 69%|██████▉   | 156169/224755 [00:04<00:01, 47854.48it/s] 72%|███████▏  | 160991/224755 [00:04<00:01, 45008.54it/s] 74%|███████▎  | 165540/224755 [00:04<00:01, 41458.71it/s] 76%|███████▌  | 169940/224755 [00:04<00:01, 41847.35it/s] 78%|███████▊  | 176386/224755 [00:04<00:01, 47826.81it/s] 81%|████████  | 181258/224755 [00:04<00:00, 45682.84it/s] 83%|████████▎ | 186641/224755 [00:04<00:00, 47535.19it/s] 85%|████████▌ | 191459/224755 [00:05<00:00, 42426.04it/s] 87%|████████▋ | 196603/224755 [00:05<00:00, 44771.41it/s] 90%|████████▉ | 201205/224755 [00:05<00:00, 44762.49it/s] 92%|█████████▏| 205768/224755 [00:05<00:00, 43765.16it/s] 94%|█████████▎| 210205/224755 [00:05<00:00, 43928.50it/s] 96%|█████████▌| 215355/224755 [00:05<00:00, 46037.61it/s] 98%|█████████▊| 220629/224755 [00:05<00:00, 47949.83it/s]100%|██████████| 224755/224755 [00:05<00:00, 38850.24it/s]
The spherical harmonics array is 198.05 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 86.04798722267151 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 0.7039994476888344
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.002, 'pow_max': 0.00205, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 15.63it/s] 21%|██        | 4/19 [00:00<00:00, 17.71it/s] 37%|███▋      | 7/19 [00:00<00:00, 19.11it/s] 53%|█████▎    | 10/19 [00:00<00:00, 20.64it/s] 68%|██████▊   | 13/19 [00:00<00:00, 21.54it/s] 84%|████████▍ | 16/19 [00:00<00:00, 21.73it/s]100%|██████████| 19/19 [00:00<00:00, 22.19it/s]100%|██████████| 19/19 [00:00<00:00, 21.03it/s]
Done. k_max for TT ell_max = 0.016480852268776554 k_max for EE ell_max = 0.08520031871715644
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4311140 Minimum k_amp 0.00019760140751641845 n_x_max 101 n_z_max 101
Time to get list of k, phi, theta: 0.5068714618682861 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07155647926070599
Ratio of unique |k|: 0.001970940400914839
Time to get unique k and theta: 1.0055656433105469 seconds

Getting transfer functions
  0%|          | 0/8497 [00:00<?, ?it/s]  2%|▏         | 168/8497 [00:00<00:04, 1676.02it/s]  5%|▍         | 384/8497 [00:00<00:04, 1927.08it/s]  7%|▋         | 600/8497 [00:00<00:03, 2029.47it/s] 10%|▉         | 816/8497 [00:00<00:03, 2039.46it/s] 12%|█▏        | 1044/8497 [00:00<00:03, 2113.00it/s] 15%|█▍        | 1272/8497 [00:00<00:03, 2145.25it/s] 18%|█▊        | 1500/8497 [00:00<00:03, 2167.46it/s] 20%|██        | 1740/8497 [00:00<00:03, 2230.81it/s] 23%|██▎       | 1980/8497 [00:00<00:02, 2253.56it/s] 26%|██▌       | 2208/8497 [00:01<00:02, 2241.07it/s] 29%|██▉       | 2496/8497 [00:01<00:02, 2412.48it/s] 33%|███▎      | 2808/8497 [00:01<00:02, 2613.05it/s] 37%|███▋      | 3108/8497 [00:01<00:01, 2724.40it/s] 40%|████      | 3408/8497 [00:01<00:01, 2783.54it/s] 44%|████▍     | 3756/8497 [00:01<00:01, 2971.96it/s] 48%|████▊     | 4054/8497 [00:01<00:01, 2941.39it/s] 51%|█████     | 4349/8497 [00:01<00:01, 2898.35it/s] 55%|█████▍    | 4656/8497 [00:01<00:01, 2933.41it/s] 59%|█████▉    | 5004/8497 [00:01<00:01, 3050.27it/s] 62%|██████▏   | 5309/8497 [00:02<00:01, 3046.81it/s] 66%|██████▌   | 5616/8497 [00:02<00:00, 3052.27it/s] 70%|███████   | 5952/8497 [00:02<00:00, 3124.07it/s] 74%|███████▍  | 6288/8497 [00:02<00:00, 3166.56it/s] 78%|███████▊  | 6605/8497 [00:02<00:00, 3116.04it/s] 82%|████████▏ | 6936/8497 [00:02<00:00, 3172.20it/s] 85%|████████▌ | 7254/8497 [00:02<00:00, 3107.72it/s] 89%|████████▉ | 7596/8497 [00:02<00:00, 3187.45it/s] 93%|█████████▎| 7916/8497 [00:02<00:00, 3082.87it/s] 97%|█████████▋| 8232/8497 [00:02<00:00, 3101.09it/s]100%|██████████| 8497/8497 [00:03<00:00, 2782.46it/s]
Size of transfer function: 1.36 MB. 

Size of integrand: 28.59 MB. Time to calculate integrand: 0.023240089416503906 s

Getting spherical harmonics
  0%|          | 0/308490 [00:00<?, ?it/s]  1%|▏         | 4422/308490 [00:00<00:06, 43710.33it/s]  3%|▎         | 9246/308490 [00:00<00:06, 44158.92it/s]  4%|▍         | 13668/308490 [00:00<00:06, 44006.45it/s]  6%|▌         | 18068/308490 [00:00<00:07, 37793.86it/s]  7%|▋         | 21950/308490 [00:00<00:07, 38097.27it/s]  8%|▊         | 26130/308490 [00:00<00:07, 38696.08it/s] 10%|▉         | 30049/308490 [00:00<00:09, 29237.23it/s] 11%|█▏        | 35376/308490 [00:00<00:07, 35109.31it/s] 13%|█▎        | 39798/308490 [00:01<00:07, 36759.97it/s] 14%|█▍        | 44622/308490 [00:01<00:06, 39323.36it/s] 16%|█▋        | 50652/308490 [00:01<00:05, 44397.19it/s] 18%|█▊        | 56280/308490 [00:01<00:05, 47251.33it/s] 20%|█▉        | 61160/308490 [00:01<00:05, 44537.77it/s] 21%|██▏       | 65744/308490 [00:01<00:05, 42790.45it/s] 23%|██▎       | 70118/308490 [00:01<00:05, 41834.62it/s] 24%|██▍       | 74365/308490 [00:01<00:05, 40936.63it/s] 26%|██▌       | 78792/308490 [00:01<00:05, 40261.54it/s] 27%|██▋       | 84420/308490 [00:02<00:05, 44034.30it/s] 29%|██▉       | 90048/308490 [00:02<00:04, 46865.08it/s] 31%|███       | 95274/308490 [00:02<00:04, 48193.37it/s] 33%|███▎      | 101304/308490 [00:02<00:04, 51573.12it/s] 35%|███▍      | 106501/308490 [00:02<00:03, 51143.40it/s] 36%|███▌      | 111643/308490 [00:02<00:04, 47749.38it/s] 38%|███▊      | 116580/308490 [00:02<00:04, 47501.91it/s] 39%|███▉      | 121404/308490 [00:02<00:04, 46103.52it/s] 41%|████      | 127032/308490 [00:02<00:03, 48811.21it/s] 43%|████▎     | 131952/308490 [00:03<00:03, 47794.32it/s] 44%|████▍     | 136759/308490 [00:03<00:03, 46514.55it/s] 46%|████▋     | 142710/308490 [00:03<00:03, 49139.38it/s] 48%|████▊     | 147936/308490 [00:03<00:03, 49362.22it/s] 50%|████▉     | 153966/308490 [00:03<00:02, 51988.82it/s] 52%|█████▏    | 159996/308490 [00:03<00:02, 54151.71it/s] 54%|█████▍    | 166026/308490 [00:03<00:02, 55742.53it/s] 56%|█████▌    | 171617/308490 [00:03<00:02, 55125.86it/s] 57%|█████▋    | 177141/308490 [00:03<00:02, 54928.42it/s] 60%|█████▉    | 183622/308490 [00:03<00:02, 57828.60it/s] 61%|██████▏   | 189417/308490 [00:04<00:02, 57199.30it/s] 63%|██████▎   | 195146/308490 [00:04<00:02, 56360.43it/s] 65%|██████▌   | 200790/308490 [00:04<00:01, 56114.39it/s] 67%|██████▋   | 206407/308490 [00:04<00:01, 53266.99it/s] 69%|██████▊   | 211764/308490 [00:04<00:01, 52727.12it/s] 70%|███████   | 217080/308490 [00:04<00:01, 52639.78it/s] 72%|███████▏  | 222708/308490 [00:04<00:01, 52202.78it/s] 74%|███████▍  | 227939/308490 [00:04<00:01, 51041.65it/s] 76%|███████▌  | 234366/308490 [00:04<00:01, 53486.15it/s] 78%|███████▊  | 239718/308490 [00:05<00:01, 51010.22it/s] 80%|███████▉  | 245771/308490 [00:05<00:01, 53671.33it/s] 82%|████████▏ | 252054/308490 [00:05<00:01, 55338.88it/s] 84%|████████▍ | 258486/308490 [00:05<00:00, 57457.35it/s] 86%|████████▌ | 265320/308490 [00:05<00:00, 60119.32it/s] 88%|████████▊ | 271353/308490 [00:05<00:00, 57810.13it/s] 90%|████████▉ | 277162/308490 [00:05<00:00, 55463.04it/s] 92%|█████████▏| 283008/308490 [00:05<00:00, 55970.73it/s] 94%|█████████▎| 288630/308490 [00:05<00:00, 51007.07it/s] 95%|█████████▌| 293818/308490 [00:06<00:00, 48027.57it/s] 97%|█████████▋| 299088/308490 [00:06<00:00, 49236.31it/s] 99%|█████████▉| 305520/308490 [00:06<00:00, 52245.41it/s]100%|██████████| 308490/308490 [00:06<00:00, 48872.62it/s]
The spherical harmonics array is 271.84 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 86.38290405273438 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 0.6980250252732646
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.0001, 'pow_max': 0.00015000000000000001, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 17.64it/s] 21%|██        | 4/19 [00:00<00:00, 18.57it/s] 37%|███▋      | 7/19 [00:00<00:00, 19.62it/s] 53%|█████▎    | 10/19 [00:00<00:00, 20.21it/s] 68%|██████▊   | 13/19 [00:00<00:00, 20.93it/s] 84%|████████▍ | 16/19 [00:00<00:00, 21.07it/s]100%|██████████| 19/19 [00:00<00:00, 21.43it/s]100%|██████████| 19/19 [00:00<00:00, 20.71it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6356712 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 0.7485923767089844 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07026981873647886
Ratio of unique |k|: 0.0017317128729443774
Time to get unique k and theta: 1.5409784317016602 seconds

Getting transfer functions
  0%|          | 0/11008 [00:00<?, ?it/s]  1%|          | 135/11008 [00:00<00:08, 1335.56it/s]  4%|▎         | 390/11008 [00:00<00:05, 2005.53it/s]  6%|▌         | 630/11008 [00:00<00:04, 2170.86it/s]  8%|▊         | 885/11008 [00:00<00:04, 2260.79it/s] 10%|█         | 1125/11008 [00:00<00:04, 2290.48it/s] 13%|█▎        | 1380/11008 [00:00<00:04, 2326.62it/s] 15%|█▍        | 1620/11008 [00:00<00:04, 2333.56it/s] 17%|█▋        | 1860/11008 [00:00<00:03, 2345.60it/s] 19%|█▉        | 2115/11008 [00:00<00:03, 2386.42it/s] 22%|██▏       | 2370/11008 [00:01<00:03, 2390.82it/s] 24%|██▎       | 2610/11008 [00:01<00:03, 2373.69it/s] 26%|██▌       | 2865/11008 [00:01<00:03, 2397.86it/s] 29%|██▉       | 3225/11008 [00:01<00:02, 2746.52it/s] 33%|███▎      | 3615/11008 [00:01<00:02, 3083.72it/s] 36%|███▌      | 3975/11008 [00:01<00:02, 3203.39it/s] 39%|███▉      | 4305/11008 [00:01<00:02, 3208.76it/s] 42%|████▏     | 4627/11008 [00:01<00:01, 3202.24it/s] 45%|████▌     | 4995/11008 [00:01<00:01, 3312.52it/s] 48%|████▊     | 5327/11008 [00:01<00:01, 3308.52it/s] 51%|█████▏    | 5658/11008 [00:02<00:01, 3266.89it/s] 55%|█████▌    | 6075/11008 [00:02<00:01, 3499.71it/s] 58%|█████▊    | 6435/11008 [00:02<00:01, 3487.28it/s] 62%|██████▏   | 6795/11008 [00:02<00:01, 3494.42it/s] 65%|██████▍   | 7155/11008 [00:02<00:01, 3482.65it/s] 69%|██████▊   | 7545/11008 [00:02<00:00, 3586.84it/s] 72%|███████▏  | 7920/11008 [00:02<00:00, 3618.18it/s] 75%|███████▌  | 8282/11008 [00:02<00:00, 3553.91it/s] 78%|███████▊  | 8640/11008 [00:02<00:00, 3557.90it/s] 82%|████████▏ | 9030/11008 [00:02<00:00, 3624.19it/s] 86%|████████▌ | 9450/11008 [00:03<00:00, 3777.46it/s] 89%|████████▉ | 9828/11008 [00:03<00:00, 3751.55it/s] 93%|█████████▎| 10204/11008 [00:03<00:00, 3748.57it/s] 96%|█████████▌| 10590/11008 [00:03<00:00, 3747.33it/s]100%|█████████▉| 10965/11008 [00:03<00:00, 3726.99it/s]100%|██████████| 11008/11008 [00:03<00:00, 3145.28it/s]
Size of transfer function: 1.76 MB. 

Size of integrand: 37.04 MB. Time to calculate integrand: 0.02315235137939453 s

Getting spherical harmonics
  0%|          | 0/446685 [00:00<?, ?it/s]  1%|          | 4074/446685 [00:00<00:11, 38611.23it/s]  2%|▏         | 9894/446685 [00:00<00:09, 47844.73it/s]  3%|▎         | 14672/446685 [00:00<00:09, 44675.88it/s]  4%|▍         | 19150/446685 [00:00<00:10, 41408.70it/s]  5%|▌         | 23315/446685 [00:00<00:10, 40389.22it/s]  6%|▌         | 27365/446685 [00:00<00:10, 39170.74it/s]  7%|▋         | 31428/446685 [00:00<00:10, 39074.40it/s]  8%|▊         | 35502/446685 [00:00<00:10, 38394.94it/s]  9%|▉         | 40158/446685 [00:00<00:10, 39775.61it/s] 10%|▉         | 44232/446685 [00:01<00:10, 40017.08it/s] 11%|█         | 48888/446685 [00:01<00:09, 41021.34it/s] 12%|█▏        | 53544/446685 [00:01<00:09, 42457.66it/s] 13%|█▎        | 57797/446685 [00:01<00:09, 40638.40it/s] 14%|█▍        | 62274/446685 [00:01<00:09, 41623.42it/s] 15%|█▍        | 66452/446685 [00:01<00:09, 40882.80it/s] 16%|█▌        | 70552/446685 [00:01<00:09, 40327.26it/s] 17%|█▋        | 75078/446685 [00:01<00:09, 41048.18it/s] 18%|█▊        | 79734/446685 [00:01<00:08, 42489.19it/s] 19%|█▉        | 83992/446685 [00:02<00:10, 36021.91it/s] 20%|█▉        | 87761/446685 [00:02<00:11, 31132.63it/s] 21%|██        | 91956/446685 [00:02<00:10, 33473.20it/s] 22%|██▏       | 98358/446685 [00:02<00:08, 40129.76it/s] 23%|██▎       | 103596/446685 [00:02<00:08, 42257.97it/s] 24%|██▍       | 109416/446685 [00:02<00:07, 46110.03it/s] 26%|██▌       | 116400/446685 [00:02<00:06, 52314.52it/s] 27%|██▋       | 121781/446685 [00:02<00:06, 49157.74it/s] 28%|██▊       | 126830/446685 [00:03<00:07, 45382.66it/s] 30%|██▉       | 132114/446685 [00:03<00:06, 46652.82it/s] 31%|███       | 136883/446685 [00:03<00:06, 46632.79it/s] 32%|███▏      | 143754/446685 [00:03<00:05, 52101.23it/s] 34%|███▎      | 150156/446685 [00:03<00:05, 54369.83it/s] 35%|███▍      | 155652/446685 [00:03<00:05, 54129.54it/s] 36%|███▋      | 162960/446685 [00:03<00:04, 57961.16it/s] 38%|███▊      | 169944/446685 [00:03<00:04, 59907.73it/s] 39%|███▉      | 175950/446685 [00:03<00:04, 59548.49it/s] 41%|████      | 182166/446685 [00:04<00:04, 59078.08it/s] 42%|████▏     | 188081/446685 [00:04<00:04, 56643.22it/s] 43%|████▎     | 193763/446685 [00:04<00:04, 55139.30it/s] 45%|████▍     | 199290/446685 [00:04<00:04, 54759.20it/s] 46%|████▌     | 205446/446685 [00:04<00:04, 56055.85it/s] 47%|████▋     | 211266/446685 [00:04<00:04, 56212.23it/s] 49%|████▉     | 218250/446685 [00:04<00:03, 58482.61it/s] 50%|█████     | 224096/446685 [00:04<00:03, 57554.39it/s] 51%|█████▏    | 229890/446685 [00:04<00:04, 54094.56it/s] 53%|█████▎    | 235331/446685 [00:04<00:03, 53029.57it/s] 54%|█████▍    | 240948/446685 [00:05<00:03, 53477.02it/s] 55%|█████▌    | 247350/446685 [00:05<00:03, 53902.68it/s] 57%|█████▋    | 252750/446685 [00:05<00:03, 51806.36it/s] 58%|█████▊    | 258408/446685 [00:05<00:03, 52900.72it/s] 59%|█████▉    | 264810/446685 [00:05<00:03, 54627.39it/s] 61%|██████    | 271794/446685 [00:05<00:03, 57988.22it/s] 63%|██████▎   | 279942/446685 [00:05<00:02, 63286.39it/s] 64%|██████▍   | 286344/446685 [00:05<00:02, 63395.47it/s] 66%|██████▌   | 293328/446685 [00:05<00:02, 64953.94it/s] 67%|██████▋   | 299834/446685 [00:06<00:02, 61442.47it/s] 69%|██████▊   | 306714/446685 [00:06<00:02, 62974.39it/s] 70%|███████   | 313045/446685 [00:06<00:02, 62687.18it/s] 71%|███████▏  | 319337/446685 [00:06<00:02, 60679.88it/s] 73%|███████▎  | 325429/446685 [00:06<00:02, 59095.06it/s] 74%|███████▍  | 332322/446685 [00:06<00:01, 60923.64it/s] 76%|███████▌  | 338724/446685 [00:06<00:01, 60478.84it/s] 77%|███████▋  | 345126/446685 [00:06<00:01, 59551.06it/s] 79%|███████▊  | 351528/446685 [00:06<00:01, 60128.18it/s] 80%|████████  | 357930/446685 [00:07<00:01, 60011.22it/s] 82%|████████▏ | 364332/446685 [00:07<00:01, 60873.45it/s] 83%|████████▎ | 371316/446685 [00:07<00:01, 62389.48it/s] 85%|████████▍ | 377560/446685 [00:07<00:01, 61009.64it/s] 86%|████████▌ | 384702/446685 [00:07<00:00, 63805.07it/s] 88%|████████▊ | 391686/446685 [00:07<00:00, 65240.20it/s] 89%|████████▉ | 398223/446685 [00:07<00:00, 62299.81it/s] 91%|█████████ | 404490/446685 [00:07<00:00, 61570.52it/s] 92%|█████████▏| 410668/446685 [00:07<00:00, 59744.78it/s] 93%|█████████▎| 416662/446685 [00:07<00:00, 58447.25it/s] 95%|█████████▍| 422521/446685 [00:08<00:00, 56099.56it/s] 96%|█████████▌| 428934/446685 [00:08<00:00, 57542.99it/s] 98%|█████████▊| 435918/446685 [00:08<00:00, 60380.33it/s] 99%|█████████▉| 443484/446685 [00:08<00:00, 64267.82it/s]100%|██████████| 446685/446685 [00:08<00:00, 52706.87it/s]
The spherical harmonics array is 393.62 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 91.44126868247986 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 0.7680250721912248
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.0002, 'pow_max': 0.00025, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 16.16it/s] 21%|██        | 4/19 [00:00<00:00, 16.57it/s] 32%|███▏      | 6/19 [00:00<00:00, 17.83it/s] 47%|████▋     | 9/19 [00:00<00:00, 19.45it/s] 63%|██████▎   | 12/19 [00:00<00:00, 20.07it/s] 79%|███████▉  | 15/19 [00:00<00:00, 20.84it/s] 95%|█████████▍| 18/19 [00:00<00:00, 21.33it/s]100%|██████████| 19/19 [00:00<00:00, 20.19it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6356712 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 0.7989890575408936 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07026981873647886
Ratio of unique |k|: 0.0017317128729443774
Time to get unique k and theta: 1.5380899906158447 seconds

Getting transfer functions
  0%|          | 0/11008 [00:00<?, ?it/s]  2%|▏         | 240/11008 [00:00<00:04, 2250.10it/s]  5%|▍         | 510/11008 [00:00<00:04, 2424.91it/s]  7%|▋         | 780/11008 [00:00<00:04, 2491.66it/s] 10%|▉         | 1065/11008 [00:00<00:03, 2580.66it/s] 12%|█▏        | 1324/11008 [00:00<00:03, 2572.66it/s] 14%|█▍        | 1590/11008 [00:00<00:03, 2596.11it/s] 17%|█▋        | 1860/11008 [00:00<00:03, 2606.02it/s] 19%|█▉        | 2145/11008 [00:00<00:03, 2629.30it/s] 22%|██▏       | 2430/11008 [00:00<00:03, 2679.26it/s] 25%|██▍       | 2698/11008 [00:01<00:03, 2608.36it/s] 27%|██▋       | 2985/11008 [00:01<00:02, 2679.30it/s] 31%|███       | 3360/11008 [00:01<00:02, 2968.71it/s] 34%|███▍      | 3750/11008 [00:01<00:02, 3237.52it/s] 37%|███▋      | 4095/11008 [00:01<00:02, 3268.03it/s] 40%|████      | 4440/11008 [00:01<00:01, 3306.17it/s] 43%|████▎     | 4785/11008 [00:01<00:01, 3315.17it/s] 47%|████▋     | 5145/11008 [00:01<00:01, 3386.11it/s] 50%|████▉     | 5490/11008 [00:01<00:01, 3397.56it/s] 53%|█████▎    | 5830/11008 [00:01<00:01, 3356.59it/s] 56%|█████▋    | 6195/11008 [00:02<00:01, 3429.25it/s] 60%|█████▉    | 6555/11008 [00:02<00:01, 3454.04it/s] 63%|██████▎   | 6945/11008 [00:02<00:01, 3546.21it/s] 66%|██████▋   | 7300/11008 [00:02<00:01, 3426.86it/s] 69%|██████▉   | 7644/11008 [00:02<00:01, 3309.98it/s] 73%|███████▎  | 7995/11008 [00:02<00:00, 3364.48it/s] 76%|███████▌  | 8355/11008 [00:02<00:00, 3405.90it/s] 79%|███████▉  | 8730/11008 [00:02<00:00, 3479.67it/s] 83%|████████▎ | 9120/11008 [00:02<00:00, 3558.50it/s] 86%|████████▌ | 9477/11008 [00:03<00:00, 3552.92it/s] 89%|████████▉ | 9833/11008 [00:03<00:00, 3413.51it/s] 92%|█████████▏| 10176/11008 [00:03<00:00, 3414.00it/s] 96%|█████████▌| 10519/11008 [00:03<00:00, 3382.93it/s] 99%|█████████▊| 10858/11008 [00:03<00:00, 3346.76it/s]100%|██████████| 11008/11008 [00:03<00:00, 3171.38it/s]
Size of transfer function: 1.76 MB. 

Size of integrand: 37.04 MB. Time to calculate integrand: 0.029990673065185547 s

Getting spherical harmonics
  0%|          | 0/446685 [00:00<?, ?it/s]  1%|▏         | 5820/446685 [00:00<00:07, 57284.58it/s]  3%|▎         | 11549/446685 [00:00<00:07, 56318.31it/s]  4%|▍         | 17182/446685 [00:00<00:08, 49581.90it/s]  5%|▍         | 22219/446685 [00:00<00:09, 44028.43it/s]  6%|▌         | 26723/446685 [00:00<00:10, 39954.07it/s]  7%|▋         | 30805/446685 [00:00<00:12, 33116.37it/s]  8%|▊         | 34295/446685 [00:00<00:12, 32168.98it/s]  8%|▊         | 37618/446685 [00:01<00:13, 31447.39it/s] 10%|▉         | 42486/446685 [00:01<00:11, 35806.05it/s] 11%|█         | 47724/446685 [00:01<00:10, 38723.65it/s] 12%|█▏        | 52962/446685 [00:01<00:09, 41746.32it/s] 13%|█▎        | 57618/446685 [00:01<00:09, 41976.78it/s] 14%|█▍        | 62274/446685 [00:01<00:09, 42085.83it/s] 15%|█▌        | 67512/446685 [00:01<00:08, 43505.19it/s] 16%|█▋        | 73332/446685 [00:01<00:08, 46585.67it/s] 18%|█▊        | 79734/446685 [00:01<00:07, 51137.18it/s] 19%|█▉        | 85554/446685 [00:01<00:06, 53043.56it/s] 20%|██        | 90902/446685 [00:02<00:07, 50348.87it/s] 21%|██▏       | 96030/446685 [00:02<00:07, 49961.52it/s] 23%|██▎       | 101268/446685 [00:02<00:07, 49215.46it/s] 24%|██▍       | 106506/446685 [00:02<00:06, 49618.27it/s] 25%|██▍       | 111487/446685 [00:02<00:06, 48602.78it/s] 26%|██▋       | 118146/446685 [00:02<00:06, 53498.91it/s] 28%|██▊       | 123526/446685 [00:02<00:06, 52408.68it/s] 29%|██▉       | 129204/446685 [00:02<00:05, 53019.05it/s] 30%|███       | 136188/446685 [00:02<00:05, 56951.76it/s] 32%|███▏      | 144336/446685 [00:03<00:04, 63606.79it/s] 34%|███▎      | 150721/446685 [00:03<00:04, 60089.94it/s] 35%|███▌      | 156779/446685 [00:03<00:04, 59695.92it/s] 36%|███▋      | 162782/446685 [00:03<00:04, 57573.44it/s] 38%|███▊      | 168570/446685 [00:03<00:08, 33188.95it/s] 39%|███▉      | 173436/446685 [00:03<00:07, 35926.85it/s] 40%|████      | 178674/446685 [00:03<00:06, 39180.20it/s] 41%|████      | 183423/446685 [00:04<00:06, 40957.82it/s] 43%|████▎     | 190896/446685 [00:04<00:05, 47757.32it/s] 44%|████▍     | 197298/446685 [00:04<00:04, 51621.15it/s] 46%|████▌     | 203700/446685 [00:04<00:04, 54862.33it/s] 47%|████▋     | 210102/446685 [00:04<00:04, 56833.54it/s] 48%|████▊     | 216034/446685 [00:04<00:04, 55023.29it/s] 50%|█████     | 223488/446685 [00:04<00:03, 57404.33it/s] 51%|█████▏    | 229890/446685 [00:04<00:03, 58552.56it/s] 53%|█████▎    | 237456/446685 [00:04<00:03, 60682.64it/s] 55%|█████▍    | 243581/446685 [00:05<00:03, 59704.53it/s] 56%|█████▌    | 249588/446685 [00:05<00:03, 56952.43it/s] 57%|█████▋    | 255321/446685 [00:05<00:03, 52631.37it/s] 59%|█████▊    | 261318/446685 [00:05<00:03, 53615.34it/s] 60%|█████▉    | 267720/446685 [00:05<00:03, 56268.37it/s] 62%|██████▏   | 276450/446685 [00:05<00:02, 63172.63it/s] 63%|██████▎   | 282815/446685 [00:05<00:02, 62685.25it/s] 65%|██████▍   | 289254/446685 [00:05<00:02, 62615.49it/s] 66%|██████▌   | 295537/446685 [00:05<00:02, 61491.74it/s] 68%|██████▊   | 302058/446685 [00:06<00:02, 61204.98it/s] 69%|██████▉   | 308268/446685 [00:06<00:02, 61459.38it/s] 70%|███████   | 314759/446685 [00:06<00:02, 62454.66it/s] 72%|███████▏  | 321264/446685 [00:06<00:01, 63018.32it/s] 73%|███████▎  | 327574/446685 [00:06<00:02, 59398.75it/s] 75%|███████▍  | 333558/446685 [00:06<00:02, 55957.33it/s] 76%|███████▌  | 339888/446685 [00:06<00:01, 56233.14it/s] 78%|███████▊  | 346290/446685 [00:06<00:01, 58129.62it/s] 79%|███████▉  | 352692/446685 [00:06<00:01, 59642.42it/s] 80%|████████  | 359094/446685 [00:06<00:01, 57121.34it/s] 82%|████████▏ | 366078/446685 [00:07<00:01, 59681.30it/s] 83%|████████▎ | 372091/446685 [00:07<00:01, 59473.53it/s] 85%|████████▍ | 378882/446685 [00:07<00:01, 61097.13it/s] 86%|████████▋ | 385866/446685 [00:07<00:00, 62694.08it/s] 88%|████████▊ | 394014/446685 [00:07<00:00, 66417.61it/s] 90%|████████▉ | 400663/446685 [00:07<00:00, 62729.29it/s] 91%|█████████ | 406971/446685 [00:07<00:00, 61319.06it/s] 93%|█████████▎| 413220/446685 [00:07<00:00, 61489.48it/s] 94%|█████████▍| 419386/446685 [00:07<00:00, 57480.76it/s] 95%|█████████▌| 425442/446685 [00:08<00:00, 56583.53it/s] 97%|█████████▋| 431844/446685 [00:08<00:00, 58182.92it/s] 98%|█████████▊| 437697/446685 [00:08<00:00, 55150.35it/s] 99%|█████████▉| 443256/446685 [00:08<00:00, 54462.49it/s]100%|██████████| 446685/446685 [00:08<00:00, 52702.27it/s]
The spherical harmonics array is 393.62 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 90.75455737113953 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 0.92153811348519
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.0003, 'pow_max': 0.00035, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 16%|█▌        | 3/19 [00:00<00:00, 20.93it/s] 32%|███▏      | 6/19 [00:00<00:00, 22.25it/s] 47%|████▋     | 9/19 [00:00<00:00, 22.66it/s] 63%|██████▎   | 12/19 [00:00<00:00, 22.93it/s] 79%|███████▉  | 15/19 [00:00<00:00, 23.05it/s] 95%|█████████▍| 18/19 [00:00<00:00, 23.17it/s]100%|██████████| 19/19 [00:00<00:00, 22.75it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6356712 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 0.7671301364898682 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07026981873647886
Ratio of unique |k|: 0.0017317128729443774
Time to get unique k and theta: 1.5240881443023682 seconds

Getting transfer functions
  0%|          | 0/11008 [00:00<?, ?it/s]  2%|▏         | 180/11008 [00:00<00:06, 1756.01it/s]  4%|▍         | 450/11008 [00:00<00:04, 2240.66it/s]  7%|▋         | 720/11008 [00:00<00:04, 2434.70it/s]  9%|▉         | 975/11008 [00:00<00:04, 2446.87it/s] 11%|█         | 1230/11008 [00:00<00:03, 2472.68it/s] 14%|█▍        | 1515/11008 [00:00<00:03, 2557.97it/s] 16%|█▌        | 1771/11008 [00:00<00:03, 2537.52it/s] 19%|█▊        | 2040/11008 [00:00<00:03, 2553.66it/s] 21%|██        | 2296/11008 [00:00<00:03, 2482.10it/s] 23%|██▎       | 2550/11008 [00:01<00:03, 2495.25it/s] 25%|██▌       | 2800/11008 [00:01<00:03, 2432.44it/s] 28%|██▊       | 3105/11008 [00:01<00:03, 2600.21it/s] 31%|███▏      | 3450/11008 [00:01<00:02, 2848.18it/s] 35%|███▍      | 3810/11008 [00:01<00:02, 3069.50it/s] 38%|███▊      | 4155/11008 [00:01<00:02, 3145.19it/s] 41%|████      | 4485/11008 [00:01<00:02, 3163.93it/s] 44%|████▎     | 4815/11008 [00:01<00:01, 3202.59it/s] 47%|████▋     | 5145/11008 [00:01<00:01, 3196.56it/s] 50%|████▉     | 5490/11008 [00:01<00:01, 3241.77it/s] 53%|█████▎    | 5850/11008 [00:02<00:01, 3316.61it/s] 56%|█████▋    | 6195/11008 [00:02<00:01, 3332.55it/s] 59%|█████▉    | 6529/11008 [00:02<00:01, 3315.05it/s] 63%|██████▎   | 6885/11008 [00:02<00:01, 3371.65it/s] 66%|██████▌   | 7230/11008 [00:02<00:01, 3366.94it/s] 69%|██████▉   | 7575/11008 [00:02<00:01, 3351.32it/s] 72%|███████▏  | 7920/11008 [00:02<00:00, 3353.15it/s] 75%|███████▌  | 8280/11008 [00:02<00:00, 3398.60it/s] 78%|███████▊  | 8640/11008 [00:02<00:00, 3446.05it/s] 82%|████████▏ | 9000/11008 [00:02<00:00, 3452.58it/s] 85%|████████▌ | 9360/11008 [00:03<00:00, 3491.36it/s] 88%|████████▊ | 9710/11008 [00:03<00:00, 3447.37it/s] 91%|█████████▏| 10055/11008 [00:03<00:00, 3428.45it/s] 95%|█████████▍| 10425/11008 [00:03<00:00, 3500.64it/s] 98%|█████████▊| 10776/11008 [00:03<00:00, 3467.37it/s]100%|██████████| 11008/11008 [00:03<00:00, 3088.59it/s]
Size of transfer function: 1.76 MB. 

Size of integrand: 37.04 MB. Time to calculate integrand: 0.016629695892333984 s

Getting spherical harmonics
  0%|          | 0/446685 [00:00<?, ?it/s]  1%|          | 5238/446685 [00:00<00:09, 48987.28it/s]  2%|▏         | 10476/446685 [00:00<00:08, 49792.00it/s]  4%|▍         | 16878/446685 [00:00<00:07, 54942.19it/s]  5%|▌         | 22698/446685 [00:00<00:07, 53986.15it/s]  6%|▋         | 28101/446685 [00:00<00:07, 52884.75it/s]  7%|▋         | 33392/446685 [00:00<00:08, 50851.07it/s]  9%|▊         | 38485/446685 [00:00<00:09, 43574.64it/s] 10%|▉         | 42993/446685 [00:00<00:09, 41415.32it/s] 11%|█         | 47236/446685 [00:01<00:09, 41210.65it/s] 12%|█▏        | 52380/446685 [00:01<00:09, 43048.95it/s] 13%|█▎        | 57618/446685 [00:01<00:08, 44391.76it/s] 14%|█▍        | 62856/446685 [00:01<00:08, 45377.97it/s] 15%|█▌        | 67512/446685 [00:01<00:08, 45680.14it/s] 16%|█▌        | 72168/446685 [00:01<00:08, 45231.55it/s] 17%|█▋        | 76824/446685 [00:01<00:08, 44187.05it/s] 18%|█▊        | 81480/446685 [00:01<00:08, 44176.69it/s] 20%|█▉        | 87300/446685 [00:01<00:07, 46658.62it/s] 21%|██        | 91967/446685 [00:01<00:07, 45660.70it/s] 22%|██▏       | 96612/446685 [00:02<00:07, 45682.08it/s] 23%|██▎       | 101268/446685 [00:02<00:07, 44359.83it/s] 24%|██▎       | 105709/446685 [00:02<00:07, 44275.20it/s] 25%|██▍       | 110140/446685 [00:02<00:07, 42986.76it/s] 26%|██▌       | 116982/446685 [00:02<00:06, 48717.58it/s] 27%|██▋       | 121845/446685 [00:02<00:07, 46331.97it/s] 29%|██▉       | 128622/446685 [00:02<00:06, 51375.76it/s] 30%|███       | 136188/446685 [00:02<00:05, 56432.04it/s] 32%|███▏      | 143172/446685 [00:02<00:05, 59083.88it/s] 34%|███▎      | 150738/446685 [00:03<00:04, 62804.83it/s] 35%|███▌      | 157038/446685 [00:03<00:04, 59437.71it/s] 36%|███▋      | 163020/446685 [00:03<00:05, 54094.01it/s] 38%|███▊      | 169362/446685 [00:03<00:04, 56380.94it/s] 39%|███▉      | 175182/446685 [00:03<00:04, 56699.21it/s] 41%|████      | 181584/446685 [00:03<00:04, 58738.43it/s] 42%|████▏     | 188568/446685 [00:03<00:04, 61365.89it/s] 44%|████▎     | 194755/446685 [00:03<00:04, 59565.98it/s] 45%|████▍     | 200754/446685 [00:03<00:04, 57859.74it/s] 46%|████▋     | 206610/446685 [00:04<00:04, 56464.69it/s] 48%|████▊     | 213594/446685 [00:04<00:03, 59755.81it/s] 49%|████▉     | 220578/446685 [00:04<00:03, 61871.43it/s] 51%|█████     | 226791/446685 [00:04<00:03, 58627.58it/s] 52%|█████▏    | 232697/446685 [00:04<00:04, 52421.93it/s] 53%|█████▎    | 238620/446685 [00:04<00:03, 54113.66it/s] 55%|█████▍    | 244146/446685 [00:04<00:03, 54209.93it/s] 56%|█████▌    | 250842/446685 [00:04<00:03, 56296.84it/s] 58%|█████▊    | 258990/446685 [00:04<00:02, 63015.20it/s] 59%|█████▉    | 265371/446685 [00:05<00:02, 63189.05it/s] 61%|██████    | 271746/446685 [00:05<00:02, 62478.91it/s] 62%|██████▏   | 278196/446685 [00:05<00:02, 62677.55it/s] 64%|██████▎   | 284492/446685 [00:05<00:02, 58523.23it/s] 65%|██████▌   | 290412/446685 [00:05<00:02, 55543.91it/s] 66%|██████▋   | 296031/446685 [00:05<00:02, 54327.63it/s] 67%|██████▋   | 301506/446685 [00:05<00:02, 52107.11it/s] 69%|██████▊   | 306752/446685 [00:05<00:02, 50893.67it/s] 70%|███████   | 313116/446685 [00:05<00:02, 54169.34it/s] 72%|███████▏  | 319518/446685 [00:06<00:02, 54453.45it/s] 73%|███████▎  | 324990/446685 [00:06<00:02, 54262.67it/s] 74%|███████▍  | 331158/446685 [00:06<00:02, 56221.51it/s] 75%|███████▌  | 336978/446685 [00:06<00:01, 55484.18it/s] 77%|███████▋  | 342543/446685 [00:06<00:01, 54284.27it/s] 78%|███████▊  | 347984/446685 [00:06<00:01, 54105.39it/s] 79%|███████▉  | 353856/446685 [00:06<00:01, 54528.12it/s] 81%|████████  | 359676/446685 [00:06<00:01, 55231.46it/s] 82%|████████▏ | 365205/446685 [00:06<00:01, 48134.99it/s] 83%|████████▎ | 370175/446685 [00:07<00:01, 46076.64it/s] 85%|████████▍ | 377718/446685 [00:07<00:01, 52817.20it/s] 86%|████████▌ | 383538/446685 [00:07<00:01, 53354.70it/s] 87%|████████▋ | 390522/446685 [00:07<00:00, 56832.54it/s] 89%|████████▊ | 396342/446685 [00:07<00:00, 56462.07it/s] 90%|█████████ | 402162/446685 [00:07<00:00, 56046.61it/s] 91%|█████████▏| 407982/446685 [00:07<00:00, 56590.89it/s] 93%|█████████▎| 414384/446685 [00:07<00:00, 58400.98it/s] 94%|█████████▍| 420249/446685 [00:07<00:00, 55117.52it/s] 95%|█████████▌| 426024/446685 [00:08<00:00, 55518.25it/s] 97%|█████████▋| 433417/446685 [00:08<00:00, 60770.52it/s] 99%|█████████▉| 441156/446685 [00:08<00:00, 63582.98it/s]100%|██████████| 446685/446685 [00:08<00:00, 53859.01it/s]
The spherical harmonics array is 393.62 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 91.95261287689209 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 0.889881085964706
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.0004, 'pow_max': 0.00045000000000000004, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 14.65it/s] 21%|██        | 4/19 [00:00<00:00, 16.25it/s] 32%|███▏      | 6/19 [00:00<00:00, 17.42it/s] 47%|████▋     | 9/19 [00:00<00:00, 19.08it/s] 63%|██████▎   | 12/19 [00:00<00:00, 20.17it/s] 79%|███████▉  | 15/19 [00:00<00:00, 21.21it/s] 95%|█████████▍| 18/19 [00:00<00:00, 21.56it/s]100%|██████████| 19/19 [00:00<00:00, 20.19it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6356712 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 0.7557709217071533 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07026981873647886
Ratio of unique |k|: 0.0017317128729443774
Time to get unique k and theta: 1.5376627445220947 seconds

Getting transfer functions
  0%|          | 0/11008 [00:00<?, ?it/s]  2%|▏         | 195/11008 [00:00<00:05, 1890.16it/s]  4%|▍         | 420/11008 [00:00<00:05, 2056.02it/s]  6%|▌         | 675/11008 [00:00<00:04, 2253.31it/s]  9%|▊         | 945/11008 [00:00<00:04, 2374.80it/s] 11%|█         | 1200/11008 [00:00<00:04, 2434.89it/s] 13%|█▎        | 1444/11008 [00:00<00:04, 2378.98it/s] 15%|█▌        | 1695/11008 [00:00<00:03, 2397.19it/s] 18%|█▊        | 1950/11008 [00:00<00:03, 2423.45it/s] 20%|██        | 2205/11008 [00:00<00:03, 2450.22it/s] 22%|██▏       | 2460/11008 [00:01<00:03, 2457.56it/s] 25%|██▍       | 2706/11008 [00:01<00:03, 2443.83it/s] 27%|██▋       | 2985/11008 [00:01<00:03, 2535.71it/s] 31%|███       | 3360/11008 [00:01<00:02, 2867.67it/s] 34%|███▎      | 3690/11008 [00:01<00:02, 2987.59it/s] 37%|███▋      | 4035/11008 [00:01<00:02, 3107.69it/s] 40%|███▉      | 4365/11008 [00:01<00:02, 3116.59it/s] 43%|████▎     | 4695/11008 [00:01<00:02, 3136.16it/s] 46%|████▌     | 5009/11008 [00:01<00:01, 3136.74it/s] 49%|████▊     | 5340/11008 [00:01<00:01, 3167.46it/s] 52%|█████▏    | 5670/11008 [00:02<00:01, 3169.37it/s] 55%|█████▍    | 6015/11008 [00:02<00:01, 3229.66it/s] 58%|█████▊    | 6390/11008 [00:02<00:01, 3341.05it/s] 61%|██████    | 6735/11008 [00:02<00:01, 3338.09it/s] 64%|██████▍   | 7069/11008 [00:02<00:01, 3301.39it/s] 67%|██████▋   | 7400/11008 [00:02<00:01, 3297.96it/s] 70%|███████   | 7755/11008 [00:02<00:00, 3366.25it/s] 74%|███████▎  | 8092/11008 [00:02<00:00, 3313.87it/s] 77%|███████▋  | 8424/11008 [00:02<00:00, 3297.41it/s] 80%|███████▉  | 8775/11008 [00:02<00:00, 3325.41it/s] 83%|████████▎ | 9165/11008 [00:03<00:00, 3459.56it/s] 86%|████████▋ | 9511/11008 [00:03<00:00, 3450.66it/s] 90%|████████▉ | 9900/11008 [00:03<00:00, 3537.99it/s] 93%|█████████▎| 10254/11008 [00:03<00:00, 3520.24it/s] 96%|█████████▋| 10606/11008 [00:03<00:00, 3509.88it/s]100%|█████████▉| 10957/11008 [00:03<00:00, 3404.44it/s]100%|██████████| 11008/11008 [00:03<00:00, 3042.22it/s]
Size of transfer function: 1.76 MB. 

Size of integrand: 37.04 MB. Time to calculate integrand: 0.030897855758666992 s

Getting spherical harmonics
  0%|          | 0/446685 [00:00<?, ?it/s]  1%|▏         | 6402/446685 [00:00<00:07, 57716.18it/s]  3%|▎         | 12174/446685 [00:00<00:07, 57175.31it/s]  4%|▍         | 17890/446685 [00:00<00:07, 55323.08it/s]  5%|▌         | 23424/446685 [00:00<00:08, 52528.68it/s]  6%|▋         | 28689/446685 [00:00<00:08, 47899.36it/s]  8%|▊         | 33531/446685 [00:00<00:08, 46384.62it/s]  9%|▊         | 38412/446685 [00:00<00:08, 46617.39it/s] 10%|▉         | 43650/446685 [00:00<00:08, 45692.64it/s] 11%|█         | 48306/446685 [00:01<00:10, 38931.11it/s] 12%|█▏        | 52353/446685 [00:01<00:10, 36570.99it/s] 13%|█▎        | 56654/446685 [00:01<00:10, 38208.44it/s] 14%|█▍        | 61692/446685 [00:01<00:09, 40990.09it/s] 15%|█▍        | 66930/446685 [00:01<00:08, 42915.12it/s] 16%|█▌        | 71301/446685 [00:01<00:08, 42414.13it/s] 17%|█▋        | 75596/446685 [00:01<00:08, 42075.79it/s] 18%|█▊        | 80330/446685 [00:01<00:08, 43562.61it/s] 19%|█▉        | 84721/446685 [00:01<00:08, 43106.40it/s] 20%|█▉        | 89055/446685 [00:02<00:08, 42072.74it/s] 21%|██        | 93702/446685 [00:02<00:08, 42794.36it/s] 22%|██▏       | 98940/446685 [00:02<00:07, 45365.21it/s] 23%|██▎       | 104178/446685 [00:02<00:07, 46691.56it/s] 25%|██▍       | 109998/446685 [00:02<00:06, 48811.28it/s] 26%|██▋       | 117564/446685 [00:02<00:05, 55527.15it/s] 28%|██▊       | 123118/446685 [00:02<00:06, 52465.05it/s] 29%|██▉       | 128622/446685 [00:02<00:06, 52075.89it/s] 30%|██▉       | 133860/446685 [00:02<00:06, 51857.18it/s] 31%|███       | 139057/446685 [00:02<00:05, 51825.56it/s] 32%|███▏      | 144248/446685 [00:03<00:06, 47858.92it/s] 34%|███▎      | 150156/446685 [00:03<00:05, 50155.49it/s] 35%|███▌      | 156558/446685 [00:03<00:05, 51889.10it/s] 36%|███▋      | 162960/446685 [00:03<00:05, 55098.29it/s] 38%|███▊      | 169944/446685 [00:03<00:04, 58627.65it/s] 39%|███▉      | 175849/446685 [00:03<00:04, 54943.29it/s] 41%|████      | 182166/446685 [00:03<00:04, 55557.56it/s] 42%|████▏     | 187768/446685 [00:03<00:05, 50192.83it/s] 43%|████▎     | 192895/446685 [00:04<00:05, 50378.54it/s] 45%|████▍     | 199044/446685 [00:04<00:04, 52347.97it/s] 46%|████▌     | 205130/446685 [00:04<00:04, 54698.94it/s] 47%|████▋     | 211848/446685 [00:04<00:04, 57691.30it/s] 49%|████▊     | 217673/446685 [00:04<00:04, 54693.52it/s] 50%|█████     | 225234/446685 [00:04<00:03, 58498.15it/s] 52%|█████▏    | 231636/446685 [00:04<00:03, 58562.98it/s] 53%|█████▎    | 237521/446685 [00:04<00:03, 57329.26it/s] 54%|█████▍    | 243272/446685 [00:04<00:03, 54526.47it/s] 56%|█████▌    | 249096/446685 [00:04<00:03, 54793.86it/s] 58%|█████▊    | 257244/446685 [00:05<00:03, 60757.54it/s] 59%|█████▉    | 263646/446685 [00:05<00:02, 61565.65it/s] 60%|██████    | 269822/446685 [00:05<00:02, 61008.62it/s] 62%|██████▏   | 275935/446685 [00:05<00:03, 52814.64it/s] 63%|██████▎   | 281688/446685 [00:05<00:03, 53188.36it/s] 64%|██████▍   | 288090/446685 [00:05<00:02, 56052.04it/s] 66%|██████▌   | 294492/446685 [00:05<00:02, 57788.05it/s] 67%|██████▋   | 300369/446685 [00:05<00:02, 57917.94it/s] 69%|██████▊   | 306231/446685 [00:05<00:02, 55605.41it/s] 70%|██████▉   | 311952/446685 [00:06<00:02, 55874.28it/s] 71%|███████   | 317772/446685 [00:06<00:02, 55259.95it/s] 73%|███████▎  | 325338/446685 [00:06<00:02, 60477.29it/s] 74%|███████▍  | 331740/446685 [00:06<00:01, 60781.65it/s] 76%|███████▌  | 337844/446685 [00:06<00:01, 58378.50it/s] 77%|███████▋  | 343713/446685 [00:06<00:01, 57327.85it/s] 78%|███████▊  | 349467/446685 [00:06<00:01, 57046.73it/s] 80%|███████▉  | 355186/446685 [00:06<00:01, 56267.11it/s] 81%|████████  | 360840/446685 [00:06<00:01, 54866.36it/s] 82%|████████▏ | 366337/446685 [00:07<00:01, 53254.49it/s] 83%|████████▎ | 372480/446685 [00:07<00:01, 54031.45it/s] 85%|████████▍ | 377890/446685 [00:07<00:01, 53200.30it/s] 86%|████████▌ | 384120/446685 [00:07<00:01, 55192.88it/s] 87%|████████▋ | 389647/446685 [00:07<00:01, 54322.05it/s] 88%|████████▊ | 395178/446685 [00:07<00:00, 54302.17it/s] 90%|████████▉ | 401580/446685 [00:07<00:00, 57091.41it/s] 91%|█████████ | 407301/446685 [00:07<00:00, 57106.73it/s] 93%|█████████▎| 413220/446685 [00:07<00:00, 56840.58it/s] 94%|█████████▍| 420786/446685 [00:07<00:00, 61350.13it/s] 96%|█████████▌| 426919/446685 [00:08<00:00, 58584.12it/s] 97%|█████████▋| 432796/446685 [00:08<00:00, 57473.42it/s] 98%|█████████▊| 438556/446685 [00:08<00:00, 56714.44it/s] 99%|█████████▉| 444235/446685 [00:08<00:00, 55332.46it/s]100%|██████████| 446685/446685 [00:08<00:00, 52623.80it/s]
The spherical harmonics array is 393.62 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 92.20530819892883 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 0.9990677552430535
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.0005, 'pow_max': 0.00055, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 16.80it/s] 26%|██▋       | 5/19 [00:00<00:00, 19.53it/s] 42%|████▏     | 8/19 [00:00<00:00, 20.94it/s] 58%|█████▊    | 11/19 [00:00<00:00, 21.84it/s] 74%|███████▎  | 14/19 [00:00<00:00, 22.36it/s] 89%|████████▉ | 17/19 [00:00<00:00, 22.65it/s]100%|██████████| 19/19 [00:00<00:00, 21.90it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6356712 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 0.7292828559875488 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07026981873647886
Ratio of unique |k|: 0.0017317128729443774
Time to get unique k and theta: 1.5460293292999268 seconds

Getting transfer functions
  0%|          | 0/11008 [00:00<?, ?it/s]  0%|          | 45/11008 [00:00<00:25, 430.24it/s]  2%|▏         | 270/11008 [00:00<00:07, 1438.61it/s]  5%|▍         | 510/11008 [00:00<00:05, 1845.85it/s]  7%|▋         | 765/11008 [00:00<00:04, 2076.27it/s]  9%|▉         | 1020/11008 [00:00<00:04, 2237.16it/s] 11%|█▏        | 1260/11008 [00:00<00:04, 2275.52it/s] 14%|█▎        | 1500/11008 [00:00<00:04, 2305.44it/s] 16%|█▌        | 1755/11008 [00:00<00:03, 2357.86it/s] 18%|█▊        | 1995/11008 [00:00<00:03, 2353.88it/s] 20%|██        | 2231/11008 [00:01<00:03, 2337.68it/s] 22%|██▏       | 2465/11008 [00:01<00:03, 2276.70it/s] 25%|██▍       | 2715/11008 [00:01<00:03, 2299.34it/s] 27%|██▋       | 2970/11008 [00:01<00:03, 2372.21it/s] 30%|███       | 3315/11008 [00:01<00:02, 2676.36it/s] 33%|███▎      | 3675/11008 [00:01<00:02, 2934.21it/s] 37%|███▋      | 4020/11008 [00:01<00:02, 3066.44it/s] 40%|███▉      | 4365/11008 [00:01<00:02, 3140.82it/s] 43%|████▎     | 4710/11008 [00:01<00:01, 3190.80it/s] 46%|████▌     | 5040/11008 [00:01<00:01, 3186.76it/s] 49%|████▉     | 5370/11008 [00:02<00:01, 3184.06it/s] 52%|█████▏    | 5700/11008 [00:02<00:01, 3203.38it/s] 55%|█████▍    | 6021/11008 [00:02<00:01, 3184.14it/s] 58%|█████▊    | 6405/11008 [00:02<00:01, 3338.56it/s] 61%|██████    | 6739/11008 [00:02<00:01, 3312.72it/s] 64%|██████▍   | 7071/11008 [00:02<00:01, 3282.63it/s] 67%|██████▋   | 7410/11008 [00:02<00:01, 3269.62it/s] 70%|███████   | 7755/11008 [00:02<00:00, 3306.16it/s] 74%|███████▍  | 8130/11008 [00:02<00:00, 3433.52it/s] 77%|███████▋  | 8475/11008 [00:02<00:00, 3417.38it/s] 80%|████████  | 8820/11008 [00:03<00:00, 3402.84it/s] 84%|████████▎ | 9210/11008 [00:03<00:00, 3534.78it/s] 87%|████████▋ | 9564/11008 [00:03<00:00, 3534.73it/s] 90%|█████████ | 9918/11008 [00:03<00:00, 3489.44it/s] 93%|█████████▎| 10290/11008 [00:03<00:00, 3532.11it/s] 97%|█████████▋| 10680/11008 [00:03<00:00, 3606.07it/s]100%|██████████| 11008/11008 [00:03<00:00, 2980.28it/s]
Size of transfer function: 1.76 MB. 

Size of integrand: 37.04 MB. Time to calculate integrand: 0.030508756637573242 s

Getting spherical harmonics
  0%|          | 0/446685 [00:00<?, ?it/s]  1%|          | 5238/446685 [00:00<00:08, 49607.37it/s]  3%|▎         | 11640/446685 [00:00<00:07, 55035.77it/s]  4%|▍         | 17137/446685 [00:00<00:07, 53926.91it/s]  5%|▌         | 22525/446685 [00:00<00:08, 49150.78it/s]  6%|▋         | 27936/446685 [00:00<00:08, 50660.02it/s]  7%|▋         | 33041/446685 [00:00<00:08, 50621.34it/s]  9%|▊         | 38129/446685 [00:00<00:08, 49397.41it/s] 10%|▉         | 43088/446685 [00:00<00:08, 48691.33it/s] 11%|█         | 48306/446685 [00:00<00:08, 46761.94it/s] 12%|█▏        | 53007/446685 [00:01<00:09, 42657.65it/s] 13%|█▎        | 58782/446685 [00:01<00:08, 46665.92it/s] 14%|█▍        | 64602/446685 [00:01<00:07, 49834.66it/s] 16%|█▌        | 69840/446685 [00:01<00:07, 49981.56it/s] 17%|█▋        | 74904/446685 [00:01<00:07, 50080.85it/s] 18%|█▊        | 79958/446685 [00:01<00:07, 49861.02it/s] 19%|█▉        | 84976/446685 [00:01<00:07, 46943.98it/s] 20%|██        | 89722/446685 [00:01<00:07, 45051.76it/s] 21%|██        | 94271/446685 [00:01<00:07, 44453.30it/s] 22%|██▏       | 98745/446685 [00:02<00:08, 43114.02it/s] 23%|██▎       | 103078/446685 [00:02<00:08, 39800.01it/s] 24%|██▍       | 107670/446685 [00:02<00:08, 40358.49it/s] 25%|██▌       | 113490/446685 [00:02<00:07, 44712.66it/s] 27%|██▋       | 119310/446685 [00:02<00:06, 47565.16it/s] 28%|██▊       | 125712/446685 [00:02<00:06, 51520.89it/s] 29%|██▉       | 131532/446685 [00:02<00:06, 51481.96it/s] 31%|███       | 136770/446685 [00:02<00:06, 50547.57it/s] 32%|███▏      | 143172/446685 [00:02<00:05, 53817.09it/s] 33%|███▎      | 148583/446685 [00:03<00:05, 49793.44it/s] 34%|███▍      | 153648/446685 [00:03<00:06, 48716.59it/s] 35%|███▌      | 158564/446685 [00:03<00:05, 48783.72it/s] 37%|███▋      | 165288/446685 [00:03<00:05, 53516.66it/s] 38%|███▊      | 171108/446685 [00:03<00:05, 53921.14it/s] 40%|███▉      | 177510/446685 [00:03<00:04, 55644.77it/s] 41%|████      | 183095/446685 [00:03<00:04, 54796.04it/s] 42%|████▏     | 188588/446685 [00:03<00:04, 52647.34it/s] 44%|████▎     | 194970/446685 [00:03<00:04, 54929.03it/s] 45%|████▌     | 201954/446685 [00:04<00:04, 58031.17it/s] 47%|████▋     | 208938/446685 [00:04<00:03, 60033.06it/s] 48%|████▊     | 215340/446685 [00:04<00:03, 60513.84it/s] 50%|████▉     | 221742/446685 [00:04<00:03, 60057.67it/s] 51%|█████     | 228726/446685 [00:04<00:03, 62291.63it/s] 53%|█████▎    | 235710/446685 [00:04<00:03, 63138.14it/s] 54%|█████▍    | 243276/446685 [00:04<00:03, 65835.33it/s] 56%|█████▌    | 249868/446685 [00:04<00:03, 62632.95it/s] 57%|█████▋    | 256662/446685 [00:04<00:02, 63701.84it/s] 59%|█████▉    | 263058/446685 [00:05<00:03, 59159.80it/s] 60%|██████    | 269042/446685 [00:05<00:03, 55634.90it/s] 61%|██████▏   | 274675/446685 [00:05<00:03, 53377.06it/s] 63%|██████▎   | 280062/446685 [00:05<00:03, 49762.83it/s] 64%|██████▍   | 286344/446685 [00:05<00:03, 52775.69it/s] 65%|██████▌   | 291697/446685 [00:05<00:03, 47838.61it/s] 67%|██████▋   | 297117/446685 [00:05<00:03, 49487.06it/s] 68%|██████▊   | 302640/446685 [00:05<00:02, 50911.89it/s] 69%|██████▉   | 309042/446685 [00:05<00:02, 54303.75it/s] 70%|███████   | 314557/446685 [00:06<00:02, 50858.77it/s] 72%|███████▏  | 320100/446685 [00:06<00:02, 50894.67it/s] 73%|███████▎  | 325338/446685 [00:06<00:02, 50578.37it/s] 75%|███████▍  | 332904/446685 [00:06<00:02, 55671.17it/s] 76%|███████▌  | 338724/446685 [00:06<00:01, 55893.37it/s] 77%|███████▋  | 345126/446685 [00:06<00:01, 57239.42it/s] 79%|███████▊  | 351528/446685 [00:06<00:01, 58650.24it/s] 80%|████████  | 357408/446685 [00:06<00:01, 56341.37it/s] 81%|████████▏ | 363168/446685 [00:06<00:01, 56167.65it/s] 83%|████████▎ | 368800/446685 [00:07<00:01, 55821.36it/s] 84%|████████▍ | 374392/446685 [00:07<00:01, 51589.58it/s] 85%|████████▌ | 381210/446685 [00:07<00:01, 55508.40it/s] 87%|████████▋ | 386825/446685 [00:07<00:01, 51881.22it/s] 88%|████████▊ | 392090/446685 [00:07<00:01, 47775.90it/s] 89%|████████▉ | 397506/446685 [00:07<00:01, 48767.96it/s] 90%|█████████ | 402744/446685 [00:07<00:00, 48304.47it/s] 91%|█████████▏| 407626/446685 [00:07<00:00, 47322.87it/s] 92%|█████████▏| 412391/446685 [00:07<00:00, 43814.73it/s] 94%|█████████▎| 418458/446685 [00:08<00:00, 46219.70it/s] 95%|█████████▍| 423120/446685 [00:08<00:00, 40295.71it/s] 96%|█████████▌| 428934/446685 [00:08<00:00, 43773.75it/s] 97%|█████████▋| 433590/446685 [00:08<00:00, 43368.58it/s] 99%|█████████▊| 439992/446685 [00:08<00:00, 48668.26it/s]100%|██████████| 446685/446685 [00:08<00:00, 51609.09it/s]
The spherical harmonics array is 393.62 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 92.57184767723083 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 0.9020659330123957
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.0006, 'pow_max': 0.00065, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 19.03it/s] 26%|██▋       | 5/19 [00:00<00:00, 21.66it/s] 42%|████▏     | 8/19 [00:00<00:00, 22.25it/s] 58%|█████▊    | 11/19 [00:00<00:00, 22.49it/s] 74%|███████▎  | 14/19 [00:00<00:00, 22.74it/s] 89%|████████▉ | 17/19 [00:00<00:00, 22.88it/s]100%|██████████| 19/19 [00:00<00:00, 22.55it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6356712 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 0.7737216949462891 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07026981873647886
Ratio of unique |k|: 0.0017317128729443774
Time to get unique k and theta: 1.5700206756591797 seconds

Getting transfer functions
  0%|          | 0/11008 [00:00<?, ?it/s]  2%|▏         | 240/11008 [00:00<00:04, 2286.43it/s]  5%|▍         | 510/11008 [00:00<00:04, 2451.83it/s]  7%|▋         | 780/11008 [00:00<00:04, 2524.95it/s] 10%|▉         | 1065/11008 [00:00<00:03, 2595.39it/s] 12%|█▏        | 1335/11008 [00:00<00:03, 2620.04it/s] 15%|█▍        | 1605/11008 [00:00<00:03, 2602.84it/s] 17%|█▋        | 1875/11008 [00:00<00:03, 2597.31it/s] 19%|█▉        | 2145/11008 [00:00<00:03, 2624.89it/s] 22%|██▏       | 2430/11008 [00:00<00:03, 2679.35it/s] 25%|██▍       | 2700/11008 [00:01<00:03, 2673.77it/s] 28%|██▊       | 3030/11008 [00:01<00:02, 2845.23it/s] 31%|███       | 3390/11008 [00:01<00:02, 3058.13it/s] 34%|███▍      | 3735/11008 [00:01<00:02, 3164.52it/s] 37%|███▋      | 4110/11008 [00:01<00:02, 3331.35it/s] 40%|████      | 4444/11008 [00:01<00:01, 3297.67it/s] 43%|████▎     | 4785/11008 [00:01<00:01, 3301.93it/s] 46%|████▋     | 5116/11008 [00:01<00:01, 3239.15it/s] 49%|████▉     | 5445/11008 [00:01<00:01, 3247.89it/s] 53%|█████▎    | 5790/11008 [00:01<00:01, 3298.28it/s] 56%|█████▌    | 6165/11008 [00:02<00:01, 3389.34it/s] 59%|█████▉    | 6504/11008 [00:02<00:01, 3315.29it/s] 62%|██████▏   | 6840/11008 [00:02<00:01, 3315.31it/s] 66%|██████▌   | 7230/11008 [00:02<00:01, 3447.54it/s] 69%|██████▉   | 7575/11008 [00:02<00:01, 3358.67it/s] 72%|███████▏  | 7912/11008 [00:02<00:00, 3332.30it/s] 75%|███████▌  | 8295/11008 [00:02<00:00, 3398.18it/s] 78%|███████▊  | 8635/11008 [00:02<00:00, 3386.07it/s] 82%|████████▏ | 9015/11008 [00:02<00:00, 3501.02it/s] 85%|████████▌ | 9366/11008 [00:03<00:00, 3388.08it/s] 88%|████████▊ | 9706/11008 [00:03<00:00, 3328.69it/s] 91%|█████████▏| 10050/11008 [00:03<00:00, 3334.98it/s] 95%|█████████▍| 10410/11008 [00:03<00:00, 3410.59it/s] 98%|█████████▊| 10785/11008 [00:03<00:00, 3498.22it/s]100%|██████████| 11008/11008 [00:03<00:00, 3160.33it/s]
Size of transfer function: 1.76 MB. 

Size of integrand: 37.04 MB. Time to calculate integrand: 0.024082660675048828 s

Getting spherical harmonics
  0%|          | 0/446685 [00:00<?, ?it/s]  1%|▏         | 5820/446685 [00:00<00:08, 52054.05it/s]  3%|▎         | 12222/446685 [00:00<00:07, 55758.39it/s]  4%|▍         | 17801/446685 [00:00<00:07, 55145.68it/s]  5%|▌         | 23315/446685 [00:00<00:08, 47453.80it/s]  6%|▋         | 28177/446685 [00:00<00:10, 39518.11it/s]  7%|▋         | 33174/446685 [00:00<00:09, 42141.14it/s]  8%|▊         | 37589/446685 [00:00<00:10, 37430.37it/s] 10%|▉         | 42486/446685 [00:00<00:10, 39714.45it/s] 10%|█         | 46625/446685 [00:01<00:10, 39763.01it/s] 11%|█▏        | 50717/446685 [00:01<00:10, 38461.30it/s] 12%|█▏        | 55290/446685 [00:01<00:09, 39476.57it/s] 13%|█▎        | 59946/446685 [00:01<00:09, 40953.88it/s] 15%|█▍        | 65766/446685 [00:01<00:08, 44006.85it/s] 16%|█▌        | 70422/446685 [00:01<00:08, 43443.07it/s] 17%|█▋        | 74788/446685 [00:01<00:09, 40776.10it/s] 18%|█▊        | 78899/446685 [00:01<00:11, 32339.25it/s] 19%|█▊        | 83226/446685 [00:02<00:10, 34351.35it/s] 20%|█▉        | 88464/446685 [00:02<00:09, 38744.03it/s] 21%|██        | 93120/446685 [00:02<00:08, 40501.74it/s] 22%|██▏       | 98358/446685 [00:02<00:08, 43266.90it/s] 23%|██▎       | 104178/446685 [00:02<00:07, 47087.94it/s] 25%|██▍       | 109998/446685 [00:02<00:06, 49049.04it/s] 26%|██▌       | 116400/446685 [00:02<00:06, 51944.11it/s] 27%|██▋       | 122220/446685 [00:02<00:06, 52938.08it/s] 29%|██▉       | 130948/446685 [00:02<00:05, 62702.41it/s] 31%|███       | 137307/446685 [00:03<00:05, 60695.15it/s] 32%|███▏      | 143448/446685 [00:03<00:05, 57575.36it/s] 33%|███▎      | 149574/446685 [00:03<00:05, 57971.47it/s] 35%|███▌      | 157140/446685 [00:03<00:04, 60252.18it/s] 37%|███▋      | 163194/446685 [00:03<00:04, 60258.17it/s] 38%|███▊      | 169240/446685 [00:03<00:05, 52151.21it/s] 39%|███▉      | 174642/446685 [00:03<00:05, 52166.17it/s] 41%|████      | 182007/446685 [00:03<00:04, 57886.17it/s] 42%|████▏     | 187952/446685 [00:03<00:04, 56212.68it/s] 43%|████▎     | 193685/446685 [00:04<00:04, 55386.04it/s] 45%|████▍     | 199626/446685 [00:04<00:04, 55863.80it/s] 46%|████▌     | 205446/446685 [00:04<00:04, 56176.57it/s] 47%|████▋     | 211629/446685 [00:04<00:04, 57793.85it/s] 49%|████▊     | 217668/446685 [00:04<00:04, 57164.52it/s] 50%|█████     | 223411/446685 [00:04<00:03, 57004.76it/s] 52%|█████▏    | 230472/446685 [00:04<00:03, 60577.24it/s] 53%|█████▎    | 236874/446685 [00:04<00:03, 61434.87it/s] 55%|█████▍    | 243759/446685 [00:04<00:03, 63613.13it/s] 56%|█████▌    | 250135/446685 [00:04<00:03, 62486.37it/s] 58%|█████▊    | 257288/446685 [00:05<00:02, 65135.04it/s] 59%|█████▉    | 264810/446685 [00:05<00:02, 66290.90it/s] 61%|██████    | 271445/446685 [00:05<00:02, 64944.86it/s] 62%|██████▏   | 277946/446685 [00:05<00:02, 63222.46it/s] 64%|██████▎   | 284598/446685 [00:05<00:02, 64147.20it/s] 65%|██████▌   | 291582/446685 [00:05<00:02, 64881.54it/s] 67%|██████▋   | 298566/446685 [00:05<00:02, 65949.21it/s] 69%|██████▊   | 306132/446685 [00:05<00:02, 68367.21it/s] 70%|███████   | 313698/446685 [00:05<00:01, 68741.24it/s] 72%|███████▏  | 320577/446685 [00:06<00:01, 67999.42it/s] 73%|███████▎  | 327380/446685 [00:06<00:01, 63667.54it/s] 75%|███████▍  | 334068/446685 [00:06<00:01, 64457.73it/s] 76%|███████▌  | 340553/446685 [00:06<00:01, 64427.45it/s] 78%|███████▊  | 348036/446685 [00:06<00:01, 67348.45it/s] 80%|███████▉  | 356439/446685 [00:06<00:01, 72216.05it/s] 81%|████████▏ | 363986/446685 [00:06<00:01, 73172.34it/s] 83%|████████▎ | 371329/446685 [00:06<00:01, 67759.35it/s] 85%|████████▍ | 378199/446685 [00:06<00:01, 63979.34it/s] 86%|████████▌ | 384691/446685 [00:07<00:01, 57281.45it/s] 88%|████████▊ | 391104/446685 [00:07<00:00, 58516.69it/s] 89%|████████▉ | 397506/446685 [00:07<00:00, 58111.04it/s] 90%|█████████ | 403908/446685 [00:07<00:00, 57149.47it/s] 92%|█████████▏| 409688/446685 [00:07<00:00, 57203.34it/s] 93%|█████████▎| 415454/446685 [00:07<00:00, 57262.86it/s] 95%|█████████▍| 422532/446685 [00:07<00:00, 59005.30it/s] 96%|█████████▌| 428451/446685 [00:07<00:00, 57584.70it/s] 97%|█████████▋| 434222/446685 [00:07<00:00, 50330.30it/s] 99%|█████████▉| 441468/446685 [00:08<00:00, 56083.34it/s]100%|██████████| 446685/446685 [00:08<00:00, 54934.50it/s]
The spherical harmonics array is 393.62 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 87.45344829559326 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 0.855136999130409
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.0007, 'pow_max': 0.00075, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 14.35it/s] 21%|██        | 4/19 [00:00<00:00, 16.07it/s] 32%|███▏      | 6/19 [00:00<00:00, 17.31it/s] 42%|████▏     | 8/19 [00:00<00:00, 18.15it/s] 58%|█████▊    | 11/19 [00:00<00:00, 19.78it/s] 74%|███████▎  | 14/19 [00:00<00:00, 20.93it/s] 89%|████████▉ | 17/19 [00:00<00:00, 21.70it/s]100%|██████████| 19/19 [00:00<00:00, 20.18it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6356712 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 0.7309074401855469 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07026981873647886
Ratio of unique |k|: 0.0017317128729443774
Time to get unique k and theta: 1.5421595573425293 seconds

Getting transfer functions
  0%|          | 0/11008 [00:00<?, ?it/s]  2%|▏         | 180/11008 [00:00<00:06, 1685.73it/s]  4%|▍         | 435/11008 [00:00<00:04, 2116.38it/s]  6%|▋         | 705/11008 [00:00<00:04, 2321.33it/s]  9%|▊         | 960/11008 [00:00<00:04, 2398.23it/s] 11%|█         | 1215/11008 [00:00<00:04, 2433.34it/s] 13%|█▎        | 1485/11008 [00:00<00:03, 2477.29it/s] 16%|█▌        | 1733/11008 [00:00<00:03, 2476.41it/s] 18%|█▊        | 1995/11008 [00:00<00:03, 2512.96it/s] 20%|██        | 2250/11008 [00:00<00:03, 2505.88it/s] 23%|██▎       | 2505/11008 [00:01<00:03, 2506.64it/s] 25%|██▌       | 2756/11008 [00:01<00:03, 2501.47it/s] 28%|██▊       | 3030/11008 [00:01<00:03, 2559.66it/s] 31%|███       | 3390/11008 [00:01<00:02, 2862.23it/s] 34%|███▍      | 3735/11008 [00:01<00:02, 3018.12it/s] 37%|███▋      | 4095/11008 [00:01<00:02, 3183.12it/s] 40%|████      | 4425/11008 [00:01<00:02, 3211.89it/s] 43%|████▎     | 4785/11008 [00:01<00:01, 3291.65it/s] 46%|████▋     | 5115/11008 [00:01<00:01, 3212.90it/s] 49%|████▉     | 5437/11008 [00:01<00:01, 3182.36it/s] 52%|█████▏    | 5756/11008 [00:02<00:01, 3134.90it/s] 55%|█████▌    | 6070/11008 [00:02<00:01, 3093.93it/s] 58%|█████▊    | 6380/11008 [00:02<00:01, 3046.41it/s] 61%|██████    | 6735/11008 [00:02<00:01, 3172.94it/s] 64%|██████▍   | 7065/11008 [00:02<00:01, 3208.56it/s] 67%|██████▋   | 7410/11008 [00:02<00:01, 3273.01it/s] 71%|███████   | 7785/11008 [00:02<00:00, 3379.79it/s] 74%|███████▍  | 8130/11008 [00:02<00:00, 3382.73it/s] 77%|███████▋  | 8469/11008 [00:02<00:00, 3358.77it/s] 80%|███████▉  | 8805/11008 [00:02<00:00, 3321.81it/s] 83%|████████▎ | 9150/11008 [00:03<00:00, 3316.61it/s] 86%|████████▋ | 9510/11008 [00:03<00:00, 3376.85it/s] 90%|████████▉ | 9900/11008 [00:03<00:00, 3512.62it/s] 93%|█████████▎| 10260/11008 [00:03<00:00, 3535.37it/s] 96%|█████████▋| 10614/11008 [00:03<00:00, 3524.17it/s]100%|█████████▉| 10967/11008 [00:03<00:00, 3441.71it/s]100%|██████████| 11008/11008 [00:03<00:00, 3049.09it/s]
Size of transfer function: 1.76 MB. 

Size of integrand: 37.04 MB. Time to calculate integrand: 0.029278993606567383 s

Getting spherical harmonics
  0%|          | 0/446685 [00:00<?, ?it/s]  1%|          | 5238/446685 [00:00<00:08, 51306.77it/s]  2%|▏         | 10476/446685 [00:00<00:08, 50532.28it/s]  4%|▎         | 15714/446685 [00:00<00:09, 47717.03it/s]  5%|▍         | 20504/446685 [00:00<00:14, 28436.89it/s]  6%|▌         | 25608/446685 [00:00<00:12, 33188.71it/s]  7%|▋         | 30264/446685 [00:00<00:11, 34884.75it/s]  8%|▊         | 34219/446685 [00:01<00:13, 29531.03it/s]  8%|▊         | 37573/446685 [00:01<00:15, 26254.53it/s]  9%|▉         | 41904/446685 [00:01<00:13, 29237.18it/s] 11%|█         | 47724/446685 [00:01<00:11, 35642.83it/s] 12%|█▏        | 52962/446685 [00:01<00:10, 38891.83it/s] 13%|█▎        | 58200/446685 [00:01<00:09, 41525.26it/s] 14%|█▍        | 63438/446685 [00:01<00:08, 43840.00it/s] 16%|█▌        | 69840/446685 [00:01<00:07, 48032.58it/s] 17%|█▋        | 74793/446685 [00:01<00:08, 46083.28it/s] 18%|█▊        | 80316/446685 [00:02<00:07, 47633.25it/s] 19%|█▉        | 85165/446685 [00:02<00:08, 43324.16it/s] 20%|██        | 89612/446685 [00:02<00:08, 43326.95it/s] 21%|██        | 94025/446685 [00:02<00:08, 43444.40it/s] 22%|██▏       | 98427/446685 [00:02<00:08, 41428.06it/s] 23%|██▎       | 103596/446685 [00:02<00:07, 43872.92it/s] 24%|██▍       | 108834/446685 [00:02<00:07, 45447.69it/s] 26%|██▌       | 114072/446685 [00:02<00:07, 47307.05it/s] 27%|██▋       | 121056/446685 [00:02<00:06, 52816.62it/s] 28%|██▊       | 126366/446685 [00:03<00:06, 52678.17it/s] 29%|██▉       | 131653/446685 [00:03<00:06, 50172.24it/s] 31%|███       | 138516/446685 [00:03<00:05, 55351.65it/s] 32%|███▏      | 144105/446685 [00:03<00:05, 53367.48it/s] 33%|███▎      | 149489/446685 [00:03<00:05, 52442.47it/s] 35%|███▍      | 155394/446685 [00:03<00:05, 53236.85it/s] 36%|███▌      | 160741/446685 [00:03<00:05, 51234.38it/s] 37%|███▋      | 165889/446685 [00:03<00:05, 51127.85it/s] 39%|███▊      | 172854/446685 [00:03<00:04, 55914.30it/s] 40%|████      | 178674/446685 [00:04<00:04, 56242.48it/s] 41%|████▏     | 184494/446685 [00:04<00:04, 56599.88it/s] 43%|████▎     | 190168/446685 [00:04<00:04, 55563.32it/s] 44%|████▍     | 195736/446685 [00:04<00:04, 54988.91it/s] 45%|████▌     | 201243/446685 [00:04<00:07, 32275.29it/s] 46%|████▌     | 205581/446685 [00:05<00:10, 22339.07it/s] 47%|████▋     | 208963/446685 [00:05<00:11, 20085.80it/s] 47%|████▋     | 211772/446685 [00:05<00:12, 18862.82it/s] 48%|████▊     | 214195/446685 [00:05<00:12, 19170.46it/s] 49%|████▉     | 219414/446685 [00:05<00:09, 24912.44it/s] 51%|█████     | 225816/446685 [00:05<00:06, 32727.16it/s] 52%|█████▏    | 233382/446685 [00:05<00:05, 42439.75it/s] 54%|█████▍    | 240366/446685 [00:05<00:04, 48493.44it/s] 56%|█████▌    | 247932/446685 [00:06<00:03, 53905.84it/s] 57%|█████▋    | 253847/446685 [00:06<00:03, 54128.16it/s] 58%|█████▊    | 259629/446685 [00:06<00:03, 47591.47it/s] 60%|█████▉    | 265974/446685 [00:06<00:03, 51266.98it/s] 61%|██████    | 271794/446685 [00:06<00:03, 52998.12it/s] 62%|██████▏   | 277353/446685 [00:06<00:03, 52901.24it/s] 63%|██████▎   | 282824/446685 [00:06<00:03, 52866.35it/s] 65%|██████▍   | 288237/446685 [00:06<00:03, 51144.26it/s] 66%|██████▌   | 293910/446685 [00:06<00:02, 52184.55it/s] 67%|██████▋   | 300312/446685 [00:07<00:02, 54755.15it/s] 68%|██████▊   | 305844/446685 [00:07<00:02, 48636.80it/s] 70%|██████▉   | 310858/446685 [00:07<00:02, 45923.00it/s] 71%|███████   | 315566/446685 [00:07<00:02, 44248.76it/s] 72%|███████▏  | 320068/446685 [00:07<00:02, 43344.05it/s] 73%|███████▎  | 326502/446685 [00:07<00:02, 48352.20it/s] 75%|███████▍  | 332904/446685 [00:07<00:02, 52194.97it/s] 76%|███████▌  | 339306/446685 [00:07<00:01, 54926.46it/s] 77%|███████▋  | 345126/446685 [00:08<00:01, 55752.88it/s] 79%|███████▊  | 351528/446685 [00:08<00:01, 57872.58it/s] 80%|████████  | 357358/446685 [00:08<00:01, 55920.28it/s] 81%|████████▏ | 362990/446685 [00:08<00:01, 54729.84it/s] 82%|████████▏ | 368492/446685 [00:08<00:01, 51676.45it/s] 84%|████████▍ | 374226/446685 [00:08<00:01, 52751.49it/s] 85%|████████▍ | 379539/446685 [00:08<00:01, 47933.21it/s] 86%|████████▋ | 385866/446685 [00:08<00:01, 51014.38it/s] 88%|████████▊ | 391104/446685 [00:08<00:01, 51093.89it/s] 89%|████████▊ | 396274/446685 [00:09<00:00, 50926.36it/s] 90%|████████▉ | 401408/446685 [00:09<00:00, 50026.54it/s] 91%|█████████ | 406439/446685 [00:09<00:00, 47877.09it/s] 92%|█████████▏| 411474/446685 [00:09<00:00, 47253.12it/s] 93%|█████████▎| 417294/446685 [00:09<00:00, 49306.78it/s] 95%|█████████▍| 422532/446685 [00:09<00:00, 49175.23it/s] 96%|█████████▌| 427770/446685 [00:09<00:00, 49134.42it/s] 97%|█████████▋| 434172/446685 [00:09<00:00, 52249.77it/s] 99%|█████████▊| 440574/446685 [00:09<00:00, 53196.03it/s]100%|█████████▉| 446088/446685 [00:09<00:00, 53738.44it/s]100%|██████████| 446685/446685 [00:10<00:00, 44640.13it/s]
The spherical harmonics array is 393.62 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 94.93005776405334 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 0.7996975452992606
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.0008, 'pow_max': 0.0008500000000000001, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 14.28it/s] 21%|██        | 4/19 [00:00<00:00, 15.17it/s] 32%|███▏      | 6/19 [00:00<00:00, 16.10it/s] 42%|████▏     | 8/19 [00:00<00:00, 17.03it/s] 58%|█████▊    | 11/19 [00:00<00:00, 18.51it/s] 74%|███████▎  | 14/19 [00:00<00:00, 19.61it/s] 89%|████████▉ | 17/19 [00:00<00:00, 20.80it/s]100%|██████████| 19/19 [00:00<00:00, 19.24it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6356712 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 0.7505295276641846 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07026981873647886
Ratio of unique |k|: 0.0017317128729443774
Time to get unique k and theta: 1.543015956878662 seconds

Getting transfer functions
  0%|          | 0/11008 [00:00<?, ?it/s]  2%|▏         | 210/11008 [00:00<00:05, 1966.06it/s]  4%|▍         | 465/11008 [00:00<00:04, 2254.51it/s]  6%|▋         | 705/11008 [00:00<00:04, 2271.47it/s]  9%|▊         | 945/11008 [00:00<00:04, 2291.70it/s] 11%|█         | 1200/11008 [00:00<00:04, 2343.44it/s] 13%|█▎        | 1455/11008 [00:00<00:04, 2386.61it/s] 16%|█▌        | 1710/11008 [00:00<00:03, 2426.17it/s] 18%|█▊        | 1965/11008 [00:00<00:03, 2460.99it/s] 20%|██        | 2220/11008 [00:00<00:03, 2434.77it/s] 22%|██▏       | 2464/11008 [00:01<00:03, 2392.14it/s] 25%|██▍       | 2715/11008 [00:01<00:03, 2414.85it/s] 27%|██▋       | 3015/11008 [00:01<00:03, 2570.55it/s] 31%|███       | 3420/11008 [00:01<00:02, 3002.76it/s] 35%|███▍      | 3810/11008 [00:01<00:02, 3267.15it/s] 38%|███▊      | 4155/11008 [00:01<00:02, 3278.43it/s] 41%|████      | 4484/11008 [00:01<00:01, 3268.82it/s] 44%|████▎     | 4815/11008 [00:01<00:01, 3239.86it/s] 47%|████▋     | 5175/11008 [00:01<00:01, 3313.47it/s] 50%|█████     | 5507/11008 [00:01<00:01, 3308.37it/s] 53%|█████▎    | 5850/11008 [00:02<00:01, 3337.27it/s] 57%|█████▋    | 6285/11008 [00:02<00:01, 3634.06it/s] 61%|██████    | 6675/11008 [00:02<00:01, 3686.57it/s] 64%|██████▍   | 7044/11008 [00:02<00:01, 3612.82it/s] 67%|██████▋   | 7410/11008 [00:02<00:01, 3589.21it/s] 71%|███████   | 7770/11008 [00:02<00:00, 3575.90it/s] 74%|███████▍  | 8130/11008 [00:02<00:00, 3582.19it/s] 77%|███████▋  | 8489/11008 [00:02<00:00, 3537.72it/s] 81%|████████  | 8865/11008 [00:02<00:00, 3601.08it/s] 84%|████████▍ | 9240/11008 [00:02<00:00, 3611.29it/s] 88%|████████▊ | 9645/11008 [00:03<00:00, 3700.57it/s] 91%|█████████ | 10016/11008 [00:03<00:00, 3648.99it/s] 94%|█████████▍| 10381/11008 [00:03<00:00, 3585.89it/s] 98%|█████████▊| 10740/11008 [00:03<00:00, 3578.93it/s]100%|██████████| 11008/11008 [00:03<00:00, 3170.75it/s]
Size of transfer function: 1.76 MB. 

Size of integrand: 37.04 MB. Time to calculate integrand: 0.03275609016418457 s

Getting spherical harmonics
  0%|          | 0/446685 [00:00<?, ?it/s]  1%|▏         | 6402/446685 [00:00<00:07, 62766.91it/s]  3%|▎         | 12679/446685 [00:00<00:07, 59883.74it/s]  4%|▍         | 18675/446685 [00:00<00:07, 54346.20it/s]  5%|▌         | 24157/446685 [00:00<00:07, 52992.49it/s]  7%|▋         | 29480/446685 [00:00<00:08, 51640.18it/s]  8%|▊         | 34657/446685 [00:00<00:08, 51064.04it/s]  9%|▉         | 39770/446685 [00:00<00:08, 48991.27it/s] 10%|█         | 44681/446685 [00:00<00:08, 45859.05it/s] 11%|█         | 49298/446685 [00:01<00:09, 42473.96it/s] 12%|█▏        | 53593/446685 [00:01<00:09, 40413.34it/s] 13%|█▎        | 58200/446685 [00:01<00:09, 39594.59it/s] 14%|█▍        | 62185/446685 [00:01<00:09, 38688.37it/s] 15%|█▍        | 66930/446685 [00:01<00:09, 41054.66it/s] 16%|█▌        | 72168/446685 [00:01<00:08, 43886.63it/s] 17%|█▋        | 76824/446685 [00:01<00:08, 44285.19it/s] 18%|█▊        | 81284/446685 [00:01<00:08, 42866.12it/s] 19%|█▉        | 85597/446685 [00:01<00:08, 41216.85it/s] 20%|██        | 90792/446685 [00:02<00:08, 44075.48it/s] 21%|██▏       | 96030/446685 [00:02<00:07, 45788.89it/s] 23%|██▎       | 101268/446685 [00:02<00:07, 46761.86it/s] 24%|██▍       | 107088/446685 [00:02<00:06, 49972.81it/s] 25%|██▌       | 113490/446685 [00:02<00:06, 52791.48it/s] 27%|██▋       | 119892/446685 [00:02<00:05, 54713.22it/s] 28%|██▊       | 126294/446685 [00:02<00:05, 56495.41it/s] 30%|██▉       | 132696/446685 [00:02<00:05, 57527.12it/s] 31%|███       | 138776/446685 [00:02<00:05, 58464.67it/s] 32%|███▏      | 144918/446685 [00:02<00:05, 58630.57it/s] 34%|███▍      | 151902/446685 [00:03<00:04, 60979.01it/s] 35%|███▌      | 158304/446685 [00:03<00:04, 59874.24it/s] 37%|███▋      | 165870/446685 [00:03<00:04, 62452.68it/s] 39%|███▊      | 172113/446685 [00:03<00:05, 50601.72it/s] 40%|███▉      | 178092/446685 [00:03<00:05, 52578.71it/s] 41%|████▏     | 185076/446685 [00:03<00:04, 56180.70it/s] 43%|████▎     | 192060/446685 [00:03<00:04, 59669.18it/s] 44%|████▍     | 198227/446685 [00:03<00:04, 59427.10it/s] 46%|████▌     | 204308/446685 [00:03<00:04, 59418.33it/s] 47%|████▋     | 210684/446685 [00:04<00:03, 59891.74it/s] 49%|████▊     | 216742/446685 [00:04<00:03, 60012.09it/s] 50%|████▉     | 222792/446685 [00:04<00:04, 54732.17it/s] 51%|█████▏    | 229308/446685 [00:04<00:03, 57149.25it/s] 53%|█████▎    | 235128/446685 [00:04<00:03, 56510.53it/s] 54%|█████▍    | 242112/446685 [00:04<00:03, 59384.41it/s] 56%|█████▌    | 248105/446685 [00:04<00:03, 58930.80it/s] 57%|█████▋    | 254035/446685 [00:04<00:03, 56874.12it/s] 59%|█████▊    | 261318/446685 [00:04<00:03, 61031.53it/s] 60%|█████▉    | 267464/446685 [00:05<00:03, 58335.60it/s] 61%|██████    | 273344/446685 [00:05<00:03, 53987.17it/s] 62%|██████▏   | 278822/446685 [00:05<00:03, 52978.41it/s] 64%|██████▍   | 286926/446685 [00:05<00:02, 60068.26it/s] 66%|██████▌   | 293328/446685 [00:05<00:02, 59961.03it/s] 67%|██████▋   | 300312/446685 [00:05<00:02, 62167.26it/s] 69%|██████▊   | 306579/446685 [00:05<00:02, 60141.19it/s] 70%|██████▉   | 312635/446685 [00:05<00:02, 58910.62it/s] 71%|███████▏  | 318936/446685 [00:05<00:02, 59330.33it/s] 73%|███████▎  | 326502/446685 [00:06<00:01, 63878.18it/s] 75%|███████▍  | 334068/446685 [00:06<00:01, 65935.34it/s] 76%|███████▋  | 340685/446685 [00:06<00:01, 63920.97it/s] 78%|███████▊  | 347101/446685 [00:06<00:01, 59503.69it/s] 79%|███████▉  | 353274/446685 [00:06<00:01, 59772.29it/s] 81%|████████  | 359676/446685 [00:06<00:01, 60221.01it/s] 82%|████████▏ | 365732/446685 [00:06<00:01, 55988.56it/s] 83%|████████▎ | 372480/446685 [00:06<00:01, 57934.81it/s] 85%|████████▍ | 378330/446685 [00:06<00:01, 57141.60it/s] 86%|████████▌ | 384120/446685 [00:07<00:01, 56267.87it/s] 87%|████████▋ | 389770/446685 [00:07<00:01, 54116.06it/s] 88%|████████▊ | 395205/446685 [00:07<00:00, 53626.78it/s] 90%|█████████ | 402162/446685 [00:07<00:00, 58056.50it/s] 91%|█████████▏| 408003/446685 [00:07<00:00, 55371.51it/s] 93%|█████████▎| 414966/446685 [00:07<00:00, 57868.36it/s] 94%|█████████▍| 420784/446685 [00:07<00:00, 57372.64it/s] 95%|█████████▌| 426541/446685 [00:07<00:00, 53285.59it/s] 97%|█████████▋| 431928/446685 [00:07<00:00, 53065.02it/s] 98%|█████████▊| 437274/446685 [00:08<00:00, 51238.20it/s]100%|█████████▉| 444648/446685 [00:08<00:00, 56705.20it/s]100%|██████████| 446685/446685 [00:08<00:00, 54754.33it/s]
The spherical harmonics array is 393.62 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 88.88150238990784 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 0.7970655436055446
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.0009, 'pow_max': 0.00095, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 15.60it/s] 21%|██        | 4/19 [00:00<00:00, 16.84it/s] 32%|███▏      | 6/19 [00:00<00:00, 17.87it/s] 47%|████▋     | 9/19 [00:00<00:00, 19.26it/s] 63%|██████▎   | 12/19 [00:00<00:00, 20.64it/s] 79%|███████▉  | 15/19 [00:00<00:00, 21.58it/s] 95%|█████████▍| 18/19 [00:00<00:00, 22.17it/s]100%|██████████| 19/19 [00:00<00:00, 20.70it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519265089295892
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6356712 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 0.767148494720459 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07026981873647886
Ratio of unique |k|: 0.0017317128729443774
Time to get unique k and theta: 1.5441665649414062 seconds

Getting transfer functions
  0%|          | 0/11008 [00:00<?, ?it/s]  2%|▏         | 225/11008 [00:00<00:04, 2219.14it/s]  4%|▍         | 465/11008 [00:00<00:04, 2262.88it/s]  7%|▋         | 720/11008 [00:00<00:04, 2383.02it/s]  9%|▊         | 960/11008 [00:00<00:04, 2345.99it/s] 11%|█         | 1215/11008 [00:00<00:04, 2388.71it/s] 13%|█▎        | 1455/11008 [00:00<00:04, 2386.16it/s] 16%|█▌        | 1710/11008 [00:00<00:03, 2406.94it/s] 18%|█▊        | 1965/11008 [00:00<00:03, 2415.52it/s] 20%|██        | 2250/11008 [00:00<00:03, 2515.50it/s] 23%|██▎       | 2505/11008 [00:01<00:03, 2523.50it/s] 25%|██▌       | 2760/11008 [00:01<00:03, 2507.94it/s] 28%|██▊       | 3060/11008 [00:01<00:03, 2631.48it/s] 31%|███       | 3420/11008 [00:01<00:02, 2894.32it/s] 34%|███▍      | 3795/11008 [00:01<00:02, 3109.26it/s] 38%|███▊      | 4185/11008 [00:01<00:02, 3306.77it/s] 41%|████▏     | 4545/11008 [00:01<00:01, 3360.29it/s] 44%|████▍     | 4890/11008 [00:01<00:01, 3364.47it/s] 47%|████▋     | 5227/11008 [00:01<00:01, 3308.26it/s] 51%|█████     | 5565/11008 [00:01<00:01, 3324.18it/s] 54%|█████▎    | 5898/11008 [00:02<00:01, 3313.75it/s] 57%|█████▋    | 6285/11008 [00:02<00:01, 3447.37it/s] 61%|██████    | 6720/11008 [00:02<00:01, 3706.30it/s] 64%|██████▍   | 7091/11008 [00:02<00:01, 3613.40it/s] 68%|██████▊   | 7455/11008 [00:02<00:00, 3589.32it/s] 71%|███████   | 7815/11008 [00:02<00:00, 3573.64it/s] 74%|███████▍  | 8190/11008 [00:02<00:00, 3604.23it/s] 78%|███████▊  | 8551/11008 [00:02<00:00, 3497.49it/s] 81%|████████  | 8902/11008 [00:02<00:00, 3351.96it/s] 84%|████████▍ | 9240/11008 [00:03<00:00, 3353.83it/s] 88%|████████▊ | 9660/11008 [00:03<00:00, 3577.29it/s] 91%|█████████ | 10020/11008 [00:03<00:00, 3549.20it/s] 94%|█████████▍| 10395/11008 [00:03<00:00, 3575.11it/s] 98%|█████████▊| 10754/11008 [00:03<00:00, 3569.63it/s]100%|██████████| 11008/11008 [00:03<00:00, 3165.00it/s]
Size of transfer function: 1.76 MB. 

Size of integrand: 37.04 MB. Time to calculate integrand: 0.022113323211669922 s

Getting spherical harmonics
  0%|          | 0/446685 [00:00<?, ?it/s]  1%|          | 5238/446685 [00:00<00:09, 48062.63it/s]  2%|▏         | 11058/446685 [00:00<00:08, 53146.24it/s]  4%|▎         | 16387/446685 [00:00<00:08, 51743.86it/s]  5%|▍         | 21570/446685 [00:00<00:08, 49212.40it/s]  6%|▌         | 27354/446685 [00:00<00:08, 50438.30it/s]  7%|▋         | 32592/446685 [00:00<00:08, 49996.25it/s]  9%|▊         | 38412/446685 [00:00<00:07, 51309.55it/s] 10%|▉         | 43548/446685 [00:00<00:07, 51179.41it/s] 11%|█         | 48669/446685 [00:00<00:07, 50394.23it/s] 12%|█▏        | 53710/446685 [00:01<00:07, 49496.62it/s] 13%|█▎        | 58661/446685 [00:01<00:08, 44393.11it/s] 14%|█▍        | 63186/446685 [00:01<00:09, 38389.43it/s] 15%|█▌        | 67199/446685 [00:01<00:10, 36275.64it/s] 16%|█▌        | 71586/446685 [00:01<00:10, 36800.62it/s] 17%|█▋        | 75644/446685 [00:01<00:09, 37771.71it/s] 18%|█▊        | 80316/446685 [00:01<00:09, 39413.64it/s] 19%|█▉        | 84972/446685 [00:01<00:09, 40159.08it/s] 20%|██        | 89628/446685 [00:02<00:08, 41632.09it/s] 21%|██        | 94866/446685 [00:02<00:08, 42684.98it/s] 22%|██▏       | 99522/446685 [00:02<00:08, 42202.14it/s] 23%|██▎       | 103762/446685 [00:02<00:08, 41480.89it/s] 24%|██▍       | 108252/446685 [00:02<00:08, 41617.38it/s] 25%|██▌       | 112908/446685 [00:02<00:07, 41943.91it/s] 26%|██▋       | 117564/446685 [00:02<00:07, 42851.14it/s] 27%|██▋       | 122802/446685 [00:02<00:07, 42818.87it/s] 29%|██▉       | 128622/446685 [00:02<00:06, 46363.31it/s] 30%|███       | 135024/446685 [00:03<00:06, 51175.78it/s] 32%|███▏      | 140844/446685 [00:03<00:05, 52327.88it/s] 33%|███▎      | 147246/446685 [00:03<00:05, 54639.65it/s] 34%|███▍      | 152733/446685 [00:03<00:05, 50075.53it/s] 35%|███▌      | 158304/446685 [00:03<00:05, 50197.96it/s] 37%|███▋      | 164124/446685 [00:03<00:05, 50550.66it/s] 38%|███▊      | 169944/446685 [00:03<00:05, 52431.01it/s] 39%|███▉      | 175230/446685 [00:03<00:05, 51851.40it/s] 41%|████      | 181584/446685 [00:03<00:04, 53722.70it/s] 42%|████▏     | 187404/446685 [00:04<00:04, 54582.47it/s] 43%|████▎     | 193224/446685 [00:04<00:04, 53770.31it/s] 44%|████▍     | 198615/446685 [00:04<00:04, 51670.03it/s] 46%|████▌     | 204282/446685 [00:04<00:04, 52842.81it/s] 47%|████▋     | 209586/446685 [00:04<00:04, 51772.42it/s] 48%|████▊     | 215340/446685 [00:04<00:04, 53229.52it/s] 50%|████▉     | 221532/446685 [00:04<00:04, 55734.88it/s] 51%|█████     | 227127/446685 [00:04<00:04, 54861.64it/s] 52%|█████▏    | 232630/446685 [00:04<00:03, 54425.34it/s] 53%|█████▎    | 238084/446685 [00:04<00:03, 54222.91it/s] 55%|█████▍    | 243858/446685 [00:05<00:03, 53671.60it/s] 56%|█████▌    | 249678/446685 [00:05<00:03, 53402.84it/s] 57%|█████▋    | 255025/446685 [00:05<00:03, 50120.73it/s] 58%|█████▊    | 260154/446685 [00:05<00:03, 50043.96it/s] 60%|█████▉    | 266556/446685 [00:05<00:03, 52447.44it/s] 61%|██████    | 272958/446685 [00:05<00:03, 55690.37it/s] 62%|██████▏   | 278778/446685 [00:05<00:03, 54386.83it/s] 64%|██████▎   | 284244/446685 [00:05<00:03, 53878.22it/s] 65%|██████▍   | 289836/446685 [00:05<00:02, 54158.81it/s] 66%|██████▋   | 296238/446685 [00:06<00:02, 56493.88it/s] 68%|██████▊   | 301901/446685 [00:06<00:02, 55245.37it/s] 69%|██████▉   | 307438/446685 [00:06<00:02, 51788.02it/s] 70%|██████▉   | 312660/446685 [00:06<00:02, 49171.56it/s] 71%|███████▏  | 318354/446685 [00:06<00:02, 50668.27it/s] 72%|███████▏  | 323592/446685 [00:06<00:02, 50917.93it/s] 74%|███████▎  | 329412/446685 [00:06<00:02, 52422.73it/s] 75%|███████▌  | 335232/446685 [00:06<00:02, 53305.12it/s] 76%|███████▌  | 340582/446685 [00:06<00:02, 51386.30it/s] 77%|███████▋  | 345743/446685 [00:07<00:02, 50246.62it/s] 79%|███████▊  | 350946/446685 [00:07<00:01, 50395.70it/s] 80%|████████  | 357348/446685 [00:07<00:01, 53346.38it/s] 81%|████████▏ | 363168/446685 [00:07<00:01, 53705.79it/s] 83%|████████▎ | 368545/446685 [00:07<00:01, 52886.37it/s] 84%|████████▎ | 373838/446685 [00:07<00:01, 49267.36it/s] 85%|████████▌ | 380628/446685 [00:07<00:01, 54034.80it/s] 86%|████████▋ | 386092/446685 [00:07<00:01, 49284.34it/s] 88%|████████▊ | 392850/446685 [00:07<00:01, 52770.65it/s] 89%|████████▉ | 399252/446685 [00:08<00:00, 54871.79it/s] 91%|█████████ | 404815/446685 [00:08<00:00, 54359.64it/s] 92%|█████████▏| 411474/446685 [00:08<00:00, 56749.32it/s] 94%|█████████▎| 417876/446685 [00:08<00:00, 58385.11it/s] 95%|█████████▍| 423751/446685 [00:08<00:00, 54162.19it/s] 96%|█████████▋| 430098/446685 [00:08<00:00, 56694.69it/s] 98%|█████████▊| 435918/446685 [00:08<00:00, 56528.57it/s] 99%|█████████▉| 441623/446685 [00:08<00:00, 54027.17it/s]100%|██████████| 446685/446685 [00:08<00:00, 50208.31it/s]
The spherical harmonics array is 393.62 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 85.87618160247803 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 0.777542080770409
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.001, 'pow_max': 0.00105, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 16.93it/s] 26%|██▋       | 5/19 [00:00<00:00, 19.71it/s] 42%|████▏     | 8/19 [00:00<00:00, 21.23it/s] 58%|█████▊    | 11/19 [00:00<00:00, 22.01it/s] 74%|███████▎  | 14/19 [00:00<00:00, 22.49it/s] 89%|████████▉ | 17/19 [00:00<00:00, 22.76it/s]100%|██████████| 19/19 [00:00<00:00, 22.06it/s]
Done. k_max for TT ell_max = 0.02261894553888885 k_max for EE ell_max = 0.08519989272692324
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6282516 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 0.7524349689483643 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07030781935135541
Ratio of unique |k|: 0.001738475477022263
Time to get unique k and theta: 1.534752368927002 seconds

Getting transfer functions
  0%|          | 0/10922 [00:00<?, ?it/s]  2%|▏         | 225/10922 [00:00<00:04, 2146.96it/s]  4%|▍         | 450/10922 [00:00<00:04, 2164.48it/s]  6%|▋         | 690/10922 [00:00<00:04, 2243.23it/s]  9%|▊         | 930/10922 [00:00<00:04, 2296.07it/s] 11%|█         | 1170/10922 [00:00<00:04, 2316.88it/s] 13%|█▎        | 1410/10922 [00:00<00:04, 2326.44it/s] 15%|█▌        | 1650/10922 [00:00<00:03, 2344.49it/s] 17%|█▋        | 1890/10922 [00:00<00:03, 2351.35it/s] 20%|█▉        | 2130/10922 [00:00<00:03, 2332.16it/s] 22%|██▏       | 2400/10922 [00:01<00:03, 2418.38it/s] 24%|██▍       | 2670/10922 [00:01<00:03, 2449.96it/s] 27%|██▋       | 2955/10922 [00:01<00:03, 2553.06it/s] 30%|███       | 3315/10922 [00:01<00:02, 2857.51it/s] 34%|███▎      | 3660/10922 [00:01<00:02, 3008.39it/s] 37%|███▋      | 3990/10922 [00:01<00:02, 3084.81it/s] 40%|███▉      | 4320/10922 [00:01<00:02, 3125.84it/s] 43%|████▎     | 4650/10922 [00:01<00:01, 3161.63it/s] 46%|████▌     | 4995/10922 [00:01<00:01, 3213.91it/s] 49%|████▉     | 5325/10922 [00:01<00:01, 3218.59it/s] 52%|█████▏    | 5655/10922 [00:02<00:01, 3214.88it/s] 55%|█████▍    | 5985/10922 [00:02<00:01, 3231.36it/s] 58%|█████▊    | 6345/10922 [00:02<00:01, 3331.18it/s] 61%|██████▏   | 6690/10922 [00:02<00:01, 3339.08it/s] 64%|██████▍   | 7035/10922 [00:02<00:01, 3327.83it/s] 68%|██████▊   | 7380/10922 [00:02<00:01, 3317.49it/s] 71%|███████   | 7770/10922 [00:02<00:00, 3485.95it/s] 75%|███████▍  | 8145/10922 [00:02<00:00, 3536.41it/s] 78%|███████▊  | 8520/10922 [00:02<00:00, 3550.20it/s] 81%|████████▏ | 8880/10922 [00:02<00:00, 3531.81it/s] 85%|████████▍ | 9240/10922 [00:03<00:00, 3531.44it/s] 88%|████████▊ | 9660/10922 [00:03<00:00, 3679.75it/s] 92%|█████████▏| 10028/10922 [00:03<00:00, 3656.97it/s] 95%|█████████▌| 10425/10922 [00:03<00:00, 3717.70it/s] 99%|█████████▉| 10797/10922 [00:03<00:00, 3608.93it/s]100%|██████████| 10922/10922 [00:03<00:00, 3087.27it/s]
Size of transfer function: 1.75 MB. 

Size of integrand: 36.75 MB. Time to calculate integrand: 0.029999494552612305 s

Getting spherical harmonics
  0%|          | 0/441710 [00:00<?, ?it/s]  1%|          | 5184/441710 [00:00<00:08, 50611.89it/s]  2%|▏         | 10368/441710 [00:00<00:08, 50491.46it/s]  4%|▎         | 16128/441710 [00:00<00:08, 52696.05it/s]  5%|▍         | 21396/441710 [00:00<00:09, 45948.61it/s]  6%|▌         | 26093/441710 [00:00<00:09, 45887.42it/s]  7%|▋         | 30746/441710 [00:00<00:08, 45815.29it/s]  8%|▊         | 35370/441710 [00:00<00:09, 44696.66it/s]  9%|▉         | 39869/441710 [00:00<00:09, 43755.29it/s] 10%|█         | 44928/441710 [00:00<00:08, 44594.96it/s] 11%|█         | 49536/441710 [00:01<00:09, 42929.87it/s] 12%|█▏        | 53846/441710 [00:01<00:09, 40485.81it/s] 13%|█▎        | 58176/441710 [00:01<00:09, 39924.43it/s] 14%|█▍        | 62784/441710 [00:01<00:09, 41565.12it/s] 15%|█▌        | 66968/441710 [00:01<00:09, 41345.30it/s] 16%|█▋        | 72000/441710 [00:01<00:08, 43080.75it/s] 18%|█▊        | 77760/441710 [00:01<00:07, 47017.44it/s] 19%|█▉        | 82944/441710 [00:01<00:07, 46694.66it/s] 20%|█▉        | 87633/441710 [00:01<00:07, 46630.12it/s] 21%|██        | 92309/441710 [00:02<00:07, 46313.17it/s] 22%|██▏       | 96949/441710 [00:02<00:07, 45079.19it/s] 23%|██▎       | 101467/441710 [00:02<00:08, 41746.35it/s] 24%|██▍       | 105984/441710 [00:02<00:07, 42299.67it/s] 25%|██▌       | 111744/441710 [00:02<00:07, 46282.88it/s] 27%|██▋       | 118080/441710 [00:02<00:06, 50655.07it/s] 28%|██▊       | 124992/441710 [00:02<00:05, 55452.34it/s] 30%|██▉       | 131328/441710 [00:02<00:05, 56943.22it/s] 31%|███       | 137088/441710 [00:02<00:05, 56869.23it/s] 32%|███▏      | 142848/441710 [00:03<00:05, 55987.52it/s] 34%|███▍      | 149760/441710 [00:03<00:04, 59549.76it/s] 36%|███▌      | 157645/441710 [00:03<00:04, 65184.83it/s] 37%|███▋      | 164193/441710 [00:03<00:04, 62565.47it/s] 39%|███▊      | 171072/441710 [00:03<00:04, 63618.88it/s] 40%|████      | 177464/441710 [00:03<00:04, 60021.01it/s] 42%|████▏     | 183520/441710 [00:03<00:04, 57327.40it/s] 43%|████▎     | 190656/441710 [00:03<00:04, 60035.31it/s] 45%|████▍     | 197568/441710 [00:03<00:03, 61798.83it/s] 46%|████▌     | 203787/441710 [00:04<00:03, 59982.63it/s] 48%|████▊     | 209815/441710 [00:04<00:03, 59928.98it/s] 49%|████▉     | 216576/441710 [00:04<00:03, 60518.62it/s] 50%|█████     | 222642/441710 [00:04<00:03, 57453.38it/s] 52%|█████▏    | 228672/441710 [00:04<00:03, 57983.44it/s] 53%|█████▎    | 235584/441710 [00:04<00:03, 60300.34it/s] 55%|█████▍    | 241920/441710 [00:04<00:03, 60236.70it/s] 56%|█████▌    | 247960/441710 [00:04<00:03, 59338.25it/s] 57%|█████▋    | 253904/441710 [00:04<00:03, 58326.29it/s] 59%|█████▉    | 259744/441710 [00:04<00:03, 54964.25it/s] 60%|██████    | 265536/441710 [00:05<00:03, 55267.78it/s] 62%|██████▏   | 271872/441710 [00:05<00:02, 56703.23it/s] 63%|██████▎   | 277564/441710 [00:05<00:02, 56407.66it/s] 64%|██████▍   | 283392/441710 [00:05<00:02, 56002.43it/s] 65%|██████▌   | 289002/441710 [00:05<00:03, 46657.28it/s] 67%|██████▋   | 293921/441710 [00:05<00:03, 44649.97it/s] 68%|██████▊   | 298944/441710 [00:05<00:03, 45177.99it/s] 69%|██████▉   | 304704/441710 [00:05<00:02, 47533.20it/s] 71%|███████   | 312192/441710 [00:06<00:02, 54312.96it/s] 72%|███████▏  | 318528/441710 [00:06<00:02, 56324.79it/s] 73%|███████▎  | 324264/441710 [00:06<00:02, 52478.23it/s] 75%|███████▍  | 329623/441710 [00:06<00:02, 48964.76it/s] 76%|███████▌  | 335568/441710 [00:06<00:02, 51736.09it/s] 77%|███████▋  | 341568/441710 [00:06<00:01, 53346.78it/s] 79%|███████▉  | 347904/441710 [00:06<00:01, 55875.67it/s] 80%|████████  | 353664/441710 [00:06<00:01, 55159.68it/s] 81%|████████▏ | 359424/441710 [00:06<00:01, 55757.22it/s] 83%|████████▎ | 365041/441710 [00:06<00:01, 55222.50it/s] 84%|████████▍ | 370591/441710 [00:07<00:01, 53745.50it/s] 85%|████████▌ | 376704/441710 [00:07<00:01, 55261.62it/s] 87%|████████▋ | 383040/441710 [00:07<00:01, 57304.89it/s] 88%|████████▊ | 388800/441710 [00:07<00:00, 55342.85it/s] 89%|████████▉ | 395136/441710 [00:07<00:00, 57187.30it/s] 91%|█████████ | 401472/441710 [00:07<00:00, 58566.02it/s] 92%|█████████▏| 408384/441710 [00:07<00:00, 60025.53it/s] 94%|█████████▍| 414720/441710 [00:07<00:00, 60209.96it/s] 95%|█████████▌| 420748/441710 [00:07<00:00, 53552.48it/s] 96%|█████████▋| 426231/441710 [00:08<00:00, 52705.68it/s] 98%|█████████▊| 432000/441710 [00:08<00:00, 53720.07it/s] 99%|█████████▉| 437760/441710 [00:08<00:00, 53958.80it/s]100%|██████████| 441710/441710 [00:08<00:00, 52914.87it/s]
The spherical harmonics array is 389.23 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 88.77105832099915 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 0.7569537667276643
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.0015, 'pow_max': 0.00155, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 13.83it/s] 21%|██        | 4/19 [00:00<00:01, 14.78it/s] 32%|███▏      | 6/19 [00:00<00:00, 15.72it/s] 42%|████▏     | 8/19 [00:00<00:00, 16.71it/s] 53%|█████▎    | 10/19 [00:00<00:00, 17.74it/s] 68%|██████▊   | 13/19 [00:00<00:00, 19.27it/s] 84%|████████▍ | 16/19 [00:00<00:00, 20.36it/s]100%|██████████| 19/19 [00:01<00:00, 21.04it/s]100%|██████████| 19/19 [00:01<00:00, 18.89it/s]
Done. k_max for TT ell_max = 0.009880133605414064 k_max for EE ell_max = 0.08519563282459129
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 2264842 Minimum k_amp 0.00019760140751641845 n_x_max 82 n_z_max 82
Time to get list of k, phi, theta: 0.25774288177490234 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07363736631517784
Ratio of unique |k|: 0.0024425544916599038
Time to get unique k and theta: 0.45736217498779297 seconds

Getting transfer functions
  0%|          | 0/5532 [00:00<?, ?it/s]  2%|▏         | 128/5532 [00:00<00:04, 1236.54it/s]  5%|▌         | 280/5532 [00:00<00:03, 1380.00it/s]  8%|▊         | 432/5532 [00:00<00:03, 1415.46it/s] 11%|█         | 592/5532 [00:00<00:03, 1471.15it/s] 14%|█▎        | 752/5532 [00:00<00:03, 1500.98it/s] 16%|█▋        | 912/5532 [00:00<00:03, 1510.43it/s] 19%|█▉        | 1072/5532 [00:00<00:02, 1531.94it/s] 22%|██▏       | 1240/5532 [00:00<00:02, 1557.48it/s] 25%|██▌       | 1400/5532 [00:00<00:02, 1562.30it/s] 28%|██▊       | 1568/5532 [00:01<00:02, 1591.83it/s] 33%|███▎      | 1808/5532 [00:01<00:02, 1824.07it/s] 37%|███▋      | 2048/5532 [00:01<00:01, 1992.51it/s] 41%|████      | 2280/5532 [00:01<00:01, 2077.61it/s] 46%|████▌     | 2520/5532 [00:01<00:01, 2169.87it/s] 49%|████▉     | 2738/5532 [00:01<00:01, 2171.54it/s] 53%|█████▎    | 2956/5532 [00:01<00:01, 1954.23it/s] 58%|█████▊    | 3192/5532 [00:01<00:01, 2062.73it/s] 62%|██████▏   | 3424/5532 [00:01<00:00, 2125.06it/s] 66%|██████▌   | 3664/5532 [00:01<00:00, 2183.64it/s] 70%|███████   | 3896/5532 [00:02<00:00, 2210.15it/s] 74%|███████▍  | 4120/5532 [00:02<00:00, 2218.72it/s] 79%|███████▊  | 4344/5532 [00:02<00:00, 2166.84it/s] 83%|████████▎ | 4568/5532 [00:02<00:00, 2178.54it/s] 87%|████████▋ | 4800/5532 [00:02<00:00, 2205.19it/s] 91%|█████████ | 5024/5532 [00:02<00:00, 2204.61it/s] 96%|█████████▌| 5288/5532 [00:02<00:00, 2321.99it/s]100%|█████████▉| 5521/5532 [00:02<00:00, 2298.83it/s]100%|██████████| 5532/5532 [00:02<00:00, 1972.69it/s]
Size of transfer function: 0.89 MB. 

Size of integrand: 18.61 MB. Time to calculate integrand: 0.013843774795532227 s

Getting spherical harmonics
  0%|          | 0/166777 [00:00<?, ?it/s]  3%|▎         | 4360/166777 [00:00<00:03, 41921.31it/s]  5%|▌         | 8553/166777 [00:00<00:04, 39228.09it/s]  7%|▋         | 12484/166777 [00:00<00:04, 34839.99it/s] 10%|█         | 17004/166777 [00:00<00:03, 37810.56it/s] 13%|█▎        | 21364/166777 [00:00<00:03, 39025.79it/s] 15%|█▌        | 25724/166777 [00:00<00:03, 39945.32it/s] 18%|█▊        | 30520/166777 [00:00<00:03, 41870.49it/s] 21%|██        | 35098/166777 [00:00<00:03, 43003.35it/s] 24%|██▍       | 39894/166777 [00:00<00:02, 44470.76it/s] 27%|██▋       | 44360/166777 [00:01<00:02, 43777.03it/s] 29%|██▉       | 48752/166777 [00:01<00:02, 43497.10it/s] 32%|███▏      | 53410/166777 [00:01<00:02, 44245.17it/s] 35%|███▌      | 58424/166777 [00:01<00:02, 45700.62it/s] 38%|███▊      | 63220/166777 [00:01<00:02, 44788.31it/s] 41%|████      | 67709/166777 [00:01<00:02, 43354.14it/s] 43%|████▎     | 72158/166777 [00:01<00:02, 43329.81it/s] 47%|████▋     | 77826/166777 [00:01<00:01, 46701.15it/s] 50%|████▉     | 83276/166777 [00:01<00:01, 48676.20it/s] 53%|█████▎    | 88156/166777 [00:02<00:01, 43633.66it/s] 56%|█████▌    | 93304/166777 [00:02<00:01, 45224.51it/s] 59%|█████▉    | 98754/166777 [00:02<00:01, 47753.80it/s] 62%|██████▏   | 103606/166777 [00:02<00:01, 46672.79it/s] 65%|██████▍   | 108328/166777 [00:02<00:01, 43908.87it/s] 68%|██████▊   | 112924/166777 [00:02<00:01, 44012.01it/s] 71%|███████   | 118156/166777 [00:02<00:01, 45898.41it/s] 74%|███████▎  | 122952/166777 [00:02<00:00, 46364.87it/s] 77%|███████▋  | 127966/166777 [00:02<00:00, 47219.81it/s] 80%|███████▉  | 132712/166777 [00:03<00:00, 44709.44it/s] 82%|████████▏ | 137222/166777 [00:03<00:00, 42650.46it/s] 85%|████████▌ | 142136/166777 [00:03<00:00, 44408.33it/s] 88%|████████▊ | 147368/166777 [00:03<00:00, 46509.82it/s] 92%|█████████▏| 153036/166777 [00:03<00:00, 49205.12it/s] 95%|█████████▍| 158050/166777 [00:03<00:00, 49236.13it/s] 98%|█████████▊| 163064/166777 [00:03<00:00, 49011.47it/s]100%|██████████| 166777/166777 [00:03<00:00, 44602.52it/s]
The spherical harmonics array is 146.96 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 78.45918202400208 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 0.7467712477741301
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.002, 'pow_max': 0.00205, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 14.86it/s] 21%|██        | 4/19 [00:00<00:00, 16.20it/s] 32%|███▏      | 6/19 [00:00<00:00, 17.48it/s] 47%|████▋     | 9/19 [00:00<00:00, 19.10it/s] 63%|██████▎   | 12/19 [00:00<00:00, 20.53it/s] 79%|███████▉  | 15/19 [00:00<00:00, 21.45it/s] 95%|█████████▍| 18/19 [00:00<00:00, 22.07it/s]100%|██████████| 19/19 [00:00<00:00, 20.48it/s]
Done. k_max for TT ell_max = 0.012366638596575524 k_max for EE ell_max = 0.08519733678552407
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 2824426 Minimum k_amp 0.00019760140751641845 n_x_max 88 n_z_max 88
Time to get list of k, phi, theta: 0.3485887050628662 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0729107436342818
Ratio of unique |k|: 0.002269133622194386
Time to get unique k and theta: 0.6330687999725342 seconds

Getting transfer functions
  0%|          | 0/6409 [00:00<?, ?it/s]  2%|▏         | 126/6409 [00:00<00:04, 1259.36it/s]  4%|▍         | 270/6409 [00:00<00:04, 1356.09it/s]  7%|▋         | 450/6409 [00:00<00:03, 1549.82it/s] 10%|▉         | 612/6409 [00:00<00:03, 1564.62it/s] 12%|█▏        | 792/6409 [00:00<00:03, 1644.77it/s] 15%|█▌        | 972/6409 [00:00<00:03, 1673.10it/s] 18%|█▊        | 1152/6409 [00:00<00:03, 1699.21it/s] 21%|██        | 1341/6409 [00:00<00:02, 1730.87it/s] 24%|██▎       | 1521/6409 [00:00<00:02, 1721.49it/s] 26%|██▋       | 1694/6409 [00:01<00:02, 1720.21it/s] 30%|███       | 1944/6409 [00:01<00:02, 1936.77it/s] 34%|███▍      | 2187/6409 [00:01<00:02, 2078.77it/s] 38%|███▊      | 2439/6409 [00:01<00:01, 2200.96it/s] 42%|████▏     | 2673/6409 [00:01<00:01, 2228.84it/s] 46%|████▌     | 2925/6409 [00:01<00:01, 2290.05it/s] 49%|████▉     | 3168/6409 [00:01<00:01, 2308.11it/s] 53%|█████▎    | 3411/6409 [00:01<00:01, 2343.73it/s] 57%|█████▋    | 3654/6409 [00:01<00:01, 2363.32it/s] 61%|██████    | 3924/6409 [00:01<00:01, 2455.88it/s] 66%|██████▌   | 4203/6409 [00:02<00:00, 2528.51it/s] 70%|██████▉   | 4456/6409 [00:02<00:00, 2516.08it/s] 73%|███████▎  | 4708/6409 [00:02<00:00, 2477.20it/s] 78%|███████▊  | 4968/6409 [00:02<00:00, 2491.77it/s] 81%|████████▏ | 5218/6409 [00:02<00:00, 2491.94it/s] 85%|████████▌ | 5472/6409 [00:02<00:00, 2502.94it/s] 89%|████████▉ | 5733/6409 [00:02<00:00, 2508.64it/s] 94%|█████████▎| 5994/6409 [00:02<00:00, 2519.93it/s] 97%|█████████▋| 6247/6409 [00:02<00:00, 2507.07it/s]100%|██████████| 6409/6409 [00:02<00:00, 2190.44it/s]
Size of transfer function: 1.03 MB. 

Size of integrand: 21.56 MB. Time to calculate integrand: 0.016979217529296875 s

Getting spherical harmonics
  0%|          | 0/205931 [00:00<?, ?it/s]  2%|▏         | 3766/205931 [00:00<00:05, 34240.92it/s]  4%|▎         | 7263/205931 [00:00<00:05, 34103.84it/s]  5%|▌         | 11029/205931 [00:00<00:05, 34674.39it/s]  8%|▊         | 15602/205931 [00:00<00:05, 37480.52it/s]  9%|▉         | 19368/205931 [00:00<00:05, 37199.15it/s] 11%|█▏        | 23403/205931 [00:00<00:04, 37763.62it/s] 13%|█▎        | 27438/205931 [00:00<00:04, 38080.23it/s] 15%|█▌        | 31473/205931 [00:00<00:04, 38450.15it/s] 17%|█▋        | 35508/205931 [00:00<00:04, 38815.12it/s] 19%|█▉        | 39543/205931 [00:01<00:04, 38998.62it/s] 21%|██        | 43578/205931 [00:01<00:04, 38953.64it/s] 23%|██▎       | 47882/205931 [00:01<00:04, 39451.61it/s] 25%|██▌       | 52186/205931 [00:01<00:03, 39592.78it/s] 28%|██▊       | 57566/205931 [00:01<00:03, 42979.17it/s] 30%|███       | 61862/205931 [00:01<00:03, 42604.50it/s] 32%|███▏      | 66121/205931 [00:01<00:03, 40966.32it/s] 34%|███▍      | 70478/205931 [00:01<00:03, 41199.89it/s] 37%|███▋      | 76396/205931 [00:01<00:02, 45840.03it/s] 40%|███▉      | 81507/205931 [00:02<00:02, 44982.75it/s] 42%|████▏     | 86618/205931 [00:02<00:02, 46446.85it/s] 45%|████▍     | 91998/205931 [00:02<00:02, 48515.00it/s] 47%|████▋     | 96873/205931 [00:02<00:02, 48281.69it/s] 50%|████▉     | 101951/205931 [00:02<00:02, 48345.64it/s] 52%|█████▏    | 106797/205931 [00:02<00:02, 47389.29it/s] 54%|█████▍    | 111546/205931 [00:02<00:02, 43957.56it/s] 56%|█████▋    | 116208/205931 [00:02<00:02, 44689.05it/s] 59%|█████▉    | 121050/205931 [00:02<00:01, 45438.94it/s] 61%|██████    | 125625/205931 [00:02<00:01, 45197.07it/s] 63%|██████▎   | 130734/205931 [00:03<00:01, 46806.64it/s] 66%|██████▌   | 135435/205931 [00:03<00:01, 46056.74it/s] 69%|██████▊   | 141494/205931 [00:03<00:01, 49208.82it/s] 71%|███████   | 146420/205931 [00:03<00:01, 47635.29it/s] 74%|███████▍  | 152254/205931 [00:03<00:01, 50191.16it/s] 77%|███████▋  | 157634/205931 [00:03<00:00, 50685.35it/s] 79%|███████▉  | 162713/205931 [00:03<00:00, 49035.93it/s] 81%|████████▏ | 167631/205931 [00:03<00:00, 47213.73it/s] 84%|████████▍ | 172698/205931 [00:03<00:00, 47516.13it/s] 87%|████████▋ | 178885/205931 [00:04<00:00, 51556.46it/s] 90%|████████▉ | 184596/205931 [00:04<00:00, 53156.83it/s] 92%|█████████▏| 189940/205931 [00:04<00:00, 47076.89it/s] 95%|█████████▍| 194788/205931 [00:04<00:00, 44505.87it/s] 97%|█████████▋| 199349/205931 [00:04<00:00, 44650.93it/s] 99%|█████████▉| 204171/205931 [00:04<00:00, 45341.21it/s]100%|██████████| 205931/205931 [00:04<00:00, 44414.82it/s]
The spherical harmonics array is 181.47 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 83.01480674743652 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 0.703077195155666
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.0001, 'pow_max': 0.00015000000000000001, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 15.62it/s] 21%|██        | 4/19 [00:00<00:00, 16.82it/s] 32%|███▏      | 6/19 [00:00<00:00, 17.43it/s] 47%|████▋     | 9/19 [00:00<00:00, 19.01it/s] 63%|██████▎   | 12/19 [00:00<00:00, 20.16it/s] 79%|███████▉  | 15/19 [00:00<00:00, 20.84it/s] 95%|█████████▍| 18/19 [00:00<00:00, 21.26it/s]100%|██████████| 19/19 [00:00<00:00, 20.08it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6356712 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 0.7431724071502686 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07026981873647886
Ratio of unique |k|: 0.0017317128729443774
Time to get unique k and theta: 1.5191354751586914 seconds

Getting transfer functions
  0%|          | 0/11008 [00:00<?, ?it/s]  2%|▏         | 210/11008 [00:00<00:05, 1993.33it/s]  4%|▍         | 465/11008 [00:00<00:04, 2292.85it/s]  7%|▋         | 735/11008 [00:00<00:04, 2403.44it/s]  9%|▉         | 1005/11008 [00:00<00:04, 2487.34it/s] 12%|█▏        | 1275/11008 [00:00<00:03, 2553.44it/s] 14%|█▍        | 1545/11008 [00:00<00:03, 2584.31it/s] 16%|█▋        | 1815/11008 [00:00<00:03, 2573.64it/s] 19%|█▉        | 2085/11008 [00:00<00:03, 2603.71it/s] 21%|██▏       | 2355/11008 [00:00<00:03, 2594.84it/s] 24%|██▍       | 2625/11008 [00:01<00:03, 2610.57it/s] 26%|██▌       | 2887/11008 [00:01<00:03, 2598.59it/s] 30%|██▉       | 3255/11008 [00:01<00:02, 2908.28it/s] 33%|███▎      | 3615/11008 [00:01<00:02, 3097.78it/s] 36%|███▌      | 3945/11008 [00:01<00:02, 3154.62it/s] 39%|███▉      | 4305/11008 [00:01<00:02, 3255.39it/s] 42%|████▏     | 4650/11008 [00:01<00:01, 3299.68it/s] 45%|████▌     | 4981/11008 [00:01<00:01, 3299.11it/s] 49%|████▉     | 5370/11008 [00:01<00:01, 3439.42it/s] 52%|█████▏    | 5714/11008 [00:01<00:01, 3427.04it/s] 55%|█████▌    | 6057/11008 [00:02<00:01, 3420.72it/s] 58%|█████▊    | 6399/11008 [00:02<00:01, 3370.44it/s] 61%|██████    | 6737/11008 [00:02<00:01, 3349.28it/s] 65%|██████▍   | 7125/11008 [00:02<00:01, 3480.27it/s] 68%|██████▊   | 7485/11008 [00:02<00:01, 3480.92it/s] 71%|███████▏  | 7860/11008 [00:02<00:00, 3515.49it/s] 75%|███████▍  | 8220/11008 [00:02<00:00, 3537.33it/s] 78%|███████▊  | 8595/11008 [00:02<00:00, 3556.97it/s] 81%|████████▏ | 8951/11008 [00:02<00:00, 3532.56it/s] 85%|████████▍ | 9315/11008 [00:02<00:00, 3539.28it/s] 88%|████████▊ | 9669/11008 [00:03<00:00, 3525.89it/s] 91%|█████████ | 10022/11008 [00:03<00:00, 3493.45it/s] 94%|█████████▍| 10372/11008 [00:03<00:00, 3468.67it/s] 97%|█████████▋| 10719/11008 [00:03<00:00, 3438.03it/s]100%|██████████| 11008/11008 [00:03<00:00, 3167.53it/s]
Size of transfer function: 1.76 MB. 

Size of integrand: 37.04 MB. Time to calculate integrand: 0.02310013771057129 s

Getting spherical harmonics
  0%|          | 0/446685 [00:00<?, ?it/s]  1%|          | 4656/446685 [00:00<00:10, 41221.31it/s]  2%|▏         | 9312/446685 [00:00<00:09, 44021.28it/s]  3%|▎         | 14550/446685 [00:00<00:09, 46104.35it/s]  4%|▍         | 19788/446685 [00:00<00:09, 46556.55it/s]  5%|▌         | 24446/446685 [00:00<00:11, 37866.55it/s]  6%|▋         | 28430/446685 [00:00<00:11, 37312.38it/s]  7%|▋         | 32592/446685 [00:00<00:10, 38083.83it/s]  8%|▊         | 37248/446685 [00:00<00:10, 40463.25it/s] 10%|▉         | 42486/446685 [00:01<00:09, 42569.69it/s] 11%|█         | 47142/446685 [00:01<00:09, 43614.91it/s] 12%|█▏        | 52380/446685 [00:01<00:08, 44800.99it/s] 13%|█▎        | 56894/446685 [00:01<00:12, 30398.37it/s] 14%|█▎        | 60551/446685 [00:01<00:16, 23518.22it/s] 14%|█▍        | 64602/446685 [00:01<00:14, 26638.45it/s] 16%|█▌        | 69258/446685 [00:01<00:12, 30582.87it/s] 17%|█▋        | 74496/446685 [00:02<00:10, 35006.15it/s] 18%|█▊        | 79734/446685 [00:02<00:09, 38565.85it/s] 19%|█▉        | 84390/446685 [00:02<00:09, 39725.52it/s] 20%|█▉        | 88672/446685 [00:02<00:09, 39592.20it/s] 21%|██        | 92847/446685 [00:02<00:09, 38517.54it/s] 22%|██▏       | 97776/446685 [00:02<00:08, 40652.95it/s] 23%|██▎       | 102432/446685 [00:02<00:08, 41725.53it/s] 24%|██▍       | 107088/446685 [00:02<00:08, 42333.46it/s] 25%|██▌       | 111744/446685 [00:02<00:07, 43029.12it/s] 26%|██▋       | 117564/446685 [00:03<00:07, 46300.17it/s] 28%|██▊       | 123384/446685 [00:03<00:06, 48003.77it/s] 29%|██▉       | 129786/446685 [00:03<00:06, 52251.45it/s] 30%|███       | 135047/446685 [00:03<00:06, 49876.35it/s] 31%|███▏      | 140262/446685 [00:03<00:06, 49900.39it/s] 33%|███▎      | 145832/446685 [00:03<00:05, 51542.50it/s] 34%|███▍      | 151016/446685 [00:03<00:06, 48997.95it/s] 35%|███▌      | 156558/446685 [00:03<00:05, 49733.55it/s] 36%|███▋      | 162960/446685 [00:03<00:05, 52646.90it/s] 38%|███▊      | 168248/446685 [00:04<00:05, 51179.99it/s] 39%|███▉      | 173436/446685 [00:04<00:05, 51206.07it/s] 40%|████      | 178674/446685 [00:04<00:05, 51430.35it/s] 41%|████▏     | 185076/446685 [00:04<00:04, 54767.96it/s] 43%|████▎     | 190567/446685 [00:04<00:04, 53017.56it/s] 44%|████▍     | 196134/446685 [00:04<00:04, 51832.34it/s] 45%|████▌     | 201372/446685 [00:04<00:04, 51873.86it/s] 46%|████▋     | 206633/446685 [00:04<00:04, 52084.16it/s] 48%|████▊     | 213208/446685 [00:04<00:04, 56064.00it/s] 49%|████▉     | 218833/446685 [00:04<00:04, 52004.57it/s] 51%|█████     | 226398/446685 [00:05<00:03, 57078.06it/s] 52%|█████▏    | 232154/446685 [00:05<00:03, 54518.60it/s] 53%|█████▎    | 237652/446685 [00:05<00:03, 54170.89it/s] 55%|█████▍    | 244440/446685 [00:05<00:03, 55825.18it/s] 56%|█████▌    | 250260/446685 [00:05<00:03, 55663.96it/s] 57%|█████▋    | 255838/446685 [00:05<00:03, 53481.09it/s] 59%|█████▉    | 263064/446685 [00:05<00:03, 58055.33it/s] 60%|██████    | 268901/446685 [00:05<00:03, 56406.65it/s] 61%|██████▏   | 274566/446685 [00:05<00:03, 56153.65it/s] 63%|██████▎   | 280197/446685 [00:06<00:02, 56101.49it/s] 64%|██████▍   | 285818/446685 [00:06<00:02, 53918.49it/s] 65%|██████▌   | 291230/446685 [00:06<00:02, 53390.31it/s] 67%|██████▋   | 297402/446685 [00:06<00:02, 55391.72it/s] 68%|██████▊   | 302956/446685 [00:06<00:02, 52845.19it/s] 69%|██████▉   | 309042/446685 [00:06<00:02, 54972.46it/s] 71%|███████   | 315444/446685 [00:06<00:02, 57193.24it/s] 72%|███████▏  | 321846/446685 [00:06<00:02, 57369.52it/s] 74%|███████▎  | 328444/446685 [00:06<00:01, 59832.31it/s] 75%|███████▍  | 334453/446685 [00:07<00:01, 56862.53it/s] 76%|███████▌  | 340181/446685 [00:07<00:01, 55334.13it/s] 78%|███████▊  | 346290/446685 [00:07<00:01, 55315.72it/s] 79%|███████▉  | 351844/446685 [00:07<00:01, 53845.01it/s] 80%|███████▉  | 357244/446685 [00:07<00:01, 50967.35it/s] 81%|████████▏ | 363750/446685 [00:07<00:01, 53578.88it/s] 83%|████████▎ | 369136/446685 [00:07<00:01, 47904.61it/s] 84%|████████▍ | 374226/446685 [00:07<00:01, 48422.01it/s] 85%|████████▍ | 379464/446685 [00:07<00:01, 48977.39it/s] 86%|████████▋ | 385284/446685 [00:08<00:01, 49663.79it/s] 88%|████████▊ | 393432/446685 [00:08<00:00, 57401.06it/s] 90%|████████▉ | 399834/446685 [00:08<00:00, 59097.97it/s] 91%|█████████ | 405797/446685 [00:08<00:00, 56904.82it/s] 92%|█████████▏| 411534/446685 [00:08<00:00, 55842.92it/s] 93%|█████████▎| 417294/446685 [00:08<00:00, 55781.72it/s] 95%|█████████▍| 423696/446685 [00:08<00:00, 57352.21it/s] 96%|█████████▌| 429516/446685 [00:08<00:00, 57529.08it/s] 98%|█████████▊| 437082/446685 [00:08<00:00, 60842.50it/s] 99%|█████████▉| 443163/446685 [00:09<00:00, 59055.48it/s]100%|██████████| 446685/446685 [00:09<00:00, 49232.29it/s]
The spherical harmonics array is 393.62 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 84.41193842887878 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 0.8311450666394999
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.0002, 'pow_max': 0.00025, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 12.26it/s] 21%|██        | 4/19 [00:00<00:01, 13.13it/s] 32%|███▏      | 6/19 [00:00<00:00, 14.01it/s] 42%|████▏     | 8/19 [00:00<00:00, 14.75it/s] 53%|█████▎    | 10/19 [00:00<00:00, 15.81it/s] 63%|██████▎   | 12/19 [00:00<00:00, 16.89it/s] 74%|███████▎  | 14/19 [00:00<00:00, 17.77it/s] 89%|████████▉ | 17/19 [00:01<00:00, 19.26it/s]100%|██████████| 19/19 [00:01<00:00, 17.17it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6356712 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 0.7749757766723633 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07026981873647886
Ratio of unique |k|: 0.0017317128729443774
Time to get unique k and theta: 1.5446627140045166 seconds

Getting transfer functions
  0%|          | 0/11008 [00:00<?, ?it/s]  1%|▏         | 165/11008 [00:00<00:06, 1561.50it/s]  4%|▍         | 420/11008 [00:00<00:05, 2105.78it/s]  6%|▌         | 660/11008 [00:00<00:04, 2214.37it/s]  8%|▊         | 930/11008 [00:00<00:04, 2351.31it/s] 11%|█         | 1200/11008 [00:00<00:03, 2456.27it/s] 13%|█▎        | 1455/11008 [00:00<00:03, 2454.76it/s] 16%|█▌        | 1755/11008 [00:00<00:03, 2593.85it/s] 18%|█▊        | 2025/11008 [00:00<00:03, 2602.69it/s] 21%|██        | 2286/11008 [00:00<00:03, 2571.32it/s] 23%|██▎       | 2544/11008 [00:01<00:03, 2458.85it/s] 25%|██▌       | 2791/11008 [00:01<00:03, 2378.48it/s] 28%|██▊       | 3120/11008 [00:01<00:02, 2637.78it/s] 31%|███       | 3436/11008 [00:01<00:02, 2789.27it/s] 34%|███▍      | 3735/11008 [00:01<00:02, 2834.54it/s] 37%|███▋      | 4080/11008 [00:01<00:02, 2980.65it/s] 40%|████      | 4425/11008 [00:01<00:02, 3082.48it/s] 43%|████▎     | 4755/11008 [00:01<00:01, 3128.83it/s] 47%|████▋     | 5130/11008 [00:01<00:01, 3284.62it/s] 50%|████▉     | 5459/11008 [00:01<00:01, 3206.10it/s] 53%|█████▎    | 5805/11008 [00:02<00:01, 3264.59it/s] 56%|█████▌    | 6180/11008 [00:02<00:01, 3400.49it/s] 59%|█████▉    | 6521/11008 [00:02<00:01, 3379.65it/s] 62%|██████▏   | 6860/11008 [00:02<00:01, 3273.88it/s] 65%|██████▌   | 7189/11008 [00:02<00:01, 3250.29it/s] 69%|██████▊   | 7560/11008 [00:02<00:01, 3353.94it/s] 72%|███████▏  | 7905/11008 [00:02<00:00, 3374.84it/s] 75%|███████▍  | 8243/11008 [00:02<00:00, 3299.93it/s] 78%|███████▊  | 8610/11008 [00:02<00:00, 3365.62it/s] 81%|████████▏ | 8970/11008 [00:03<00:00, 3416.67it/s] 85%|████████▍ | 9345/11008 [00:03<00:00, 3486.34it/s] 88%|████████▊ | 9694/11008 [00:03<00:00, 3413.03it/s] 91%|█████████▏| 10050/11008 [00:03<00:00, 3452.22it/s] 95%|█████████▍| 10410/11008 [00:03<00:00, 3488.35it/s] 98%|█████████▊| 10760/11008 [00:03<00:00, 3386.37it/s]100%|██████████| 11008/11008 [00:03<00:00, 3047.57it/s]
Size of transfer function: 1.76 MB. 

Size of integrand: 37.04 MB. Time to calculate integrand: 0.022577762603759766 s

Getting spherical harmonics
  0%|          | 0/446685 [00:00<?, ?it/s]  1%|          | 4656/446685 [00:00<00:10, 42258.25it/s]  2%|▏         | 9894/446685 [00:00<00:09, 43863.13it/s]  3%|▎         | 14550/446685 [00:00<00:10, 42354.90it/s]  4%|▍         | 18785/446685 [00:00<00:10, 40689.29it/s]  5%|▌         | 23280/446685 [00:00<00:10, 40584.33it/s]  6%|▋         | 28518/446685 [00:00<00:09, 43159.42it/s]  8%|▊         | 33756/446685 [00:00<00:09, 43665.25it/s]  9%|▊         | 38412/446685 [00:00<00:09, 43616.24it/s] 10%|▉         | 43068/446685 [00:01<00:09, 43379.04it/s] 11%|█         | 47724/446685 [00:01<00:09, 42398.41it/s] 12%|█▏        | 51967/446685 [00:01<00:09, 40836.40it/s] 13%|█▎        | 56055/446685 [00:01<00:09, 39797.39it/s] 14%|█▎        | 60528/446685 [00:01<00:09, 40410.19it/s] 14%|█▍        | 64602/446685 [00:01<00:09, 39326.74it/s] 15%|█▌        | 68537/446685 [00:01<00:13, 28499.36it/s] 17%|█▋        | 74496/446685 [00:01<00:10, 34721.42it/s] 18%|█▊        | 78570/446685 [00:02<00:10, 35669.15it/s] 19%|█▉        | 84390/446685 [00:02<00:08, 40769.45it/s] 20%|██        | 90792/446685 [00:02<00:07, 45360.02it/s] 21%|██▏       | 96030/446685 [00:02<00:07, 46970.74it/s] 23%|██▎       | 100907/446685 [00:02<00:07, 45835.40it/s] 24%|██▎       | 105616/446685 [00:02<00:07, 44952.72it/s] 25%|██▍       | 111162/446685 [00:02<00:07, 46805.27it/s] 26%|██▋       | 118146/446685 [00:02<00:06, 51119.97it/s] 28%|██▊       | 124548/446685 [00:02<00:06, 53314.27it/s] 29%|██▉       | 131532/446685 [00:02<00:05, 57124.18it/s] 31%|███       | 137352/446685 [00:03<00:05, 57176.53it/s] 32%|███▏      | 143172/446685 [00:03<00:05, 57242.04it/s] 33%|███▎      | 148915/446685 [00:03<00:05, 55831.99it/s] 35%|███▍      | 154812/446685 [00:03<00:05, 56376.79it/s] 36%|███▌      | 161214/446685 [00:03<00:04, 58518.70it/s] 37%|███▋      | 167083/446685 [00:03<00:04, 58265.89it/s] 39%|███▊      | 172921/446685 [00:03<00:04, 58275.67it/s] 40%|████      | 178757/446685 [00:03<00:04, 53980.19it/s] 41%|████      | 184220/446685 [00:03<00:05, 50663.29it/s] 43%|████▎     | 190314/446685 [00:04<00:04, 51712.70it/s] 44%|████▍     | 195538/446685 [00:04<00:05, 50105.97it/s] 45%|████▍     | 200790/446685 [00:04<00:04, 50455.31it/s] 46%|████▌     | 205864/446685 [00:04<00:04, 49975.53it/s] 47%|████▋     | 210879/446685 [00:04<00:04, 49935.24it/s] 49%|████▊     | 217086/446685 [00:04<00:04, 52329.44it/s] 50%|█████     | 224070/446685 [00:04<00:03, 56160.80it/s] 52%|█████▏    | 230472/446685 [00:04<00:03, 57864.16it/s] 53%|█████▎    | 236292/446685 [00:04<00:03, 57264.80it/s] 54%|█████▍    | 242112/446685 [00:05<00:03, 57200.42it/s] 55%|█████▌    | 247834/446685 [00:05<00:03, 54423.59it/s] 57%|█████▋    | 253300/446685 [00:05<00:03, 50990.02it/s] 58%|█████▊    | 258447/446685 [00:05<00:03, 50343.04it/s] 59%|█████▉    | 264228/446685 [00:05<00:03, 52346.22it/s] 60%|██████    | 269498/446685 [00:05<00:03, 49338.18it/s] 61%|██████▏   | 274482/446685 [00:05<00:03, 49231.14it/s] 63%|██████▎   | 279942/446685 [00:05<00:03, 49610.74it/s] 64%|██████▍   | 286344/446685 [00:05<00:03, 53438.27it/s] 66%|██████▌   | 292746/446685 [00:06<00:02, 56278.86it/s] 67%|██████▋   | 299730/446685 [00:06<00:02, 59936.41it/s] 68%|██████▊   | 305757/446685 [00:06<00:02, 58940.94it/s] 70%|██████▉   | 312534/446685 [00:06<00:02, 61361.85it/s] 71%|███████▏  | 318695/446685 [00:06<00:02, 59130.79it/s] 73%|███████▎  | 324639/446685 [00:06<00:02, 56294.62it/s] 74%|███████▍  | 330310/446685 [00:06<00:02, 55238.11it/s] 75%|███████▌  | 335861/446685 [00:06<00:02, 54039.76it/s] 77%|███████▋  | 342216/446685 [00:06<00:01, 56708.77it/s] 78%|███████▊  | 347917/446685 [00:06<00:01, 56659.45it/s] 79%|███████▉  | 354438/446685 [00:07<00:01, 58984.04it/s] 81%|████████  | 360357/446685 [00:07<00:01, 58955.23it/s] 82%|████████▏ | 366267/446685 [00:07<00:01, 57601.89it/s] 83%|████████▎ | 372042/446685 [00:07<00:01, 54516.07it/s] 85%|████████▍ | 378300/446685 [00:07<00:01, 56337.05it/s] 86%|████████▌ | 383968/446685 [00:07<00:01, 54003.90it/s] 87%|████████▋ | 390522/446685 [00:07<00:01, 56072.95it/s] 89%|████████▊ | 396342/446685 [00:07<00:00, 56312.91it/s] 90%|████████▉ | 401995/446685 [00:07<00:00, 53219.03it/s] 91%|█████████ | 407357/446685 [00:08<00:00, 51988.23it/s] 93%|█████████▎| 413220/446685 [00:08<00:00, 52610.93it/s] 94%|█████████▎| 418501/446685 [00:08<00:00, 51099.90it/s] 95%|█████████▍| 424278/446685 [00:08<00:00, 52647.22it/s] 96%|█████████▋| 430098/446685 [00:08<00:00, 53220.82it/s] 97%|█████████▋| 435434/446685 [00:08<00:00, 50778.27it/s] 99%|█████████▊| 440574/446685 [00:08<00:00, 50310.43it/s]100%|██████████| 446685/446685 [00:08<00:00, 50796.71it/s]
The spherical harmonics array is 393.62 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 92.5146894454956 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 1.1529079821792552
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.0003, 'pow_max': 0.00035, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 17.61it/s] 26%|██▋       | 5/19 [00:00<00:00, 19.08it/s] 42%|████▏     | 8/19 [00:00<00:00, 20.54it/s] 58%|█████▊    | 11/19 [00:00<00:00, 21.27it/s] 74%|███████▎  | 14/19 [00:00<00:00, 21.48it/s] 89%|████████▉ | 17/19 [00:00<00:00, 21.80it/s]100%|██████████| 19/19 [00:00<00:00, 21.26it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6356712 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 0.7513072490692139 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07026981873647886
Ratio of unique |k|: 0.0017317128729443774
Time to get unique k and theta: 1.544363260269165 seconds

Getting transfer functions
  0%|          | 0/11008 [00:00<?, ?it/s]  2%|▏         | 210/11008 [00:00<00:05, 1998.57it/s]  4%|▍         | 450/11008 [00:00<00:04, 2181.32it/s]  6%|▋         | 690/11008 [00:00<00:04, 2253.29it/s]  8%|▊         | 916/11008 [00:00<00:04, 2233.77it/s] 10%|█         | 1155/11008 [00:00<00:04, 2275.22it/s] 13%|█▎        | 1395/11008 [00:00<00:04, 2315.78it/s] 15%|█▍        | 1650/11008 [00:00<00:03, 2370.49it/s] 17%|█▋        | 1890/11008 [00:00<00:03, 2368.12it/s] 19%|█▉        | 2130/11008 [00:00<00:03, 2349.54it/s] 22%|██▏       | 2385/11008 [00:01<00:03, 2393.59it/s] 24%|██▍       | 2625/11008 [00:01<00:03, 2380.95it/s] 26%|██▌       | 2880/11008 [00:01<00:03, 2389.93it/s] 30%|██▉       | 3255/11008 [00:01<00:02, 2774.77it/s] 33%|███▎      | 3600/11008 [00:01<00:02, 2944.25it/s] 36%|███▌      | 3930/11008 [00:01<00:02, 3033.77it/s] 39%|███▉      | 4290/11008 [00:01<00:02, 3162.23it/s] 42%|████▏     | 4650/11008 [00:01<00:01, 3260.60it/s] 45%|████▌     | 4977/11008 [00:01<00:01, 3259.46it/s] 48%|████▊     | 5310/11008 [00:01<00:01, 3267.03it/s] 51%|█████     | 5640/11008 [00:02<00:01, 3241.68it/s] 54%|█████▍    | 5985/11008 [00:02<00:01, 3271.45it/s] 58%|█████▊    | 6345/11008 [00:02<00:01, 3337.27it/s] 61%|██████    | 6679/11008 [00:02<00:01, 3319.33it/s] 64%|██████▎   | 7011/11008 [00:02<00:01, 3291.53it/s] 67%|██████▋   | 7341/11008 [00:02<00:01, 3286.62it/s] 70%|██████▉   | 7680/11008 [00:02<00:01, 3285.46it/s] 73%|███████▎  | 8010/11008 [00:02<00:00, 3280.17it/s] 76%|███████▌  | 8355/11008 [00:02<00:00, 3322.44it/s] 79%|███████▉  | 8715/11008 [00:02<00:00, 3399.57it/s] 82%|████████▏ | 9075/11008 [00:03<00:00, 3442.30it/s] 86%|████████▌ | 9420/11008 [00:03<00:00, 3298.99it/s] 89%|████████▊ | 9752/11008 [00:03<00:00, 3228.24it/s] 92%|█████████▏| 10140/11008 [00:03<00:00, 3385.39it/s] 95%|█████████▌| 10500/11008 [00:03<00:00, 3418.30it/s] 99%|█████████▊| 10845/11008 [00:03<00:00, 3376.68it/s]100%|██████████| 11008/11008 [00:03<00:00, 3010.61it/s]
Size of transfer function: 1.76 MB. 

Size of integrand: 37.04 MB. Time to calculate integrand: 0.02974104881286621 s

Getting spherical harmonics
  0%|          | 0/446685 [00:00<?, ?it/s]  1%|          | 5238/446685 [00:00<00:08, 51394.27it/s]  2%|▏         | 10476/446685 [00:00<00:08, 51077.14it/s]  3%|▎         | 15584/446685 [00:00<00:09, 44588.01it/s]  5%|▍         | 20370/446685 [00:00<00:09, 45191.37it/s]  6%|▌         | 25608/446685 [00:00<00:08, 47513.08it/s]  7%|▋         | 30409/446685 [00:00<00:08, 46314.04it/s]  8%|▊         | 35075/446685 [00:00<00:08, 46033.13it/s]  9%|▉         | 39701/446685 [00:00<00:11, 36269.99it/s] 10%|█         | 45396/446685 [00:01<00:09, 40728.43it/s] 11%|█▏        | 50634/446685 [00:01<00:09, 42353.15it/s] 13%|█▎        | 56454/446685 [00:01<00:08, 45898.72it/s] 14%|█▍        | 61692/446685 [00:01<00:08, 46659.54it/s] 15%|█▌        | 67512/446685 [00:01<00:07, 47920.50it/s] 16%|█▌        | 72394/446685 [00:01<00:08, 45014.65it/s] 17%|█▋        | 76977/446685 [00:01<00:08, 43745.90it/s] 18%|█▊        | 81405/446685 [00:01<00:08, 41543.04it/s] 19%|█▉        | 85603/446685 [00:01<00:08, 40188.44it/s] 20%|██        | 89649/446685 [00:02<00:09, 38200.85it/s] 21%|██        | 93702/446685 [00:02<00:09, 37841.13it/s] 22%|██▏       | 98358/446685 [00:02<00:08, 39617.62it/s] 23%|██▎       | 104178/446685 [00:02<00:07, 44346.45it/s] 24%|██▍       | 108834/446685 [00:02<00:07, 44107.97it/s] 26%|██▌       | 114654/446685 [00:02<00:07, 47422.13it/s] 27%|██▋       | 120474/446685 [00:02<00:06, 48183.57it/s] 28%|██▊       | 125309/446685 [00:02<00:06, 47969.68it/s] 29%|██▉       | 131532/446685 [00:02<00:06, 50035.30it/s] 31%|███       | 137352/446685 [00:03<00:05, 52210.32it/s] 32%|███▏      | 143172/446685 [00:03<00:05, 53368.56it/s] 33%|███▎      | 149574/446685 [00:03<00:05, 54388.53it/s] 35%|███▍      | 155394/446685 [00:03<00:05, 55451.23it/s] 36%|███▌      | 161214/446685 [00:03<00:05, 55507.19it/s] 38%|███▊      | 167616/446685 [00:03<00:04, 57299.17it/s] 39%|███▉      | 174018/446685 [00:03<00:04, 57698.10it/s] 40%|████      | 179838/446685 [00:03<00:04, 57745.69it/s] 42%|████▏     | 186240/446685 [00:03<00:04, 57178.46it/s] 43%|████▎     | 191963/446685 [00:04<00:04, 54781.69it/s] 44%|████▍     | 197457/446685 [00:04<00:04, 50803.13it/s] 45%|████▌     | 203118/446685 [00:04<00:04, 51852.74it/s] 47%|████▋     | 208347/446685 [00:04<00:04, 51858.22it/s] 48%|████▊     | 214758/446685 [00:04<00:04, 54501.40it/s] 50%|████▉     | 221742/446685 [00:04<00:03, 58288.33it/s] 51%|█████     | 227601/446685 [00:04<00:03, 56150.54it/s] 52%|█████▏    | 233247/446685 [00:04<00:03, 55367.37it/s] 53%|█████▎    | 238804/446685 [00:04<00:03, 54681.77it/s] 55%|█████▍    | 244440/446685 [00:04<00:03, 53737.44it/s] 56%|█████▌    | 249824/446685 [00:05<00:03, 52522.97it/s] 57%|█████▋    | 256662/446685 [00:05<00:03, 56667.81it/s] 59%|█████▉    | 264228/446685 [00:05<00:02, 61185.94it/s] 61%|██████    | 270630/446685 [00:05<00:02, 61559.11it/s] 62%|██████▏   | 277032/446685 [00:05<00:02, 61327.30it/s] 63%|██████▎   | 283174/446685 [00:05<00:02, 58212.38it/s] 65%|██████▍   | 289027/446685 [00:05<00:02, 55470.44it/s] 66%|██████▌   | 294611/446685 [00:05<00:02, 52710.25it/s] 67%|██████▋   | 299921/446685 [00:05<00:02, 50663.74it/s] 68%|██████▊   | 305016/446685 [00:06<00:02, 50225.56it/s] 70%|██████▉   | 311952/446685 [00:06<00:02, 54820.69it/s] 71%|███████▏  | 318354/446685 [00:06<00:02, 57270.62it/s] 73%|███████▎  | 324118/446685 [00:06<00:02, 56982.47it/s] 74%|███████▍  | 329842/446685 [00:06<00:02, 53898.94it/s] 75%|███████▌  | 335276/446685 [00:06<00:02, 53186.36it/s] 77%|███████▋  | 342216/446685 [00:06<00:01, 56983.83it/s] 78%|███████▊  | 349200/446685 [00:06<00:01, 59931.81it/s] 80%|███████▉  | 356184/446685 [00:06<00:01, 61879.54it/s] 81%|████████  | 362393/446685 [00:07<00:01, 57705.90it/s] 82%|████████▏ | 368406/446685 [00:07<00:01, 55372.79it/s] 84%|████████▍ | 375972/446685 [00:07<00:01, 60580.51it/s] 86%|████████▌ | 382956/446685 [00:07<00:01, 62882.70it/s] 87%|████████▋ | 389315/446685 [00:07<00:00, 57840.78it/s] 88%|████████▊ | 395213/446685 [00:07<00:00, 56312.80it/s] 90%|████████▉ | 400921/446685 [00:07<00:00, 56202.63it/s] 91%|█████████ | 406594/446685 [00:07<00:00, 55206.36it/s] 92%|█████████▏| 412150/446685 [00:07<00:00, 52143.09it/s] 94%|█████████▎| 418458/446685 [00:08<00:00, 54151.27it/s] 95%|█████████▌| 425442/446685 [00:08<00:00, 57272.05it/s] 97%|█████████▋| 432426/446685 [00:08<00:00, 60566.49it/s] 98%|█████████▊| 438528/446685 [00:08<00:00, 55786.86it/s] 99%|█████████▉| 444198/446685 [00:08<00:00, 54941.42it/s]100%|██████████| 446685/446685 [00:08<00:00, 52189.04it/s]
The spherical harmonics array is 393.62 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 100.22076559066772 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 1.1177340929547221
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.0004, 'pow_max': 0.00045000000000000004, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 19.77it/s] 26%|██▋       | 5/19 [00:00<00:00, 21.31it/s] 42%|████▏     | 8/19 [00:00<00:00, 21.78it/s] 58%|█████▊    | 11/19 [00:00<00:00, 22.00it/s] 74%|███████▎  | 14/19 [00:00<00:00, 21.74it/s] 89%|████████▉ | 17/19 [00:00<00:00, 21.91it/s]100%|██████████| 19/19 [00:00<00:00, 21.81it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6356712 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 0.7611358165740967 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07026981873647886
Ratio of unique |k|: 0.0017317128729443774
Time to get unique k and theta: 1.5393989086151123 seconds

Getting transfer functions
  0%|          | 0/11008 [00:00<?, ?it/s]  2%|▏         | 225/11008 [00:00<00:04, 2200.89it/s]  4%|▍         | 480/11008 [00:00<00:04, 2399.25it/s]  7%|▋         | 735/11008 [00:00<00:04, 2442.77it/s]  9%|▉         | 990/11008 [00:00<00:04, 2441.57it/s] 11%|█▏        | 1260/11008 [00:00<00:03, 2504.92it/s] 14%|█▍        | 1530/11008 [00:00<00:03, 2525.72it/s] 16%|█▌        | 1785/11008 [00:00<00:03, 2532.83it/s] 19%|█▊        | 2055/11008 [00:00<00:03, 2559.57it/s] 21%|██        | 2325/11008 [00:00<00:03, 2590.02it/s] 24%|██▎       | 2595/11008 [00:01<00:03, 2602.70it/s] 26%|██▌       | 2856/11008 [00:01<00:03, 2598.52it/s] 29%|██▉       | 3180/11008 [00:01<00:02, 2768.29it/s] 32%|███▏      | 3510/11008 [00:01<00:02, 2882.19it/s] 35%|███▍      | 3825/11008 [00:01<00:02, 2944.17it/s] 38%|███▊      | 4170/11008 [00:01<00:02, 3089.38it/s] 41%|████      | 4515/11008 [00:01<00:02, 3050.95it/s] 44%|████▍     | 4860/11008 [00:01<00:01, 3130.81it/s] 47%|████▋     | 5205/11008 [00:01<00:01, 3204.05it/s] 50%|█████     | 5550/11008 [00:01<00:01, 3263.12it/s] 54%|█████▎    | 5895/11008 [00:02<00:01, 3283.13it/s] 57%|█████▋    | 6224/11008 [00:02<00:01, 3268.72it/s] 60%|█████▉    | 6552/11008 [00:02<00:01, 3215.83it/s] 62%|██████▏   | 6874/11008 [00:02<00:01, 3199.26it/s] 66%|██████▌   | 7230/11008 [00:02<00:01, 3304.90it/s] 69%|██████▊   | 7561/11008 [00:02<00:01, 3292.31it/s] 72%|███████▏  | 7891/11008 [00:02<00:00, 3280.93it/s] 75%|███████▍  | 8235/11008 [00:02<00:00, 3326.01it/s] 78%|███████▊  | 8568/11008 [00:02<00:00, 3311.11it/s] 81%|████████  | 8900/11008 [00:03<00:00, 3107.98it/s] 84%|████████▎ | 9214/11008 [00:03<00:00, 3086.08it/s] 87%|████████▋ | 9540/11008 [00:03<00:00, 3105.86it/s] 90%|█████████ | 9915/11008 [00:03<00:00, 3272.64it/s] 93%|█████████▎| 10290/11008 [00:03<00:00, 3388.99it/s] 97%|█████████▋| 10635/11008 [00:03<00:00, 3368.74it/s]100%|█████████▉| 10980/11008 [00:03<00:00, 3357.97it/s]100%|██████████| 11008/11008 [00:03<00:00, 3037.95it/s]
Size of transfer function: 1.76 MB. 

Size of integrand: 37.04 MB. Time to calculate integrand: 0.027818679809570312 s

Getting spherical harmonics
  0%|          | 0/446685 [00:00<?, ?it/s]  1%|          | 5238/446685 [00:00<00:09, 45788.28it/s]  2%|▏         | 10476/446685 [00:00<00:09, 47669.38it/s]  4%|▎         | 15714/446685 [00:00<00:08, 47971.71it/s]  5%|▍         | 20515/446685 [00:00<00:09, 44979.58it/s]  6%|▌         | 25608/446685 [00:00<00:09, 44693.34it/s]  7%|▋         | 30846/446685 [00:00<00:08, 46312.49it/s]  8%|▊         | 36084/446685 [00:00<00:09, 44500.57it/s]  9%|▉         | 40740/446685 [00:00<00:09, 43196.96it/s] 10%|█         | 45396/446685 [00:01<00:09, 42874.89it/s] 11%|█▏        | 50634/446685 [00:01<00:09, 43766.85it/s] 12%|█▏        | 55290/446685 [00:01<00:08, 44183.95it/s] 13%|█▎        | 59946/446685 [00:01<00:08, 43660.23it/s] 14%|█▍        | 64318/446685 [00:01<00:08, 42795.43it/s] 16%|█▌        | 69258/446685 [00:01<00:08, 44032.65it/s] 16%|█▋        | 73667/446685 [00:01<00:08, 42605.44it/s] 18%|█▊        | 78570/446685 [00:01<00:08, 43210.82it/s] 19%|█▊        | 82896/446685 [00:01<00:08, 42641.10it/s] 20%|█▉        | 87162/446685 [00:02<00:08, 41025.45it/s] 20%|██        | 91272/446685 [00:02<00:08, 40583.41it/s] 21%|██▏       | 95448/446685 [00:02<00:08, 39484.18it/s] 22%|██▏       | 100030/446685 [00:02<00:08, 41266.26it/s] 23%|██▎       | 104173/446685 [00:02<00:08, 40400.22it/s] 24%|██▍       | 108252/446685 [00:02<00:08, 40241.96it/s] 26%|██▌       | 114654/446685 [00:02<00:07, 46734.70it/s] 27%|██▋       | 121056/446685 [00:02<00:06, 51147.48it/s] 28%|██▊       | 126876/446685 [00:02<00:06, 52896.38it/s] 30%|██▉       | 132696/446685 [00:02<00:05, 53294.52it/s] 31%|███▏      | 139680/446685 [00:03<00:05, 57612.57it/s] 33%|███▎      | 145453/446685 [00:03<00:05, 57331.24it/s] 34%|███▍      | 151194/446685 [00:03<00:05, 52985.30it/s] 35%|███▌      | 156557/446685 [00:03<00:05, 52590.31it/s] 36%|███▌      | 161859/446685 [00:03<00:05, 51428.02it/s] 37%|███▋      | 167034/446685 [00:03<00:05, 51202.86it/s] 39%|███▊      | 172175/446685 [00:03<00:05, 49418.35it/s] 40%|███▉      | 177138/446685 [00:03<00:05, 46734.75it/s] 41%|████      | 183912/446685 [00:03<00:05, 51548.27it/s] 42%|████▏     | 189732/446685 [00:04<00:04, 52591.24it/s] 44%|████▎     | 195023/446685 [00:04<00:04, 52592.29it/s] 45%|████▍     | 200305/446685 [00:04<00:04, 50315.41it/s] 46%|████▌     | 205366/446685 [00:04<00:04, 49081.21it/s] 47%|████▋     | 210295/446685 [00:04<00:05, 47120.94it/s] 48%|████▊     | 216504/446685 [00:04<00:04, 50733.96it/s] 50%|████▉     | 222324/446685 [00:04<00:04, 52355.97it/s] 51%|█████     | 228144/446685 [00:04<00:04, 52575.05it/s] 52%|█████▏    | 233422/446685 [00:04<00:04, 52529.89it/s] 54%|█████▎    | 239784/446685 [00:05<00:03, 55276.10it/s] 55%|█████▍    | 245604/446685 [00:05<00:03, 55093.07it/s] 56%|█████▌    | 251125/446685 [00:05<00:03, 51472.03it/s] 57%|█████▋    | 256319/446685 [00:05<00:03, 50042.75it/s] 59%|█████▊    | 261465/446685 [00:05<00:03, 50431.86it/s] 60%|█████▉    | 267720/446685 [00:05<00:03, 53147.52it/s] 61%|██████    | 273059/446685 [00:05<00:03, 49936.81it/s] 62%|██████▏   | 278099/446685 [00:05<00:03, 49265.71it/s] 64%|██████▎   | 284016/446685 [00:05<00:03, 51675.02it/s] 65%|██████▌   | 290418/446685 [00:05<00:02, 53656.24it/s] 66%|██████▌   | 295804/446685 [00:06<00:02, 53661.46it/s] 67%|██████▋   | 301185/446685 [00:06<00:02, 52571.47it/s] 69%|██████▉   | 307296/446685 [00:06<00:02, 54023.27it/s] 70%|███████   | 312706/446685 [00:06<00:02, 53573.04it/s] 71%|███████   | 318068/446685 [00:06<00:02, 52136.43it/s] 73%|███████▎  | 324174/446685 [00:06<00:02, 54483.52it/s] 74%|███████▍  | 329994/446685 [00:06<00:02, 55003.08it/s] 75%|███████▌  | 336396/446685 [00:06<00:01, 56893.37it/s] 77%|███████▋  | 342798/446685 [00:06<00:01, 58835.83it/s] 78%|███████▊  | 348692/446685 [00:07<00:01, 56147.08it/s] 79%|███████▉  | 354336/446685 [00:07<00:01, 52389.83it/s] 81%|████████  | 359676/446685 [00:07<00:01, 50566.96it/s] 82%|████████▏ | 366078/446685 [00:07<00:01, 53479.60it/s] 84%|████████▎ | 373062/446685 [00:07<00:01, 57790.23it/s] 85%|████████▌ | 380046/446685 [00:07<00:01, 61093.22it/s] 87%|████████▋ | 387030/446685 [00:07<00:00, 63486.41it/s] 88%|████████▊ | 393430/446685 [00:07<00:00, 62578.13it/s] 89%|████████▉ | 399725/446685 [00:07<00:00, 57344.95it/s] 91%|█████████ | 406236/446685 [00:08<00:00, 59339.17it/s] 92%|█████████▏| 412258/446685 [00:08<00:00, 59117.11it/s] 94%|█████████▎| 418230/446685 [00:08<00:00, 54521.33it/s] 95%|█████████▍| 423782/446685 [00:08<00:00, 53297.72it/s] 97%|█████████▋| 431844/446685 [00:08<00:00, 59781.37it/s] 98%|█████████▊| 437899/446685 [00:08<00:00, 56456.06it/s] 99%|█████████▉| 443620/446685 [00:08<00:00, 51940.86it/s]100%|██████████| 446685/446685 [00:08<00:00, 50850.01it/s]
The spherical harmonics array is 393.62 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 99.18652439117432 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 1.3322533534454926
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.0005, 'pow_max': 0.00055, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 16%|█▌        | 3/19 [00:00<00:00, 22.19it/s] 32%|███▏      | 6/19 [00:00<00:00, 22.28it/s] 47%|████▋     | 9/19 [00:00<00:00, 21.86it/s] 63%|██████▎   | 12/19 [00:00<00:00, 22.03it/s] 79%|███████▉  | 15/19 [00:00<00:00, 22.18it/s] 95%|█████████▍| 18/19 [00:00<00:00, 22.22it/s]100%|██████████| 19/19 [00:00<00:00, 22.16it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6356712 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 0.7478001117706299 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07026981873647886
Ratio of unique |k|: 0.0017317128729443774
Time to get unique k and theta: 1.5258457660675049 seconds

Getting transfer functions
  0%|          | 0/11008 [00:00<?, ?it/s]  2%|▏         | 210/11008 [00:00<00:05, 2036.39it/s]  4%|▍         | 465/11008 [00:00<00:04, 2325.85it/s]  6%|▋         | 705/11008 [00:00<00:04, 2326.56it/s]  9%|▊         | 960/11008 [00:00<00:04, 2395.69it/s] 11%|█         | 1200/11008 [00:00<00:04, 2385.52it/s] 13%|█▎        | 1470/11008 [00:00<00:03, 2463.35it/s] 16%|█▌        | 1717/11008 [00:00<00:03, 2410.75it/s] 18%|█▊        | 1959/11008 [00:00<00:03, 2305.26it/s] 20%|██        | 2205/11008 [00:00<00:03, 2316.77it/s] 22%|██▏       | 2475/11008 [00:01<00:03, 2418.23it/s] 25%|██▍       | 2745/11008 [00:01<00:03, 2476.63it/s] 28%|██▊       | 3030/11008 [00:01<00:03, 2570.35it/s] 31%|███       | 3360/11008 [00:01<00:02, 2757.22it/s] 34%|███▎      | 3690/11008 [00:01<00:02, 2891.37it/s] 37%|███▋      | 4020/11008 [00:01<00:02, 2987.75it/s] 40%|███▉      | 4365/11008 [00:01<00:02, 3110.78it/s] 43%|████▎     | 4695/11008 [00:01<00:02, 3143.25it/s] 46%|████▌     | 5040/11008 [00:01<00:01, 3183.07it/s] 49%|████▊     | 5359/11008 [00:01<00:01, 3176.46it/s] 52%|█████▏    | 5685/11008 [00:02<00:01, 3158.83it/s] 55%|█████▍    | 6015/11008 [00:02<00:01, 3171.05it/s] 58%|█████▊    | 6333/11008 [00:02<00:01, 3112.97it/s] 61%|██████    | 6660/11008 [00:02<00:01, 3142.99it/s] 64%|██████▎   | 7005/11008 [00:02<00:01, 3207.99it/s] 67%|██████▋   | 7365/11008 [00:02<00:01, 3321.97it/s] 70%|██████▉   | 7698/11008 [00:02<00:01, 3215.54it/s] 73%|███████▎  | 8025/11008 [00:02<00:00, 3210.14it/s] 76%|███████▋  | 8415/11008 [00:02<00:00, 3379.44it/s] 80%|███████▉  | 8754/11008 [00:03<00:00, 3373.73it/s] 83%|████████▎ | 9092/11008 [00:03<00:00, 3255.29it/s] 86%|████████▌ | 9450/11008 [00:03<00:00, 3335.13it/s] 89%|████████▉ | 9785/11008 [00:03<00:00, 3226.16it/s] 92%|█████████▏| 10125/11008 [00:03<00:00, 3265.15it/s] 95%|█████████▍| 10455/11008 [00:03<00:00, 3273.80it/s] 98%|█████████▊| 10784/11008 [00:03<00:00, 3245.06it/s]100%|██████████| 11008/11008 [00:03<00:00, 2972.92it/s]
Size of transfer function: 1.76 MB. 

Size of integrand: 37.04 MB. Time to calculate integrand: 0.03340864181518555 s

Getting spherical harmonics
  0%|          | 0/446685 [00:00<?, ?it/s]  1%|          | 4656/446685 [00:00<00:10, 42760.50it/s]  2%|▏         | 9312/446685 [00:00<00:10, 43041.19it/s]  3%|▎         | 13968/446685 [00:00<00:10, 42956.44it/s]  4%|▍         | 18624/446685 [00:00<00:10, 40906.97it/s]  5%|▌         | 23862/446685 [00:00<00:09, 44223.78it/s]  6%|▋         | 28518/446685 [00:00<00:09, 43478.15it/s]  7%|▋         | 33174/446685 [00:00<00:09, 44241.74it/s]  8%|▊         | 37617/446685 [00:00<00:09, 43408.47it/s]  9%|▉         | 41971/446685 [00:00<00:09, 42579.23it/s] 11%|█         | 47724/446685 [00:01<00:08, 45573.61it/s] 12%|█▏        | 52380/446685 [00:01<00:08, 45841.01it/s] 13%|█▎        | 57618/446685 [00:01<00:08, 47053.11it/s] 14%|█▍        | 62325/446685 [00:01<00:10, 35919.60it/s] 15%|█▍        | 66297/446685 [00:01<00:14, 26181.44it/s] 16%|█▌        | 69516/446685 [00:02<00:18, 20871.11it/s] 16%|█▌        | 72141/446685 [00:02<00:19, 18868.82it/s] 17%|█▋        | 74395/446685 [00:02<00:19, 18919.53it/s] 17%|█▋        | 77988/446685 [00:02<00:16, 21975.27it/s] 18%|█▊        | 81480/446685 [00:02<00:14, 24462.02it/s] 19%|█▉        | 86136/446685 [00:02<00:12, 29532.54it/s] 20%|██        | 90792/446685 [00:02<00:10, 33406.86it/s] 21%|██▏       | 95448/446685 [00:02<00:09, 36447.85it/s] 23%|██▎       | 100686/446685 [00:02<00:08, 39883.60it/s] 24%|██▎       | 105342/446685 [00:03<00:08, 41247.99it/s] 25%|██▍       | 111162/446685 [00:03<00:07, 43645.21it/s] 26%|██▌       | 116982/446685 [00:03<00:07, 45968.91it/s] 27%|██▋       | 121640/446685 [00:03<00:07, 42861.01it/s] 28%|██▊       | 126876/446685 [00:03<00:07, 43258.93it/s] 30%|██▉       | 132661/446685 [00:03<00:06, 47147.96it/s] 31%|███       | 138516/446685 [00:03<00:06, 50164.08it/s] 32%|███▏      | 144721/446685 [00:03<00:05, 53515.95it/s] 34%|███▎      | 150151/446685 [00:03<00:05, 53582.58it/s] 35%|███▍      | 155565/446685 [00:04<00:05, 51271.40it/s] 36%|███▌      | 161214/446685 [00:04<00:05, 52232.03it/s] 37%|███▋      | 167034/446685 [00:04<00:05, 52846.54it/s] 39%|███▊      | 172348/446685 [00:04<00:05, 52158.77it/s] 40%|████      | 178674/446685 [00:04<00:04, 53993.59it/s] 41%|████▏     | 184494/446685 [00:04<00:04, 53825.90it/s] 43%|████▎     | 189885/446685 [00:04<00:04, 51866.44it/s] 44%|████▍     | 196134/446685 [00:04<00:04, 54025.25it/s] 45%|████▌     | 201954/446685 [00:04<00:04, 54962.76it/s] 46%|████▋     | 207465/446685 [00:05<00:04, 54714.99it/s] 48%|████▊     | 212946/446685 [00:05<00:04, 50377.43it/s] 49%|████▉     | 218250/446685 [00:05<00:04, 50534.23it/s] 50%|█████     | 224652/446685 [00:05<00:04, 53607.04it/s] 52%|█████▏    | 231054/446685 [00:05<00:03, 54878.97it/s] 53%|█████▎    | 238038/446685 [00:05<00:03, 58018.70it/s] 55%|█████▍    | 243865/446685 [00:05<00:03, 54988.24it/s] 56%|█████▌    | 249402/446685 [00:05<00:03, 54634.32it/s] 57%|█████▋    | 254916/446685 [00:05<00:03, 54731.04it/s] 58%|█████▊    | 260407/446685 [00:06<00:03, 53641.84it/s] 60%|█████▉    | 265974/446685 [00:06<00:03, 52794.32it/s] 61%|██████    | 272376/446685 [00:06<00:03, 54516.77it/s] 62%|██████▏   | 277833/446685 [00:06<00:03, 54212.76it/s] 64%|██████▎   | 284016/446685 [00:06<00:02, 56303.23it/s] 65%|██████▍   | 289836/446685 [00:06<00:02, 55899.13it/s] 66%|██████▌   | 295656/446685 [00:06<00:02, 55760.65it/s] 67%|██████▋   | 301238/446685 [00:06<00:02, 53160.03it/s] 69%|██████▊   | 306577/446685 [00:06<00:02, 51464.42it/s] 70%|██████▉   | 311952/446685 [00:06<00:02, 51418.68it/s] 71%|███████▏  | 318354/446685 [00:07<00:02, 54743.48it/s] 73%|███████▎  | 324756/446685 [00:07<00:02, 56229.95it/s] 74%|███████▍  | 331740/446685 [00:07<00:01, 58698.34it/s] 76%|███████▌  | 338142/446685 [00:07<00:01, 58550.39it/s] 77%|███████▋  | 344003/446685 [00:07<00:01, 56210.30it/s] 78%|███████▊  | 349638/446685 [00:07<00:01, 52221.09it/s] 79%|███████▉  | 355020/446685 [00:07<00:01, 51811.49it/s] 81%|████████  | 360840/446685 [00:07<00:01, 53304.33it/s] 82%|████████▏ | 366660/446685 [00:07<00:01, 54493.82it/s] 84%|████████▎ | 373062/446685 [00:08<00:01, 56800.61it/s] 85%|████████▍ | 379464/446685 [00:08<00:01, 57750.26it/s] 86%|████████▋ | 385866/446685 [00:08<00:01, 56860.55it/s] 88%|████████▊ | 391571/446685 [00:08<00:01, 52388.30it/s] 89%|████████▉ | 396924/446685 [00:08<00:00, 51558.46it/s] 90%|█████████ | 403326/446685 [00:08<00:00, 54211.66it/s] 92%|█████████▏| 408791/446685 [00:08<00:00, 43291.08it/s] 93%|█████████▎| 413473/446685 [00:09<00:01, 29764.96it/s] 93%|█████████▎| 417218/446685 [00:09<00:01, 27622.34it/s] 95%|█████████▍| 422532/446685 [00:09<00:00, 31924.50it/s] 96%|█████████▌| 427188/446685 [00:09<00:00, 34759.67it/s] 97%|█████████▋| 432426/446685 [00:09<00:00, 38649.15it/s] 98%|█████████▊| 439410/446685 [00:09<00:00, 45528.05it/s]100%|█████████▉| 445230/446685 [00:09<00:00, 48781.70it/s]100%|██████████| 446685/446685 [00:09<00:00, 45404.59it/s]
The spherical harmonics array is 393.62 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 95.94884896278381 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 1.168627226505805
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.0006, 'pow_max': 0.00065, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 18.22it/s] 26%|██▋       | 5/19 [00:00<00:00, 19.82it/s] 42%|████▏     | 8/19 [00:00<00:00, 20.92it/s] 58%|█████▊    | 11/19 [00:00<00:00, 21.46it/s] 74%|███████▎  | 14/19 [00:00<00:00, 21.78it/s] 89%|████████▉ | 17/19 [00:00<00:00, 21.95it/s]100%|██████████| 19/19 [00:00<00:00, 21.49it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6356712 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 0.7144062519073486 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07026981873647886
Ratio of unique |k|: 0.0017317128729443774
Time to get unique k and theta: 1.504734754562378 seconds

Getting transfer functions
  0%|          | 0/11008 [00:00<?, ?it/s]  2%|▏         | 240/11008 [00:00<00:04, 2388.93it/s]  4%|▍         | 495/11008 [00:00<00:04, 2445.33it/s]  7%|▋         | 740/11008 [00:00<00:04, 2387.47it/s]  9%|▉         | 990/11008 [00:00<00:04, 2425.98it/s] 11%|█▏        | 1260/11008 [00:00<00:03, 2468.65it/s] 14%|█▍        | 1530/11008 [00:00<00:03, 2526.53it/s] 16%|█▌        | 1786/11008 [00:00<00:03, 2537.16it/s] 19%|█▉        | 2070/11008 [00:00<00:03, 2600.43it/s] 21%|██        | 2331/11008 [00:00<00:03, 2570.31it/s] 24%|██▎       | 2589/11008 [00:01<00:03, 2508.81it/s] 26%|██▌       | 2841/11008 [00:01<00:03, 2459.56it/s] 29%|██▉       | 3195/11008 [00:01<00:02, 2746.01it/s] 33%|███▎      | 3585/11008 [00:01<00:02, 3044.14it/s] 36%|███▌      | 3930/11008 [00:01<00:02, 3146.33it/s] 39%|███▊      | 4260/11008 [00:01<00:02, 3184.45it/s] 42%|████▏     | 4590/11008 [00:01<00:02, 3207.89it/s] 45%|████▍     | 4935/11008 [00:01<00:01, 3231.53it/s] 48%|████▊     | 5295/11008 [00:01<00:01, 3294.53it/s] 51%|█████▏    | 5655/11008 [00:01<00:01, 3371.63it/s] 55%|█████▍    | 6015/11008 [00:02<00:01, 3407.23it/s] 58%|█████▊    | 6420/11008 [00:02<00:01, 3562.28it/s] 62%|██████▏   | 6777/11008 [00:02<00:01, 3541.98it/s] 65%|██████▍   | 7132/11008 [00:02<00:01, 3468.17it/s] 68%|██████▊   | 7500/11008 [00:02<00:00, 3526.75it/s] 71%|███████▏  | 7860/11008 [00:02<00:00, 3503.62it/s] 75%|███████▍  | 8235/11008 [00:02<00:00, 3552.54it/s] 78%|███████▊  | 8595/11008 [00:02<00:00, 3553.57it/s] 81%|████████▏ | 8970/11008 [00:02<00:00, 3600.97it/s] 85%|████████▍ | 9331/11008 [00:02<00:00, 3570.19it/s] 88%|████████▊ | 9720/11008 [00:03<00:00, 3617.98it/s] 92%|█████████▏| 10095/11008 [00:03<00:00, 3636.49it/s] 95%|█████████▌| 10470/11008 [00:03<00:00, 3623.60it/s] 98%|█████████▊| 10833/11008 [00:03<00:00, 3582.75it/s]100%|██████████| 11008/11008 [00:03<00:00, 3183.35it/s]
Size of transfer function: 1.76 MB. 

Size of integrand: 37.04 MB. Time to calculate integrand: 0.02041769027709961 s

Getting spherical harmonics
  0%|          | 0/446685 [00:00<?, ?it/s]  1%|          | 5102/446685 [00:00<00:08, 51015.55it/s]  2%|▏         | 10204/446685 [00:00<00:09, 47349.41it/s]  3%|▎         | 14957/446685 [00:00<00:09, 45041.14it/s]  4%|▍         | 19788/446685 [00:00<00:09, 43204.74it/s]  5%|▌         | 24444/446685 [00:00<00:09, 43330.57it/s]  6%|▋         | 28789/446685 [00:00<00:10, 39586.33it/s]  8%|▊         | 33756/446685 [00:00<00:09, 41335.08it/s]  9%|▊         | 38412/446685 [00:00<00:09, 42135.94it/s] 10%|▉         | 42657/446685 [00:00<00:09, 42040.39it/s] 11%|█         | 47724/446685 [00:01<00:09, 44020.95it/s] 12%|█▏        | 53544/446685 [00:01<00:08, 47760.46it/s] 13%|█▎        | 58782/446685 [00:01<00:08, 48090.19it/s] 14%|█▍        | 64602/446685 [00:01<00:07, 48537.27it/s] 16%|█▌        | 69840/446685 [00:01<00:07, 48181.01it/s] 17%|█▋        | 74665/446685 [00:01<00:08, 44387.26it/s] 18%|█▊        | 79734/446685 [00:01<00:07, 46052.10it/s] 19%|█▉        | 84972/446685 [00:01<00:07, 46215.03it/s] 20%|██        | 90792/446685 [00:01<00:07, 48158.36it/s] 22%|██▏       | 96612/446685 [00:02<00:07, 49383.06it/s] 23%|██▎       | 101850/446685 [00:02<00:07, 49075.25it/s] 24%|██▍       | 107088/446685 [00:02<00:06, 49031.54it/s] 25%|██▌       | 113490/446685 [00:02<00:06, 52145.10it/s] 27%|██▋       | 118728/446685 [00:02<00:06, 51870.61it/s] 28%|██▊       | 125130/446685 [00:02<00:05, 54911.13it/s] 30%|██▉       | 132114/446685 [00:02<00:05, 59159.50it/s] 31%|███       | 138055/446685 [00:02<00:05, 58751.48it/s] 32%|███▏      | 144336/446685 [00:02<00:05, 59099.49it/s] 34%|███▎      | 150258/446685 [00:03<00:05, 57773.65it/s] 35%|███▌      | 157140/446685 [00:03<00:04, 60253.77it/s] 37%|███▋      | 163542/446685 [00:03<00:04, 57992.56it/s] 38%|███▊      | 169944/446685 [00:03<00:04, 57014.47it/s] 39%|███▉      | 175669/446685 [00:03<00:04, 56929.49it/s] 41%|████      | 181378/446685 [00:03<00:05, 52725.09it/s] 42%|████▏     | 186822/446685 [00:03<00:05, 50304.45it/s] 43%|████▎     | 192642/446685 [00:03<00:04, 52355.72it/s] 44%|████▍     | 197935/446685 [00:03<00:04, 52048.41it/s] 45%|████▌     | 203179/446685 [00:04<00:05, 47925.19it/s] 47%|████▋     | 208048/446685 [00:04<00:05, 47491.80it/s] 48%|████▊     | 213594/446685 [00:04<00:04, 49584.17it/s] 49%|████▉     | 218605/446685 [00:04<00:04, 49715.25it/s] 50%|█████     | 224070/446685 [00:04<00:04, 50207.15it/s] 51%|█████▏    | 229308/446685 [00:04<00:04, 50473.98it/s] 53%|█████▎    | 235710/446685 [00:04<00:03, 53651.15it/s] 54%|█████▍    | 242112/446685 [00:04<00:03, 54408.92it/s] 56%|█████▌    | 249096/446685 [00:04<00:03, 58612.54it/s] 57%|█████▋    | 255498/446685 [00:05<00:03, 59703.47it/s] 59%|█████▊    | 261488/446685 [00:05<00:03, 58080.89it/s] 60%|██████    | 268302/446685 [00:05<00:03, 59286.09it/s] 61%|██████▏   | 274241/446685 [00:05<00:02, 58281.35it/s] 63%|██████▎   | 280076/446685 [00:05<00:03, 55000.12it/s] 64%|██████▍   | 285607/446685 [00:05<00:03, 50750.54it/s] 65%|██████▌   | 291000/446685 [00:05<00:03, 51014.61it/s] 67%|██████▋   | 297402/446685 [00:05<00:02, 53621.03it/s] 68%|██████▊   | 302810/446685 [00:05<00:02, 53651.46it/s] 69%|██████▉   | 309624/446685 [00:06<00:02, 56043.82it/s] 71%|███████   | 316608/446685 [00:06<00:02, 59523.72it/s] 72%|███████▏  | 322589/446685 [00:06<00:02, 59487.00it/s] 74%|███████▎  | 328558/446685 [00:06<00:02, 58956.21it/s] 75%|███████▍  | 334467/446685 [00:06<00:02, 54861.22it/s] 76%|███████▌  | 340011/446685 [00:06<00:02, 52687.12it/s] 77%|███████▋  | 345708/446685 [00:06<00:01, 52667.14it/s] 79%|███████▊  | 351528/446685 [00:06<00:01, 53847.26it/s] 81%|████████  | 359676/446685 [00:06<00:01, 60384.53it/s] 82%|████████▏ | 366660/446685 [00:06<00:01, 62086.61it/s] 83%|████████▎ | 372890/446685 [00:07<00:01, 61582.57it/s] 85%|████████▍ | 379062/446685 [00:07<00:01, 61186.79it/s] 86%|████████▌ | 385189/446685 [00:07<00:01, 58223.70it/s] 88%|████████▊ | 391104/446685 [00:07<00:00, 58189.96it/s] 89%|████████▉ | 396943/446685 [00:07<00:00, 52171.90it/s] 90%|█████████ | 403326/446685 [00:07<00:00, 54561.01it/s] 92%|█████████▏| 409728/446685 [00:07<00:00, 57010.85it/s] 93%|█████████▎| 416712/446685 [00:07<00:00, 59537.48it/s] 95%|█████████▍| 422735/446685 [00:07<00:00, 56464.42it/s] 96%|█████████▌| 428451/446685 [00:08<00:00, 56409.31it/s] 97%|█████████▋| 434754/446685 [00:08<00:00, 58168.26it/s] 99%|█████████▊| 440615/446685 [00:08<00:00, 55613.18it/s]100%|██████████| 446685/446685 [00:08<00:00, 53215.76it/s]
The spherical harmonics array is 393.62 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 98.84412622451782 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 1.0591065966105702
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.0007, 'pow_max': 0.00075, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 12.30it/s] 21%|██        | 4/19 [00:00<00:01, 12.74it/s] 32%|███▏      | 6/19 [00:00<00:00, 13.42it/s] 42%|████▏     | 8/19 [00:00<00:00, 14.28it/s] 53%|█████▎    | 10/19 [00:00<00:00, 15.19it/s] 63%|██████▎   | 12/19 [00:00<00:00, 16.23it/s] 79%|███████▉  | 15/19 [00:00<00:00, 17.78it/s] 95%|█████████▍| 18/19 [00:01<00:00, 19.21it/s]100%|██████████| 19/19 [00:01<00:00, 16.74it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6356712 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 0.7743768692016602 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07026981873647886
Ratio of unique |k|: 0.0017317128729443774
Time to get unique k and theta: 1.7851979732513428 seconds

Getting transfer functions
  0%|          | 0/11008 [00:00<?, ?it/s]  0%|          | 15/11008 [00:00<01:41, 108.68it/s]  2%|▏         | 255/11008 [00:00<00:08, 1242.63it/s]  4%|▍         | 495/11008 [00:00<00:06, 1708.50it/s]  7%|▋         | 750/11008 [00:00<00:05, 1993.92it/s]  9%|▊         | 958/11008 [00:00<00:05, 1740.98it/s] 11%|█         | 1185/11008 [00:00<00:05, 1865.15it/s] 13%|█▎        | 1410/11008 [00:00<00:04, 1961.40it/s] 15%|█▍        | 1635/11008 [00:00<00:04, 2037.67it/s] 17%|█▋        | 1875/11008 [00:01<00:04, 2135.43it/s] 19%|█▉        | 2115/11008 [00:01<00:04, 2201.01it/s] 21%|██▏       | 2355/11008 [00:01<00:03, 2258.46it/s] 24%|██▎       | 2610/11008 [00:01<00:03, 2315.00it/s] 26%|██▌       | 2850/11008 [00:01<00:03, 2320.88it/s] 29%|██▉       | 3180/11008 [00:01<00:03, 2594.64it/s] 32%|███▏      | 3495/11008 [00:01<00:02, 2737.47it/s] 35%|███▍      | 3810/11008 [00:01<00:02, 2841.25it/s] 37%|███▋      | 4110/11008 [00:01<00:02, 2870.68it/s] 40%|████      | 4425/11008 [00:01<00:02, 2945.43it/s] 43%|████▎     | 4755/11008 [00:02<00:02, 3047.60it/s] 46%|████▋     | 5100/11008 [00:02<00:01, 3151.97it/s] 49%|████▉     | 5416/11008 [00:02<00:01, 3105.93it/s] 52%|█████▏    | 5730/11008 [00:02<00:01, 3106.95it/s] 55%|█████▍    | 6045/11008 [00:02<00:01, 3112.01it/s] 58%|█████▊    | 6390/11008 [00:02<00:01, 3210.66it/s] 61%|██████    | 6735/11008 [00:02<00:01, 3264.17it/s] 64%|██████▍   | 7062/11008 [00:02<00:01, 3158.68it/s] 67%|██████▋   | 7380/11008 [00:02<00:01, 3134.93it/s] 70%|███████   | 7725/11008 [00:02<00:01, 3206.03it/s] 73%|███████▎  | 8047/11008 [00:03<00:00, 3192.43it/s] 76%|███████▋  | 8415/11008 [00:03<00:00, 3292.63it/s] 79%|███████▉  | 8745/11008 [00:03<00:00, 3248.16it/s] 83%|████████▎ | 9105/11008 [00:03<00:00, 3341.40it/s] 86%|████████▌ | 9465/11008 [00:03<00:00, 3398.58it/s] 89%|████████▉ | 9806/11008 [00:03<00:00, 3336.94it/s] 92%|█████████▏| 10141/11008 [00:03<00:00, 3231.67it/s] 95%|█████████▌| 10465/11008 [00:03<00:00, 3221.38it/s] 98%|█████████▊| 10815/11008 [00:03<00:00, 3291.05it/s]100%|██████████| 11008/11008 [00:03<00:00, 2786.72it/s]
Size of transfer function: 1.76 MB. 

Size of integrand: 37.04 MB. Time to calculate integrand: 0.023488998413085938 s

Getting spherical harmonics
  0%|          | 0/446685 [00:00<?, ?it/s]  1%|          | 3492/446685 [00:00<00:14, 31543.66it/s]  2%|▏         | 9312/446685 [00:00<00:09, 43877.81it/s]  3%|▎         | 15132/446685 [00:00<00:08, 48970.82it/s]  4%|▍         | 20044/446685 [00:00<00:09, 47082.85it/s]  6%|▌         | 24764/446685 [00:00<00:09, 46719.31it/s]  7%|▋         | 29442/446685 [00:00<00:09, 45694.10it/s]  8%|▊         | 34338/446685 [00:00<00:08, 46268.47it/s]  9%|▊         | 38969/446685 [00:00<00:09, 44911.38it/s] 10%|▉         | 43467/446685 [00:00<00:08, 44901.59it/s] 11%|█         | 47962/446685 [00:01<00:09, 42259.24it/s] 12%|█▏        | 52216/446685 [00:01<00:09, 41199.91it/s] 13%|█▎        | 57036/446685 [00:01<00:09, 42757.47it/s] 14%|█▍        | 61692/446685 [00:01<00:08, 43682.38it/s] 15%|█▍        | 66348/446685 [00:01<00:08, 44220.43it/s] 16%|█▌        | 71004/446685 [00:01<00:08, 44777.52it/s] 17%|█▋        | 76242/446685 [00:01<00:08, 45272.34it/s] 18%|█▊        | 80898/446685 [00:01<00:08, 43330.97it/s] 19%|█▉        | 85249/446685 [00:01<00:08, 42845.28it/s] 20%|██        | 90210/446685 [00:02<00:08, 44412.92it/s] 21%|██▏       | 96030/446685 [00:02<00:07, 47399.48it/s] 23%|██▎       | 101268/446685 [00:02<00:07, 48635.73it/s] 24%|██▍       | 106506/446685 [00:02<00:06, 49442.63it/s] 25%|██▌       | 111744/446685 [00:02<00:06, 48538.89it/s] 26%|██▋       | 118146/446685 [00:02<00:06, 52728.63it/s] 28%|██▊       | 123966/446685 [00:02<00:06, 52977.19it/s] 29%|██▉       | 130950/446685 [00:02<00:05, 57406.05it/s] 31%|███       | 137352/446685 [00:02<00:05, 57439.31it/s] 32%|███▏      | 143172/446685 [00:02<00:05, 56169.02it/s] 34%|███▎      | 150738/446685 [00:03<00:04, 61256.16it/s] 35%|███▌      | 157140/446685 [00:03<00:04, 59423.91it/s] 37%|███▋      | 163542/446685 [00:03<00:04, 58916.62it/s] 38%|███▊      | 169455/446685 [00:03<00:04, 58064.04it/s] 39%|███▉      | 175274/446685 [00:03<00:04, 56658.22it/s] 41%|████      | 180949/446685 [00:03<00:04, 56240.74it/s] 42%|████▏     | 186578/446685 [00:03<00:04, 56105.36it/s] 43%|████▎     | 193224/446685 [00:03<00:04, 57937.73it/s] 45%|████▍     | 199626/446685 [00:03<00:04, 59051.12it/s] 46%|████▌     | 205533/446685 [00:04<00:06, 37733.32it/s] 47%|████▋     | 210268/446685 [00:04<00:09, 23799.09it/s] 48%|████▊     | 213921/446685 [00:04<00:10, 22637.33it/s] 49%|████▊     | 217055/446685 [00:05<00:10, 22044.88it/s] 49%|████▉     | 219851/446685 [00:05<00:11, 20549.92it/s] 50%|█████     | 224070/446685 [00:05<00:09, 24364.11it/s] 52%|█████▏    | 230472/446685 [00:05<00:06, 31660.27it/s] 53%|█████▎    | 236292/446685 [00:05<00:05, 37332.92it/s] 55%|█████▍    | 243858/446685 [00:05<00:04, 45725.07it/s] 56%|█████▌    | 250260/446685 [00:05<00:03, 49597.48it/s] 57%|█████▋    | 255684/446685 [00:05<00:03, 47979.89it/s] 58%|█████▊    | 260809/446685 [00:05<00:04, 46168.84it/s] 59%|█████▉    | 265655/446685 [00:06<00:03, 45863.16it/s] 61%|██████    | 271212/446685 [00:06<00:03, 47972.44it/s] 62%|██████▏   | 277614/446685 [00:06<00:03, 50652.34it/s] 63%|██████▎   | 283434/446685 [00:06<00:03, 51648.26it/s] 65%|██████▍   | 289254/446685 [00:06<00:02, 53035.41it/s] 66%|██████▌   | 295074/446685 [00:06<00:02, 54325.89it/s] 67%|██████▋   | 301476/446685 [00:06<00:02, 56021.67it/s] 69%|██████▉   | 307296/446685 [00:06<00:02, 55562.95it/s] 70%|███████   | 313093/446685 [00:06<00:02, 56250.75it/s] 71%|███████▏  | 318936/446685 [00:07<00:02, 56598.67it/s] 73%|███████▎  | 324756/446685 [00:07<00:02, 56595.59it/s] 74%|███████▍  | 330576/446685 [00:07<00:02, 55829.78it/s] 75%|███████▌  | 336396/446685 [00:07<00:01, 55197.44it/s] 77%|███████▋  | 342798/446685 [00:07<00:01, 56006.34it/s] 78%|███████▊  | 349200/446685 [00:07<00:01, 57456.46it/s] 79%|███████▉  | 354950/446685 [00:07<00:01, 54178.07it/s] 81%|████████  | 360399/446685 [00:07<00:01, 54065.40it/s] 82%|████████▏ | 365827/446685 [00:07<00:01, 53235.42it/s] 83%|████████▎ | 371164/446685 [00:07<00:01, 53265.30it/s] 84%|████████▍ | 377136/446685 [00:08<00:01, 54840.39it/s] 86%|████████▌ | 382631/446685 [00:08<00:01, 54793.81it/s] 87%|████████▋ | 388118/446685 [00:08<00:01, 51469.04it/s] 88%|████████▊ | 393432/446685 [00:08<00:01, 50987.44it/s] 89%|████████▉ | 399252/446685 [00:08<00:00, 52857.16it/s] 91%|█████████ | 405654/446685 [00:08<00:00, 55340.67it/s] 92%|█████████▏| 411211/446685 [00:08<00:00, 51350.28it/s] 93%|█████████▎| 416410/446685 [00:08<00:00, 51478.51it/s] 94%|█████████▍| 421950/446685 [00:08<00:00, 50968.72it/s] 96%|█████████▌| 427265/446685 [00:09<00:00, 51581.37it/s] 97%|█████████▋| 432451/446685 [00:09<00:00, 50583.50it/s] 98%|█████████▊| 438246/446685 [00:09<00:00, 52316.16it/s] 99%|█████████▉| 443497/446685 [00:09<00:00, 51777.51it/s]100%|██████████| 446685/446685 [00:09<00:00, 47465.01it/s]
The spherical harmonics array is 393.62 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 102.99352502822876 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 1.0104313126641356
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.0008, 'pow_max': 0.0008500000000000001, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 14.85it/s] 21%|██        | 4/19 [00:00<00:00, 15.58it/s] 32%|███▏      | 6/19 [00:00<00:00, 16.43it/s] 42%|████▏     | 8/19 [00:00<00:00, 17.36it/s] 58%|█████▊    | 11/19 [00:00<00:00, 18.76it/s] 74%|███████▎  | 14/19 [00:00<00:00, 19.99it/s] 89%|████████▉ | 17/19 [00:00<00:00, 20.76it/s]100%|██████████| 19/19 [00:00<00:00, 19.34it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6356712 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 0.7227823734283447 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07026981873647886
Ratio of unique |k|: 0.0017317128729443774
Time to get unique k and theta: 1.5290143489837646 seconds

Getting transfer functions
  0%|          | 0/11008 [00:00<?, ?it/s]  2%|▏         | 180/11008 [00:00<00:06, 1781.52it/s]  4%|▍         | 435/11008 [00:00<00:04, 2208.50it/s]  6%|▌         | 675/11008 [00:00<00:04, 2284.58it/s]  8%|▊         | 930/11008 [00:00<00:04, 2383.31it/s] 11%|█         | 1200/11008 [00:00<00:03, 2481.90it/s] 13%|█▎        | 1455/11008 [00:00<00:03, 2489.97it/s] 16%|█▌        | 1725/11008 [00:00<00:03, 2509.39it/s] 18%|█▊        | 1995/11008 [00:00<00:03, 2567.38it/s] 20%|██        | 2252/11008 [00:00<00:03, 2557.47it/s] 23%|██▎       | 2520/11008 [00:01<00:03, 2549.05it/s] 25%|██▌       | 2805/11008 [00:01<00:03, 2616.00it/s] 28%|██▊       | 3135/11008 [00:01<00:02, 2781.64it/s] 32%|███▏      | 3480/11008 [00:01<00:02, 2966.75it/s] 35%|███▍      | 3825/11008 [00:01<00:02, 3069.32it/s] 38%|███▊      | 4170/11008 [00:01<00:02, 3152.09it/s] 41%|████      | 4500/11008 [00:01<00:02, 3160.60it/s] 44%|████▍     | 4875/11008 [00:01<00:01, 3292.00it/s] 47%|████▋     | 5205/11008 [00:01<00:01, 3282.53it/s] 50%|█████     | 5535/11008 [00:01<00:01, 3267.97it/s] 54%|█████▍    | 5925/11008 [00:02<00:01, 3438.69it/s] 57%|█████▋    | 6270/11008 [00:02<00:01, 3428.98it/s] 60%|██████    | 6630/11008 [00:02<00:01, 3459.18it/s] 64%|██████▎   | 7005/11008 [00:02<00:01, 3514.06it/s] 67%|██████▋   | 7357/11008 [00:02<00:01, 3502.07it/s] 70%|███████   | 7725/11008 [00:02<00:00, 3521.18it/s] 73%|███████▎  | 8078/11008 [00:02<00:00, 3447.29it/s] 77%|███████▋  | 8460/11008 [00:02<00:00, 3546.67it/s] 80%|████████  | 8816/11008 [00:02<00:00, 3479.31it/s] 83%|████████▎ | 9165/11008 [00:02<00:00, 3324.92it/s] 87%|████████▋ | 9525/11008 [00:03<00:00, 3366.70it/s] 90%|████████▉ | 9885/11008 [00:03<00:00, 3417.85it/s] 93%|█████████▎| 10275/11008 [00:03<00:00, 3529.30it/s] 97%|█████████▋| 10629/11008 [00:03<00:00, 3439.58it/s]100%|█████████▉| 10974/11008 [00:03<00:00, 3402.60it/s]100%|██████████| 11008/11008 [00:03<00:00, 3124.59it/s]
Size of transfer function: 1.76 MB. 

Size of integrand: 37.04 MB. Time to calculate integrand: 0.02013230323791504 s

Getting spherical harmonics
  0%|          | 0/446685 [00:00<?, ?it/s]  1%|          | 4656/446685 [00:00<00:10, 43894.54it/s]  2%|▏         | 9312/446685 [00:00<00:10, 43406.94it/s]  3%|▎         | 14162/446685 [00:00<00:09, 45642.19it/s]  4%|▍         | 18736/446685 [00:00<00:10, 42427.24it/s]  5%|▌         | 23280/446685 [00:00<00:10, 41917.82it/s]  6%|▋         | 28518/446685 [00:00<00:09, 43545.29it/s]  8%|▊         | 33756/446685 [00:00<00:09, 45314.97it/s]  9%|▊         | 38301/446685 [00:00<00:09, 44634.86it/s] 10%|▉         | 42772/446685 [00:00<00:09, 43276.17it/s] 11%|█         | 47142/446685 [00:01<00:09, 41792.16it/s] 12%|█▏        | 52962/446685 [00:01<00:08, 44815.47it/s] 13%|█▎        | 57618/446685 [00:01<00:08, 44210.97it/s] 14%|█▍        | 62274/446685 [00:01<00:08, 43754.89it/s] 15%|█▍        | 66930/446685 [00:01<00:08, 44329.41it/s] 16%|█▌        | 72168/446685 [00:01<00:08, 45729.74it/s] 17%|█▋        | 76824/446685 [00:01<00:08, 44610.85it/s] 18%|█▊        | 82062/446685 [00:01<00:08, 45469.81it/s] 19%|█▉        | 86718/446685 [00:01<00:07, 45577.85it/s] 21%|██        | 91956/446685 [00:02<00:07, 45584.52it/s] 22%|██▏       | 96516/446685 [00:02<00:07, 44531.35it/s] 23%|██▎       | 100970/446685 [00:02<00:08, 42195.63it/s] 24%|██▍       | 106506/446685 [00:02<00:07, 44418.46it/s] 25%|██▌       | 111744/446685 [00:02<00:07, 45797.69it/s] 26%|██▋       | 118146/446685 [00:02<00:06, 49999.76it/s] 28%|██▊       | 123166/446685 [00:02<00:06, 49563.33it/s] 29%|██▉       | 129204/446685 [00:02<00:06, 51506.24it/s] 30%|███       | 136188/446685 [00:02<00:05, 56071.83it/s] 32%|███▏      | 141812/446685 [00:03<00:05, 53525.34it/s] 33%|███▎      | 147828/446685 [00:03<00:05, 54667.47it/s] 34%|███▍      | 153318/446685 [00:03<00:05, 52531.69it/s] 36%|███▌      | 159468/446685 [00:03<00:05, 54495.36it/s] 37%|███▋      | 164944/446685 [00:03<00:05, 53660.99it/s] 38%|███▊      | 171108/446685 [00:03<00:04, 55710.08it/s] 40%|███▉      | 176700/446685 [00:03<00:04, 54906.42it/s] 41%|████      | 182748/446685 [00:03<00:04, 56273.18it/s] 42%|████▏     | 188568/446685 [00:03<00:04, 55970.85it/s] 44%|████▎     | 194970/446685 [00:04<00:04, 57850.91it/s] 45%|████▌     | 201372/446685 [00:04<00:04, 59362.20it/s] 47%|████▋     | 208356/446685 [00:04<00:03, 62234.50it/s] 48%|████▊     | 214802/446685 [00:04<00:03, 62887.78it/s] 49%|████▉     | 221100/446685 [00:04<00:03, 58384.81it/s] 51%|█████     | 227006/446685 [00:04<00:03, 57343.22it/s] 52%|█████▏    | 233382/446685 [00:04<00:03, 58972.01it/s] 54%|█████▍    | 240366/446685 [00:04<00:03, 61961.38it/s] 55%|█████▌    | 246603/446685 [00:04<00:03, 61627.93it/s] 57%|█████▋    | 252794/446685 [00:04<00:03, 57420.49it/s] 58%|█████▊    | 258606/446685 [00:05<00:03, 54668.27it/s] 59%|█████▉    | 264136/446685 [00:05<00:03, 53610.19it/s] 60%|██████    | 269538/446685 [00:05<00:03, 51173.76it/s] 62%|██████▏   | 275286/446685 [00:05<00:03, 52221.71it/s] 63%|██████▎   | 283434/446685 [00:05<00:02, 59694.67it/s] 65%|██████▍   | 289905/446685 [00:05<00:02, 61109.90it/s] 66%|██████▋   | 296065/446685 [00:05<00:02, 60379.22it/s] 68%|██████▊   | 302137/446685 [00:05<00:02, 50274.73it/s] 69%|██████▉   | 308460/446685 [00:06<00:02, 52965.48it/s] 71%|███████   | 315444/446685 [00:06<00:02, 56661.68it/s] 72%|███████▏  | 321846/446685 [00:06<00:02, 57666.07it/s] 73%|███████▎  | 327761/446685 [00:06<00:02, 53665.97it/s] 75%|███████▍  | 333269/446685 [00:06<00:02, 53255.13it/s] 76%|███████▌  | 338724/446685 [00:06<00:02, 53055.77it/s] 77%|███████▋  | 344096/446685 [00:06<00:02, 51048.76it/s] 78%|███████▊  | 350364/446685 [00:06<00:01, 53179.13it/s] 80%|███████▉  | 356766/446685 [00:06<00:01, 54999.41it/s] 81%|████████▏ | 363168/446685 [00:06<00:01, 56565.36it/s] 83%|████████▎ | 368852/446685 [00:07<00:01, 52168.25it/s] 84%|████████▍ | 374949/446685 [00:07<00:01, 54551.52it/s] 85%|████████▌ | 381792/446685 [00:07<00:01, 57043.38it/s] 87%|████████▋ | 387552/446685 [00:07<00:01, 52495.40it/s] 89%|████████▊ | 395760/446685 [00:07<00:00, 59103.71it/s] 90%|████████▉ | 401770/446685 [00:07<00:00, 58445.94it/s] 91%|█████████▏| 407982/446685 [00:07<00:00, 59297.82it/s] 93%|█████████▎| 414384/446685 [00:07<00:00, 60270.79it/s] 94%|█████████▍| 420452/446685 [00:07<00:00, 57444.37it/s] 96%|█████████▌| 427770/446685 [00:08<00:00, 61682.64it/s] 97%|█████████▋| 435336/446685 [00:08<00:00, 62662.98it/s] 99%|█████████▉| 441639/446685 [00:08<00:00, 61732.67it/s]100%|██████████| 446685/446685 [00:08<00:00, 53259.93it/s]
The spherical harmonics array is 393.62 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 96.20755982398987 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 0.9716654570720715
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.0009, 'pow_max': 0.00095, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 16.96it/s] 21%|██        | 4/19 [00:00<00:00, 18.62it/s] 37%|███▋      | 7/19 [00:00<00:00, 20.06it/s] 53%|█████▎    | 10/19 [00:00<00:00, 21.01it/s] 68%|██████▊   | 13/19 [00:00<00:00, 21.51it/s] 84%|████████▍ | 16/19 [00:00<00:00, 21.79it/s]100%|██████████| 19/19 [00:00<00:00, 21.97it/s]100%|██████████| 19/19 [00:00<00:00, 21.21it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519179891249254
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6356712 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 0.7354283332824707 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07026981873647886
Ratio of unique |k|: 0.0017317128729443774
Time to get unique k and theta: 1.6179676055908203 seconds

Getting transfer functions
  0%|          | 0/11008 [00:00<?, ?it/s]  2%|▏         | 210/11008 [00:00<00:05, 2097.80it/s]  4%|▍         | 480/11008 [00:00<00:04, 2438.29it/s]  7%|▋         | 735/11008 [00:00<00:04, 2431.63it/s]  9%|▉         | 990/11008 [00:00<00:04, 2453.30it/s] 12%|█▏        | 1275/11008 [00:00<00:03, 2549.98it/s] 14%|█▍        | 1545/11008 [00:00<00:03, 2577.12it/s] 16%|█▋        | 1803/11008 [00:00<00:03, 2547.24it/s] 19%|█▉        | 2070/11008 [00:00<00:03, 2550.91it/s] 21%|██        | 2326/11008 [00:00<00:03, 2550.82it/s] 24%|██▎       | 2595/11008 [00:01<00:03, 2584.62it/s] 26%|██▌       | 2865/11008 [00:01<00:03, 2619.05it/s] 29%|██▉       | 3195/11008 [00:01<00:02, 2815.88it/s] 32%|███▏      | 3540/11008 [00:01<00:02, 2970.53it/s] 35%|███▌      | 3900/11008 [00:01<00:02, 3145.20it/s] 39%|███▉      | 4275/11008 [00:01<00:02, 3310.50it/s] 42%|████▏     | 4607/11008 [00:01<00:01, 3306.24it/s] 45%|████▍     | 4950/11008 [00:01<00:01, 3342.67it/s] 48%|████▊     | 5310/11008 [00:01<00:01, 3378.51it/s] 51%|█████▏    | 5648/11008 [00:01<00:01, 3347.51it/s] 55%|█████▍    | 6000/11008 [00:02<00:01, 3356.79it/s] 58%|█████▊    | 6336/11008 [00:02<00:01, 3316.83it/s] 61%|██████    | 6690/11008 [00:02<00:01, 3353.37it/s] 64%|██████▍   | 7065/11008 [00:02<00:01, 3456.00it/s] 67%|██████▋   | 7425/11008 [00:02<00:01, 3452.58it/s] 71%|███████   | 7771/11008 [00:02<00:00, 3447.27it/s] 74%|███████▎  | 8116/11008 [00:02<00:00, 3421.87it/s] 77%|███████▋  | 8475/11008 [00:02<00:00, 3438.34it/s] 80%|████████  | 8835/11008 [00:02<00:00, 3478.40it/s] 83%|████████▎ | 9183/11008 [00:02<00:00, 3460.88it/s] 87%|████████▋ | 9530/11008 [00:03<00:00, 3373.84it/s] 90%|█████████ | 9915/11008 [00:03<00:00, 3486.58it/s] 93%|█████████▎| 10275/11008 [00:03<00:00, 3501.49it/s] 97%|█████████▋| 10626/11008 [00:03<00:00, 3502.76it/s]100%|█████████▉| 10977/11008 [00:03<00:00, 3451.22it/s]100%|██████████| 11008/11008 [00:03<00:00, 3147.90it/s]
Size of transfer function: 1.76 MB. 

Size of integrand: 37.04 MB. Time to calculate integrand: 0.031496286392211914 s

Getting spherical harmonics
  0%|          | 0/446685 [00:00<?, ?it/s]  1%|▏         | 5820/446685 [00:00<00:08, 53704.16it/s]  3%|▎         | 11640/446685 [00:00<00:08, 54287.70it/s]  4%|▍         | 17070/446685 [00:00<00:08, 51644.72it/s]  5%|▍         | 22241/446685 [00:00<00:08, 47524.51it/s]  6%|▌         | 27026/446685 [00:00<00:13, 30550.99it/s]  7%|▋         | 30725/446685 [00:00<00:14, 29696.07it/s]  8%|▊         | 34338/446685 [00:00<00:13, 30950.55it/s]  9%|▉         | 40158/446685 [00:01<00:10, 37663.76it/s] 10%|█         | 45978/446685 [00:01<00:09, 41438.23it/s] 11%|█▏        | 51216/446685 [00:01<00:09, 43419.68it/s] 13%|█▎        | 55872/446685 [00:01<00:08, 44119.94it/s] 14%|█▎        | 60452/446685 [00:01<00:08, 43189.57it/s] 15%|█▍        | 65184/446685 [00:01<00:09, 42152.90it/s] 16%|█▌        | 70422/446685 [00:01<00:08, 43356.63it/s] 17%|█▋        | 75078/446685 [00:01<00:08, 43689.76it/s] 18%|█▊        | 79590/446685 [00:01<00:08, 44087.29it/s] 19%|█▉        | 84033/446685 [00:02<00:08, 42793.75it/s] 20%|█▉        | 88464/446685 [00:02<00:08, 43203.38it/s] 21%|██        | 92806/446685 [00:02<00:08, 40108.59it/s] 22%|██▏       | 97194/446685 [00:02<00:08, 40387.31it/s] 23%|██▎       | 101850/446685 [00:02<00:08, 42057.67it/s] 24%|██▍       | 106506/446685 [00:02<00:08, 42340.98it/s] 25%|██▍       | 111162/446685 [00:02<00:07, 42510.64it/s] 26%|██▋       | 118146/446685 [00:02<00:06, 49372.86it/s] 28%|██▊       | 123966/446685 [00:02<00:06, 51292.14it/s] 29%|██▉       | 129786/446685 [00:03<00:06, 52426.84it/s] 30%|███       | 136188/446685 [00:03<00:05, 55287.64it/s] 32%|███▏      | 142590/446685 [00:03<00:05, 56601.81it/s] 33%|███▎      | 148894/446685 [00:03<00:05, 58455.28it/s] 35%|███▍      | 154754/446685 [00:03<00:05, 52763.76it/s] 36%|███▌      | 160632/446685 [00:03<00:05, 54077.77it/s] 38%|███▊      | 168198/446685 [00:03<00:04, 59080.59it/s] 39%|███▉      | 175716/446685 [00:03<00:04, 63615.58it/s] 41%|████      | 182159/446685 [00:03<00:04, 58446.41it/s] 42%|████▏     | 188568/446685 [00:03<00:04, 59922.79it/s] 44%|████▎     | 194664/446685 [00:04<00:04, 59932.41it/s] 45%|████▍     | 200730/446685 [00:04<00:04, 56902.98it/s] 46%|████▌     | 206493/446685 [00:04<00:04, 52760.24it/s] 48%|████▊     | 214176/446685 [00:04<00:04, 57827.56it/s] 50%|████▉     | 221742/446685 [00:04<00:03, 62264.47it/s] 51%|█████▏    | 229308/446685 [00:04<00:03, 64654.37it/s] 53%|█████▎    | 235848/446685 [00:04<00:03, 59465.47it/s] 54%|█████▍    | 241909/446685 [00:04<00:03, 55586.93it/s] 55%|█████▌    | 247572/446685 [00:05<00:03, 54876.01it/s] 57%|█████▋    | 253752/446685 [00:05<00:03, 56608.58it/s] 58%|█████▊    | 259664/446685 [00:05<00:03, 57303.97it/s] 59%|█████▉    | 265446/446685 [00:05<00:03, 54870.85it/s] 61%|██████    | 271212/446685 [00:05<00:03, 54927.74it/s] 62%|██████▏   | 276739/446685 [00:05<00:03, 53421.50it/s] 63%|██████▎   | 282107/446685 [00:05<00:03, 52597.34it/s] 65%|██████▍   | 289254/446685 [00:05<00:02, 56281.67it/s] 66%|██████▌   | 294889/446685 [00:05<00:02, 55841.76it/s] 67%|██████▋   | 300476/446685 [00:06<00:02, 53358.51it/s] 69%|██████▊   | 306132/446685 [00:06<00:02, 52550.34it/s] 70%|██████▉   | 311952/446685 [00:06<00:02, 53728.43it/s] 71%|███████   | 317340/446685 [00:06<00:02, 53707.09it/s] 73%|███████▎  | 324747/446685 [00:06<00:02, 59575.63it/s] 74%|███████▍  | 330736/446685 [00:06<00:01, 58722.33it/s] 75%|███████▌  | 336978/446685 [00:06<00:01, 57570.02it/s] 77%|███████▋  | 342757/446685 [00:06<00:01, 55061.08it/s] 78%|███████▊  | 348293/446685 [00:06<00:01, 52431.54it/s] 79%|███████▉  | 353856/446685 [00:06<00:01, 53238.86it/s] 80%|████████  | 359211/446685 [00:07<00:01, 53043.71it/s] 82%|████████▏ | 364536/446685 [00:07<00:01, 51337.29it/s] 83%|████████▎ | 369690/446685 [00:07<00:01, 50819.13it/s] 84%|████████▍ | 375972/446685 [00:07<00:01, 53861.61it/s] 86%|████████▌ | 382956/446685 [00:07<00:01, 58178.42it/s] 87%|████████▋ | 389358/446685 [00:07<00:00, 59300.00it/s] 89%|████████▉ | 396921/446685 [00:07<00:00, 64058.59it/s] 91%|█████████ | 404490/446685 [00:07<00:00, 64501.81it/s] 92%|█████████▏| 410956/446685 [00:07<00:00, 61831.03it/s] 93%|█████████▎| 417164/446685 [00:08<00:00, 57842.54it/s] 95%|█████████▍| 423001/446685 [00:08<00:00, 54837.34it/s] 96%|█████████▌| 428534/446685 [00:08<00:00, 51773.04it/s] 98%|█████████▊| 435918/446685 [00:08<00:00, 57165.18it/s] 99%|█████████▉| 442902/446685 [00:08<00:00, 60073.89it/s]100%|██████████| 446685/446685 [00:08<00:00, 52084.70it/s]
The spherical harmonics array is 393.62 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 95.50596499443054 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 0.9403024966876133
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.001, 'pow_max': 0.00105, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 14.85it/s] 21%|██        | 4/19 [00:00<00:00, 15.89it/s] 32%|███▏      | 6/19 [00:00<00:00, 16.91it/s] 42%|████▏     | 8/19 [00:00<00:00, 17.92it/s] 58%|█████▊    | 11/19 [00:00<00:00, 19.37it/s] 74%|███████▎  | 14/19 [00:00<00:00, 20.72it/s] 89%|████████▉ | 17/19 [00:00<00:00, 21.59it/s]100%|██████████| 19/19 [00:00<00:00, 20.02it/s]
Done. k_max for TT ell_max = 0.02259977597839506 k_max for EE ell_max = 0.08519861475622366
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 6265644 Minimum k_amp 0.00019760140751641845 n_x_max 115 n_z_max 115
Time to get list of k, phi, theta: 0.7416119575500488 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07031104863283008
Ratio of unique |k|: 0.0017401243990242663
Time to get unique k and theta: 1.4817991256713867 seconds

Getting transfer functions
  0%|          | 0/10903 [00:00<?, ?it/s]  1%|          | 75/10903 [00:00<00:14, 733.18it/s]  3%|▎         | 315/10903 [00:00<00:06, 1656.16it/s]  5%|▌         | 570/10903 [00:00<00:05, 2001.01it/s]  8%|▊         | 825/10903 [00:00<00:04, 2189.75it/s] 10%|▉         | 1080/10903 [00:00<00:04, 2293.30it/s] 12%|█▏        | 1335/10903 [00:00<00:04, 2337.93it/s] 14%|█▍        | 1575/10903 [00:00<00:04, 2312.94it/s] 17%|█▋        | 1830/10903 [00:00<00:03, 2385.27it/s] 19%|█▉        | 2100/10903 [00:00<00:03, 2473.03it/s] 22%|██▏       | 2370/10903 [00:01<00:03, 2506.94it/s] 24%|██▍       | 2625/10903 [00:01<00:03, 2513.52it/s] 27%|██▋       | 2910/10903 [00:01<00:03, 2597.42it/s] 30%|██▉       | 3240/10903 [00:01<00:02, 2770.36it/s] 32%|███▏      | 3540/10903 [00:01<00:02, 2832.43it/s] 35%|███▌      | 3825/10903 [00:01<00:02, 2831.68it/s] 38%|███▊      | 4155/10903 [00:01<00:02, 2928.55it/s] 41%|████      | 4455/10903 [00:01<00:02, 2946.79it/s] 44%|████▎     | 4770/10903 [00:01<00:02, 2994.95it/s] 47%|████▋     | 5100/10903 [00:01<00:01, 3060.29it/s] 50%|████▉     | 5430/10903 [00:02<00:01, 3093.63it/s] 53%|█████▎    | 5760/10903 [00:02<00:01, 3123.51it/s] 56%|█████▌    | 6105/10903 [00:02<00:01, 3185.48it/s] 59%|█████▉    | 6424/10903 [00:02<00:01, 3185.01it/s] 62%|██████▏   | 6743/10903 [00:02<00:01, 3184.89it/s] 65%|██████▍   | 7080/10903 [00:02<00:01, 3207.79it/s] 68%|██████▊   | 7410/10903 [00:02<00:01, 3231.71it/s] 71%|███████   | 7734/10903 [00:02<00:00, 3224.36it/s] 74%|███████▍  | 8057/10903 [00:02<00:00, 3204.91it/s] 77%|███████▋  | 8445/10903 [00:02<00:00, 3372.18it/s] 81%|████████  | 8783/10903 [00:03<00:00, 3338.01it/s] 84%|████████▎ | 9117/10903 [00:03<00:00, 3283.92it/s] 87%|████████▋ | 9446/10903 [00:03<00:00, 3248.02it/s] 90%|████████▉ | 9771/10903 [00:03<00:00, 3160.71it/s] 93%|█████████▎| 10110/10903 [00:03<00:00, 3201.81it/s] 96%|█████████▌| 10431/10903 [00:03<00:00, 3197.57it/s] 99%|█████████▊| 10755/10903 [00:03<00:00, 3197.22it/s]100%|██████████| 10903/10903 [00:03<00:00, 2908.38it/s]
Size of transfer function: 1.75 MB. 

Size of integrand: 36.68 MB. Time to calculate integrand: 0.022925615310668945 s

Getting spherical harmonics
  0%|          | 0/440544 [00:00<?, ?it/s]  1%|          | 5166/440544 [00:00<00:08, 49311.06it/s]  2%|▏         | 10906/440544 [00:00<00:08, 51527.05it/s]  4%|▎         | 16072/440544 [00:00<00:08, 49032.40it/s]  5%|▍         | 20980/440544 [00:00<00:09, 46578.91it/s]  6%|▌         | 25648/440544 [00:00<00:16, 25616.67it/s]  7%|▋         | 29123/440544 [00:01<00:19, 21100.79it/s]  7%|▋         | 31898/440544 [00:01<00:20, 19696.09it/s]  8%|▊         | 34293/440544 [00:01<00:23, 17301.68it/s]  8%|▊         | 36312/440544 [00:01<00:26, 14973.63it/s]  9%|▊         | 38458/440544 [00:01<00:25, 15618.51it/s]  9%|▉         | 40190/440544 [00:01<00:26, 15073.98it/s] 10%|▉         | 41902/440544 [00:01<00:26, 15163.71it/s] 10%|▉         | 43624/440544 [00:02<00:27, 14642.17it/s] 10%|█         | 45346/440544 [00:02<00:26, 14705.21it/s] 11%|█         | 47068/440544 [00:02<00:28, 13820.49it/s] 11%|█         | 48479/440544 [00:02<00:28, 13545.40it/s] 11%|█▏        | 49850/440544 [00:02<00:29, 13391.79it/s] 12%|█▏        | 51198/440544 [00:02<00:30, 12727.98it/s] 12%|█▏        | 53382/440544 [00:02<00:27, 13876.49it/s] 13%|█▎        | 55104/440544 [00:02<00:27, 13841.38it/s] 13%|█▎        | 56486/440544 [00:03<00:27, 13754.05it/s] 13%|█▎        | 57859/440544 [00:03<00:28, 13482.91it/s] 13%|█▎        | 59204/440544 [00:03<00:28, 13210.89it/s] 14%|█▎        | 60521/440544 [00:03<00:29, 12805.85it/s] 14%|█▍        | 61992/440544 [00:03<00:29, 13000.07it/s] 14%|█▍        | 63291/440544 [00:03<00:29, 12683.35it/s] 15%|█▍        | 64558/440544 [00:03<00:33, 11354.78it/s] 15%|█▍        | 66010/440544 [00:03<00:31, 11723.86it/s] 15%|█▌        | 67732/440544 [00:03<00:29, 12671.64it/s] 16%|█▌        | 69454/440544 [00:04<00:27, 13514.00it/s] 16%|█▌        | 71176/440544 [00:04<00:27, 13678.13it/s] 17%|█▋        | 72898/440544 [00:04<00:25, 14171.56it/s] 17%|█▋        | 74323/440544 [00:04<00:26, 13852.00it/s] 17%|█▋        | 75712/440544 [00:04<00:26, 13540.47it/s] 17%|█▋        | 77068/440544 [00:04<00:27, 13138.91it/s] 18%|█▊        | 78638/440544 [00:04<00:27, 13387.67it/s] 18%|█▊        | 80360/440544 [00:04<00:28, 12749.36it/s] 19%|█▊        | 81647/440544 [00:04<00:28, 12741.22it/s] 19%|█▉        | 83230/440544 [00:05<00:29, 12209.94it/s] 19%|█▉        | 84463/440544 [00:05<00:29, 12179.92it/s] 20%|█▉        | 86674/440544 [00:05<00:24, 14690.52it/s] 20%|██        | 88970/440544 [00:05<00:20, 16894.84it/s] 21%|██        | 90698/440544 [00:05<00:21, 16246.19it/s] 21%|██        | 92988/440544 [00:05<00:19, 17802.43it/s] 22%|██▏       | 95284/440544 [00:05<00:17, 19205.99it/s] 22%|██▏       | 97233/440544 [00:05<00:18, 18562.55it/s] 22%|██▏       | 99112/440544 [00:06<00:22, 15301.19it/s] 23%|██▎       | 100745/440544 [00:06<00:25, 13126.39it/s] 23%|██▎       | 102172/440544 [00:06<00:27, 12168.15it/s] 23%|██▎       | 103467/440544 [00:06<00:27, 12107.86it/s] 24%|██▍       | 105042/440544 [00:06<00:26, 12509.21it/s] 24%|██▍       | 106764/440544 [00:06<00:25, 13223.25it/s] 25%|██▍       | 108122/440544 [00:06<00:25, 12916.13it/s] 25%|██▌       | 110782/440544 [00:06<00:20, 15826.48it/s] 26%|██▌       | 114226/440544 [00:07<00:16, 20160.42it/s] 26%|██▋       | 116522/440544 [00:07<00:16, 19629.73it/s] 27%|██▋       | 118818/440544 [00:07<00:17, 18435.44it/s] 27%|██▋       | 120696/440544 [00:07<00:18, 17713.40it/s] 28%|██▊       | 122488/440544 [00:07<00:19, 15912.27it/s] 28%|██▊       | 124113/440544 [00:07<00:21, 14408.07it/s] 29%|██▊       | 125588/440544 [00:07<00:22, 14221.55it/s] 29%|██▉       | 127031/440544 [00:07<00:24, 12883.33it/s] 29%|██▉       | 128345/440544 [00:08<00:24, 12653.22it/s] 29%|██▉       | 129625/440544 [00:08<00:26, 11521.25it/s] 30%|██▉       | 130872/440544 [00:08<00:26, 11470.97it/s] 30%|██▉       | 132032/440544 [00:08<00:30, 10220.10it/s] 30%|███       | 133742/440544 [00:08<00:26, 11691.39it/s] 31%|███       | 136038/440544 [00:08<00:22, 13819.38it/s] 32%|███▏      | 139482/440544 [00:08<00:15, 19037.01it/s] 32%|███▏      | 142926/440544 [00:08<00:13, 22800.20it/s] 33%|███▎      | 145513/440544 [00:09<00:12, 23640.10it/s] 34%|███▎      | 148666/440544 [00:09<00:12, 23570.14it/s] 34%|███▍      | 151077/440544 [00:09<00:18, 15731.53it/s] 35%|███▍      | 153015/440544 [00:09<00:19, 14844.24it/s] 35%|███▌      | 154749/440544 [00:09<00:20, 13647.06it/s] 35%|███▌      | 156287/440544 [00:09<00:23, 11889.07it/s] 36%|███▌      | 157612/440544 [00:10<00:23, 11999.56it/s] 36%|███▌      | 158912/440544 [00:10<00:25, 11178.10it/s] 36%|███▋      | 160096/440544 [00:10<00:25, 11217.71it/s] 37%|███▋      | 161266/440544 [00:10<00:27, 10151.44it/s] 37%|███▋      | 162442/440544 [00:10<00:29, 9564.59it/s]  37%|███▋      | 164164/440544 [00:10<00:25, 10891.87it/s] 38%|███▊      | 166460/440544 [00:10<00:19, 13769.27it/s] 38%|███▊      | 169330/440544 [00:10<00:17, 15934.49it/s] 39%|███▉      | 172200/440544 [00:11<00:15, 17292.45it/s] 40%|███▉      | 175644/440544 [00:11<00:12, 20600.80it/s] 40%|████      | 177751/440544 [00:11<00:13, 19463.66it/s] 41%|████      | 179729/440544 [00:11<00:15, 16525.30it/s] 41%|████      | 181458/440544 [00:11<00:16, 15391.62it/s] 42%|████▏     | 183048/440544 [00:11<00:16, 15218.47it/s] 42%|████▏     | 184602/440544 [00:11<00:20, 12737.90it/s] 42%|████▏     | 185976/440544 [00:12<00:19, 12802.54it/s] 43%|████▎     | 187698/440544 [00:12<00:18, 13344.97it/s] 43%|████▎     | 189420/440544 [00:12<00:18, 13440.00it/s] 43%|████▎     | 191142/440544 [00:12<00:19, 12671.92it/s] 44%|████▎     | 192439/440544 [00:12<00:21, 11494.71it/s] 44%|████▍     | 194012/440544 [00:12<00:20, 12248.68it/s] 44%|████▍     | 195734/440544 [00:12<00:18, 12994.23it/s] 45%|████▍     | 197063/440544 [00:12<00:19, 12203.16it/s] 45%|████▌     | 198604/440544 [00:13<00:20, 11945.23it/s] 46%|████▌     | 201474/440544 [00:13<00:15, 15098.94it/s] 46%|████▌     | 203196/440544 [00:13<00:16, 13978.90it/s] 47%|████▋     | 204918/440544 [00:13<00:16, 14273.33it/s] 47%|████▋     | 207788/440544 [00:13<00:13, 17786.37it/s] 48%|████▊     | 209641/440544 [00:13<00:15, 14869.23it/s] 48%|████▊     | 211248/440544 [00:13<00:17, 13213.61it/s] 48%|████▊     | 213528/440544 [00:14<00:15, 14274.82it/s] 49%|████▉     | 215250/440544 [00:14<00:15, 14519.42it/s] 49%|████▉     | 216972/440544 [00:14<00:15, 14370.13it/s] 50%|████▉     | 218449/440544 [00:14<00:15, 14240.19it/s] 50%|████▉     | 219899/440544 [00:14<00:18, 11884.61it/s] 50%|█████     | 221564/440544 [00:14<00:17, 12320.81it/s] 51%|█████     | 223286/440544 [00:14<00:16, 13201.77it/s] 51%|█████▏    | 226730/440544 [00:14<00:11, 18324.15it/s] 53%|█████▎    | 231896/440544 [00:15<00:07, 26878.17it/s] 53%|█████▎    | 235340/440544 [00:15<00:07, 27587.96it/s] 54%|█████▍    | 238227/440544 [00:15<00:07, 25326.46it/s] 55%|█████▍    | 240875/440544 [00:15<00:07, 25026.93it/s] 55%|█████▌    | 243456/440544 [00:15<00:10, 18814.46it/s] 56%|█████▌    | 245601/440544 [00:15<00:11, 17345.85it/s] 56%|█████▌    | 247522/440544 [00:15<00:13, 14655.44it/s] 57%|█████▋    | 249160/440544 [00:16<00:13, 13811.53it/s] 57%|█████▋    | 250653/440544 [00:16<00:13, 13906.24it/s] 57%|█████▋    | 252125/440544 [00:16<00:15, 12352.40it/s] 58%|█████▊    | 253430/440544 [00:16<00:16, 11441.29it/s] 58%|█████▊    | 254856/440544 [00:16<00:15, 11859.08it/s] 58%|█████▊    | 256085/440544 [00:16<00:15, 11619.59it/s] 59%|█████▊    | 257726/440544 [00:16<00:14, 12284.35it/s] 59%|█████▉    | 258977/440544 [00:16<00:15, 12052.12it/s] 59%|█████▉    | 260596/440544 [00:17<00:14, 12676.72it/s] 60%|█████▉    | 262318/440544 [00:17<00:13, 13571.45it/s] 60%|█████▉    | 264040/440544 [00:17<00:12, 14047.60it/s] 60%|██████    | 265762/440544 [00:17<00:12, 14385.01it/s] 61%|██████    | 267208/440544 [00:17<00:12, 14049.54it/s] 61%|██████    | 268618/440544 [00:17<00:12, 13701.27it/s] 61%|██████▏   | 269991/440544 [00:17<00:14, 11693.07it/s] 62%|██████▏   | 272076/440544 [00:17<00:13, 12941.82it/s] 62%|██████▏   | 273399/440544 [00:18<00:13, 12691.87it/s] 62%|██████▏   | 274685/440544 [00:18<00:13, 12200.88it/s] 63%|██████▎   | 275915/440544 [00:18<00:13, 11857.31it/s] 63%|██████▎   | 277106/440544 [00:18<00:14, 11587.79it/s] 63%|██████▎   | 278267/440544 [00:18<00:14, 11277.44it/s] 63%|██████▎   | 279538/440544 [00:18<00:14, 11473.76it/s] 64%|██████▎   | 280687/440544 [00:18<00:15, 10335.29it/s] 64%|██████▍   | 281834/440544 [00:18<00:15, 10026.20it/s] 65%|██████▌   | 287000/440544 [00:18<00:07, 20454.79it/s] 66%|██████▌   | 289138/440544 [00:19<00:07, 19486.17it/s] 66%|██████▌   | 291155/440544 [00:19<00:07, 18708.39it/s] 67%|██████▋   | 293888/440544 [00:19<00:07, 20486.62it/s] 67%|██████▋   | 296184/440544 [00:19<00:06, 21072.02it/s] 68%|██████▊   | 298329/440544 [00:19<00:08, 17307.35it/s] 68%|██████▊   | 300187/440544 [00:19<00:08, 15622.56it/s] 69%|██████▊   | 301854/440544 [00:19<00:10, 12912.80it/s] 69%|██████▉   | 303275/440544 [00:20<00:10, 12921.71it/s] 69%|██████▉   | 304794/440544 [00:20<00:10, 12951.60it/s] 70%|██████▉   | 306516/440544 [00:20<00:09, 13590.24it/s] 70%|██████▉   | 307929/440544 [00:20<00:10, 12965.90it/s] 70%|███████   | 309262/440544 [00:20<00:11, 11638.67it/s] 70%|███████   | 310534/440544 [00:20<00:11, 11475.78it/s] 71%|███████   | 312256/440544 [00:20<00:10, 12628.69it/s] 71%|███████   | 313551/440544 [00:20<00:11, 11360.41it/s] 71%|███████▏  | 314724/440544 [00:21<00:11, 11212.16it/s] 72%|███████▏  | 315869/440544 [00:21<00:11, 11031.01it/s] 72%|███████▏  | 317422/440544 [00:21<00:10, 11851.37it/s] 73%|███████▎  | 320292/440544 [00:21<00:07, 16163.04it/s] 74%|███████▎  | 324884/440544 [00:21<00:05, 22851.21it/s] 75%|███████▍  | 328328/440544 [00:21<00:04, 25086.25it/s] 75%|███████▌  | 331198/440544 [00:21<00:04, 23592.68it/s] 76%|███████▌  | 334068/440544 [00:21<00:04, 22816.42it/s] 76%|███████▋  | 336367/440544 [00:22<00:05, 18396.63it/s] 77%|███████▋  | 338328/440544 [00:22<00:05, 18212.34it/s] 77%|███████▋  | 340230/440544 [00:22<00:05, 17589.20it/s] 78%|███████▊  | 342040/440544 [00:22<00:06, 16003.26it/s] 78%|███████▊  | 343685/440544 [00:22<00:06, 15649.41it/s] 78%|███████▊  | 345277/440544 [00:22<00:06, 15310.59it/s] 79%|███████▊  | 346823/440544 [00:22<00:06, 14674.17it/s] 79%|███████▉  | 348299/440544 [00:22<00:06, 14496.83it/s] 79%|███████▉  | 349753/440544 [00:23<00:07, 12875.78it/s] 80%|███████▉  | 351067/440544 [00:23<00:06, 12804.07it/s] 80%|████████  | 352436/440544 [00:23<00:07, 11749.72it/s] 80%|████████  | 353635/440544 [00:23<00:08, 10699.13it/s] 81%|████████  | 355306/440544 [00:23<00:07, 11578.54it/s] 81%|████████  | 357028/440544 [00:23<00:06, 12724.26it/s] 81%|████████▏ | 358750/440544 [00:23<00:06, 13613.14it/s] 82%|████████▏ | 360472/440544 [00:23<00:05, 14109.41it/s] 82%|████████▏ | 361905/440544 [00:23<00:06, 12873.13it/s] 82%|████████▏ | 363221/440544 [00:24<00:06, 12403.99it/s] 83%|████████▎ | 364490/440544 [00:24<00:06, 10934.19it/s] 83%|████████▎ | 365638/440544 [00:24<00:07, 10000.08it/s] 83%|████████▎ | 366786/440544 [00:24<00:07, 9401.30it/s]  84%|████████▎ | 368508/440544 [00:24<00:06, 10341.98it/s] 84%|████████▍ | 370230/440544 [00:24<00:06, 11384.58it/s] 85%|████████▍ | 373674/440544 [00:24<00:03, 16828.66it/s] 86%|████████▌ | 378840/440544 [00:25<00:02, 25569.18it/s] 87%|████████▋ | 381604/440544 [00:25<00:02, 24396.90it/s] 87%|████████▋ | 384194/440544 [00:25<00:02, 21939.42it/s] 88%|████████▊ | 386527/440544 [00:25<00:03, 17504.98it/s] 88%|████████▊ | 388494/440544 [00:25<00:03, 17004.55it/s] 89%|████████▊ | 390339/440544 [00:25<00:03, 14668.15it/s] 89%|████████▉ | 391938/440544 [00:25<00:03, 14819.69it/s] 89%|████████▉ | 393518/440544 [00:26<00:03, 12773.78it/s] 90%|████████▉ | 394893/440544 [00:26<00:03, 11963.62it/s] 90%|████████▉ | 396153/440544 [00:26<00:03, 11947.04it/s] 90%|█████████ | 398356/440544 [00:26<00:03, 13574.85it/s] 91%|█████████ | 399754/440544 [00:26<00:03, 12418.91it/s] 91%|█████████ | 401030/440544 [00:26<00:03, 11871.82it/s] 91%|█████████▏| 402948/440544 [00:26<00:02, 13144.23it/s] 92%|█████████▏| 404670/440544 [00:26<00:02, 13537.37it/s] 92%|█████████▏| 406043/440544 [00:27<00:02, 12515.88it/s] 93%|█████████▎| 408114/440544 [00:27<00:02, 13344.05it/s] 93%|█████████▎| 409836/440544 [00:27<00:02, 12952.98it/s] 93%|█████████▎| 411558/440544 [00:27<00:02, 13160.07it/s] 94%|█████████▍| 413280/440544 [00:27<00:01, 13810.42it/s] 94%|█████████▍| 415576/440544 [00:27<00:01, 13076.83it/s] 95%|█████████▍| 417298/440544 [00:27<00:01, 13188.14it/s] 95%|█████████▌| 419594/440544 [00:28<00:01, 14514.41it/s] 96%|█████████▌| 423038/440544 [00:28<00:00, 18958.57it/s] 97%|█████████▋| 425908/440544 [00:28<00:00, 21133.58it/s] 97%|█████████▋| 428204/440544 [00:28<00:00, 19609.50it/s] 98%|█████████▊| 430252/440544 [00:28<00:00, 18998.54it/s] 98%|█████████▊| 432209/440544 [00:28<00:00, 18664.14it/s] 99%|█████████▊| 434113/440544 [00:28<00:00, 15327.38it/s] 99%|█████████▉| 435755/440544 [00:28<00:00, 13262.44it/s] 99%|█████████▉| 437388/440544 [00:29<00:00, 13778.36it/s]100%|█████████▉| 439110/440544 [00:29<00:00, 14331.07it/s]100%|██████████| 440544/440544 [00:29<00:00, 15043.20it/s]
The spherical harmonics array is 388.21 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 121.9553074836731 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 0.8785971119650713
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.0015, 'pow_max': 0.00155, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 17.10it/s] 21%|██        | 4/19 [00:00<00:00, 18.06it/s] 32%|███▏      | 6/19 [00:00<00:00, 18.86it/s] 47%|████▋     | 9/19 [00:00<00:00, 20.04it/s] 63%|██████▎   | 12/19 [00:00<00:00, 20.95it/s] 79%|███████▉  | 15/19 [00:00<00:00, 21.43it/s] 95%|█████████▍| 18/19 [00:00<00:00, 21.75it/s]100%|██████████| 19/19 [00:00<00:00, 20.85it/s]
Done. k_max for TT ell_max = 0.007820044837681183 k_max for EE ell_max = 0.08518711301992739
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 1816478 Minimum k_amp 0.00019760140751641845 n_x_max 76 n_z_max 76
Time to get list of k, phi, theta: 0.21783208847045898 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07440167180665001
Ratio of unique |k|: 0.002629814399073372
Time to get unique k and theta: 0.36420702934265137 seconds

Getting transfer functions
  0%|          | 0/4777 [00:00<?, ?it/s]  1%|          | 49/4777 [00:00<00:10, 464.10it/s]  4%|▎         | 168/4777 [00:00<00:05, 876.66it/s]  6%|▋         | 308/4777 [00:00<00:04, 1110.80it/s]  9%|▉         | 441/4777 [00:00<00:03, 1187.48it/s] 12%|█▏        | 574/4777 [00:00<00:03, 1225.48it/s] 15%|█▌        | 721/4777 [00:00<00:03, 1292.93it/s] 18%|█▊        | 861/4777 [00:00<00:02, 1319.20it/s] 21%|██        | 994/4777 [00:00<00:02, 1309.71it/s] 24%|██▎       | 1127/4777 [00:00<00:02, 1308.41it/s] 27%|██▋       | 1267/4777 [00:01<00:02, 1315.75it/s] 30%|██▉       | 1428/4777 [00:01<00:02, 1400.31it/s] 34%|███▍      | 1645/4777 [00:01<00:01, 1629.87it/s] 39%|███▉      | 1855/4777 [00:01<00:01, 1751.78it/s] 43%|████▎     | 2058/4777 [00:01<00:01, 1821.56it/s] 47%|████▋     | 2261/4777 [00:01<00:01, 1881.59it/s] 52%|█████▏    | 2471/4777 [00:01<00:01, 1931.99it/s] 56%|█████▌    | 2681/4777 [00:01<00:01, 1976.30it/s] 60%|██████    | 2879/4777 [00:01<00:00, 1963.06it/s] 65%|██████▍   | 3094/4777 [00:01<00:00, 2003.33it/s] 69%|██████▉   | 3304/4777 [00:02<00:00, 2009.33it/s] 73%|███████▎  | 3507/4777 [00:02<00:00, 2000.37it/s] 78%|███████▊  | 3710/4777 [00:02<00:00, 2005.01it/s] 82%|████████▏ | 3920/4777 [00:02<00:00, 2031.68it/s] 86%|████████▋ | 4124/4777 [00:02<00:00, 1973.86it/s] 90%|█████████ | 4322/4777 [00:02<00:00, 1963.28it/s] 95%|█████████▍| 4522/4777 [00:02<00:00, 1959.36it/s] 99%|█████████▉| 4725/4777 [00:02<00:00, 1968.75it/s]100%|██████████| 4777/4777 [00:02<00:00, 1711.17it/s]
Size of transfer function: 0.77 MB. 

Size of integrand: 16.07 MB. Time to calculate integrand: 0.008949756622314453 s

Getting spherical harmonics
  0%|          | 0/135149 [00:00<?, ?it/s]  3%|▎         | 4400/135149 [00:00<00:03, 43024.32it/s]  6%|▋         | 8703/135149 [00:00<00:04, 28448.84it/s]  9%|▉         | 12672/135149 [00:00<00:03, 30666.39it/s] 12%|█▏        | 16720/135149 [00:00<00:03, 33834.09it/s] 15%|█▌        | 20333/135149 [00:00<00:03, 34559.25it/s] 18%|█▊        | 24640/135149 [00:00<00:02, 36864.80it/s] 21%|██        | 28512/135149 [00:00<00:02, 37239.69it/s] 24%|██▍       | 32306/135149 [00:00<00:03, 29590.16it/s] 26%|██▋       | 35536/135149 [00:01<00:05, 19841.33it/s] 28%|██▊       | 38086/135149 [00:01<00:05, 17273.06it/s] 30%|██▉       | 40224/135149 [00:01<00:05, 16210.55it/s] 31%|███       | 42115/135149 [00:01<00:06, 13799.81it/s] 32%|███▏      | 43704/135149 [00:02<00:07, 13063.38it/s] 33%|███▎      | 45140/135149 [00:02<00:06, 13305.56it/s] 35%|███▍      | 46816/135149 [00:02<00:06, 13707.55it/s] 36%|███▌      | 48270/135149 [00:02<00:06, 13151.64it/s] 37%|███▋      | 49638/135149 [00:02<00:06, 13047.25it/s] 38%|███▊      | 50978/135149 [00:02<00:06, 12999.56it/s] 39%|███▊      | 52302/135149 [00:02<00:07, 11452.05it/s] 40%|███▉      | 54032/135149 [00:02<00:06, 12821.77it/s] 42%|████▏     | 56848/135149 [00:02<00:04, 16742.71it/s] 43%|████▎     | 58616/135149 [00:03<00:04, 15850.42it/s] 45%|████▍     | 60272/135149 [00:03<00:04, 15497.79it/s] 46%|████▌     | 61871/135149 [00:03<00:04, 14673.38it/s] 47%|████▋     | 63536/135149 [00:03<00:04, 15134.99it/s] 50%|████▉     | 67232/135149 [00:03<00:03, 21032.46it/s] 53%|█████▎    | 71808/135149 [00:03<00:02, 27603.05it/s] 56%|█████▌    | 75504/135149 [00:03<00:01, 30127.14it/s] 59%|█████▉    | 80256/135149 [00:03<00:01, 34812.46it/s] 62%|██████▏   | 84128/135149 [00:03<00:01, 35809.00it/s] 66%|██████▌   | 89011/135149 [00:04<00:01, 39603.24it/s] 70%|██████▉   | 94160/135149 [00:04<00:00, 42891.97it/s] 73%|███████▎  | 98481/135149 [00:04<00:00, 39223.28it/s] 76%|███████▌  | 102484/135149 [00:04<00:00, 38412.18it/s] 79%|███████▊  | 106381/135149 [00:04<00:00, 36309.52it/s] 82%|████████▏ | 111056/135149 [00:04<00:00, 39045.07it/s] 85%|████████▌ | 115023/135149 [00:04<00:00, 35926.94it/s] 88%|████████▊ | 119504/135149 [00:04<00:00, 38014.78it/s] 91%|█████████▏| 123552/135149 [00:04<00:00, 38620.36it/s] 95%|█████████▍| 127776/135149 [00:05<00:00, 39397.41it/s] 98%|█████████▊| 133056/135149 [00:05<00:00, 42585.58it/s]100%|██████████| 135149/135149 [00:05<00:00, 26163.83it/s]
The spherical harmonics array is 119.09 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 91.58180236816406 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 0.8288133893024594
Cubic Torus
Running - E1 l_max=20, Lx=31797
Running {'topology': 'E1', 'Lx': 1.15, 'Ly': 1.15, 'Lz': 1.15, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.002, 'pow_max': 0.00205, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 14.05it/s] 21%|██        | 4/19 [00:00<00:00, 15.56it/s] 32%|███▏      | 6/19 [00:00<00:00, 16.77it/s] 42%|████▏     | 8/19 [00:00<00:00, 17.83it/s] 58%|█████▊    | 11/19 [00:00<00:00, 19.29it/s] 74%|███████▎  | 14/19 [00:00<00:00, 20.01it/s] 89%|████████▉ | 17/19 [00:00<00:00, 20.73it/s]100%|██████████| 19/19 [00:00<00:00, 19.29it/s]
Done. k_max for TT ell_max = 0.01028013843438453 k_max for EE ell_max = 0.08518796500039377
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 2168840 Minimum k_amp 0.00019760140751641845 n_x_max 81 n_z_max 81
Time to get list of k, phi, theta: 0.2639932632446289 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07377446008004279
Ratio of unique |k|: 0.002478283321960126
Time to get unique k and theta: 0.4741475582122803 seconds

Getting transfer functions
  0%|          | 0/5375 [00:00<?, ?it/s]  2%|▏         | 98/5375 [00:00<00:05, 960.50it/s]  4%|▍         | 238/5375 [00:00<00:04, 1214.86it/s]  7%|▋         | 378/5375 [00:00<00:03, 1278.35it/s] 10%|▉         | 511/5375 [00:00<00:03, 1292.81it/s] 12%|█▏        | 658/5375 [00:00<00:03, 1334.20it/s] 15%|█▍        | 798/5375 [00:00<00:03, 1352.73it/s] 17%|█▋        | 938/5375 [00:00<00:03, 1361.97it/s] 20%|██        | 1085/5375 [00:00<00:03, 1390.28it/s] 23%|██▎       | 1225/5375 [00:00<00:03, 1381.41it/s] 26%|██▌       | 1386/5375 [00:01<00:02, 1441.86it/s] 30%|██▉       | 1596/5375 [00:01<00:02, 1639.90it/s] 34%|███▍      | 1820/5375 [00:01<00:01, 1803.76it/s] 38%|███▊      | 2037/5375 [00:01<00:01, 1899.58it/s] 42%|████▏     | 2240/5375 [00:01<00:01, 1925.92it/s] 46%|████▌     | 2450/5375 [00:01<00:01, 1964.75it/s] 49%|████▉     | 2660/5375 [00:01<00:01, 1992.16it/s] 53%|█████▎    | 2860/5375 [00:01<00:01, 1988.28it/s] 57%|█████▋    | 3059/5375 [00:01<00:01, 1977.15it/s] 61%|██████    | 3257/5375 [00:01<00:01, 1973.29it/s] 64%|██████▍   | 3460/5375 [00:02<00:00, 1990.08it/s] 68%|██████▊   | 3675/5375 [00:02<00:00, 2026.77it/s] 72%|███████▏  | 3885/5375 [00:02<00:00, 2031.62it/s] 76%|███████▌  | 4095/5375 [00:02<00:00, 2046.12it/s] 80%|████████  | 4305/5375 [00:02<00:00, 2052.03it/s] 84%|████████▍ | 4536/5375 [00:02<00:00, 2126.98it/s] 88%|████████▊ | 4749/5375 [00:02<00:00, 2104.04it/s] 92%|█████████▏| 4963/5375 [00:02<00:00, 2110.90it/s] 96%|█████████▋| 5175/5375 [00:02<00:00, 2098.87it/s]100%|██████████| 5375/5375 [00:02<00:00, 1829.39it/s]
Size of transfer function: 0.86 MB. 

Size of integrand: 18.08 MB. Time to calculate integrand: 0.011666059494018555 s

Getting spherical harmonics
  0%|          | 0/160005 [00:00<?, ?it/s]  3%|▎         | 4807/160005 [00:00<00:03, 46179.61it/s]  6%|▌         | 9425/160005 [00:00<00:03, 38374.59it/s]  8%|▊         | 13337/160005 [00:00<00:04, 36657.13it/s] 11%|█         | 17036/160005 [00:00<00:03, 35904.71it/s] 13%|█▎        | 21318/160005 [00:00<00:03, 38114.67it/s] 16%|█▌        | 25498/160005 [00:00<00:03, 39257.66it/s] 18%|█▊        | 29449/160005 [00:00<00:03, 39068.51it/s] 21%|██        | 33858/160005 [00:00<00:03, 40303.43it/s] 24%|██▎       | 37902/160005 [00:00<00:03, 39550.97it/s] 26%|██▌       | 41868/160005 [00:01<00:03, 37959.14it/s] 30%|███       | 48279/160005 [00:01<00:02, 45136.70it/s] 34%|███▎      | 53922/160005 [00:01<00:02, 48265.58it/s] 37%|███▋      | 58784/160005 [00:01<00:02, 47320.44it/s] 40%|███▉      | 63542/160005 [00:01<00:02, 42245.82it/s] 42%|████▏     | 67876/160005 [00:01<00:02, 41256.07it/s] 45%|████▌     | 72105/160005 [00:01<00:02, 41377.79it/s] 48%|████▊     | 77539/160005 [00:01<00:01, 44526.12it/s] 51%|█████▏    | 82044/160005 [00:01<00:01, 43880.93it/s] 55%|█████▍    | 87362/160005 [00:02<00:01, 46153.12it/s] 58%|█████▊    | 92169/160005 [00:02<00:01, 46335.25it/s] 61%|██████    | 96826/160005 [00:02<00:01, 45553.61it/s] 63%|██████▎   | 101574/160005 [00:02<00:01, 45944.12it/s] 66%|██████▋   | 106182/160005 [00:02<00:01, 44867.42it/s] 69%|██████▉   | 110770/160005 [00:02<00:01, 44654.09it/s] 72%|███████▏  | 115368/160005 [00:02<00:01, 44409.40it/s] 75%|███████▌  | 120384/160005 [00:02<00:00, 45870.93it/s] 78%|███████▊  | 124979/160005 [00:02<00:00, 45104.96it/s] 81%|████████  | 129496/160005 [00:03<00:00, 43422.88it/s] 84%|████████▍ | 134805/160005 [00:03<00:00, 46108.35it/s] 87%|████████▋ | 139438/160005 [00:03<00:00, 45069.47it/s] 91%|█████████ | 145255/160005 [00:03<00:00, 48791.83it/s] 94%|█████████▍| 150271/160005 [00:03<00:00, 48964.92it/s] 97%|█████████▋| 155287/160005 [00:03<00:00, 49144.71it/s]100%|██████████| 160005/160005 [00:03<00:00, 44240.71it/s]
The spherical harmonics array is 141.0 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 95.43045043945312 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 0.7125253238550789
