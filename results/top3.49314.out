Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.0001, 'pow_max': 0.00015000000000000001, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Making run folder: runs/E1_Lx_1.10_Ly_1.10_Lz_1.10_beta_90_alpha_90_l_max_20_accuracy_99_percent/
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.17it/s] 16%|█▌        | 3/19 [00:00<00:01, 10.59it/s] 26%|██▋       | 5/19 [00:00<00:01, 11.68it/s] 37%|███▋      | 7/19 [00:00<00:00, 12.32it/s] 47%|████▋     | 9/19 [00:00<00:00, 13.02it/s] 58%|█████▊    | 11/19 [00:00<00:00, 13.83it/s] 68%|██████▊   | 13/19 [00:00<00:00, 14.74it/s] 79%|███████▉  | 15/19 [00:01<00:00, 15.75it/s] 89%|████████▉ | 17/19 [00:01<00:00, 16.43it/s]100%|██████████| 19/19 [00:01<00:00, 14.62it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5563266 Minimum k_amp 0.00020658328967625562 n_x_max 110 n_z_max 110
Time to get list of k, phi, theta: 2.980076789855957 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0706865355710117
Ratio of unique |k|: 0.0018102675658507072
Time to get unique k and theta: 1.2683725357055664 seconds

Getting transfer functions
  0%|          | 0/10071 [00:00<?, ?it/s]  2%|▏         | 210/10071 [00:00<00:04, 2081.39it/s]  5%|▍         | 462/10071 [00:00<00:04, 2326.52it/s]  7%|▋         | 728/10071 [00:00<00:03, 2469.17it/s] 10%|▉         | 980/10071 [00:00<00:03, 2444.09it/s] 12%|█▏        | 1246/10071 [00:00<00:03, 2490.69it/s] 15%|█▌        | 1512/10071 [00:00<00:03, 2502.70it/s] 18%|█▊        | 1778/10071 [00:00<00:03, 2529.59it/s] 20%|██        | 2058/10071 [00:00<00:03, 2563.14it/s] 23%|██▎       | 2338/10071 [00:00<00:02, 2607.45it/s] 26%|██▌       | 2604/10071 [00:01<00:02, 2605.72it/s] 29%|██▉       | 2940/10071 [00:01<00:02, 2798.85it/s] 32%|███▏      | 3262/10071 [00:01<00:02, 2895.81it/s] 35%|███▌      | 3570/10071 [00:01<00:02, 2946.48it/s] 39%|███▉      | 3920/10071 [00:01<00:01, 3089.75it/s] 42%|████▏     | 4270/10071 [00:01<00:01, 3189.61it/s] 46%|████▌     | 4620/10071 [00:01<00:01, 3280.64it/s] 49%|████▉     | 4956/10071 [00:01<00:01, 3282.87it/s] 53%|█████▎    | 5292/10071 [00:01<00:01, 3305.10it/s] 56%|█████▌    | 5656/10071 [00:01<00:01, 3365.19it/s] 60%|█████▉    | 5993/10071 [00:02<00:01, 3297.02it/s] 63%|██████▎   | 6323/10071 [00:02<00:01, 2966.35it/s] 66%|██████▌   | 6626/10071 [00:02<00:01, 2962.09it/s] 69%|██████▉   | 6930/10071 [00:02<00:01, 2974.39it/s] 72%|███████▏  | 7266/10071 [00:02<00:00, 3059.31it/s] 76%|███████▌  | 7616/10071 [00:02<00:00, 3159.90it/s] 79%|███████▉  | 7966/10071 [00:02<00:00, 3237.80it/s] 83%|████████▎ | 8330/10071 [00:02<00:00, 3324.79it/s] 86%|████████▌ | 8680/10071 [00:02<00:00, 3354.06it/s] 90%|████████▉ | 9017/10071 [00:03<00:00, 3345.60it/s] 93%|█████████▎| 9353/10071 [00:03<00:00, 3342.91it/s] 96%|█████████▌| 9688/10071 [00:03<00:00, 3215.24it/s]100%|█████████▉| 10052/10071 [00:03<00:00, 3307.79it/s]100%|██████████| 10071/10071 [00:03<00:00, 3019.78it/s]
Size of transfer function: 1.61 MB. 

Size of integrand: 33.88 MB. Time to calculate integrand: 0.6257367134094238 s

Getting spherical harmonics
  0%|          | 0/393248 [00:00<?, ?it/s]  1%|▏         | 5130/393248 [00:00<00:08, 47410.29it/s]  3%|▎         | 10260/393248 [00:00<00:08, 46483.37it/s]  4%|▍         | 15390/393248 [00:00<00:08, 47200.69it/s]  5%|▌         | 20113/393248 [00:00<00:07, 47014.56it/s]  6%|▋         | 24815/393248 [00:00<00:07, 46144.11it/s]  8%|▊         | 29754/393248 [00:00<00:07, 46165.10it/s]  9%|▉         | 34884/393248 [00:00<00:07, 46850.49it/s] 10%|█         | 39569/393248 [00:00<00:08, 44072.68it/s] 11%|█         | 43999/393248 [00:00<00:07, 43719.23it/s] 12%|█▏        | 48735/393248 [00:01<00:07, 43505.51it/s] 14%|█▍        | 54378/393248 [00:01<00:07, 45729.89it/s] 15%|█▌        | 59508/393248 [00:01<00:07, 46898.62it/s] 16%|█▋        | 64638/393248 [00:01<00:06, 47196.79it/s] 18%|█▊        | 69364/393248 [00:01<00:06, 46694.88it/s] 19%|█▉        | 74036/393248 [00:01<00:06, 45616.18it/s] 20%|██        | 79002/393248 [00:01<00:06, 45284.24it/s] 21%|██▏       | 83619/393248 [00:01<00:07, 44146.34it/s] 23%|██▎       | 88749/393248 [00:01<00:06, 44961.18it/s] 24%|██▎       | 93248/393248 [00:02<00:06, 44798.92it/s] 25%|██▍       | 97729/393248 [00:02<00:06, 44607.96it/s] 26%|██▌       | 103113/393248 [00:02<00:06, 47165.26it/s] 28%|██▊       | 110808/393248 [00:02<00:05, 54597.30it/s] 30%|██▉       | 116964/393248 [00:02<00:04, 55862.82it/s] 31%|███▏      | 123120/393248 [00:02<00:04, 57371.11it/s] 33%|███▎      | 128855/393248 [00:02<00:04, 53761.27it/s] 34%|███▍      | 134919/393248 [00:02<00:04, 55553.14it/s] 36%|███▌      | 141588/393248 [00:02<00:04, 55907.78it/s] 38%|███▊      | 147744/393248 [00:03<00:04, 56654.89it/s] 39%|███▉      | 153429/393248 [00:03<00:04, 53835.53it/s] 41%|████      | 160056/393248 [00:03<00:04, 56255.26it/s] 42%|████▏     | 165711/393248 [00:03<00:04, 54423.74it/s] 44%|████▎     | 171855/393248 [00:03<00:03, 55952.71it/s] 45%|████▌     | 177476/393248 [00:03<00:03, 54723.70it/s] 47%|████▋     | 183141/393248 [00:03<00:03, 55122.47it/s] 48%|████▊     | 188668/393248 [00:03<00:03, 54394.31it/s] 49%|████▉     | 194427/393248 [00:03<00:03, 55022.21it/s] 51%|█████     | 201096/393248 [00:03<00:03, 57752.60it/s] 53%|█████▎    | 206879/393248 [00:04<00:03, 56273.66it/s] 54%|█████▍    | 213408/393248 [00:04<00:03, 58555.85it/s] 56%|█████▌    | 219277/393248 [00:04<00:03, 55060.98it/s] 57%|█████▋    | 224828/393248 [00:04<00:03, 53241.92it/s] 59%|█████▊    | 230187/393248 [00:04<00:03, 50062.79it/s] 60%|█████▉    | 235467/393248 [00:04<00:03, 49709.91it/s] 61%|██████▏   | 241110/393248 [00:04<00:02, 50990.44it/s] 63%|██████▎   | 246753/393248 [00:04<00:02, 51691.88it/s] 64%|██████▍   | 252396/393248 [00:04<00:02, 52592.91it/s] 66%|██████▌   | 258552/393248 [00:05<00:02, 54768.48it/s] 67%|██████▋   | 264195/393248 [00:05<00:02, 54786.29it/s] 69%|██████▊   | 270351/393248 [00:05<00:02, 55437.12it/s] 70%|███████   | 275994/393248 [00:05<00:02, 54319.51it/s] 72%|███████▏  | 283689/393248 [00:05<00:01, 59399.57it/s] 74%|███████▎  | 289630/393248 [00:05<00:01, 55735.20it/s] 75%|███████▌  | 295238/393248 [00:05<00:01, 52820.59it/s] 76%|███████▋  | 300618/393248 [00:05<00:01, 52067.74it/s] 78%|███████▊  | 306774/393248 [00:05<00:01, 54150.17it/s] 80%|███████▉  | 312930/393248 [00:06<00:01, 55321.25it/s] 81%|████████▏ | 319599/393248 [00:06<00:01, 58273.57it/s] 83%|████████▎ | 325457/393248 [00:06<00:01, 58057.51it/s] 84%|████████▍ | 331284/393248 [00:06<00:01, 57082.95it/s] 86%|████████▌ | 337305/393248 [00:06<00:00, 57973.59it/s] 87%|████████▋ | 343117/393248 [00:06<00:00, 56256.43it/s] 89%|████████▉ | 349866/393248 [00:06<00:00, 58454.88it/s] 91%|█████████ | 356535/393248 [00:06<00:00, 60051.47it/s] 92%|█████████▏| 362550/393248 [00:06<00:00, 59578.07it/s] 94%|█████████▎| 368514/393248 [00:07<00:00, 56373.47it/s] 95%|█████████▌| 374184/393248 [00:07<00:00, 55362.27it/s] 97%|█████████▋| 380646/393248 [00:07<00:00, 57263.33it/s] 98%|█████████▊| 386393/393248 [00:07<00:00, 56805.51it/s]100%|█████████▉| 392958/393248 [00:07<00:00, 57581.49it/s]100%|██████████| 393248/393248 [00:07<00:00, 52906.70it/s]
The spherical harmonics array is 346.53 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 29.601216793060303 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 1.7064847670581822
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.0002, 'pow_max': 0.00025, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 14.55it/s] 21%|██        | 4/19 [00:00<00:00, 15.91it/s] 32%|███▏      | 6/19 [00:00<00:00, 16.89it/s] 42%|████▏     | 8/19 [00:00<00:00, 17.89it/s] 58%|█████▊    | 11/19 [00:00<00:00, 19.53it/s] 74%|███████▎  | 14/19 [00:00<00:00, 21.00it/s] 89%|████████▉ | 17/19 [00:00<00:00, 22.05it/s]100%|██████████| 19/19 [00:00<00:00, 20.26it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5563266 Minimum k_amp 0.00020658328967625562 n_x_max 110 n_z_max 110
Time to get list of k, phi, theta: 0.6021382808685303 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0706865355710117
Ratio of unique |k|: 0.0018102675658507072
Time to get unique k and theta: 1.3274903297424316 seconds

Getting transfer functions
  0%|          | 0/10071 [00:00<?, ?it/s]  2%|▏         | 182/10071 [00:00<00:05, 1783.52it/s]  4%|▍         | 392/10071 [00:00<00:05, 1933.91it/s]  6%|▌         | 602/10071 [00:00<00:04, 1999.13it/s]  8%|▊         | 840/10071 [00:00<00:04, 2103.10it/s] 11%|█         | 1078/10071 [00:00<00:04, 2166.88it/s] 13%|█▎        | 1302/10071 [00:00<00:04, 2184.45it/s] 15%|█▌        | 1521/10071 [00:00<00:03, 2165.75it/s] 17%|█▋        | 1738/10071 [00:00<00:03, 2105.79it/s] 19%|█▉        | 1949/10071 [00:00<00:03, 2093.24it/s] 21%|██▏       | 2159/10071 [00:01<00:03, 2063.54it/s] 23%|██▎       | 2366/10071 [00:01<00:03, 2015.62it/s] 25%|██▌       | 2568/10071 [00:01<00:03, 2012.28it/s] 28%|██▊       | 2814/10071 [00:01<00:03, 2114.60it/s] 32%|███▏      | 3178/10071 [00:01<00:02, 2541.61it/s] 35%|███▌      | 3528/10071 [00:01<00:02, 2804.02it/s] 39%|███▊      | 3892/10071 [00:01<00:02, 3038.80it/s] 42%|████▏     | 4256/10071 [00:01<00:01, 3182.46it/s] 46%|████▌     | 4606/10071 [00:01<00:01, 3267.42it/s] 49%|████▉     | 4984/10071 [00:01<00:01, 3391.02it/s] 53%|█████▎    | 5362/10071 [00:02<00:01, 3473.65it/s] 57%|█████▋    | 5726/10071 [00:02<00:01, 3494.68it/s] 61%|██████    | 6104/10071 [00:02<00:01, 3538.00it/s] 65%|██████▍   | 6524/10071 [00:02<00:00, 3728.25it/s] 69%|██████▊   | 6916/10071 [00:02<00:00, 3760.01it/s] 72%|███████▏  | 7293/10071 [00:02<00:00, 3760.35it/s] 76%|███████▌  | 7670/10071 [00:02<00:00, 3725.22it/s] 80%|███████▉  | 8043/10071 [00:02<00:00, 3598.24it/s] 83%|████████▎ | 8404/10071 [00:02<00:00, 3465.26it/s] 87%|████████▋ | 8752/10071 [00:03<00:00, 3424.85it/s] 90%|█████████ | 9100/10071 [00:03<00:00, 3425.87it/s] 94%|█████████▍| 9450/10071 [00:03<00:00, 3422.10it/s] 97%|█████████▋| 9800/10071 [00:03<00:00, 3406.37it/s]100%|██████████| 10071/10071 [00:03<00:00, 2969.65it/s]
Size of transfer function: 1.61 MB. 

Size of integrand: 33.88 MB. Time to calculate integrand: 0.01704263687133789 s

Getting spherical harmonics
  0%|          | 0/393248 [00:00<?, ?it/s]  1%|          | 4617/393248 [00:00<00:08, 44319.11it/s]  2%|▏         | 9747/393248 [00:00<00:08, 46745.75it/s]  4%|▎         | 14420/393248 [00:00<00:08, 44675.42it/s]  5%|▍         | 18981/393248 [00:00<00:08, 44375.74it/s]  6%|▌         | 23421/393248 [00:00<00:08, 44314.59it/s]  7%|▋         | 27854/393248 [00:00<00:08, 43723.66it/s]  8%|▊         | 32832/393248 [00:00<00:08, 44419.25it/s]  9%|▉         | 37273/393248 [00:00<00:08, 42617.91it/s] 11%|█         | 41543/393248 [00:00<00:08, 41819.61it/s] 12%|█▏        | 45730/393248 [00:01<00:08, 41068.68it/s] 13%|█▎        | 49840/393248 [00:01<00:08, 39375.63it/s] 14%|█▍        | 54891/393248 [00:01<00:07, 42425.65it/s] 15%|█▌        | 59506/393248 [00:01<00:07, 43499.78it/s] 16%|█▋        | 64125/393248 [00:01<00:07, 43600.40it/s] 17%|█▋        | 68501/393248 [00:01<00:07, 43160.30it/s] 19%|█▊        | 72828/393248 [00:01<00:07, 42889.45it/s] 20%|█▉        | 77124/393248 [00:01<00:08, 39340.85it/s] 21%|██        | 81567/393248 [00:01<00:07, 39998.33it/s] 22%|██▏       | 86697/393248 [00:02<00:07, 42164.21it/s] 23%|██▎       | 91827/393248 [00:02<00:06, 44321.06it/s] 25%|██▍       | 96444/393248 [00:02<00:06, 44669.93it/s] 26%|██▌       | 101574/393248 [00:02<00:06, 46345.03it/s] 27%|██▋       | 107730/393248 [00:02<00:05, 49668.51it/s] 29%|██▊       | 112860/393248 [00:02<00:05, 49683.78it/s] 31%|███       | 120555/393248 [00:02<00:04, 55990.37it/s] 32%|███▏      | 127224/393248 [00:02<00:04, 59032.33it/s] 34%|███▍      | 133130/393248 [00:02<00:04, 58499.87it/s] 36%|███▌      | 140049/393248 [00:02<00:04, 61202.47it/s] 37%|███▋      | 146174/393248 [00:03<00:04, 61199.23it/s] 39%|███▊      | 152297/393248 [00:03<00:04, 58782.97it/s] 40%|████      | 158195/393248 [00:03<00:04, 57580.86it/s] 42%|████▏     | 163968/393248 [00:03<00:03, 57589.47it/s] 43%|████▎     | 169803/393248 [00:03<00:03, 56711.57it/s] 45%|████▍     | 176472/393248 [00:03<00:03, 59027.48it/s] 46%|████▋     | 182384/393248 [00:03<00:03, 56285.31it/s] 48%|████▊     | 188784/393248 [00:03<00:03, 57011.67it/s] 49%|████▉     | 194504/393248 [00:03<00:03, 54462.91it/s] 51%|█████     | 200070/393248 [00:04<00:03, 54193.78it/s] 52%|█████▏    | 205713/393248 [00:04<00:03, 53969.06it/s] 54%|█████▎    | 211356/393248 [00:04<00:03, 53174.55it/s] 55%|█████▌    | 216683/393248 [00:04<00:03, 49724.73it/s] 56%|█████▋    | 222129/393248 [00:04<00:03, 50897.22it/s] 58%|█████▊    | 227259/393248 [00:04<00:03, 50176.61it/s] 59%|█████▉    | 232389/393248 [00:04<00:03, 49356.60it/s] 61%|██████    | 238545/393248 [00:04<00:02, 52275.99it/s] 62%|██████▏   | 244188/393248 [00:04<00:02, 52625.63it/s] 63%|██████▎   | 249466/393248 [00:05<00:02, 51701.82it/s] 65%|██████▍   | 254961/393248 [00:05<00:02, 51760.31it/s] 67%|██████▋   | 262143/393248 [00:05<00:02, 56775.81it/s] 68%|██████▊   | 268299/393248 [00:05<00:02, 56521.77it/s] 70%|██████▉   | 273960/393248 [00:05<00:02, 53853.16it/s] 71%|███████   | 280098/393248 [00:05<00:02, 55751.85it/s] 73%|███████▎  | 287280/393248 [00:05<00:01, 59546.46it/s] 75%|███████▍  | 293949/393248 [00:05<00:01, 59089.98it/s] 76%|███████▋  | 300105/393248 [00:05<00:01, 58404.25it/s] 78%|███████▊  | 305960/393248 [00:05<00:01, 58335.13it/s] 79%|███████▉  | 311804/393248 [00:06<00:01, 58100.44it/s] 81%|████████  | 317620/393248 [00:06<00:01, 55278.06it/s] 82%|████████▏ | 323190/393248 [00:06<00:01, 54939.61it/s] 84%|████████▍ | 329346/393248 [00:06<00:01, 56503.13it/s] 85%|████████▌ | 335502/393248 [00:06<00:01, 57680.47it/s] 87%|████████▋ | 341286/393248 [00:06<00:00, 57133.09it/s] 88%|████████▊ | 347010/393248 [00:06<00:00, 56028.17it/s] 90%|████████▉ | 352622/393248 [00:06<00:00, 54656.13it/s] 91%|█████████ | 358098/393248 [00:06<00:00, 54348.31it/s] 92%|█████████▏| 363717/393248 [00:07<00:00, 53879.47it/s] 94%|█████████▍| 371412/393248 [00:07<00:00, 59688.61it/s] 96%|█████████▋| 378594/393248 [00:07<00:00, 61320.95it/s] 98%|█████████▊| 384750/393248 [00:07<00:00, 60980.09it/s] 99%|█████████▉| 390846/393248 [00:07<00:00, 59396.57it/s]100%|██████████| 393248/393248 [00:07<00:00, 52199.25it/s]
The spherical harmonics array is 346.53 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 51.87244248390198 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 1.7882612485705975
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.0003, 'pow_max': 0.00035, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 18.72it/s] 26%|██▋       | 5/19 [00:00<00:00, 20.12it/s] 42%|████▏     | 8/19 [00:00<00:00, 21.30it/s] 58%|█████▊    | 11/19 [00:00<00:00, 22.09it/s] 74%|███████▎  | 14/19 [00:00<00:00, 22.54it/s] 89%|████████▉ | 17/19 [00:00<00:00, 22.82it/s]100%|██████████| 19/19 [00:00<00:00, 22.24it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5563266 Minimum k_amp 0.00020658328967625562 n_x_max 110 n_z_max 110
Time to get list of k, phi, theta: 0.5829043388366699 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0706865355710117
Ratio of unique |k|: 0.0018102675658507072
Time to get unique k and theta: 1.2738780975341797 seconds

Getting transfer functions
  0%|          | 0/10071 [00:00<?, ?it/s]  1%|          | 84/10071 [00:00<00:12, 804.12it/s]  3%|▎         | 308/10071 [00:00<00:06, 1571.86it/s]  5%|▌         | 546/10071 [00:00<00:05, 1895.71it/s]  8%|▊         | 784/10071 [00:00<00:04, 2050.49it/s] 10%|█         | 1036/10071 [00:00<00:04, 2175.39it/s] 12%|█▏        | 1254/10071 [00:00<00:04, 2164.11it/s] 15%|█▍        | 1484/10071 [00:00<00:03, 2200.82it/s] 17%|█▋        | 1736/10071 [00:00<00:03, 2281.76it/s] 20%|█▉        | 1974/10071 [00:00<00:03, 2311.68it/s] 22%|██▏       | 2212/10071 [00:01<00:03, 2329.41it/s] 24%|██▍       | 2450/10071 [00:01<00:03, 2339.10it/s] 27%|██▋       | 2684/10071 [00:01<00:03, 2306.89it/s] 30%|██▉       | 3010/10071 [00:01<00:02, 2586.97it/s] 33%|███▎      | 3332/10071 [00:01<00:02, 2767.01it/s] 36%|███▋      | 3668/10071 [00:01<00:02, 2936.45it/s] 40%|███▉      | 3990/10071 [00:01<00:02, 2990.96it/s] 43%|████▎     | 4326/10071 [00:01<00:01, 3077.55it/s] 46%|████▋     | 4662/10071 [00:01<00:01, 3140.32it/s] 49%|████▉     | 4978/10071 [00:01<00:01, 3134.95it/s] 53%|█████▎    | 5292/10071 [00:02<00:01, 3086.08it/s] 56%|█████▌    | 5628/10071 [00:02<00:01, 3151.45it/s] 60%|█████▉    | 6020/10071 [00:02<00:01, 3347.31it/s] 63%|██████▎   | 6356/10071 [00:02<00:01, 3320.23it/s] 66%|██████▋   | 6689/10071 [00:02<00:01, 3258.18it/s] 70%|██████▉   | 7016/10071 [00:02<00:00, 3256.32it/s] 73%|███████▎  | 7364/10071 [00:02<00:00, 3314.46it/s] 77%|███████▋  | 7714/10071 [00:02<00:00, 3345.18it/s] 80%|████████  | 8064/10071 [00:02<00:00, 3355.52it/s] 84%|████████▍ | 8442/10071 [00:02<00:00, 3448.97it/s] 87%|████████▋ | 8787/10071 [00:03<00:00, 3403.49it/s] 91%|█████████ | 9128/10071 [00:03<00:00, 3288.74it/s] 94%|█████████▍| 9458/10071 [00:03<00:00, 3260.02it/s] 97%|█████████▋| 9786/10071 [00:03<00:00, 3236.28it/s]100%|██████████| 10071/10071 [00:03<00:00, 2889.63it/s]
Size of transfer function: 1.61 MB. 

Size of integrand: 33.88 MB. Time to calculate integrand: 0.01761031150817871 s

Getting spherical harmonics
  0%|          | 0/393248 [00:00<?, ?it/s]  1%|▏         | 4976/393248 [00:00<00:07, 49754.35it/s]  3%|▎         | 9952/393248 [00:00<00:07, 48891.58it/s]  4%|▍         | 14877/393248 [00:00<00:07, 48086.39it/s]  5%|▌         | 19688/393248 [00:00<00:08, 45011.10it/s]  6%|▌         | 24214/393248 [00:00<00:12, 30027.84it/s]  7%|▋         | 28215/393248 [00:00<00:11, 31974.23it/s]  8%|▊         | 32832/393248 [00:00<00:10, 35583.13it/s] 10%|▉         | 37962/393248 [00:00<00:08, 39572.41it/s] 11%|█         | 42579/393248 [00:01<00:08, 40423.03it/s] 12%|█▏        | 46855/393248 [00:01<00:08, 40962.85it/s] 13%|█▎        | 51300/393248 [00:01<00:08, 41640.53it/s] 14%|█▍        | 55917/393248 [00:01<00:07, 42672.23it/s] 15%|█▌        | 60534/393248 [00:01<00:07, 42246.01it/s] 17%|█▋        | 65151/393248 [00:01<00:07, 42115.06it/s] 18%|█▊        | 69407/393248 [00:01<00:07, 42044.18it/s] 19%|█▉        | 73872/393248 [00:01<00:07, 42397.73it/s] 20%|██        | 79515/393248 [00:01<00:06, 45550.71it/s] 22%|██▏       | 85671/393248 [00:02<00:06, 49224.92it/s] 23%|██▎       | 90602/393248 [00:02<00:06, 48918.13it/s] 24%|██▍       | 95499/393248 [00:02<00:06, 48183.22it/s] 26%|██▌       | 100321/393248 [00:02<00:06, 47921.89it/s] 27%|██▋       | 106191/393248 [00:02<00:05, 50361.54it/s] 29%|██▊       | 112347/393248 [00:02<00:05, 52991.04it/s] 30%|██▉       | 117753/393248 [00:02<00:05, 53300.91it/s] 31%|███▏      | 123633/393248 [00:02<00:05, 53698.57it/s] 33%|███▎      | 129003/393248 [00:02<00:04, 53613.55it/s] 35%|███▍      | 136458/393248 [00:02<00:04, 59643.86it/s] 36%|███▌      | 142434/393248 [00:03<00:04, 56953.57it/s] 38%|███▊      | 148770/393248 [00:03<00:04, 58728.32it/s] 39%|███▉      | 154672/393248 [00:03<00:04, 58168.14it/s] 41%|████      | 160509/393248 [00:03<00:04, 52511.37it/s] 42%|████▏     | 165869/393248 [00:03<00:04, 52259.04it/s] 44%|████▎     | 171170/393248 [00:03<00:04, 49442.29it/s] 45%|████▌     | 177498/393248 [00:03<00:04, 52585.02it/s] 47%|████▋     | 184167/393248 [00:03<00:03, 56126.95it/s] 48%|████▊     | 189851/393248 [00:03<00:03, 55923.01it/s] 50%|████▉     | 195492/393248 [00:04<00:04, 46996.99it/s] 51%|█████     | 200583/393248 [00:04<00:04, 47266.76it/s] 52%|█████▏    | 206226/393248 [00:04<00:03, 49374.75it/s] 54%|█████▍    | 211869/393248 [00:04<00:03, 49585.05it/s] 55%|█████▌    | 217512/393248 [00:04<00:03, 51144.96it/s] 57%|█████▋    | 223155/393248 [00:04<00:03, 52497.17it/s] 59%|█████▊    | 230337/393248 [00:04<00:02, 57248.93it/s] 60%|██████    | 237006/393248 [00:04<00:02, 59529.23it/s] 62%|██████▏   | 243162/393248 [00:04<00:02, 59640.47it/s] 63%|██████▎   | 249318/393248 [00:05<00:02, 59948.72it/s] 65%|██████▌   | 255987/393248 [00:05<00:02, 61537.39it/s] 67%|██████▋   | 262160/393248 [00:05<00:02, 61219.89it/s] 68%|██████▊   | 268812/393248 [00:05<00:02, 60068.05it/s] 70%|██████▉   | 274837/393248 [00:05<00:02, 59030.23it/s] 71%|███████▏  | 280753/393248 [00:05<00:02, 55758.54it/s] 73%|███████▎  | 286365/393248 [00:05<00:02, 51881.83it/s] 75%|███████▍  | 293436/393248 [00:05<00:01, 56803.16it/s] 76%|███████▌  | 299209/393248 [00:05<00:01, 55661.23it/s] 78%|███████▊  | 306774/393248 [00:06<00:01, 60407.49it/s] 80%|███████▉  | 312878/393248 [00:06<00:01, 59983.24it/s] 81%|████████  | 319086/393248 [00:06<00:01, 58915.06it/s] 83%|████████▎ | 325755/393248 [00:06<00:01, 61059.61it/s] 85%|████████▍ | 332424/393248 [00:06<00:01, 60034.39it/s] 86%|████████▌ | 339093/393248 [00:06<00:00, 61256.33it/s] 88%|████████▊ | 345762/393248 [00:06<00:00, 61525.46it/s] 89%|████████▉ | 351932/393248 [00:06<00:00, 56753.87it/s] 91%|█████████ | 357678/393248 [00:06<00:00, 55462.69it/s] 92%|█████████▏| 363270/393248 [00:07<00:00, 55171.84it/s] 94%|█████████▍| 369873/393248 [00:07<00:00, 57626.07it/s] 96%|█████████▌| 375667/393248 [00:07<00:00, 53698.36it/s] 97%|█████████▋| 381672/393248 [00:07<00:00, 55340.86it/s] 99%|█████████▊| 387828/393248 [00:07<00:00, 56270.81it/s]100%|██████████| 393248/393248 [00:07<00:00, 52021.71it/s]
The spherical harmonics array is 346.53 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 67.33021259307861 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 1.7659497708630671
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.0004, 'pow_max': 0.00045000000000000004, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 14.16it/s] 21%|██        | 4/19 [00:00<00:00, 16.15it/s] 32%|███▏      | 6/19 [00:00<00:00, 17.27it/s] 47%|████▋     | 9/19 [00:00<00:00, 19.04it/s] 63%|██████▎   | 12/19 [00:00<00:00, 20.27it/s] 79%|███████▉  | 15/19 [00:00<00:00, 21.26it/s] 95%|█████████▍| 18/19 [00:00<00:00, 21.68it/s]100%|██████████| 19/19 [00:00<00:00, 20.18it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5563266 Minimum k_amp 0.00020658328967625562 n_x_max 110 n_z_max 110
Time to get list of k, phi, theta: 0.6624810695648193 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0706865355710117
Ratio of unique |k|: 0.0018102675658507072
Time to get unique k and theta: 1.3467903137207031 seconds

Getting transfer functions
  0%|          | 0/10071 [00:00<?, ?it/s]  1%|          | 84/10071 [00:00<00:12, 784.63it/s]  3%|▎         | 308/10071 [00:00<00:06, 1612.88it/s]  5%|▌         | 546/10071 [00:00<00:04, 1936.91it/s]  8%|▊         | 798/10071 [00:00<00:04, 2146.84it/s] 10%|█         | 1036/10071 [00:00<00:04, 2207.46it/s] 13%|█▎        | 1288/10071 [00:00<00:03, 2282.84it/s] 15%|█▌        | 1526/10071 [00:00<00:03, 2271.98it/s] 18%|█▊        | 1764/10071 [00:00<00:03, 2269.09it/s] 20%|██        | 2016/10071 [00:00<00:03, 2339.49it/s] 23%|██▎       | 2296/10071 [00:01<00:03, 2430.29it/s] 25%|██▌       | 2540/10071 [00:01<00:03, 2388.42it/s] 28%|██▊       | 2800/10071 [00:01<00:02, 2425.39it/s] 31%|███▏      | 3150/10071 [00:01<00:02, 2735.61it/s] 34%|███▍      | 3472/10071 [00:01<00:02, 2865.36it/s] 38%|███▊      | 3794/10071 [00:01<00:02, 2962.08it/s] 41%|████      | 4130/10071 [00:01<00:01, 3045.74it/s] 44%|████▍     | 4480/10071 [00:01<00:01, 3153.98it/s] 48%|████▊     | 4816/10071 [00:01<00:01, 3199.58it/s] 51%|█████     | 5152/10071 [00:01<00:01, 3204.51it/s] 54%|█████▍    | 5488/10071 [00:02<00:01, 3244.16it/s] 58%|█████▊    | 5838/10071 [00:02<00:01, 3284.68it/s] 61%|██████▏   | 6188/10071 [00:02<00:01, 3308.71it/s] 65%|██████▍   | 6519/10071 [00:02<00:01, 3261.39it/s] 68%|██████▊   | 6860/10071 [00:02<00:00, 3300.54it/s] 72%|███████▏  | 7210/10071 [00:02<00:00, 3334.19it/s] 75%|███████▌  | 7574/10071 [00:02<00:00, 3414.70it/s] 79%|███████▉  | 7938/10071 [00:02<00:00, 3430.76it/s] 82%|████████▏ | 8282/10071 [00:02<00:00, 3355.53it/s] 86%|████████▌ | 8618/10071 [00:02<00:00, 3346.65it/s] 89%|████████▉ | 8988/10071 [00:03<00:00, 3442.02it/s] 93%|█████████▎| 9333/10071 [00:03<00:00, 3386.82it/s] 96%|█████████▌| 9674/10071 [00:03<00:00, 3365.74it/s]100%|█████████▉| 10024/10071 [00:03<00:00, 3400.51it/s]100%|██████████| 10071/10071 [00:03<00:00, 2948.19it/s]
Size of transfer function: 1.61 MB. 

Size of integrand: 33.88 MB. Time to calculate integrand: 0.025519371032714844 s

Getting spherical harmonics
  0%|          | 0/393248 [00:00<?, ?it/s]  1%|▏         | 5130/393248 [00:00<00:07, 49311.39it/s]  3%|▎         | 10773/393248 [00:00<00:07, 51286.16it/s]  4%|▍         | 15900/393248 [00:00<00:07, 48332.74it/s]  5%|▌         | 20744/393248 [00:00<00:07, 46688.47it/s]  7%|▋         | 25650/393248 [00:00<00:07, 46430.59it/s]  8%|▊         | 30780/393248 [00:00<00:07, 46997.27it/s]  9%|▉         | 35483/393248 [00:00<00:08, 44432.15it/s] 10%|█         | 39944/393248 [00:00<00:08, 41485.72it/s] 11%|█         | 44126/393248 [00:01<00:08, 40346.72it/s] 13%|█▎        | 49248/393248 [00:01<00:08, 41754.01it/s] 14%|█▎        | 53437/393248 [00:01<00:08, 41468.04it/s] 15%|█▍        | 57969/393248 [00:01<00:08, 41659.70it/s] 16%|█▌        | 62141/393248 [00:01<00:08, 37919.57it/s] 17%|█▋        | 67203/393248 [00:01<00:08, 40594.80it/s] 18%|█▊        | 71820/393248 [00:01<00:07, 40365.98it/s] 19%|█▉        | 76437/393248 [00:01<00:07, 40633.77it/s] 21%|██        | 81567/393248 [00:01<00:07, 41703.42it/s] 22%|██▏       | 85756/393248 [00:02<00:07, 40304.55it/s] 23%|██▎       | 89798/393248 [00:02<00:07, 40194.55it/s] 24%|██▍       | 93879/393248 [00:02<00:07, 39923.56it/s] 25%|██▌       | 98592/393248 [00:02<00:07, 41965.77it/s] 27%|██▋       | 104652/393248 [00:02<00:06, 47019.47it/s] 28%|██▊       | 110808/393248 [00:02<00:05, 50550.63it/s] 29%|██▉       | 115879/393248 [00:02<00:05, 50390.17it/s] 31%|███       | 121068/393248 [00:02<00:05, 49230.09it/s] 32%|███▏      | 126004/393248 [00:02<00:05, 48291.02it/s] 34%|███▍      | 132867/393248 [00:02<00:04, 53197.85it/s] 35%|███▌      | 138510/393248 [00:03<00:04, 53703.08it/s] 37%|███▋      | 143887/393248 [00:03<00:04, 51820.29it/s] 38%|███▊      | 149283/393248 [00:03<00:04, 49862.44it/s] 40%|███▉      | 155952/393248 [00:03<00:04, 53736.76it/s] 41%|████      | 162108/393248 [00:03<00:04, 54725.99it/s] 43%|████▎     | 167751/393248 [00:03<00:04, 53736.93it/s] 44%|████▍     | 173140/393248 [00:03<00:04, 53748.75it/s] 46%|████▌     | 179037/393248 [00:03<00:04, 53258.93it/s] 47%|████▋     | 184373/393248 [00:03<00:03, 52976.09it/s] 48%|████▊     | 189676/393248 [00:04<00:03, 51038.19it/s] 50%|████▉     | 194940/393248 [00:04<00:03, 50741.06it/s] 51%|█████     | 200070/393248 [00:04<00:03, 50159.13it/s] 52%|█████▏    | 205091/393248 [00:04<00:04, 43317.22it/s] 54%|█████▎    | 211356/393248 [00:04<00:03, 47668.95it/s] 56%|█████▌    | 219051/393248 [00:04<00:03, 54627.39it/s] 57%|█████▋    | 224669/393248 [00:04<00:03, 52964.18it/s] 59%|█████▊    | 230075/393248 [00:04<00:03, 48329.95it/s] 60%|█████▉    | 235040/393248 [00:04<00:03, 46362.03it/s] 61%|██████    | 239767/393248 [00:05<00:03, 44975.79it/s] 62%|██████▏   | 244323/393248 [00:05<00:03, 43697.45it/s] 64%|██████▍   | 251370/393248 [00:05<00:02, 49893.13it/s] 65%|██████▌   | 256500/393248 [00:05<00:02, 50087.47it/s] 67%|██████▋   | 262143/393248 [00:05<00:02, 50979.56it/s] 68%|██████▊   | 268299/393248 [00:05<00:02, 52320.49it/s] 70%|██████▉   | 273553/393248 [00:05<00:02, 51659.65it/s] 71%|███████   | 279072/393248 [00:05<00:02, 52338.90it/s] 72%|███████▏  | 284318/393248 [00:05<00:02, 49044.71it/s] 74%|███████▎  | 289332/393248 [00:06<00:02, 48757.15it/s] 75%|███████▌  | 294975/393248 [00:06<00:01, 50164.51it/s] 77%|███████▋  | 302139/393248 [00:06<00:01, 56256.54it/s] 79%|███████▊  | 308826/393248 [00:06<00:01, 58261.23it/s] 80%|████████  | 314687/393248 [00:06<00:01, 57177.55it/s] 81%|████████▏ | 320431/393248 [00:06<00:01, 53584.39it/s] 83%|████████▎ | 325843/393248 [00:06<00:01, 53559.64it/s] 84%|████████▍ | 331911/393248 [00:06<00:01, 55017.02it/s] 86%|████████▌ | 337444/393248 [00:06<00:01, 54594.24it/s] 87%|████████▋ | 343710/393248 [00:07<00:00, 55730.47it/s] 89%|████████▉ | 350379/393248 [00:07<00:00, 57836.57it/s] 91%|█████████ | 356172/393248 [00:07<00:00, 57598.65it/s] 92%|█████████▏| 361938/393248 [00:07<00:00, 49235.00it/s] 94%|█████████▎| 367821/393248 [00:07<00:00, 51127.80it/s] 95%|█████████▌| 374490/393248 [00:07<00:00, 54140.43it/s] 97%|█████████▋| 381672/393248 [00:07<00:00, 58610.54it/s] 99%|█████████▊| 387828/393248 [00:07<00:00, 58350.26it/s]100%|██████████| 393248/393248 [00:07<00:00, 49606.63it/s]
The spherical harmonics array is 346.53 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 84.55643725395203 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 1.8085512785232938
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.0005, 'pow_max': 0.00055, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 13.26it/s] 21%|██        | 4/19 [00:00<00:01, 13.87it/s] 32%|███▏      | 6/19 [00:00<00:00, 14.55it/s] 42%|████▏     | 8/19 [00:00<00:00, 15.42it/s] 53%|█████▎    | 10/19 [00:00<00:00, 15.96it/s] 63%|██████▎   | 12/19 [00:00<00:00, 17.13it/s] 79%|███████▉  | 15/19 [00:00<00:00, 18.82it/s] 95%|█████████▍| 18/19 [00:01<00:00, 19.68it/s]100%|██████████| 19/19 [00:01<00:00, 17.63it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5563266 Minimum k_amp 0.00020658328967625562 n_x_max 110 n_z_max 110
Time to get list of k, phi, theta: 0.6872808933258057 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0706865355710117
Ratio of unique |k|: 0.0018102675658507072
Time to get unique k and theta: 1.4944472312927246 seconds

Getting transfer functions
  0%|          | 0/10071 [00:00<?, ?it/s]  0%|          | 14/10071 [00:00<01:48, 92.87it/s]  2%|▏         | 224/10071 [00:00<00:09, 1060.91it/s]  4%|▍         | 434/10071 [00:00<00:06, 1468.47it/s]  7%|▋         | 658/10071 [00:00<00:05, 1736.42it/s]  9%|▉         | 896/10071 [00:00<00:04, 1953.82it/s] 11%|█         | 1120/10071 [00:00<00:04, 2032.24it/s] 13%|█▎        | 1329/10071 [00:00<00:05, 1701.97it/s] 16%|█▌        | 1568/10071 [00:00<00:04, 1871.09it/s] 18%|█▊        | 1778/10071 [00:01<00:04, 1914.88it/s] 20%|█▉        | 1988/10071 [00:01<00:04, 1955.82it/s] 22%|██▏       | 2212/10071 [00:01<00:03, 2007.22it/s] 24%|██▍       | 2436/10071 [00:01<00:03, 2043.52it/s] 26%|██▋       | 2646/10071 [00:01<00:03, 2036.41it/s] 29%|██▉       | 2940/10071 [00:01<00:03, 2281.76it/s] 32%|███▏      | 3234/10071 [00:01<00:02, 2448.68it/s] 35%|███▌      | 3570/10071 [00:01<00:02, 2693.35it/s] 38%|███▊      | 3864/10071 [00:01<00:02, 2765.07it/s] 41%|████▏     | 4158/10071 [00:01<00:02, 2806.43it/s] 44%|████▍     | 4466/10071 [00:02<00:01, 2871.47it/s] 47%|████▋     | 4774/10071 [00:02<00:01, 2909.30it/s] 50%|█████     | 5066/10071 [00:02<00:01, 2801.08it/s] 53%|█████▎    | 5348/10071 [00:02<00:01, 2774.97it/s] 56%|█████▌    | 5656/10071 [00:02<00:01, 2848.50it/s] 59%|█████▉    | 5964/10071 [00:02<00:01, 2887.04it/s] 62%|██████▏   | 6286/10071 [00:02<00:01, 2963.10it/s] 65%|██████▌   | 6594/10071 [00:02<00:01, 2988.51it/s] 69%|██████▉   | 6930/10071 [00:02<00:01, 3083.82it/s] 72%|███████▏  | 7252/10071 [00:02<00:00, 3096.91it/s] 75%|███████▌  | 7562/10071 [00:03<00:00, 3055.26it/s] 78%|███████▊  | 7896/10071 [00:03<00:00, 3110.90it/s] 82%|████████▏ | 8208/10071 [00:03<00:00, 3100.67it/s] 85%|████████▍ | 8519/10071 [00:03<00:00, 3083.59it/s] 88%|████████▊ | 8828/10071 [00:03<00:00, 2982.95it/s] 91%|█████████ | 9128/10071 [00:03<00:00, 2977.92it/s] 94%|█████████▎| 9427/10071 [00:03<00:00, 2500.23it/s] 97%|█████████▋| 9772/10071 [00:03<00:00, 2733.11it/s]100%|██████████| 10071/10071 [00:03<00:00, 2534.69it/s]
Size of transfer function: 1.61 MB. 

Size of integrand: 33.88 MB. Time to calculate integrand: 0.02463507652282715 s

Getting spherical harmonics
  0%|          | 0/393248 [00:00<?, ?it/s]  0%|          | 513/393248 [00:00<01:35, 4101.34it/s]  1%|▏         | 5643/393248 [00:00<00:13, 28429.56it/s]  2%|▏         | 9747/393248 [00:00<00:11, 33477.96it/s]  4%|▎         | 14364/393248 [00:00<00:11, 34272.06it/s]  5%|▍         | 18981/393248 [00:00<00:10, 36983.42it/s]  6%|▌         | 23085/393248 [00:00<00:09, 37255.42it/s]  7%|▋         | 27189/393248 [00:00<00:09, 38360.04it/s]  8%|▊         | 31806/393248 [00:00<00:09, 38796.60it/s]  9%|▉         | 36423/393248 [00:00<00:08, 40934.11it/s] 10%|█         | 41040/393248 [00:01<00:08, 41531.69it/s] 12%|█▏        | 45657/393248 [00:01<00:08, 41338.64it/s] 13%|█▎        | 49807/393248 [00:01<00:08, 40282.77it/s] 14%|█▎        | 53865/393248 [00:01<00:08, 39552.73it/s] 15%|█▍        | 57828/393248 [00:01<00:08, 38639.13it/s] 16%|█▌        | 62140/393248 [00:01<00:08, 39911.60it/s] 17%|█▋        | 66690/393248 [00:01<00:07, 40828.71it/s] 18%|█▊        | 71307/393248 [00:01<00:07, 40989.63it/s] 19%|█▉        | 75924/393248 [00:01<00:07, 42238.48it/s] 20%|██        | 80157/393248 [00:02<00:07, 41334.71it/s] 21%|██▏       | 84298/393248 [00:02<00:07, 40852.87it/s] 23%|██▎       | 88749/393248 [00:02<00:07, 41592.28it/s] 24%|██▎       | 93366/393248 [00:02<00:07, 42314.58it/s] 25%|██▌       | 98496/393248 [00:02<00:06, 43953.05it/s] 26%|██▋       | 104139/393248 [00:02<00:06, 47080.63it/s] 28%|██▊       | 109269/393248 [00:02<00:05, 47868.65it/s] 29%|██▉       | 114912/393248 [00:02<00:05, 50007.88it/s] 31%|███       | 121068/393248 [00:02<00:05, 52715.90it/s] 32%|███▏      | 127224/393248 [00:03<00:04, 53544.66it/s] 34%|███▍      | 132867/393248 [00:03<00:04, 53543.03it/s] 35%|███▌      | 138221/393248 [00:03<00:04, 51686.69it/s] 37%|███▋      | 144153/393248 [00:03<00:04, 53761.82it/s] 38%|███▊      | 149545/393248 [00:03<00:04, 51940.26it/s] 39%|███▉      | 154758/393248 [00:03<00:04, 51197.51it/s] 41%|████      | 161082/393248 [00:03<00:04, 53951.13it/s] 43%|████▎     | 167238/393248 [00:03<00:04, 55422.35it/s] 44%|████▍     | 173394/393248 [00:03<00:03, 56891.09it/s] 46%|████▌     | 179095/393248 [00:03<00:03, 56285.13it/s] 47%|████▋     | 184732/393248 [00:04<00:04, 52003.23it/s] 48%|████▊     | 189994/393248 [00:04<00:04, 49228.88it/s] 50%|████▉     | 194976/393248 [00:04<00:04, 48990.05it/s] 51%|█████     | 200583/393248 [00:04<00:03, 49687.82it/s] 53%|█████▎    | 207252/393248 [00:04<00:03, 53608.16it/s] 54%|█████▍    | 212895/393248 [00:04<00:03, 51949.59it/s] 56%|█████▌    | 219051/393248 [00:04<00:03, 54064.55it/s] 57%|█████▋    | 224490/393248 [00:04<00:03, 53356.57it/s] 58%|█████▊    | 229847/393248 [00:04<00:03, 52413.44it/s] 60%|█████▉    | 235103/393248 [00:05<00:03, 51144.52it/s] 61%|██████    | 240597/393248 [00:05<00:02, 51035.00it/s] 62%|██████▏   | 245709/393248 [00:05<00:02, 50206.57it/s] 64%|██████▍   | 251883/393248 [00:05<00:02, 53432.82it/s] 65%|██████▌   | 257246/393248 [00:05<00:02, 52174.70it/s] 67%|██████▋   | 262656/393248 [00:05<00:02, 51745.52it/s] 68%|██████▊   | 267842/393248 [00:05<00:02, 49050.92it/s] 70%|██████▉   | 273429/393248 [00:05<00:02, 50652.94it/s] 71%|███████▏  | 280611/393248 [00:05<00:02, 55504.31it/s] 73%|███████▎  | 286184/393248 [00:06<00:02, 53064.35it/s] 74%|███████▍  | 291519/393248 [00:06<00:01, 52374.54it/s] 76%|███████▌  | 297027/393248 [00:06<00:01, 52397.58it/s] 77%|███████▋  | 302279/393248 [00:06<00:01, 48557.61it/s] 78%|███████▊  | 307186/393248 [00:06<00:01, 46963.42it/s] 80%|███████▉  | 312930/393248 [00:06<00:01, 49820.09it/s] 81%|████████▏ | 319599/393248 [00:06<00:01, 53893.39it/s] 83%|████████▎ | 325040/393248 [00:06<00:01, 52999.78it/s] 84%|████████▍ | 330375/393248 [00:06<00:01, 49357.98it/s] 86%|████████▌ | 336528/393248 [00:07<00:01, 52057.85it/s] 87%|████████▋ | 342171/393248 [00:07<00:00, 52387.01it/s] 89%|████████▊ | 348327/393248 [00:07<00:00, 53673.80it/s] 90%|████████▉ | 353726/393248 [00:07<00:00, 48169.53it/s] 91%|█████████ | 358652/393248 [00:07<00:00, 48328.21it/s] 93%|█████████▎| 364230/393248 [00:07<00:00, 48387.95it/s] 94%|█████████▍| 369124/393248 [00:07<00:00, 48435.41it/s] 95%|█████████▌| 374490/393248 [00:07<00:00, 49627.06it/s] 97%|█████████▋| 379620/393248 [00:07<00:00, 49887.43it/s] 98%|█████████▊| 385356/393248 [00:08<00:00, 52041.36it/s] 99%|█████████▉| 390587/393248 [00:08<00:00, 50653.82it/s]100%|██████████| 393248/393248 [00:08<00:00, 48113.39it/s]
The spherical harmonics array is 346.53 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 86.8262312412262 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 1.769432676024964
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.0006, 'pow_max': 0.00065, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 15.45it/s] 21%|██        | 4/19 [00:00<00:00, 17.30it/s] 37%|███▋      | 7/19 [00:00<00:00, 18.70it/s] 53%|█████▎    | 10/19 [00:00<00:00, 20.00it/s] 68%|██████▊   | 13/19 [00:00<00:00, 21.16it/s] 84%|████████▍ | 16/19 [00:00<00:00, 21.91it/s]100%|██████████| 19/19 [00:00<00:00, 22.34it/s]100%|██████████| 19/19 [00:00<00:00, 20.91it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5563266 Minimum k_amp 0.00020658328967625562 n_x_max 110 n_z_max 110
Time to get list of k, phi, theta: 0.6556227207183838 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0706865355710117
Ratio of unique |k|: 0.0018102675658507072
Time to get unique k and theta: 1.302377700805664 seconds

Getting transfer functions
  0%|          | 0/10071 [00:00<?, ?it/s]  0%|          | 14/10071 [00:00<02:18, 72.77it/s]  3%|▎         | 252/10071 [00:00<00:09, 1043.06it/s]  5%|▍         | 490/10071 [00:00<00:06, 1543.33it/s]  7%|▋         | 742/10071 [00:00<00:05, 1855.38it/s]  9%|▉         | 952/10071 [00:00<00:04, 1927.80it/s] 12%|█▏        | 1176/10071 [00:00<00:04, 2015.83it/s] 14%|█▍        | 1414/10071 [00:00<00:04, 2128.76it/s] 16%|█▌        | 1634/10071 [00:00<00:03, 2141.09it/s] 18%|█▊        | 1862/10071 [00:01<00:03, 2139.03it/s] 21%|██        | 2100/10071 [00:01<00:03, 2184.29it/s] 23%|██▎       | 2321/10071 [00:01<00:03, 2160.93it/s] 25%|██▌       | 2539/10071 [00:01<00:03, 2164.88it/s] 28%|██▊       | 2786/10071 [00:01<00:03, 2251.03it/s] 31%|███       | 3122/10071 [00:01<00:02, 2565.79it/s] 34%|███▍      | 3430/10071 [00:01<00:02, 2711.02it/s] 37%|███▋      | 3724/10071 [00:01<00:02, 2748.53it/s] 40%|████      | 4032/10071 [00:01<00:02, 2826.53it/s] 43%|████▎     | 4368/10071 [00:01<00:01, 2954.66it/s] 47%|████▋     | 4690/10071 [00:02<00:01, 3019.57it/s] 50%|████▉     | 5026/10071 [00:02<00:01, 3084.19it/s] 53%|█████▎    | 5362/10071 [00:02<00:01, 3132.98it/s] 57%|█████▋    | 5698/10071 [00:02<00:01, 3189.84it/s] 60%|█████▉    | 6018/10071 [00:02<00:01, 3182.88it/s] 63%|██████▎   | 6337/10071 [00:02<00:01, 3167.95it/s] 66%|██████▌   | 6654/10071 [00:02<00:01, 3125.35it/s] 69%|██████▉   | 6986/10071 [00:02<00:00, 3153.95it/s] 73%|███████▎  | 7336/10071 [00:02<00:00, 3249.95it/s] 76%|███████▌  | 7662/10071 [00:02<00:00, 3204.89it/s] 79%|███████▉  | 7994/10071 [00:03<00:00, 3236.82it/s] 83%|████████▎ | 8344/10071 [00:03<00:00, 3303.71it/s] 86%|████████▌ | 8675/10071 [00:03<00:00, 3258.10it/s] 90%|████████▉ | 9030/10071 [00:03<00:00, 3301.28it/s] 93%|█████████▎| 9361/10071 [00:03<00:00, 3293.71it/s] 96%|█████████▋| 9716/10071 [00:03<00:00, 3342.42it/s]100%|█████████▉| 10066/10071 [00:03<00:00, 3351.25it/s]100%|██████████| 10071/10071 [00:03<00:00, 2737.38it/s]
Size of transfer function: 1.61 MB. 

Size of integrand: 33.88 MB. Time to calculate integrand: 0.020482540130615234 s

Getting spherical harmonics
  0%|          | 0/393248 [00:00<?, ?it/s]  0%|          | 513/393248 [00:00<03:28, 1880.09it/s]  1%|▏         | 5643/393248 [00:00<00:20, 18464.23it/s]  3%|▎         | 10260/393248 [00:00<00:14, 27194.94it/s]  4%|▎         | 14364/393248 [00:00<00:12, 30795.97it/s]  5%|▍         | 18468/393248 [00:00<00:11, 33506.01it/s]  6%|▌         | 23085/393248 [00:00<00:10, 36885.25it/s]  7%|▋         | 27189/393248 [00:00<00:10, 36369.14it/s]  8%|▊         | 31045/393248 [00:01<00:11, 31895.13it/s]  9%|▉         | 34884/393248 [00:01<00:11, 32301.36it/s] 10%|█         | 39501/393248 [00:01<00:09, 35680.66it/s] 11%|█         | 43227/393248 [00:01<00:09, 35882.21it/s] 12%|█▏        | 47709/393248 [00:01<00:09, 37678.41it/s] 13%|█▎        | 51813/393248 [00:01<00:08, 38357.22it/s] 14%|█▍        | 55917/393248 [00:01<00:08, 38858.81it/s] 15%|█▌        | 60534/393248 [00:01<00:08, 40483.41it/s] 17%|█▋        | 65151/393248 [00:01<00:08, 40751.90it/s] 18%|█▊        | 69768/393248 [00:02<00:07, 42177.57it/s] 19%|█▉        | 75411/393248 [00:02<00:07, 45272.58it/s] 20%|██        | 80541/393248 [00:02<00:06, 46110.19it/s] 22%|██▏       | 86184/393248 [00:02<00:06, 47677.28it/s] 23%|██▎       | 91827/393248 [00:02<00:06, 49121.90it/s] 25%|██▍       | 96957/393248 [00:02<00:06, 48357.57it/s] 26%|██▌       | 103113/393248 [00:02<00:05, 51897.44it/s] 28%|██▊       | 108756/393248 [00:02<00:05, 52537.52it/s] 29%|██▉       | 114399/393248 [00:02<00:05, 52697.50it/s] 31%|███       | 120555/393248 [00:02<00:04, 54905.57it/s] 32%|███▏      | 126198/393248 [00:03<00:04, 54255.48it/s] 34%|███▎      | 131841/393248 [00:03<00:04, 54620.33it/s] 35%|███▍      | 137311/393248 [00:03<00:04, 54434.55it/s] 36%|███▋      | 142760/393248 [00:03<00:04, 52869.80it/s] 38%|███▊      | 148058/393248 [00:03<00:04, 50695.13it/s] 39%|███▉      | 153148/393248 [00:03<00:04, 50490.53it/s] 41%|████      | 159543/393248 [00:03<00:04, 53501.73it/s] 42%|████▏     | 164904/393248 [00:03<00:04, 51236.77it/s] 43%|████▎     | 170049/393248 [00:03<00:04, 50268.73it/s] 45%|████▍     | 175090/393248 [00:04<00:04, 49805.23it/s] 46%|████▌     | 181089/393248 [00:04<00:04, 51769.55it/s] 48%|████▊     | 187758/393248 [00:04<00:03, 54684.53it/s] 49%|████▉     | 193228/393248 [00:04<00:03, 51196.17it/s] 50%|█████     | 198381/393248 [00:04<00:03, 50931.23it/s] 52%|█████▏    | 203661/393248 [00:04<00:03, 51000.86it/s] 53%|█████▎    | 208791/393248 [00:04<00:03, 50090.10it/s] 54%|█████▍    | 213921/393248 [00:04<00:03, 48671.79it/s] 56%|█████▌    | 219051/393248 [00:04<00:03, 48448.90it/s] 57%|█████▋    | 225207/393248 [00:05<00:03, 50822.20it/s] 59%|█████▊    | 230294/393248 [00:05<00:03, 48830.90it/s] 60%|█████▉    | 235188/393248 [00:05<00:03, 48722.60it/s] 61%|██████▏   | 241110/393248 [00:05<00:02, 51482.14it/s] 63%|██████▎   | 246753/393248 [00:05<00:02, 52460.40it/s] 64%|██████▍   | 252909/393248 [00:05<00:02, 54212.67it/s] 66%|██████▌   | 258552/393248 [00:05<00:02, 54140.91it/s] 67%|██████▋   | 264708/393248 [00:05<00:02, 56101.35it/s] 69%|██████▊   | 270328/393248 [00:05<00:02, 51491.22it/s] 70%|███████   | 275994/393248 [00:05<00:02, 52532.65it/s] 72%|███████▏  | 281305/393248 [00:06<00:02, 51028.07it/s] 73%|███████▎  | 286451/393248 [00:06<00:02, 50133.20it/s] 74%|███████▍  | 292410/393248 [00:06<00:01, 51735.18it/s] 76%|███████▌  | 298053/393248 [00:06<00:01, 52943.00it/s] 77%|███████▋  | 304722/393248 [00:06<00:01, 56137.47it/s] 79%|███████▉  | 310355/393248 [00:06<00:01, 55611.67it/s] 80%|████████  | 316249/393248 [00:06<00:01, 56574.24it/s] 82%|████████▏ | 321919/393248 [00:06<00:01, 53394.89it/s] 84%|████████▎ | 328833/393248 [00:06<00:01, 56770.18it/s] 85%|████████▌ | 335502/393248 [00:07<00:00, 59245.32it/s] 87%|████████▋ | 341658/393248 [00:07<00:00, 59619.07it/s] 88%|████████▊ | 347645/393248 [00:07<00:01, 37423.80it/s] 90%|████████▉ | 352424/393248 [00:07<00:01, 31098.80it/s] 91%|█████████ | 356388/393248 [00:07<00:01, 25229.32it/s] 91%|█████████▏| 359624/393248 [00:08<00:01, 19501.00it/s] 92%|█████████▏| 362691/393248 [00:08<00:01, 20222.78it/s] 93%|█████████▎| 366795/393248 [00:08<00:01, 23772.00it/s] 95%|█████████▍| 371925/393248 [00:08<00:00, 29047.88it/s] 96%|█████████▋| 379107/393248 [00:08<00:00, 38039.20it/s] 98%|█████████▊| 385776/393248 [00:08<00:00, 44259.05it/s]100%|█████████▉| 392958/393248 [00:08<00:00, 49739.75it/s]100%|██████████| 393248/393248 [00:08<00:00, 44099.92it/s]
The spherical harmonics array is 346.53 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 91.24737238883972 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 1.7474137070727118
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.0007, 'pow_max': 0.00075, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 18.30it/s] 26%|██▋       | 5/19 [00:00<00:00, 20.37it/s] 42%|████▏     | 8/19 [00:00<00:00, 21.53it/s] 58%|█████▊    | 11/19 [00:00<00:00, 22.23it/s] 74%|███████▎  | 14/19 [00:00<00:00, 22.61it/s] 89%|████████▉ | 17/19 [00:00<00:00, 22.82it/s]100%|██████████| 19/19 [00:00<00:00, 22.28it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5563266 Minimum k_amp 0.00020658328967625562 n_x_max 110 n_z_max 110
Time to get list of k, phi, theta: 0.6246311664581299 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0706865355710117
Ratio of unique |k|: 0.0018102675658507072
Time to get unique k and theta: 1.3097224235534668 seconds

Getting transfer functions
  0%|          | 0/10071 [00:00<?, ?it/s]  2%|▏         | 196/10071 [00:00<00:05, 1929.48it/s]  4%|▍         | 420/10071 [00:00<00:04, 2058.33it/s]  6%|▋         | 644/10071 [00:00<00:04, 2107.82it/s]  9%|▉         | 882/10071 [00:00<00:04, 2186.82it/s] 11%|█         | 1120/10071 [00:00<00:04, 2222.06it/s] 13%|█▎        | 1358/10071 [00:00<00:03, 2261.00it/s] 16%|█▌        | 1596/10071 [00:00<00:03, 2295.57it/s] 18%|█▊        | 1834/10071 [00:00<00:03, 2287.87it/s] 21%|██        | 2072/10071 [00:00<00:03, 2306.36it/s] 23%|██▎       | 2310/10071 [00:01<00:03, 2327.76it/s] 25%|██▌       | 2548/10071 [00:01<00:03, 2304.63it/s] 28%|██▊       | 2842/10071 [00:01<00:02, 2470.02it/s] 32%|███▏      | 3178/10071 [00:01<00:02, 2720.36it/s] 35%|███▌      | 3570/10071 [00:01<00:02, 3058.30it/s] 39%|███▊      | 3892/10071 [00:01<00:02, 3078.97it/s] 42%|████▏     | 4214/10071 [00:01<00:01, 3089.49it/s] 45%|████▌     | 4536/10071 [00:01<00:01, 3090.66it/s] 49%|████▊     | 4900/10071 [00:01<00:01, 3249.45it/s] 52%|█████▏    | 5226/10071 [00:01<00:01, 3248.25it/s] 55%|█████▌    | 5552/10071 [00:02<00:01, 3249.82it/s] 59%|█████▊    | 5908/10071 [00:02<00:01, 3315.50it/s] 62%|██████▏   | 6258/10071 [00:02<00:01, 3336.84it/s] 65%|██████▌   | 6592/10071 [00:02<00:01, 3289.62it/s] 69%|██████▉   | 6986/10071 [00:02<00:00, 3463.67it/s] 73%|███████▎  | 7333/10071 [00:02<00:00, 3400.43it/s] 76%|███████▌  | 7674/10071 [00:02<00:00, 3343.08it/s] 80%|███████▉  | 8022/10071 [00:02<00:00, 3371.05it/s] 83%|████████▎ | 8360/10071 [00:02<00:00, 3367.88it/s] 87%|████████▋ | 8722/10071 [00:02<00:00, 3410.58it/s] 90%|█████████ | 9064/10071 [00:03<00:00, 3299.26it/s] 93%|█████████▎| 9395/10071 [00:03<00:00, 3216.45it/s] 96%|█████████▋| 9718/10071 [00:03<00:00, 3218.35it/s]100%|█████████▉| 10041/10071 [00:03<00:00, 3197.78it/s]100%|██████████| 10071/10071 [00:03<00:00, 2950.66it/s]
Size of transfer function: 1.61 MB. 

Size of integrand: 33.88 MB. Time to calculate integrand: 0.0251619815826416 s

Getting spherical harmonics
  0%|          | 0/393248 [00:00<?, ?it/s]  1%|          | 4104/393248 [00:00<00:09, 40362.57it/s]  2%|▏         | 8721/393248 [00:00<00:08, 42913.64it/s]  4%|▎         | 13851/393248 [00:00<00:08, 45854.30it/s]  5%|▍         | 18434/393248 [00:00<00:08, 45131.86it/s]  6%|▌         | 22946/393248 [00:00<00:08, 44099.74it/s]  7%|▋         | 27357/393248 [00:00<00:11, 31002.67it/s]  8%|▊         | 30926/393248 [00:01<00:17, 20438.63it/s]  9%|▊         | 33681/393248 [00:01<00:18, 19248.43it/s]  9%|▉         | 36074/393248 [00:01<00:20, 17680.29it/s] 10%|▉         | 38150/393248 [00:01<00:20, 17400.66it/s] 10%|█         | 40094/393248 [00:01<00:19, 17689.45it/s] 11%|█         | 42017/393248 [00:01<00:20, 17200.58it/s] 11%|█         | 43837/393248 [00:01<00:22, 15697.02it/s] 12%|█▏        | 45657/393248 [00:02<00:22, 15476.47it/s] 12%|█▏        | 47254/393248 [00:02<00:23, 14546.27it/s] 12%|█▏        | 48740/393248 [00:02<00:24, 13989.07it/s] 13%|█▎        | 50274/393248 [00:02<00:24, 14273.24it/s] 13%|█▎        | 51719/393248 [00:02<00:24, 13884.73it/s] 14%|█▎        | 53118/393248 [00:02<00:24, 13804.10it/s] 14%|█▍        | 54505/393248 [00:02<00:25, 13475.39it/s] 14%|█▍        | 56430/393248 [00:02<00:23, 14118.46it/s] 15%|█▍        | 58482/393248 [00:02<00:22, 14892.55it/s] 15%|█▌        | 60534/393248 [00:03<00:23, 14411.41it/s] 16%|█▌        | 62073/393248 [00:03<00:23, 13904.26it/s] 16%|█▋        | 64125/393248 [00:03<00:22, 14686.36it/s] 17%|█▋        | 65596/393248 [00:03<00:22, 14663.51it/s] 17%|█▋        | 67064/393248 [00:03<00:25, 12749.17it/s] 17%|█▋        | 68373/393248 [00:03<00:26, 12196.11it/s] 18%|█▊        | 69768/393248 [00:03<00:26, 12012.20it/s] 18%|█▊        | 71820/393248 [00:03<00:24, 13177.18it/s] 19%|█▉        | 73872/393248 [00:04<00:22, 13997.09it/s] 19%|█▉        | 75411/393248 [00:04<00:23, 13604.39it/s] 20%|█▉        | 77463/393248 [00:04<00:21, 14975.66it/s] 20%|██        | 79515/393248 [00:04<00:20, 15269.10it/s] 21%|██        | 81054/393248 [00:04<00:20, 14881.46it/s] 21%|██        | 82546/393248 [00:04<00:22, 14016.74it/s] 21%|██▏       | 83952/393248 [00:04<00:23, 12935.16it/s] 22%|██▏       | 85255/393248 [00:05<00:26, 11447.01it/s] 22%|██▏       | 86697/393248 [00:05<00:28, 10819.10it/s] 22%|██▏       | 88236/393248 [00:05<00:28, 10868.15it/s] 23%|██▎       | 89775/393248 [00:05<00:27, 11234.72it/s] 23%|██▎       | 91314/393248 [00:05<00:26, 11497.68it/s] 24%|██▎       | 92853/393248 [00:05<00:25, 11840.33it/s] 24%|██▍       | 95931/393248 [00:05<00:17, 16527.58it/s] 25%|██▍       | 97983/393248 [00:05<00:17, 16970.82it/s] 25%|██▌       | 100035/393248 [00:05<00:16, 17692.99it/s] 26%|██▌       | 102087/393248 [00:06<00:16, 18191.78it/s] 26%|██▋       | 103949/393248 [00:06<00:16, 17905.03it/s] 27%|██▋       | 105769/393248 [00:06<00:16, 17079.34it/s] 27%|██▋       | 107502/393248 [00:06<00:17, 16497.12it/s] 28%|██▊       | 109269/393248 [00:06<00:17, 15998.63it/s] 28%|██▊       | 110883/393248 [00:06<00:18, 15288.24it/s] 29%|██▊       | 112860/393248 [00:06<00:19, 14500.49it/s] 29%|██▉       | 114912/393248 [00:06<00:18, 15251.17it/s] 30%|██▉       | 116455/393248 [00:07<00:18, 15236.04it/s] 30%|███       | 118503/393248 [00:07<00:17, 15574.99it/s] 31%|███       | 120068/393248 [00:07<00:20, 13407.24it/s] 31%|███       | 121581/393248 [00:07<00:21, 12837.69it/s] 31%|███▏      | 123120/393248 [00:07<00:20, 12909.75it/s] 32%|███▏      | 125685/393248 [00:07<00:16, 16049.76it/s] 33%|███▎      | 128250/393248 [00:07<00:14, 18148.65it/s] 34%|███▍      | 132867/393248 [00:07<00:10, 24724.94it/s] 34%|███▍      | 135395/393248 [00:08<00:10, 24078.03it/s] 35%|███▌      | 137840/393248 [00:08<00:12, 21023.54it/s] 36%|███▌      | 140024/393248 [00:08<00:13, 18462.74it/s] 36%|███▌      | 141964/393248 [00:08<00:16, 15606.65it/s] 37%|███▋      | 143641/393248 [00:08<00:16, 14988.86it/s] 37%|███▋      | 145213/393248 [00:08<00:17, 14346.73it/s] 37%|███▋      | 147231/393248 [00:08<00:17, 14433.21it/s] 38%|███▊      | 148770/393248 [00:09<00:16, 14559.60it/s] 38%|███▊      | 150309/393248 [00:09<00:16, 14319.37it/s] 39%|███▊      | 151848/393248 [00:09<00:17, 14015.14it/s] 39%|███▉      | 153900/393248 [00:09<00:16, 14932.45it/s] 40%|███▉      | 155952/393248 [00:09<00:17, 13953.30it/s] 40%|████      | 157491/393248 [00:09<00:17, 13649.50it/s] 40%|████      | 159030/393248 [00:09<00:18, 12819.18it/s] 41%|████      | 161082/393248 [00:09<00:15, 14653.88it/s] 41%|████▏     | 162621/393248 [00:09<00:16, 14201.98it/s] 42%|████▏     | 164673/393248 [00:10<00:15, 14446.88it/s] 43%|████▎     | 170829/393248 [00:10<00:08, 26256.80it/s] 45%|████▌     | 176985/393248 [00:10<00:06, 34651.40it/s] 46%|████▌     | 181602/393248 [00:10<00:05, 37575.92it/s] 47%|████▋     | 185526/393248 [00:10<00:08, 25346.14it/s] 48%|████▊     | 188692/393248 [00:11<00:10, 19512.25it/s] 49%|████▊     | 191253/393248 [00:11<00:12, 16565.72it/s] 49%|████▉     | 193371/393248 [00:11<00:12, 15488.55it/s] 50%|████▉     | 195453/393248 [00:11<00:12, 16179.71it/s] 51%|█████     | 199044/393248 [00:11<00:10, 18903.41it/s] 51%|█████     | 201167/393248 [00:11<00:11, 16051.43it/s] 52%|█████▏    | 202974/393248 [00:11<00:12, 15730.10it/s] 52%|█████▏    | 204680/393248 [00:12<00:12, 15335.52it/s] 52%|█████▏    | 206299/393248 [00:12<00:13, 13950.70it/s] 53%|█████▎    | 207756/393248 [00:12<00:13, 13392.10it/s] 53%|█████▎    | 209304/393248 [00:12<00:14, 12962.58it/s] 54%|█████▎    | 210843/393248 [00:12<00:14, 12897.09it/s] 54%|█████▍    | 212895/393248 [00:12<00:13, 13837.45it/s] 55%|█████▍    | 214947/393248 [00:12<00:12, 14751.89it/s] 55%|█████▌    | 216486/393248 [00:12<00:12, 13937.65it/s] 55%|█████▌    | 218025/393248 [00:13<00:12, 13677.95it/s] 56%|█████▌    | 220077/393248 [00:13<00:13, 13188.48it/s] 56%|█████▋    | 221616/393248 [00:13<00:12, 13655.56it/s] 57%|█████▋    | 223668/393248 [00:13<00:11, 14768.66it/s] 57%|█████▋    | 225720/393248 [00:13<00:11, 15186.90it/s] 58%|█████▊    | 227259/393248 [00:13<00:11, 14113.12it/s] 58%|█████▊    | 229311/393248 [00:13<00:10, 14969.26it/s] 59%|█████▉    | 231363/393248 [00:14<00:10, 15107.63it/s] 59%|█████▉    | 233415/393248 [00:14<00:10, 15291.07it/s] 60%|█████▉    | 235467/393248 [00:14<00:10, 15728.67it/s] 60%|██████    | 237519/393248 [00:14<00:09, 15738.09it/s] 61%|██████    | 239097/393248 [00:14<00:10, 15262.09it/s] 61%|██████▏   | 241110/393248 [00:14<00:09, 15547.61it/s] 62%|██████▏   | 243162/393248 [00:14<00:09, 15600.74it/s] 62%|██████▏   | 245214/393248 [00:14<00:09, 15995.22it/s] 63%|██████▎   | 247266/393248 [00:15<00:09, 15956.64it/s] 63%|██████▎   | 249318/393248 [00:15<00:08, 15999.84it/s] 64%|██████▍   | 251370/393248 [00:15<00:09, 15746.63it/s] 64%|██████▍   | 252946/393248 [00:15<00:09, 15490.36it/s] 65%|██████▍   | 254493/393248 [00:15<00:09, 14528.52it/s] 65%|██████▌   | 256500/393248 [00:15<00:09, 14312.06it/s] 66%|██████▌   | 258039/393248 [00:15<00:09, 14144.00it/s] 66%|██████▌   | 260091/393248 [00:15<00:08, 15541.23it/s] 67%|██████▋   | 261662/393248 [00:15<00:09, 14476.62it/s] 67%|██████▋   | 263169/393248 [00:16<00:08, 14616.71it/s] 67%|██████▋   | 265221/393248 [00:16<00:08, 14828.92it/s] 68%|██████▊   | 267273/393248 [00:16<00:08, 15600.60it/s] 68%|██████▊   | 268841/393248 [00:16<00:08, 14347.56it/s] 69%|██████▊   | 270351/393248 [00:16<00:08, 14481.07it/s] 69%|██████▉   | 271890/393248 [00:16<00:08, 14682.58it/s] 70%|██████▉   | 273369/393248 [00:16<00:08, 14640.79it/s] 70%|██████▉   | 274841/393248 [00:16<00:08, 13854.17it/s] 70%|███████   | 276507/393248 [00:17<00:08, 13619.14it/s] 71%|███████   | 278559/393248 [00:17<00:08, 13557.42it/s] 71%|███████   | 280098/393248 [00:17<00:08, 13075.59it/s] 72%|███████▏  | 281637/393248 [00:17<00:08, 13620.30it/s] 72%|███████▏  | 283176/393248 [00:17<00:08, 13209.60it/s] 72%|███████▏  | 284508/393248 [00:17<00:08, 12660.01it/s] 73%|███████▎  | 285781/393248 [00:17<00:08, 12632.29it/s] 73%|███████▎  | 287280/393248 [00:17<00:08, 13097.58it/s] 73%|███████▎  | 288819/393248 [00:17<00:07, 13657.35it/s] 74%|███████▍  | 290358/393248 [00:18<00:07, 12982.71it/s] 74%|███████▍  | 291897/393248 [00:18<00:07, 13529.07it/s] 75%|███████▍  | 293436/393248 [00:18<00:07, 13874.96it/s] 75%|███████▌  | 295488/393248 [00:18<00:06, 15046.51it/s] 76%|███████▌  | 297027/393248 [00:18<00:06, 15090.13it/s] 76%|███████▌  | 298566/393248 [00:18<00:06, 13946.99it/s] 76%|███████▋  | 300618/393248 [00:18<00:06, 14839.53it/s] 77%|███████▋  | 302157/393248 [00:18<00:06, 13641.89it/s] 77%|███████▋  | 303696/393248 [00:19<00:06, 13797.60it/s] 78%|███████▊  | 305235/393248 [00:19<00:06, 14198.51it/s] 78%|███████▊  | 306774/393248 [00:19<00:06, 13546.86it/s] 78%|███████▊  | 308313/393248 [00:19<00:06, 13653.38it/s] 79%|███████▉  | 309852/393248 [00:19<00:06, 13767.51it/s] 79%|███████▉  | 311237/393248 [00:19<00:06, 13582.28it/s] 79%|███████▉  | 312600/393248 [00:19<00:06, 13001.14it/s] 80%|███████▉  | 313956/393248 [00:19<00:06, 13054.72it/s] 80%|████████  | 316008/393248 [00:19<00:05, 14388.24it/s] 81%|████████  | 317547/393248 [00:20<00:05, 14578.74it/s] 82%|████████▏ | 320625/393248 [00:20<00:04, 16863.62it/s] 82%|████████▏ | 322269/393248 [00:20<00:04, 15234.52it/s] 82%|████████▏ | 323777/393248 [00:20<00:04, 14907.10it/s] 83%|████████▎ | 325253/393248 [00:20<00:04, 14205.09it/s] 83%|████████▎ | 327294/393248 [00:20<00:04, 14741.42it/s] 84%|████████▎ | 328833/393248 [00:20<00:04, 13887.75it/s] 84%|████████▍ | 330885/393248 [00:20<00:04, 14359.72it/s] 85%|████████▍ | 332424/393248 [00:21<00:04, 13618.90it/s] 85%|████████▌ | 334476/393248 [00:21<00:04, 14175.09it/s] 85%|████████▌ | 336015/393248 [00:21<00:03, 14370.64it/s] 86%|████████▌ | 337453/393248 [00:21<00:03, 14195.36it/s] 86%|████████▌ | 339093/393248 [00:21<00:03, 14553.05it/s] 87%|████████▋ | 341145/393248 [00:21<00:03, 14965.64it/s] 87%|████████▋ | 343197/393248 [00:21<00:03, 15952.12it/s] 88%|████████▊ | 344795/393248 [00:21<00:03, 15600.13it/s] 88%|████████▊ | 346355/393248 [00:21<00:03, 14281.64it/s] 89%|████████▊ | 348327/393248 [00:22<00:03, 14136.97it/s] 89%|████████▉ | 349866/393248 [00:22<00:03, 13639.62it/s] 89%|████████▉ | 351405/393248 [00:22<00:03, 13869.41it/s] 90%|████████▉ | 353457/393248 [00:22<00:02, 15405.35it/s] 90%|█████████ | 355509/393248 [00:22<00:02, 16178.91it/s] 91%|█████████ | 357561/393248 [00:22<00:02, 17121.91it/s] 91%|█████████▏| 359613/393248 [00:22<00:01, 17817.45it/s] 92%|█████████▏| 361410/393248 [00:22<00:01, 17687.33it/s] 92%|█████████▏| 363717/393248 [00:22<00:01, 18791.54it/s] 93%|█████████▎| 365604/393248 [00:23<00:01, 18793.65it/s] 93%|█████████▎| 367489/393248 [00:23<00:01, 18560.34it/s] 94%|█████████▍| 369349/393248 [00:23<00:01, 18411.18it/s] 94%|█████████▍| 371193/393248 [00:23<00:01, 16381.52it/s] 95%|█████████▍| 372871/393248 [00:23<00:01, 16242.82it/s] 95%|█████████▌| 374522/393248 [00:23<00:01, 14043.20it/s] 96%|█████████▌| 376542/393248 [00:23<00:01, 13869.83it/s] 96%|█████████▋| 378594/393248 [00:23<00:00, 15304.24it/s] 97%|█████████▋| 380646/393248 [00:24<00:00, 15458.20it/s] 97%|█████████▋| 382234/393248 [00:24<00:00, 13597.50it/s] 98%|█████████▊| 383724/393248 [00:24<00:00, 13100.67it/s] 98%|█████████▊| 385355/393248 [00:24<00:00, 13883.99it/s] 98%|█████████▊| 387315/393248 [00:24<00:00, 15157.85it/s] 99%|█████████▉| 388876/393248 [00:24<00:00, 14920.91it/s] 99%|█████████▉| 390906/393248 [00:24<00:00, 14322.61it/s]100%|█████████▉| 392445/393248 [00:24<00:00, 14381.84it/s]100%|██████████| 393248/393248 [00:24<00:00, 15742.22it/s]
The spherical harmonics array is 346.53 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 100.39796900749207 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 1.7236572762470934
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.0008, 'pow_max': 0.0008500000000000001, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 16.34it/s] 21%|██        | 4/19 [00:00<00:00, 17.11it/s] 32%|███▏      | 6/19 [00:00<00:00, 17.92it/s] 47%|████▋     | 9/19 [00:00<00:00, 19.19it/s] 63%|██████▎   | 12/19 [00:00<00:00, 20.51it/s] 79%|███████▉  | 15/19 [00:00<00:00, 21.35it/s] 95%|█████████▍| 18/19 [00:00<00:00, 22.03it/s]100%|██████████| 19/19 [00:00<00:00, 20.66it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5563266 Minimum k_amp 0.00020658328967625562 n_x_max 110 n_z_max 110
Time to get list of k, phi, theta: 0.6622374057769775 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0706865355710117
Ratio of unique |k|: 0.0018102675658507072
Time to get unique k and theta: 1.3539083003997803 seconds

Getting transfer functions
  0%|          | 0/10071 [00:00<?, ?it/s]  2%|▏         | 210/10071 [00:00<00:04, 2035.68it/s]  5%|▍         | 462/10071 [00:00<00:04, 2314.38it/s]  7%|▋         | 694/10071 [00:00<00:04, 2274.05it/s]  9%|▉         | 922/10071 [00:00<00:04, 2258.55it/s] 12%|█▏        | 1176/10071 [00:00<00:03, 2322.14it/s] 14%|█▍        | 1428/10071 [00:00<00:03, 2376.10it/s] 17%|█▋        | 1666/10071 [00:00<00:03, 2356.21it/s] 19%|█▉        | 1932/10071 [00:00<00:03, 2414.91it/s] 22%|██▏       | 2184/10071 [00:00<00:03, 2439.01it/s] 24%|██▍       | 2436/10071 [00:01<00:03, 2441.63it/s] 27%|██▋       | 2681/10071 [00:01<00:03, 2411.53it/s] 30%|███       | 3038/10071 [00:01<00:02, 2741.82it/s] 33%|███▎      | 3360/10071 [00:01<00:02, 2847.21it/s] 37%|███▋      | 3682/10071 [00:01<00:02, 2933.48it/s] 40%|███▉      | 4018/10071 [00:01<00:02, 3019.13it/s] 43%|████▎     | 4354/10071 [00:01<00:01, 3118.10it/s] 47%|████▋     | 4690/10071 [00:01<00:01, 3161.44it/s] 50%|█████     | 5054/10071 [00:01<00:01, 3273.41it/s] 54%|█████▎    | 5404/10071 [00:01<00:01, 3309.69it/s] 57%|█████▋    | 5736/10071 [00:02<00:01, 3300.25it/s] 60%|██████    | 6076/10071 [00:02<00:01, 3303.47it/s] 64%|██████▍   | 6440/10071 [00:02<00:01, 3361.38it/s] 67%|██████▋   | 6777/10071 [00:02<00:00, 3316.91it/s] 71%|███████   | 7112/10071 [00:02<00:00, 3308.37it/s] 74%|███████▍  | 7448/10071 [00:02<00:00, 3290.35it/s] 77%|███████▋  | 7784/10071 [00:02<00:00, 3284.66it/s] 81%|████████  | 8134/10071 [00:02<00:00, 3314.96it/s] 84%|████████▍ | 8466/10071 [00:02<00:00, 3198.48it/s] 87%|████████▋ | 8792/10071 [00:02<00:00, 3202.79it/s] 91%|█████████▏| 9198/10071 [00:03<00:00, 3409.98it/s] 95%|█████████▍| 9540/10071 [00:03<00:00, 3345.99it/s] 98%|█████████▊| 9875/10071 [00:03<00:00, 3320.41it/s]100%|██████████| 10071/10071 [00:03<00:00, 2996.59it/s]
Size of transfer function: 1.61 MB. 

Size of integrand: 33.88 MB. Time to calculate integrand: 0.021428585052490234 s

Getting spherical harmonics
  0%|          | 0/393248 [00:00<?, ?it/s]  1%|▏         | 5130/393248 [00:00<00:07, 49110.49it/s]  3%|▎         | 10773/393248 [00:00<00:07, 51843.64it/s]  4%|▍         | 15957/393248 [00:00<00:07, 49741.58it/s]  5%|▌         | 20936/393248 [00:00<00:07, 47860.56it/s]  7%|▋         | 25729/393248 [00:00<00:07, 47710.30it/s]  8%|▊         | 31293/393248 [00:00<00:07, 48842.45it/s]  9%|▉         | 36423/393248 [00:00<00:07, 48939.48it/s] 11%|█         | 41553/393248 [00:00<00:07, 49066.36it/s] 12%|█▏        | 46683/393248 [00:00<00:07, 48496.87it/s] 13%|█▎        | 51813/393248 [00:01<00:06, 48804.30it/s] 14%|█▍        | 56695/393248 [00:01<00:07, 46289.62it/s] 16%|█▌        | 61345/393248 [00:01<00:07, 45100.61it/s] 17%|█▋        | 65870/393248 [00:01<00:07, 42274.35it/s] 18%|█▊        | 70794/393248 [00:01<00:07, 43425.06it/s] 19%|█▉        | 75165/393248 [00:01<00:07, 42096.10it/s] 20%|██        | 80028/393248 [00:01<00:07, 43266.69it/s] 22%|██▏       | 84645/393248 [00:01<00:07, 43884.14it/s] 23%|██▎       | 89262/393248 [00:01<00:06, 43988.24it/s] 24%|██▍       | 93879/393248 [00:02<00:06, 43952.92it/s] 25%|██▌       | 100035/393248 [00:02<00:06, 48137.74it/s] 27%|██▋       | 106704/393248 [00:02<00:05, 52751.30it/s] 29%|██▊       | 112860/393248 [00:02<00:05, 54457.36it/s] 30%|███       | 118312/393248 [00:02<00:05, 49376.16it/s] 31%|███▏      | 123633/393248 [00:02<00:05, 49924.69it/s] 33%|███▎      | 129276/393248 [00:02<00:05, 51128.37it/s] 34%|███▍      | 134439/393248 [00:02<00:05, 51026.70it/s] 36%|███▌      | 141075/393248 [00:02<00:04, 55284.78it/s] 38%|███▊      | 147744/393248 [00:03<00:04, 58290.62it/s] 39%|███▉      | 153610/393248 [00:03<00:04, 55992.43it/s] 40%|████      | 159250/393248 [00:03<00:04, 50329.52it/s] 42%|████▏     | 164673/393248 [00:03<00:04, 50542.05it/s] 43%|████▎     | 170829/393248 [00:03<00:04, 53228.25it/s] 45%|████▍     | 176234/393248 [00:03<00:04, 49956.30it/s] 46%|████▌     | 181314/393248 [00:03<00:04, 49180.34it/s] 48%|████▊     | 187245/393248 [00:03<00:03, 51684.27it/s] 49%|████▉     | 192471/393248 [00:03<00:04, 47638.21it/s] 50%|█████     | 197322/393248 [00:04<00:04, 47239.15it/s] 52%|█████▏    | 202635/393248 [00:04<00:03, 48656.73it/s] 53%|█████▎    | 207553/393248 [00:04<00:03, 47599.43it/s] 54%|█████▍    | 213921/393248 [00:04<00:03, 51671.56it/s] 56%|█████▌    | 219564/393248 [00:04<00:03, 52190.55it/s] 57%|█████▋    | 225207/393248 [00:04<00:03, 53265.36it/s] 59%|█████▊    | 230559/393248 [00:04<00:03, 49345.23it/s] 60%|█████▉    | 235561/393248 [00:04<00:03, 49477.12it/s] 61%|██████▏   | 241623/393248 [00:04<00:02, 51592.07it/s] 63%|██████▎   | 247266/393248 [00:05<00:02, 52222.85it/s] 64%|██████▍   | 253422/393248 [00:05<00:02, 54640.64it/s] 66%|██████▌   | 259578/393248 [00:05<00:02, 55870.50it/s] 68%|██████▊   | 265734/393248 [00:05<00:02, 56894.11it/s] 69%|██████▉   | 271890/393248 [00:05<00:02, 56732.35it/s] 71%|███████   | 277575/393248 [00:05<00:02, 56666.22it/s] 72%|███████▏  | 284202/393248 [00:05<00:01, 58543.36it/s] 74%|███████▍  | 290061/393248 [00:05<00:01, 53871.25it/s] 75%|███████▌  | 295515/393248 [00:05<00:01, 52315.57it/s] 76%|███████▋  | 300793/393248 [00:06<00:02, 44881.62it/s] 78%|███████▊  | 305472/393248 [00:06<00:01, 44133.26it/s] 79%|███████▉  | 310878/393248 [00:06<00:01, 46192.49it/s] 81%|████████  | 317547/393248 [00:06<00:01, 51578.41it/s] 82%|████████▏ | 324216/393248 [00:06<00:01, 54807.43it/s] 84%|████████▍ | 330372/393248 [00:06<00:01, 55509.90it/s] 86%|████████▌ | 337041/393248 [00:06<00:00, 57332.57it/s] 87%|████████▋ | 342830/393248 [00:06<00:00, 55128.94it/s] 89%|████████▉ | 349866/393248 [00:06<00:00, 57503.39it/s] 91%|█████████ | 356022/393248 [00:07<00:00, 57491.36it/s] 92%|█████████▏| 362691/393248 [00:07<00:00, 59318.61it/s] 94%|█████████▍| 368847/393248 [00:07<00:00, 58993.25it/s] 95%|█████████▌| 374762/393248 [00:07<00:00, 58786.29it/s] 97%|█████████▋| 380651/393248 [00:07<00:00, 54688.19it/s] 98%|█████████▊| 386289/393248 [00:07<00:00, 54636.81it/s]100%|█████████▉| 391932/393248 [00:07<00:00, 55057.76it/s]100%|██████████| 393248/393248 [00:07<00:00, 51292.99it/s]
The spherical harmonics array is 346.53 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 80.40964221954346 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 1.7299039581113749
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.0009, 'pow_max': 0.00095, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 16%|█▌        | 3/19 [00:00<00:00, 18.48it/s] 26%|██▋       | 5/19 [00:00<00:00, 16.35it/s] 37%|███▋      | 7/19 [00:00<00:00, 16.09it/s] 47%|████▋     | 9/19 [00:00<00:00, 16.39it/s] 58%|█████▊    | 11/19 [00:00<00:00, 16.91it/s] 68%|██████▊   | 13/19 [00:00<00:00, 17.53it/s] 84%|████████▍ | 16/19 [00:00<00:00, 18.64it/s]100%|██████████| 19/19 [00:01<00:00, 19.86it/s]100%|██████████| 19/19 [00:01<00:00, 18.22it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519392886365851
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5563266 Minimum k_amp 0.00020658328967625562 n_x_max 110 n_z_max 110
Time to get list of k, phi, theta: 0.6647627353668213 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0706865355710117
Ratio of unique |k|: 0.0018102675658507072
Time to get unique k and theta: 1.3736293315887451 seconds

Getting transfer functions
  0%|          | 0/10071 [00:00<?, ?it/s]  2%|▏         | 168/10071 [00:00<00:06, 1611.57it/s]  4%|▍         | 406/10071 [00:00<00:04, 2045.55it/s]  6%|▋         | 644/10071 [00:00<00:04, 2181.01it/s]  9%|▉         | 882/10071 [00:00<00:04, 2254.04it/s] 11%|█▏        | 1134/10071 [00:00<00:03, 2327.00it/s] 14%|█▍        | 1386/10071 [00:00<00:03, 2385.16it/s] 16%|█▌        | 1625/10071 [00:00<00:03, 2333.54it/s] 19%|█▊        | 1876/10071 [00:00<00:03, 2372.48it/s] 21%|██        | 2114/10071 [00:00<00:03, 2361.13it/s] 23%|██▎       | 2366/10071 [00:01<00:03, 2390.42it/s] 26%|██▌       | 2606/10071 [00:01<00:03, 2392.09it/s] 29%|██▉       | 2926/10071 [00:01<00:02, 2604.49it/s] 32%|███▏      | 3262/10071 [00:01<00:02, 2793.02it/s] 36%|███▌      | 3598/10071 [00:01<00:02, 2954.86it/s] 39%|███▉      | 3948/10071 [00:01<00:01, 3104.95it/s] 43%|████▎     | 4284/10071 [00:01<00:01, 3180.27it/s] 46%|████▌     | 4648/10071 [00:01<00:01, 3293.43it/s] 50%|████▉     | 4998/10071 [00:01<00:01, 3349.61it/s] 53%|█████▎    | 5334/10071 [00:01<00:01, 3344.50it/s] 56%|█████▋    | 5670/10071 [00:02<00:01, 3339.36it/s] 60%|█████▉    | 6004/10071 [00:02<00:01, 3327.79it/s] 63%|██████▎   | 6337/10071 [00:02<00:01, 3270.25it/s] 66%|██████▌   | 6665/10071 [00:02<00:01, 3268.36it/s] 70%|██████▉   | 7000/10071 [00:02<00:00, 3278.01it/s] 73%|███████▎  | 7350/10071 [00:02<00:00, 3328.78it/s] 76%|███████▋  | 7700/10071 [00:02<00:00, 3371.52it/s] 80%|████████  | 8064/10071 [00:02<00:00, 3420.95it/s] 83%|████████▎ | 8407/10071 [00:02<00:00, 3404.28it/s] 87%|████████▋ | 8748/10071 [00:02<00:00, 3377.22it/s] 90%|█████████ | 9100/10071 [00:03<00:00, 3382.14it/s] 94%|█████████▎| 9439/10071 [00:03<00:00, 3267.44it/s] 97%|█████████▋| 9800/10071 [00:03<00:00, 3324.94it/s]100%|██████████| 10071/10071 [00:03<00:00, 2994.64it/s]
Size of transfer function: 1.61 MB. 

Size of integrand: 33.88 MB. Time to calculate integrand: 0.020601749420166016 s

Getting spherical harmonics
  0%|          | 0/393248 [00:00<?, ?it/s]  1%|▏         | 5130/393248 [00:00<00:07, 49898.96it/s]  3%|▎         | 10260/393248 [00:00<00:07, 47911.71it/s]  4%|▍         | 15057/393248 [00:00<00:07, 47859.34it/s]  5%|▌         | 19846/393248 [00:00<00:08, 45415.03it/s]  6%|▌         | 24403/393248 [00:00<00:10, 34164.02it/s]  7%|▋         | 29241/393248 [00:00<00:09, 36845.88it/s]  9%|▊         | 34371/393248 [00:00<00:09, 39701.40it/s] 10%|▉         | 38988/393248 [00:00<00:08, 40803.53it/s] 11%|█         | 43227/393248 [00:01<00:08, 39775.86it/s] 12%|█▏        | 47311/393248 [00:01<00:09, 36316.58it/s] 13%|█▎        | 51813/393248 [00:01<00:09, 37348.87it/s] 14%|█▍        | 56943/393248 [00:01<00:08, 40262.72it/s] 16%|█▌        | 62586/393248 [00:01<00:07, 43687.65it/s] 17%|█▋        | 67716/393248 [00:01<00:07, 45519.63it/s] 18%|█▊        | 72334/393248 [00:01<00:07, 45351.33it/s] 20%|█▉        | 76915/393248 [00:01<00:06, 45249.31it/s] 21%|██        | 81472/393248 [00:01<00:07, 44391.59it/s] 22%|██▏       | 85934/393248 [00:02<00:07, 43272.25it/s] 23%|██▎       | 91314/393248 [00:02<00:06, 45270.80it/s] 24%|██▍       | 95931/393248 [00:02<00:06, 45296.51it/s] 26%|██▌       | 102087/393248 [00:02<00:05, 49573.30it/s] 28%|██▊       | 108756/393248 [00:02<00:05, 53277.18it/s] 29%|██▉       | 114912/393248 [00:02<00:05, 55415.03it/s] 31%|███       | 121581/393248 [00:02<00:04, 55886.52it/s] 32%|███▏      | 127172/393248 [00:02<00:04, 54238.43it/s] 34%|███▍      | 133380/393248 [00:02<00:04, 56004.02it/s] 35%|███▌      | 139023/393248 [00:03<00:04, 55161.35it/s] 37%|███▋      | 145179/393248 [00:03<00:04, 56461.58it/s] 38%|███▊      | 150833/393248 [00:03<00:04, 55713.75it/s] 40%|███▉      | 156410/393248 [00:03<00:04, 50792.14it/s] 41%|████      | 161595/393248 [00:03<00:04, 49493.64it/s] 43%|████▎     | 167238/393248 [00:03<00:04, 49784.49it/s] 44%|████▍     | 172253/393248 [00:03<00:04, 48517.97it/s] 45%|████▌     | 178402/393248 [00:03<00:04, 52105.51it/s] 47%|████▋     | 184167/393248 [00:03<00:03, 53154.56it/s] 48%|████▊     | 189519/393248 [00:04<00:03, 52107.55it/s] 50%|████▉     | 195966/393248 [00:04<00:03, 55089.85it/s] 51%|█████     | 201501/393248 [00:04<00:03, 51621.67it/s] 53%|█████▎    | 206716/393248 [00:04<00:04, 46088.09it/s] 54%|█████▍    | 211451/393248 [00:04<00:04, 44209.77it/s] 56%|█████▌    | 218538/393248 [00:04<00:03, 50998.60it/s] 57%|█████▋    | 225720/393248 [00:04<00:03, 55776.31it/s] 59%|█████▉    | 231431/393248 [00:04<00:02, 54720.24it/s] 60%|██████    | 237006/393248 [00:04<00:02, 54648.61it/s] 62%|██████▏   | 242535/393248 [00:05<00:02, 52427.16it/s] 63%|██████▎   | 247833/393248 [00:05<00:02, 50567.32it/s] 64%|██████▍   | 252932/393248 [00:05<00:03, 41895.70it/s] 65%|██████▌   | 257372/393248 [00:05<00:03, 39450.49it/s] 66%|██████▋   | 261493/393248 [00:05<00:03, 38563.61it/s] 68%|██████▊   | 267273/393248 [00:05<00:02, 42599.24it/s] 69%|██████▉   | 272916/393248 [00:05<00:02, 45683.08it/s] 71%|███████   | 279072/393248 [00:05<00:02, 49616.71it/s] 72%|███████▏  | 284155/393248 [00:05<00:02, 48475.76it/s] 74%|███████▎  | 289087/393248 [00:06<00:02, 47898.88it/s] 75%|███████▍  | 293949/393248 [00:06<00:02, 47495.42it/s] 76%|███████▌  | 299079/393248 [00:06<00:01, 48239.09it/s] 78%|███████▊  | 305235/393248 [00:06<00:01, 51295.83it/s] 79%|███████▉  | 310878/393248 [00:06<00:01, 52048.70it/s] 81%|████████  | 317034/393248 [00:06<00:01, 54108.65it/s] 82%|████████▏ | 322459/393248 [00:06<00:01, 53266.65it/s] 84%|████████▍ | 329346/393248 [00:06<00:01, 57034.73it/s] 85%|████████▌ | 335059/393248 [00:07<00:01, 44580.03it/s] 86%|████████▋ | 339930/393248 [00:07<00:01, 34096.19it/s] 87%|████████▋ | 343954/393248 [00:07<00:01, 25179.50it/s] 88%|████████▊ | 347179/393248 [00:07<00:02, 21183.87it/s] 89%|████████▉ | 349837/393248 [00:07<00:02, 21211.70it/s] 90%|████████▉ | 352337/393248 [00:08<00:02, 19209.50it/s] 90%|█████████ | 354514/393248 [00:08<00:02, 16311.21it/s] 91%|█████████ | 357048/393248 [00:08<00:02, 16836.41it/s] 91%|█████████▏| 358890/393248 [00:08<00:02, 16918.19it/s] 92%|█████████▏| 361152/393248 [00:08<00:01, 17945.75it/s] 93%|█████████▎| 364230/393248 [00:08<00:01, 20717.40it/s] 94%|█████████▎| 367821/393248 [00:08<00:01, 24287.59it/s] 95%|█████████▍| 372360/393248 [00:08<00:00, 29784.62it/s] 96%|█████████▌| 377568/393248 [00:09<00:00, 35290.61it/s] 97%|█████████▋| 383211/393248 [00:09<00:00, 40937.36it/s] 99%|█████████▉| 389367/393248 [00:09<00:00, 46320.96it/s]100%|██████████| 393248/393248 [00:09<00:00, 42146.46it/s]
The spherical harmonics array is 346.53 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 85.57608103752136 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 1.6994223599582008
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.001, 'pow_max': 0.00105, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 18.50it/s] 26%|██▋       | 5/19 [00:00<00:00, 20.36it/s] 42%|████▏     | 8/19 [00:00<00:00, 21.53it/s] 58%|█████▊    | 11/19 [00:00<00:00, 21.91it/s] 74%|███████▎  | 14/19 [00:00<00:00, 21.95it/s] 89%|████████▉ | 17/19 [00:00<00:00, 22.26it/s]100%|██████████| 19/19 [00:00<00:00, 21.94it/s]
Done. k_max for TT ell_max = 0.022696475761330413 k_max for EE ell_max = 0.08518711301992739
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5555106 Minimum k_amp 0.00020658328967625562 n_x_max 110 n_z_max 110
Time to get list of k, phi, theta: 0.6642472743988037 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07068848011181064
Ratio of unique |k|: 0.0018111265563609407
Time to get unique k and theta: 1.3098318576812744 seconds

Getting transfer functions
  0%|          | 0/10061 [00:00<?, ?it/s]  2%|▏         | 182/10061 [00:00<00:05, 1789.24it/s]  4%|▍         | 420/10061 [00:00<00:04, 2089.25it/s]  7%|▋         | 686/10061 [00:00<00:04, 2279.37it/s]  9%|▉         | 924/10061 [00:00<00:03, 2286.46it/s] 12%|█▏        | 1162/10061 [00:00<00:03, 2269.67it/s] 14%|█▍        | 1400/10061 [00:00<00:03, 2269.21it/s] 16%|█▋        | 1638/10061 [00:00<00:03, 2283.99it/s] 19%|█▊        | 1876/10061 [00:00<00:03, 2278.24it/s] 21%|██        | 2114/10061 [00:00<00:03, 2301.03it/s] 23%|██▎       | 2352/10061 [00:01<00:03, 2299.88it/s] 26%|██▌       | 2604/10061 [00:01<00:03, 2329.03it/s] 29%|██▉       | 2912/10061 [00:01<00:02, 2543.19it/s] 32%|███▏      | 3248/10061 [00:01<00:02, 2771.16it/s] 36%|███▌      | 3598/10061 [00:01<00:02, 2952.90it/s] 39%|███▉      | 3920/10061 [00:01<00:02, 3002.41it/s] 42%|████▏     | 4221/10061 [00:01<00:01, 2965.00it/s] 45%|████▌     | 4536/10061 [00:01<00:01, 3018.85it/s] 48%|████▊     | 4858/10061 [00:01<00:01, 3069.22it/s] 51%|█████▏    | 5166/10061 [00:01<00:01, 3065.17it/s] 55%|█████▍    | 5516/10061 [00:02<00:01, 3160.67it/s] 58%|█████▊    | 5866/10061 [00:02<00:01, 3256.52it/s] 62%|██████▏   | 6216/10061 [00:02<00:01, 3320.22it/s] 65%|██████▌   | 6552/10061 [00:02<00:01, 3303.53it/s] 69%|██████▊   | 6902/10061 [00:02<00:00, 3350.78it/s] 72%|███████▏  | 7238/10061 [00:02<00:00, 3346.83it/s] 76%|███████▌  | 7616/10061 [00:02<00:00, 3440.01it/s] 79%|███████▉  | 7980/10061 [00:02<00:00, 3464.30it/s] 83%|████████▎ | 8330/10061 [00:02<00:00, 3471.29it/s] 86%|████████▋ | 8678/10061 [00:02<00:00, 3396.33it/s] 90%|████████▉ | 9044/10061 [00:03<00:00, 3446.51it/s] 94%|█████████▎| 9408/10061 [00:03<00:00, 3472.62it/s] 97%|█████████▋| 9756/10061 [00:03<00:00, 3454.89it/s]100%|██████████| 10061/10061 [00:03<00:00, 2974.77it/s]
Size of transfer function: 1.61 MB. 

Size of integrand: 33.85 MB. Time to calculate integrand: 0.02559375762939453 s

Getting spherical harmonics
  0%|          | 0/392682 [00:00<?, ?it/s]  1%|▏         | 5120/392682 [00:00<00:08, 47989.96it/s]  3%|▎         | 10261/392682 [00:00<00:07, 49944.44it/s]  4%|▍         | 15360/392682 [00:00<00:07, 50370.53it/s]  5%|▌         | 20401/392682 [00:00<00:07, 49368.27it/s]  6%|▋         | 25343/392682 [00:00<00:07, 46342.22it/s]  8%|▊         | 30006/392682 [00:00<00:08, 41814.99it/s]  9%|▊         | 34304/392682 [00:00<00:08, 40591.10it/s] 10%|█         | 39424/392682 [00:00<00:08, 42496.90it/s] 11%|█         | 43715/392682 [00:00<00:08, 42234.71it/s] 13%|█▎        | 49152/392682 [00:01<00:07, 44413.70it/s] 14%|█▎        | 53760/392682 [00:01<00:07, 43652.78it/s] 15%|█▍        | 58138/392682 [00:01<00:07, 42916.42it/s] 16%|█▌        | 62464/392682 [00:01<00:07, 41627.43it/s] 17%|█▋        | 66634/392682 [00:01<00:07, 41433.52it/s] 18%|█▊        | 71680/392682 [00:01<00:07, 42696.69it/s] 20%|█▉        | 76800/392682 [00:01<00:07, 43718.73it/s] 21%|██        | 81171/392682 [00:01<00:07, 41989.06it/s] 22%|██▏       | 85375/392682 [00:01<00:07, 41346.68it/s] 23%|██▎       | 89511/392682 [00:02<00:07, 40960.87it/s] 24%|██▍       | 93696/392682 [00:02<00:07, 40265.19it/s] 25%|██▌       | 98304/392682 [00:02<00:07, 41036.97it/s] 26%|██▋       | 103936/392682 [00:02<00:06, 45362.11it/s] 28%|██▊       | 110080/392682 [00:02<00:05, 49744.43it/s] 30%|██▉       | 116224/392682 [00:02<00:05, 52937.76it/s] 31%|███       | 122086/392682 [00:02<00:04, 54600.35it/s] 32%|███▏      | 127568/392682 [00:02<00:04, 53948.35it/s] 34%|███▍      | 132979/392682 [00:02<00:04, 53228.23it/s] 35%|███▌      | 138314/392682 [00:03<00:04, 52093.19it/s] 37%|███▋      | 143535/392682 [00:03<00:05, 46542.67it/s] 38%|███▊      | 148992/392682 [00:03<00:05, 47687.58it/s] 39%|███▉      | 154112/392682 [00:03<00:05, 47259.42it/s] 41%|████      | 159744/392682 [00:03<00:04, 49424.84it/s] 42%|████▏     | 165376/392682 [00:03<00:04, 51151.58it/s] 44%|████▎     | 171520/392682 [00:03<00:04, 52752.50it/s] 45%|████▌     | 178176/392682 [00:03<00:03, 56452.33it/s] 47%|████▋     | 184320/392682 [00:03<00:03, 57204.40it/s] 48%|████▊     | 190068/392682 [00:04<00:04, 43961.28it/s] 50%|████▉     | 194934/392682 [00:04<00:04, 43701.36it/s] 51%|█████     | 199680/392682 [00:04<00:04, 43755.09it/s] 52%|█████▏    | 205183/392682 [00:04<00:04, 46677.58it/s] 54%|█████▍    | 211456/392682 [00:04<00:03, 49874.80it/s] 56%|█████▌    | 218112/392682 [00:04<00:03, 52957.86it/s] 57%|█████▋    | 223744/392682 [00:04<00:03, 53653.36it/s] 58%|█████▊    | 229197/392682 [00:04<00:04, 37130.03it/s] 59%|█████▉    | 233643/392682 [00:05<00:04, 38642.09it/s] 61%|██████    | 238592/392682 [00:05<00:03, 40316.98it/s] 63%|██████▎   | 245760/392682 [00:05<00:03, 47135.88it/s] 64%|██████▍   | 252416/392682 [00:05<00:02, 51823.37it/s] 66%|██████▌   | 259072/392682 [00:05<00:02, 55355.43it/s] 67%|██████▋   | 264883/392682 [00:05<00:02, 55579.74it/s] 69%|██████▉   | 271360/392682 [00:05<00:02, 57523.04it/s] 71%|███████   | 277256/392682 [00:05<00:02, 54543.57it/s] 72%|███████▏  | 282835/392682 [00:05<00:02, 49856.49it/s] 73%|███████▎  | 287966/392682 [00:06<00:02, 48079.57it/s] 75%|███████▍  | 294400/392682 [00:06<00:01, 51028.67it/s] 76%|███████▋  | 299589/392682 [00:06<00:01, 50093.14it/s] 78%|███████▊  | 306176/392682 [00:06<00:01, 54371.13it/s] 80%|███████▉  | 312832/392682 [00:06<00:01, 57048.47it/s] 81%|████████  | 318602/392682 [00:06<00:01, 54996.02it/s] 83%|████████▎ | 324155/392682 [00:06<00:01, 52254.55it/s] 84%|████████▍ | 331264/392682 [00:06<00:01, 56692.59it/s] 86%|████████▌ | 336995/392682 [00:06<00:01, 55313.04it/s] 87%|████████▋ | 342569/392682 [00:07<00:00, 52797.21it/s] 89%|████████▊ | 347890/392682 [00:07<00:00, 51518.00it/s] 90%|████████▉ | 353069/392682 [00:07<00:00, 50430.52it/s] 91%|█████████ | 358129/392682 [00:07<00:00, 49081.48it/s] 92%|█████████▏| 363048/392682 [00:07<00:00, 48212.09it/s] 94%|█████████▎| 368128/392682 [00:07<00:00, 47803.78it/s] 95%|█████████▍| 372912/392682 [00:07<00:00, 47734.99it/s] 96%|█████████▌| 377688/392682 [00:07<00:00, 47597.07it/s] 98%|█████████▊| 382976/392682 [00:07<00:00, 48613.36it/s] 99%|█████████▉| 388096/392682 [00:08<00:00, 49227.18it/s]100%|██████████| 392682/392682 [00:08<00:00, 48316.39it/s]
The spherical harmonics array is 346.03 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 81.48105549812317 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 1.6974063628157543
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.0015, 'pow_max': 0.00155, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 16%|█▌        | 3/19 [00:00<00:00, 21.65it/s] 32%|███▏      | 6/19 [00:00<00:00, 22.61it/s] 47%|████▋     | 9/19 [00:00<00:00, 22.89it/s] 63%|██████▎   | 12/19 [00:00<00:00, 23.08it/s] 79%|███████▉  | 15/19 [00:00<00:00, 23.18it/s] 95%|█████████▍| 18/19 [00:00<00:00, 23.25it/s]100%|██████████| 19/19 [00:00<00:00, 23.05it/s]
Done. k_max for TT ell_max = 0.01422693794493977 k_max for EE ell_max = 0.08518839099062697
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 2709752 Minimum k_amp 0.00020658328967625562 n_x_max 87 n_z_max 87
Time to get list of k, phi, theta: 0.32518553733825684 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07304137057560987
Ratio of unique |k|: 0.0023009485738916327
Time to get unique k and theta: 0.585860013961792 seconds

Getting transfer functions
  0%|          | 0/6235 [00:00<?, ?it/s]  2%|▏         | 144/6235 [00:00<00:04, 1386.10it/s]  5%|▌         | 315/6235 [00:00<00:03, 1529.67it/s]  8%|▊         | 468/6235 [00:00<00:03, 1488.62it/s] 10%|█         | 639/6235 [00:00<00:03, 1560.17it/s] 13%|█▎        | 801/6235 [00:00<00:03, 1578.11it/s] 15%|█▌        | 963/6235 [00:00<00:03, 1578.24it/s] 18%|█▊        | 1134/6235 [00:00<00:03, 1607.47it/s] 21%|██        | 1305/6235 [00:00<00:03, 1633.24it/s] 24%|██▍       | 1485/6235 [00:00<00:02, 1683.78it/s] 27%|██▋       | 1654/6235 [00:01<00:02, 1680.37it/s] 30%|██▉       | 1863/6235 [00:01<00:02, 1794.64it/s] 34%|███▎      | 2097/6235 [00:01<00:02, 1936.34it/s] 38%|███▊      | 2340/6235 [00:01<00:01, 2081.26it/s] 41%|████▏     | 2574/6235 [00:01<00:01, 2145.14it/s] 45%|████▌     | 2817/6235 [00:01<00:01, 2212.47it/s] 49%|████▉     | 3051/6235 [00:01<00:01, 2229.95it/s] 53%|█████▎    | 3274/6235 [00:01<00:01, 2222.71it/s] 56%|█████▋    | 3510/6235 [00:01<00:01, 2243.57it/s] 60%|██████    | 3762/6235 [00:01<00:01, 2304.76it/s] 64%|██████▍   | 4005/6235 [00:02<00:00, 2337.67it/s] 68%|██████▊   | 4239/6235 [00:02<00:00, 2293.55it/s] 72%|███████▏  | 4469/6235 [00:02<00:00, 2277.66it/s] 76%|███████▌  | 4716/6235 [00:02<00:00, 2321.99it/s] 79%|███████▉  | 4950/6235 [00:02<00:00, 2320.70it/s] 83%|████████▎ | 5183/6235 [00:02<00:00, 2310.46it/s] 87%|████████▋ | 5436/6235 [00:02<00:00, 2347.65it/s] 91%|█████████ | 5671/6235 [00:02<00:00, 2322.54it/s] 95%|█████████▍| 5904/6235 [00:02<00:00, 2289.25it/s] 98%|█████████▊| 6138/6235 [00:02<00:00, 2284.19it/s]100%|██████████| 6235/6235 [00:03<00:00, 2066.84it/s]
Size of transfer function: 1.0 MB. 

Size of integrand: 20.98 MB. Time to calculate integrand: 0.016730070114135742 s

Getting spherical harmonics
  0%|          | 0/197924 [00:00<?, ?it/s]  3%|▎         | 5160/197924 [00:00<00:04, 47417.98it/s]  5%|▌         | 9902/197924 [00:00<00:04, 41215.75it/s]  7%|▋         | 14060/197924 [00:00<00:04, 37509.65it/s]  9%|▉         | 18576/197924 [00:00<00:04, 39423.08it/s] 11%|█▏        | 22704/197924 [00:00<00:04, 39822.35it/s] 14%|█▍        | 27348/197924 [00:00<00:04, 39529.08it/s] 16%|█▌        | 31476/197924 [00:00<00:04, 39770.82it/s] 18%|█▊        | 35862/197924 [00:00<00:04, 40485.21it/s] 20%|██        | 39990/197924 [00:00<00:03, 40367.29it/s] 22%|██▏       | 44118/197924 [00:01<00:03, 40627.15it/s] 24%|██▍       | 48246/197924 [00:01<00:03, 40411.47it/s] 27%|██▋       | 52890/197924 [00:01<00:03, 41900.81it/s] 29%|██▉       | 58050/197924 [00:01<00:03, 44526.39it/s] 32%|███▏      | 62952/197924 [00:01<00:02, 45247.47it/s] 34%|███▍      | 67854/197924 [00:01<00:02, 46187.10it/s] 37%|███▋      | 72477/197924 [00:01<00:02, 44298.52it/s] 39%|███▉      | 76924/197924 [00:01<00:02, 42598.68it/s] 41%|████      | 81204/197924 [00:02<00:03, 34958.62it/s] 43%|████▎     | 84922/197924 [00:02<00:04, 24828.66it/s] 45%|████▌     | 89784/197924 [00:02<00:03, 29202.96it/s] 48%|████▊     | 95460/197924 [00:02<00:02, 35035.14it/s] 50%|█████     | 99554/197924 [00:02<00:02, 34568.63it/s] 52%|█████▏    | 103420/197924 [00:02<00:02, 32280.66it/s] 54%|█████▍    | 107844/197924 [00:02<00:02, 35088.01it/s] 57%|█████▋    | 112488/197924 [00:02<00:02, 37601.32it/s] 60%|█████▉    | 117906/197924 [00:03<00:01, 41734.79it/s] 62%|██████▏   | 123582/197924 [00:03<00:01, 45415.51it/s] 65%|██████▍   | 128295/197924 [00:03<00:01, 44266.14it/s] 67%|██████▋   | 132843/197924 [00:03<00:01, 44387.54it/s] 69%|██████▉   | 137514/197924 [00:03<00:01, 44332.54it/s] 72%|███████▏  | 142008/197924 [00:03<00:01, 42285.91it/s] 74%|███████▍  | 147318/197924 [00:03<00:01, 45041.18it/s] 77%|███████▋  | 151878/197924 [00:03<00:01, 44452.18it/s] 79%|███████▉  | 156864/197924 [00:03<00:00, 45342.45it/s] 82%|████████▏ | 161427/197924 [00:04<00:00, 44032.67it/s] 84%|████████▍ | 166926/197924 [00:04<00:00, 46716.22it/s] 87%|████████▋ | 173118/197924 [00:04<00:00, 50848.17it/s] 90%|█████████ | 178235/197924 [00:04<00:00, 50809.26it/s] 93%|█████████▎| 183339/197924 [00:04<00:00, 48920.17it/s] 95%|█████████▌| 188598/197924 [00:04<00:00, 49310.34it/s] 98%|█████████▊| 193549/197924 [00:04<00:00, 45944.45it/s]100%|██████████| 197924/197924 [00:04<00:00, 41362.71it/s]
The spherical harmonics array is 174.41 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 78.81817579269409 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 1.6630222162722466
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.2, 'pow_min': 0.002, 'pow_max': 0.00205, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 14.46it/s] 21%|██        | 4/19 [00:00<00:00, 16.11it/s] 32%|███▏      | 6/19 [00:00<00:00, 17.28it/s] 47%|████▋     | 9/19 [00:00<00:00, 18.80it/s] 63%|██████▎   | 12/19 [00:00<00:00, 20.24it/s] 79%|███████▉  | 15/19 [00:00<00:00, 21.25it/s] 95%|█████████▍| 18/19 [00:00<00:00, 21.93it/s]100%|██████████| 19/19 [00:00<00:00, 20.27it/s]
Done. k_max for TT ell_max = 0.016480852268776554 k_max for EE ell_max = 0.08520031871715644
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 3773432 Minimum k_amp 0.00020658328967625562 n_x_max 97 n_z_max 97
Time to get list of k, phi, theta: 0.446272611618042 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07196764112881854
Ratio of unique |k|: 0.0020604584897780057
Time to get unique k and theta: 0.8530557155609131 seconds

Getting transfer functions
  0%|          | 0/7775 [00:00<?, ?it/s]  2%|▏         | 176/7775 [00:00<00:04, 1680.64it/s]  5%|▍         | 363/7775 [00:00<00:04, 1765.35it/s]  7%|▋         | 561/7775 [00:00<00:03, 1849.80it/s] 10%|▉         | 770/7775 [00:00<00:03, 1936.29it/s] 12%|█▏        | 968/7775 [00:00<00:03, 1941.37it/s] 15%|█▌        | 1188/7775 [00:00<00:03, 1997.38it/s] 18%|█▊        | 1397/7775 [00:00<00:03, 2019.96it/s] 21%|██        | 1599/7775 [00:00<00:03, 1994.76it/s] 23%|██▎       | 1804/7775 [00:00<00:02, 1996.95it/s] 26%|██▌       | 2004/7775 [00:01<00:02, 1984.66it/s] 29%|██▉       | 2244/7775 [00:01<00:02, 2102.13it/s] 33%|███▎      | 2530/7775 [00:01<00:02, 2326.84it/s] 36%|███▋      | 2827/7775 [00:01<00:01, 2501.91it/s] 40%|███▉      | 3091/7775 [00:01<00:01, 2519.49it/s] 43%|████▎     | 3377/7775 [00:01<00:01, 2602.32it/s] 47%|████▋     | 3663/7775 [00:01<00:01, 2653.52it/s] 51%|█████     | 3938/7775 [00:01<00:01, 2671.99it/s] 54%|█████▍    | 4213/7775 [00:01<00:01, 2666.50it/s] 58%|█████▊    | 4521/7775 [00:01<00:01, 2761.77it/s] 62%|██████▏   | 4807/7775 [00:02<00:01, 2770.33it/s] 66%|██████▌   | 5093/7775 [00:02<00:00, 2791.36it/s] 69%|██████▉   | 5379/7775 [00:02<00:00, 2794.61it/s] 73%|███████▎  | 5659/7775 [00:02<00:00, 2776.12it/s] 77%|███████▋  | 5973/7775 [00:02<00:00, 2859.28it/s] 81%|████████  | 6259/7775 [00:02<00:00, 2836.68it/s] 84%|████████▍ | 6556/7775 [00:02<00:00, 2864.30it/s] 88%|████████▊ | 6843/7775 [00:02<00:00, 2865.84it/s] 92%|█████████▏| 7139/7775 [00:02<00:00, 2863.15it/s] 96%|█████████▌| 7426/7775 [00:02<00:00, 2791.48it/s] 99%|█████████▉| 7706/7775 [00:03<00:00, 2783.21it/s]100%|██████████| 7775/7775 [00:03<00:00, 2508.86it/s]
Size of transfer function: 1.25 MB. 

Size of integrand: 26.16 MB. Time to calculate integrand: 0.017066478729248047 s

Getting spherical harmonics
  0%|          | 0/271565 [00:00<?, ?it/s]  2%|▏         | 4602/271565 [00:00<00:05, 45346.81it/s]  3%|▎         | 9204/271565 [00:00<00:05, 44469.49it/s]  5%|▌         | 13806/271565 [00:00<00:05, 44755.49it/s]  7%|▋         | 18283/271565 [00:00<00:05, 43026.67it/s]  8%|▊         | 22594/271565 [00:00<00:06, 41021.11it/s] 10%|▉         | 26904/271565 [00:00<00:06, 40005.49it/s] 11%|█▏        | 30917/271565 [00:00<00:06, 38794.73it/s] 13%|█▎        | 35754/271565 [00:00<00:05, 40665.63it/s] 15%|█▍        | 39829/271565 [00:00<00:05, 40576.95it/s] 16%|█▋        | 44250/271565 [00:01<00:05, 41578.74it/s] 18%|█▊        | 49206/271565 [00:01<00:05, 43501.97it/s] 20%|█▉        | 53564/271565 [00:01<00:05, 43030.22it/s] 21%|██▏       | 57873/271565 [00:01<00:04, 43042.81it/s] 23%|██▎       | 62658/271565 [00:01<00:04, 43796.76it/s] 25%|██▍       | 67260/271565 [00:01<00:04, 44074.13it/s] 27%|██▋       | 72570/271565 [00:01<00:04, 46482.31it/s] 29%|██▉       | 78942/271565 [00:01<00:03, 51354.81it/s] 31%|███       | 84086/271565 [00:01<00:03, 49359.94it/s] 33%|███▎      | 89208/271565 [00:02<00:03, 49143.95it/s] 35%|███▍      | 94164/271565 [00:02<00:03, 48684.36it/s] 36%|███▋      | 99120/271565 [00:02<00:03, 48864.28it/s] 39%|███▉      | 105846/271565 [00:02<00:03, 53902.95it/s] 41%|████▏     | 112218/271565 [00:02<00:02, 55707.08it/s] 43%|████▎     | 117793/271565 [00:02<00:02, 52213.70it/s] 45%|████▌     | 123192/271565 [00:02<00:02, 51754.93it/s] 48%|████▊     | 129564/271565 [00:02<00:02, 54236.91it/s] 50%|█████     | 136290/271565 [00:02<00:02, 57339.13it/s] 52%|█████▏    | 142231/271565 [00:02<00:02, 57931.21it/s] 55%|█████▍    | 148045/271565 [00:03<00:02, 56104.03it/s] 57%|█████▋    | 154344/271565 [00:03<00:02, 56239.89it/s] 59%|█████▉    | 159984/271565 [00:03<00:02, 53602.52it/s] 61%|██████▏   | 166380/271565 [00:03<00:01, 56357.44it/s] 63%|██████▎   | 172398/271565 [00:03<00:01, 57103.85it/s] 66%|██████▌   | 178770/271565 [00:03<00:01, 57745.19it/s] 68%|██████▊   | 185850/271565 [00:03<00:01, 60861.44it/s] 71%|███████   | 191957/271565 [00:03<00:01, 57004.66it/s] 73%|███████▎  | 197712/271565 [00:03<00:01, 56156.66it/s] 75%|███████▍  | 203363/271565 [00:04<00:01, 51650.36it/s] 77%|███████▋  | 209922/271565 [00:04<00:01, 55122.47it/s] 79%|███████▉  | 215523/271565 [00:04<00:01, 52230.98it/s] 81%|████████▏ | 220825/271565 [00:04<00:00, 52393.11it/s] 83%|████████▎ | 226121/271565 [00:04<00:00, 47251.92it/s] 86%|████████▌ | 232932/271565 [00:04<00:00, 52415.89it/s] 88%|████████▊ | 239990/271565 [00:04<00:00, 57366.54it/s] 91%|█████████ | 245875/271565 [00:04<00:00, 56287.30it/s] 93%|█████████▎| 252048/271565 [00:04<00:00, 57761.94it/s] 95%|█████████▍| 257907/271565 [00:05<00:00, 51797.32it/s] 97%|█████████▋| 263247/271565 [00:05<00:00, 52009.60it/s] 99%|█████████▉| 269040/271565 [00:05<00:00, 53305.49it/s]100%|██████████| 271565/271565 [00:05<00:00, 50837.50it/s]
The spherical harmonics array is 239.3 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 81.50317525863647 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 1.6783967413722847
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.0001, 'pow_max': 0.00015000000000000001, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 15.29it/s] 21%|██        | 4/19 [00:00<00:00, 17.29it/s] 32%|███▏      | 6/19 [00:00<00:00, 18.36it/s] 47%|████▋     | 9/19 [00:00<00:00, 19.68it/s] 63%|██████▎   | 12/19 [00:00<00:00, 20.63it/s] 79%|███████▉  | 15/19 [00:00<00:00, 21.19it/s] 95%|█████████▍| 18/19 [00:00<00:00, 21.25it/s]100%|██████████| 19/19 [00:00<00:00, 20.34it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5563266 Minimum k_amp 0.00020658328967625562 n_x_max 110 n_z_max 110
Time to get list of k, phi, theta: 0.6799993515014648 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0706865355710117
Ratio of unique |k|: 0.0018102675658507072
Time to get unique k and theta: 1.3130364418029785 seconds

Getting transfer functions
  0%|          | 0/10071 [00:00<?, ?it/s]  2%|▏         | 196/10071 [00:00<00:05, 1870.71it/s]  4%|▍         | 420/10071 [00:00<00:04, 2076.70it/s]  6%|▋         | 644/10071 [00:00<00:04, 2128.94it/s]  9%|▊         | 858/10071 [00:00<00:04, 2100.28it/s] 11%|█         | 1092/10071 [00:00<00:04, 2157.20it/s] 13%|█▎        | 1316/10071 [00:00<00:04, 2174.85it/s] 15%|█▌        | 1554/10071 [00:00<00:03, 2236.83it/s] 18%|█▊        | 1792/10071 [00:00<00:03, 2258.84it/s] 20%|██        | 2044/10071 [00:00<00:03, 2294.85it/s] 23%|██▎       | 2282/10071 [00:01<00:03, 2287.90it/s] 25%|██▌       | 2534/10071 [00:01<00:03, 2329.69it/s] 28%|██▊       | 2800/10071 [00:01<00:03, 2408.96it/s] 31%|███       | 3122/10071 [00:01<00:02, 2623.60it/s] 34%|███▍      | 3444/10071 [00:01<00:02, 2798.15it/s] 38%|███▊      | 3794/10071 [00:01<00:02, 2985.60it/s] 41%|████      | 4116/10071 [00:01<00:01, 3045.68it/s] 44%|████▍     | 4466/10071 [00:01<00:01, 3138.57it/s] 48%|████▊     | 4788/10071 [00:01<00:01, 3159.21it/s] 51%|█████     | 5124/10071 [00:01<00:01, 3210.20it/s] 54%|█████▍    | 5446/10071 [00:02<00:01, 3180.39it/s] 57%|█████▋    | 5765/10071 [00:02<00:01, 3180.05it/s] 60%|██████    | 6084/10071 [00:02<00:01, 3168.92it/s] 64%|██████▎   | 6412/10071 [00:02<00:01, 3177.68it/s] 67%|██████▋   | 6748/10071 [00:02<00:01, 3216.75it/s] 70%|███████   | 7098/10071 [00:02<00:00, 3289.62it/s] 74%|███████▍  | 7448/10071 [00:02<00:00, 3321.52it/s] 77%|███████▋  | 7798/10071 [00:02<00:00, 3339.13it/s] 81%|████████  | 8134/10071 [00:02<00:00, 3318.38it/s] 85%|████████▍ | 8512/10071 [00:02<00:00, 3414.64it/s] 88%|████████▊ | 8854/10071 [00:03<00:00, 3327.48it/s] 91%|█████████ | 9188/10071 [00:03<00:00, 3252.14it/s] 95%|█████████▍| 9520/10071 [00:03<00:00, 3235.64it/s] 98%|█████████▊| 9870/10071 [00:03<00:00, 3299.46it/s]100%|██████████| 10071/10071 [00:03<00:00, 2912.88it/s]
Size of transfer function: 1.61 MB. 

Size of integrand: 33.88 MB. Time to calculate integrand: 0.024840354919433594 s

Getting spherical harmonics
  0%|          | 0/393248 [00:00<?, ?it/s]  1%|▏         | 5643/393248 [00:00<00:07, 53209.31it/s]  3%|▎         | 11286/393248 [00:00<00:07, 52347.11it/s]  4%|▍         | 16522/393248 [00:00<00:07, 49816.29it/s]  5%|▌         | 21509/393248 [00:00<00:08, 44866.98it/s]  7%|▋         | 26046/393248 [00:00<00:08, 43548.10it/s]  8%|▊         | 30428/393248 [00:00<00:09, 38623.16it/s]  9%|▉         | 34884/393248 [00:00<00:09, 39717.75it/s] 10%|█         | 40014/393248 [00:00<00:08, 42774.35it/s] 11%|█▏        | 44370/393248 [00:01<00:08, 41866.51it/s] 13%|█▎        | 49248/393248 [00:01<00:07, 43256.46it/s] 14%|█▎        | 53616/393248 [00:01<00:07, 42609.68it/s] 15%|█▍        | 57905/393248 [00:01<00:08, 40761.36it/s] 16%|█▌        | 62586/393248 [00:01<00:07, 42095.21it/s] 17%|█▋        | 68229/393248 [00:01<00:07, 44480.89it/s] 18%|█▊        | 72689/393248 [00:01<00:07, 40101.72it/s] 20%|█▉        | 76772/393248 [00:01<00:08, 37376.42it/s] 20%|██        | 80576/393248 [00:01<00:08, 36401.27it/s] 21%|██▏       | 84384/393248 [00:02<00:08, 36845.66it/s] 23%|██▎       | 88749/393248 [00:02<00:08, 37270.21it/s] 24%|██▎       | 92500/393248 [00:02<00:08, 36646.39it/s] 25%|██▍       | 96957/393248 [00:02<00:07, 38478.77it/s] 26%|██▌       | 102087/393248 [00:02<00:07, 41396.01it/s] 27%|██▋       | 107217/393248 [00:02<00:06, 43728.79it/s] 29%|██▉       | 113373/393248 [00:02<00:05, 47622.24it/s] 30%|███       | 118145/393248 [00:02<00:05, 46458.61it/s] 31%|███▏      | 123120/393248 [00:02<00:05, 47213.30it/s] 33%|███▎      | 129789/393248 [00:03<00:05, 51814.38it/s] 34%|███▍      | 134975/393248 [00:03<00:05, 49781.63it/s] 36%|███▌      | 140562/393248 [00:03<00:04, 51167.68it/s] 37%|███▋      | 146718/393248 [00:03<00:04, 54070.10it/s] 39%|███▉      | 152874/393248 [00:03<00:04, 55125.01it/s] 40%|████      | 158517/393248 [00:03<00:04, 54871.15it/s] 42%|████▏     | 164015/393248 [00:03<00:04, 51280.99it/s] 43%|████▎     | 169190/393248 [00:03<00:04, 47533.02it/s] 44%|████▍     | 174420/393248 [00:03<00:04, 47872.61it/s] 46%|████▌     | 180063/393248 [00:04<00:04, 49715.73it/s] 47%|████▋     | 185083/393248 [00:04<00:04, 48087.85it/s] 48%|████▊     | 190323/393248 [00:04<00:04, 49153.34it/s] 50%|████▉     | 195966/393248 [00:04<00:03, 50260.49it/s] 51%|█████▏    | 202122/393248 [00:04<00:03, 51637.47it/s] 53%|█████▎    | 207299/393248 [00:04<00:03, 51280.69it/s] 54%|█████▍    | 212435/393248 [00:04<00:03, 50004.09it/s] 56%|█████▌    | 218538/393248 [00:04<00:03, 51377.35it/s] 57%|█████▋    | 223677/393248 [00:04<00:03, 50739.24it/s] 58%|█████▊    | 228798/393248 [00:04<00:03, 49787.95it/s] 60%|█████▉    | 234441/393248 [00:05<00:03, 50664.46it/s] 61%|██████    | 240084/393248 [00:05<00:02, 51360.73it/s] 63%|██████▎   | 247266/393248 [00:05<00:02, 56303.80it/s] 64%|██████▍   | 252909/393248 [00:05<00:02, 53569.89it/s] 66%|██████▌   | 258289/393248 [00:05<00:02, 52665.50it/s] 67%|██████▋   | 264195/393248 [00:05<00:02, 53519.28it/s] 69%|██████▊   | 269558/393248 [00:05<00:02, 49407.51it/s] 70%|███████   | 275994/393248 [00:05<00:02, 52635.86it/s] 72%|███████▏  | 281315/393248 [00:05<00:02, 50824.30it/s] 73%|███████▎  | 286440/393248 [00:06<00:02, 50009.38it/s] 74%|███████▍  | 291897/393248 [00:06<00:02, 50647.62it/s] 76%|███████▌  | 296984/393248 [00:06<00:01, 49998.17it/s] 77%|███████▋  | 302157/393248 [00:06<00:01, 49351.38it/s] 78%|███████▊  | 308313/393248 [00:06<00:01, 52413.68it/s] 80%|███████▉  | 313956/393248 [00:06<00:01, 52850.73it/s] 81%|████████▏ | 319599/393248 [00:06<00:01, 52868.22it/s] 83%|████████▎ | 326268/393248 [00:06<00:01, 55622.73it/s] 85%|████████▍ | 332937/393248 [00:06<00:01, 58097.65it/s] 86%|████████▌ | 339093/393248 [00:07<00:00, 58346.41it/s] 88%|████████▊ | 345249/393248 [00:07<00:00, 58307.49it/s] 89%|████████▉ | 351083/393248 [00:07<00:00, 57171.97it/s] 91%|█████████ | 357245/393248 [00:07<00:00, 58451.46it/s] 92%|█████████▏| 363717/393248 [00:07<00:00, 58482.50it/s] 94%|█████████▍| 369873/393248 [00:07<00:00, 58651.48it/s] 96%|█████████▌| 376029/393248 [00:07<00:00, 59418.88it/s] 97%|█████████▋| 381977/393248 [00:07<00:00, 58572.02it/s] 99%|█████████▉| 388341/393248 [00:07<00:00, 59206.37it/s]100%|██████████| 393248/393248 [00:07<00:00, 49370.90it/s]
The spherical harmonics array is 346.53 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 84.38345193862915 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 1.778953487640548
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.0002, 'pow_max': 0.00025, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 14.54it/s] 21%|██        | 4/19 [00:00<00:00, 15.12it/s] 32%|███▏      | 6/19 [00:00<00:00, 15.57it/s] 42%|████▏     | 8/19 [00:00<00:00, 15.79it/s] 53%|█████▎    | 10/19 [00:00<00:00, 15.97it/s] 63%|██████▎   | 12/19 [00:00<00:00, 16.44it/s] 74%|███████▎  | 14/19 [00:00<00:00, 17.12it/s] 89%|████████▉ | 17/19 [00:01<00:00, 18.42it/s]100%|██████████| 19/19 [00:01<00:00, 17.36it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5563266 Minimum k_amp 0.00020658328967625562 n_x_max 110 n_z_max 110
Time to get list of k, phi, theta: 0.8502974510192871 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0706865355710117
Ratio of unique |k|: 0.0018102675658507072
Time to get unique k and theta: 1.4574508666992188 seconds

Getting transfer functions
  0%|          | 0/10071 [00:00<?, ?it/s]  0%|          | 14/10071 [00:00<02:28, 67.74it/s]  3%|▎         | 266/10071 [00:00<00:09, 1056.68it/s]  6%|▌         | 560/10071 [00:00<00:05, 1722.13it/s]  8%|▊         | 826/10071 [00:00<00:04, 2022.39it/s] 11%|█         | 1064/10071 [00:00<00:04, 2101.68it/s] 13%|█▎        | 1292/10071 [00:00<00:04, 2130.53it/s] 15%|█▌        | 1517/10071 [00:00<00:03, 2154.54it/s] 17%|█▋        | 1750/10071 [00:00<00:03, 2192.06it/s] 20%|█▉        | 1988/10071 [00:01<00:03, 2240.21it/s] 22%|██▏       | 2226/10071 [00:01<00:03, 2254.65it/s] 24%|██▍       | 2464/10071 [00:01<00:03, 2275.59it/s] 27%|██▋       | 2702/10071 [00:01<00:03, 2286.01it/s] 30%|███       | 3038/10071 [00:01<00:02, 2580.84it/s] 34%|███▎      | 3374/10071 [00:01<00:02, 2792.72it/s] 37%|███▋      | 3682/10071 [00:01<00:02, 2848.92it/s] 40%|███▉      | 3990/10071 [00:01<00:02, 2885.87it/s] 43%|████▎     | 4312/10071 [00:01<00:01, 2967.44it/s] 46%|████▌     | 4610/10071 [00:01<00:01, 2942.56it/s] 49%|████▊     | 4905/10071 [00:02<00:01, 2930.02it/s] 52%|█████▏    | 5199/10071 [00:02<00:01, 2889.25it/s] 55%|█████▍    | 5502/10071 [00:02<00:01, 2887.78it/s] 58%|█████▊    | 5838/10071 [00:02<00:01, 2998.22it/s] 61%|██████▏   | 6174/10071 [00:02<00:01, 3088.11it/s] 64%|██████▍   | 6484/10071 [00:02<00:01, 3048.72it/s] 67%|██████▋   | 6790/10071 [00:02<00:01, 2982.44it/s] 71%|███████   | 7140/10071 [00:02<00:00, 3094.99it/s] 74%|███████▍  | 7476/10071 [00:02<00:00, 3154.43it/s] 77%|███████▋  | 7792/10071 [00:02<00:00, 3126.88it/s] 80%|████████  | 8105/10071 [00:03<00:00, 3094.62it/s] 84%|████████▎ | 8415/10071 [00:03<00:00, 3072.36it/s] 87%|████████▋ | 8764/10071 [00:03<00:00, 3176.25it/s] 90%|█████████ | 9086/10071 [00:03<00:00, 3167.16it/s] 94%|█████████▎| 9422/10071 [00:03<00:00, 3200.53it/s] 97%|█████████▋| 9743/10071 [00:03<00:00, 3124.74it/s]100%|█████████▉| 10056/10071 [00:03<00:00, 3101.00it/s]100%|██████████| 10071/10071 [00:03<00:00, 2699.99it/s]
Size of transfer function: 1.61 MB. 

Size of integrand: 33.88 MB. Time to calculate integrand: 0.02227616310119629 s

Getting spherical harmonics
  0%|          | 0/393248 [00:00<?, ?it/s]  0%|          | 513/393248 [00:00<03:26, 1906.40it/s]  1%|          | 4617/393248 [00:00<00:25, 15097.35it/s]  3%|▎         | 10260/393248 [00:00<00:13, 28053.60it/s]  4%|▍         | 14877/393248 [00:00<00:11, 32921.46it/s]  5%|▍         | 18810/393248 [00:00<00:11, 33038.83it/s]  6%|▌         | 22524/393248 [00:00<00:10, 33946.92it/s]  7%|▋         | 26203/393248 [00:00<00:11, 33094.76it/s]  8%|▊         | 30780/393248 [00:01<00:10, 35957.41it/s]  9%|▉         | 34525/393248 [00:01<00:09, 36292.65it/s] 10%|▉         | 38475/393248 [00:01<00:09, 35730.05it/s] 11%|█         | 42123/393248 [00:01<00:10, 34680.48it/s] 12%|█▏        | 46170/393248 [00:01<00:09, 35508.06it/s] 13%|█▎        | 49760/393248 [00:01<00:10, 31974.59it/s] 13%|█▎        | 53037/393248 [00:01<00:16, 20925.93it/s] 14%|█▍        | 55651/393248 [00:02<00:18, 18107.78it/s] 15%|█▍        | 57857/393248 [00:02<00:20, 16109.89it/s] 15%|█▌        | 59749/393248 [00:02<00:21, 15577.42it/s] 16%|█▌        | 61489/393248 [00:02<00:22, 14999.58it/s] 16%|█▌        | 63105/393248 [00:02<00:26, 12675.72it/s] 16%|█▋        | 64638/393248 [00:02<00:24, 13171.84it/s] 17%|█▋        | 66177/393248 [00:02<00:24, 13618.63it/s] 17%|█▋        | 68229/393248 [00:03<00:22, 14321.91it/s] 18%|█▊        | 69768/393248 [00:03<00:22, 14271.20it/s] 18%|█▊        | 71820/393248 [00:03<00:21, 14796.65it/s] 19%|█▊        | 73359/393248 [00:03<00:21, 14773.81it/s] 19%|█▉        | 74898/393248 [00:03<00:23, 13658.55it/s] 20%|█▉        | 76950/393248 [00:03<00:21, 14729.83it/s] 20%|██        | 79002/393248 [00:03<00:19, 15801.91it/s] 20%|██        | 80605/393248 [00:03<00:22, 13681.18it/s] 21%|██        | 82554/393248 [00:04<00:20, 15109.80it/s] 21%|██▏       | 84135/393248 [00:04<00:25, 12270.81it/s] 22%|██▏       | 85671/393248 [00:04<00:25, 12064.01it/s] 23%|██▎       | 89775/393248 [00:04<00:16, 18633.63it/s] 24%|██▍       | 94392/393248 [00:04<00:11, 25460.35it/s] 25%|██▍       | 97470/393248 [00:04<00:11, 26220.92it/s] 26%|██▌       | 100304/393248 [00:04<00:13, 21805.89it/s] 26%|██▌       | 102746/393248 [00:05<00:15, 19080.07it/s] 27%|██▋       | 104877/393248 [00:05<00:14, 19529.66it/s] 27%|██▋       | 107001/393248 [00:05<00:16, 17785.36it/s] 28%|██▊       | 108912/393248 [00:05<00:16, 16825.41it/s] 28%|██▊       | 110684/393248 [00:05<00:17, 15856.73it/s] 29%|██▊       | 112329/393248 [00:05<00:17, 15859.47it/s] 29%|██▉       | 113957/393248 [00:05<00:18, 14871.10it/s] 30%|██▉       | 116302/393248 [00:05<00:16, 17038.29it/s] 30%|███       | 118068/393248 [00:06<00:19, 14109.09it/s] 31%|███       | 120042/393248 [00:06<00:19, 13921.07it/s] 31%|███       | 121581/393248 [00:06<00:19, 14133.76it/s] 31%|███▏      | 123120/393248 [00:06<00:18, 14431.53it/s] 32%|███▏      | 124659/393248 [00:06<00:19, 13562.61it/s] 32%|███▏      | 126198/393248 [00:06<00:19, 13805.05it/s] 32%|███▏      | 127737/393248 [00:06<00:19, 13402.23it/s] 33%|███▎      | 129276/393248 [00:06<00:19, 13500.09it/s] 34%|███▎      | 131841/393248 [00:07<00:16, 16301.67it/s] 34%|███▍      | 133496/393248 [00:07<00:15, 16356.66it/s] 35%|███▍      | 135945/393248 [00:07<00:13, 18622.31it/s] 35%|███▌      | 138510/393248 [00:07<00:12, 19648.87it/s] 36%|███▌      | 140562/393248 [00:07<00:13, 18914.51it/s] 36%|███▋      | 142614/393248 [00:07<00:13, 18477.06it/s] 37%|███▋      | 144473/393248 [00:07<00:14, 17361.60it/s] 37%|███▋      | 146718/393248 [00:07<00:13, 18622.21it/s] 39%|███▉      | 153387/393248 [00:07<00:07, 31450.99it/s] 41%|████      | 161595/393248 [00:08<00:05, 45104.64it/s] 43%|████▎     | 167238/393248 [00:08<00:04, 47621.49it/s] 44%|████▍     | 172881/393248 [00:08<00:04, 50054.82it/s] 45%|████▌     | 177959/393248 [00:08<00:04, 48058.37it/s] 47%|████▋     | 183141/393248 [00:08<00:04, 48139.43it/s] 48%|████▊     | 188271/393248 [00:08<00:04, 47911.88it/s] 49%|████▉     | 193401/393248 [00:08<00:04, 47801.10it/s] 50%|█████     | 198531/393248 [00:08<00:04, 48118.80it/s] 52%|█████▏    | 203661/393248 [00:08<00:03, 48333.57it/s] 53%|█████▎    | 209817/393248 [00:08<00:03, 50749.34it/s] 55%|█████▍    | 214896/393248 [00:09<00:03, 49422.84it/s] 56%|█████▌    | 219843/393248 [00:09<00:03, 48785.80it/s] 57%|█████▋    | 224724/393248 [00:09<00:03, 48282.26it/s] 58%|█████▊    | 229553/393248 [00:09<00:03, 46221.22it/s] 60%|█████▉    | 234441/393248 [00:09<00:03, 46641.01it/s] 61%|██████    | 240597/393248 [00:09<00:03, 50550.49it/s] 63%|██████▎   | 247266/393248 [00:09<00:02, 54372.27it/s] 64%|██████▍   | 252718/393248 [00:09<00:02, 51756.64it/s] 66%|██████▌   | 257923/393248 [00:09<00:02, 47901.07it/s] 67%|██████▋   | 262776/393248 [00:10<00:03, 34457.46it/s] 68%|██████▊   | 266765/393248 [00:10<00:04, 25633.70it/s] 69%|██████▊   | 269986/393248 [00:10<00:05, 21457.16it/s] 69%|██████▉   | 272648/393248 [00:10<00:05, 20721.04it/s] 70%|███████   | 275481/393248 [00:10<00:05, 21783.17it/s] 71%|███████▏  | 280259/393248 [00:11<00:04, 27171.91it/s] 73%|███████▎  | 286254/393248 [00:11<00:03, 34359.14it/s] 74%|███████▍  | 291384/393248 [00:11<00:02, 38099.15it/s] 76%|███████▌  | 298053/393248 [00:11<00:02, 45015.64it/s] 77%|███████▋  | 304209/393248 [00:11<00:01, 48064.77it/s] 79%|███████▊  | 309339/393248 [00:11<00:01, 48323.75it/s] 80%|████████  | 314982/393248 [00:11<00:01, 47572.49it/s] 81%|████████▏ | 319888/393248 [00:11<00:01, 47772.25it/s] 83%|████████▎ | 324771/393248 [00:11<00:01, 44987.10it/s] 84%|████████▍ | 330885/393248 [00:12<00:01, 49309.22it/s] 86%|████████▌ | 337041/393248 [00:12<00:01, 51836.60it/s] 87%|████████▋ | 342311/393248 [00:12<00:01, 49954.44it/s] 88%|████████▊ | 347814/393248 [00:12<00:00, 51155.66it/s] 90%|████████▉ | 352985/393248 [00:12<00:00, 50012.40it/s] 91%|█████████▏| 359100/393248 [00:12<00:00, 51138.33it/s] 93%|█████████▎| 364327/393248 [00:12<00:00, 51454.15it/s] 94%|█████████▍| 369873/393248 [00:12<00:00, 52463.41it/s] 95%|█████████▌| 375137/393248 [00:12<00:00, 52283.75it/s] 97%|█████████▋| 381159/393248 [00:13<00:00, 52811.09it/s] 98%|█████████▊| 386802/393248 [00:13<00:00, 53287.67it/s]100%|█████████▉| 392958/393248 [00:13<00:00, 55389.80it/s]100%|██████████| 393248/393248 [00:13<00:00, 29697.22it/s]
The spherical harmonics array is 346.53 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 101.50469708442688 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 2.0839749954582003
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.0003, 'pow_max': 0.00035, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 16%|█▌        | 3/19 [00:00<00:00, 21.73it/s] 32%|███▏      | 6/19 [00:00<00:00, 22.56it/s] 47%|████▋     | 9/19 [00:00<00:00, 22.83it/s] 63%|██████▎   | 12/19 [00:00<00:00, 23.02it/s] 79%|███████▉  | 15/19 [00:00<00:00, 22.56it/s] 95%|█████████▍| 18/19 [00:00<00:00, 22.80it/s]100%|██████████| 19/19 [00:00<00:00, 22.75it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5563266 Minimum k_amp 0.00020658328967625562 n_x_max 110 n_z_max 110
Time to get list of k, phi, theta: 0.6735944747924805 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0706865355710117
Ratio of unique |k|: 0.0018102675658507072
Time to get unique k and theta: 1.3249890804290771 seconds

Getting transfer functions
  0%|          | 0/10071 [00:00<?, ?it/s]  0%|          | 14/10071 [00:00<02:15, 74.19it/s]  3%|▎         | 252/10071 [00:00<00:09, 1054.18it/s]  5%|▍         | 476/10071 [00:00<00:06, 1499.47it/s]  7%|▋         | 728/10071 [00:00<00:05, 1847.02it/s] 10%|▉         | 994/10071 [00:00<00:04, 2097.97it/s] 12%|█▏        | 1246/10071 [00:00<00:03, 2220.93it/s] 15%|█▍        | 1498/10071 [00:00<00:03, 2297.46it/s] 18%|█▊        | 1764/10071 [00:00<00:03, 2395.31it/s] 20%|██        | 2016/10071 [00:01<00:03, 2369.82it/s] 23%|██▎       | 2268/10071 [00:01<00:03, 2376.69it/s] 25%|██▌       | 2520/10071 [00:01<00:03, 2414.78it/s] 28%|██▊       | 2814/10071 [00:01<00:02, 2550.85it/s] 31%|███       | 3122/10071 [00:01<00:02, 2699.75it/s] 34%|███▍      | 3416/10071 [00:01<00:02, 2735.64it/s] 37%|███▋      | 3738/10071 [00:01<00:02, 2846.42it/s] 40%|████      | 4074/10071 [00:01<00:02, 2994.24it/s] 44%|████▎     | 4396/10071 [00:01<00:01, 3053.33it/s] 47%|████▋     | 4718/10071 [00:01<00:01, 3101.54it/s] 50%|█████     | 5068/10071 [00:02<00:01, 3215.04it/s] 54%|█████▎    | 5404/10071 [00:02<00:01, 3239.90it/s] 57%|█████▋    | 5729/10071 [00:02<00:01, 3236.74it/s] 60%|██████    | 6053/10071 [00:02<00:01, 3234.25it/s] 63%|██████▎   | 6377/10071 [00:02<00:01, 3220.12it/s] 67%|██████▋   | 6706/10071 [00:02<00:01, 3221.87it/s] 70%|███████   | 7056/10071 [00:02<00:00, 3297.89it/s] 73%|███████▎  | 7386/10071 [00:02<00:00, 3253.34it/s] 77%|███████▋  | 7742/10071 [00:02<00:00, 3314.31it/s] 81%|████████  | 8148/10071 [00:02<00:00, 3506.70it/s] 84%|████████▍ | 8499/10071 [00:03<00:00, 3340.67it/s] 88%|████████▊ | 8835/10071 [00:03<00:00, 3318.08it/s] 91%|█████████ | 9184/10071 [00:03<00:00, 3358.27it/s] 95%|█████████▍| 9521/10071 [00:03<00:00, 3355.10it/s] 98%|█████████▊| 9858/10071 [00:03<00:00, 3180.35it/s]100%|██████████| 10071/10071 [00:03<00:00, 2829.85it/s]
Size of transfer function: 1.61 MB. 

Size of integrand: 33.88 MB. Time to calculate integrand: 0.022846221923828125 s

Getting spherical harmonics
  0%|          | 0/393248 [00:00<?, ?it/s]  1%|          | 3078/393248 [00:00<00:12, 30516.72it/s]  2%|▏         | 7695/393248 [00:00<00:09, 39252.08it/s]  3%|▎         | 13338/393248 [00:00<00:08, 46074.65it/s]  5%|▍         | 17933/393248 [00:00<00:08, 43965.36it/s]  6%|▌         | 23085/393248 [00:00<00:08, 44751.96it/s]  7%|▋         | 27560/393248 [00:00<00:09, 36902.50it/s]  8%|▊         | 31430/393248 [00:01<00:15, 22798.01it/s]  9%|▉         | 34415/393248 [00:01<00:17, 20093.71it/s]  9%|▉         | 36914/393248 [00:01<00:18, 19696.35it/s] 10%|▉         | 39208/393248 [00:01<00:20, 16981.06it/s] 10%|█         | 41150/393248 [00:01<00:21, 16338.13it/s] 11%|█         | 42937/393248 [00:01<00:23, 15213.39it/s] 11%|█▏        | 44552/393248 [00:01<00:23, 15150.60it/s] 12%|█▏        | 46130/393248 [00:02<00:23, 15062.59it/s] 12%|█▏        | 47678/393248 [00:02<00:24, 14122.55it/s] 12%|█▏        | 49118/393248 [00:02<00:26, 13173.37it/s] 13%|█▎        | 51300/393248 [00:02<00:22, 14959.83it/s] 14%|█▍        | 54891/393248 [00:02<00:16, 20262.61it/s] 15%|█▌        | 59508/393248 [00:02<00:12, 26903.62it/s] 16%|█▋        | 64638/393248 [00:02<00:09, 33054.32it/s] 18%|█▊        | 69255/393248 [00:02<00:09, 35418.30it/s] 19%|█▊        | 73359/393248 [00:02<00:08, 36353.49it/s] 20%|█▉        | 77463/393248 [00:03<00:08, 36682.81it/s] 21%|██        | 83106/393248 [00:03<00:07, 41213.16it/s] 22%|██▏       | 87723/393248 [00:03<00:07, 41443.75it/s] 24%|██▎       | 92853/393248 [00:03<00:06, 43539.85it/s] 25%|██▍       | 97232/393248 [00:03<00:07, 42028.12it/s] 26%|██▋       | 103626/393248 [00:03<00:06, 46867.43it/s] 28%|██▊       | 108328/393248 [00:03<00:06, 46312.20it/s] 29%|██▉       | 114912/393248 [00:03<00:05, 50557.00it/s] 31%|███       | 119972/393248 [00:03<00:06, 44299.96it/s] 32%|███▏      | 124659/393248 [00:04<00:06, 44578.82it/s] 34%|███▎      | 131841/393248 [00:04<00:05, 51379.35it/s] 35%|███▍      | 137096/393248 [00:04<00:06, 40930.26it/s] 36%|███▌      | 141582/393248 [00:04<00:06, 41754.58it/s] 37%|███▋      | 146053/393248 [00:04<00:05, 42292.49it/s] 39%|███▊      | 152361/393248 [00:04<00:05, 46149.21it/s] 40%|███▉      | 157141/393248 [00:04<00:05, 45903.95it/s] 42%|████▏     | 164160/393248 [00:04<00:04, 52069.16it/s] 43%|████▎     | 170316/393248 [00:05<00:04, 54103.36it/s] 45%|████▍     | 175822/393248 [00:05<00:04, 51497.84it/s] 46%|████▌     | 181056/393248 [00:05<00:04, 49235.38it/s] 47%|████▋     | 186047/393248 [00:05<00:04, 45373.85it/s] 49%|████▊     | 191349/393248 [00:05<00:04, 47295.16it/s] 50%|█████     | 197505/393248 [00:05<00:03, 50832.93it/s] 52%|█████▏    | 203148/393248 [00:05<00:03, 51888.79it/s] 53%|█████▎    | 209817/393248 [00:05<00:03, 55942.28it/s] 55%|█████▍    | 215479/393248 [00:05<00:03, 54682.79it/s] 56%|█████▋    | 222129/393248 [00:06<00:03, 56314.07it/s] 58%|█████▊    | 227792/393248 [00:06<00:03, 53568.26it/s] 59%|█████▉    | 233188/393248 [00:06<00:03, 52334.47it/s] 61%|██████    | 238447/393248 [00:06<00:02, 51955.90it/s] 62%|██████▏   | 243659/393248 [00:06<00:03, 45194.69it/s] 63%|██████▎   | 248328/393248 [00:06<00:03, 40309.62it/s] 64%|██████▍   | 252529/393248 [00:06<00:03, 38101.66it/s] 66%|██████▌   | 258039/393248 [00:06<00:03, 42279.99it/s] 67%|██████▋   | 264708/393248 [00:06<00:02, 47775.63it/s] 69%|██████▊   | 270351/393248 [00:07<00:02, 49727.91it/s] 70%|███████   | 275481/393248 [00:07<00:02, 48895.96it/s] 72%|███████▏  | 282663/393248 [00:07<00:02, 54424.97it/s] 73%|███████▎  | 288306/393248 [00:07<00:01, 54417.77it/s] 75%|███████▍  | 293949/393248 [00:07<00:01, 54958.30it/s] 76%|███████▋  | 300105/393248 [00:07<00:01, 56856.86it/s] 78%|███████▊  | 306261/393248 [00:07<00:01, 56992.15it/s] 80%|███████▉  | 313443/393248 [00:07<00:01, 59310.34it/s] 81%|████████  | 319384/393248 [00:07<00:01, 55930.92it/s] 83%|████████▎ | 325242/393248 [00:08<00:01, 55808.14it/s] 84%|████████▍ | 330885/393248 [00:08<00:01, 53993.64it/s] 86%|████████▌ | 337041/393248 [00:08<00:01, 55043.21it/s] 87%|████████▋ | 342563/393248 [00:08<00:00, 54997.61it/s] 89%|████████▊ | 348327/393248 [00:08<00:00, 55354.23it/s] 90%|████████▉ | 353872/393248 [00:08<00:00, 55375.95it/s] 91%|█████████▏| 359417/393248 [00:08<00:00, 53384.12it/s] 93%|█████████▎| 366282/393248 [00:08<00:00, 56289.40it/s] 95%|█████████▍| 372951/393248 [00:08<00:00, 58156.38it/s] 96%|█████████▋| 378772/393248 [00:09<00:00, 57057.01it/s] 98%|█████████▊| 384482/393248 [00:09<00:00, 56121.09it/s] 99%|█████████▉| 390096/393248 [00:09<00:00, 55900.78it/s]100%|██████████| 393248/393248 [00:09<00:00, 42446.47it/s]
The spherical harmonics array is 346.53 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 91.14034175872803 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 2.0065207830346248
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.0004, 'pow_max': 0.00045000000000000004, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 18.55it/s] 26%|██▋       | 5/19 [00:00<00:00, 21.52it/s] 42%|████▏     | 8/19 [00:00<00:00, 22.37it/s] 58%|█████▊    | 11/19 [00:00<00:00, 22.56it/s] 74%|███████▎  | 14/19 [00:00<00:00, 22.84it/s] 89%|████████▉ | 17/19 [00:00<00:00, 22.60it/s]100%|██████████| 19/19 [00:00<00:00, 22.44it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5563266 Minimum k_amp 0.00020658328967625562 n_x_max 110 n_z_max 110
Time to get list of k, phi, theta: 0.6799662113189697 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0706865355710117
Ratio of unique |k|: 0.0018102675658507072
Time to get unique k and theta: 1.3281364440917969 seconds

Getting transfer functions
  0%|          | 0/10071 [00:00<?, ?it/s]  2%|▏         | 154/10071 [00:00<00:06, 1492.40it/s]  4%|▍         | 420/10071 [00:00<00:04, 2116.94it/s]  7%|▋         | 672/10071 [00:00<00:04, 2255.21it/s]  9%|▉         | 910/10071 [00:00<00:04, 2266.16it/s] 12%|█▏        | 1162/10071 [00:00<00:03, 2328.98it/s] 14%|█▍        | 1428/10071 [00:00<00:03, 2391.97it/s] 17%|█▋        | 1694/10071 [00:00<00:03, 2454.01it/s] 19%|█▉        | 1940/10071 [00:00<00:03, 2424.78it/s] 22%|██▏       | 2198/10071 [00:00<00:03, 2441.97it/s] 24%|██▍       | 2464/10071 [00:01<00:03, 2469.46it/s] 28%|██▊       | 2772/10071 [00:01<00:02, 2624.61it/s] 31%|███       | 3122/10071 [00:01<00:02, 2851.31it/s] 34%|███▍      | 3458/10071 [00:01<00:02, 2996.62it/s] 37%|███▋      | 3766/10071 [00:01<00:02, 3011.67it/s] 41%|████      | 4102/10071 [00:01<00:01, 3074.05it/s] 44%|████▍     | 4452/10071 [00:01<00:01, 3159.02it/s] 47%|████▋     | 4768/10071 [00:01<00:01, 3145.95it/s] 51%|█████     | 5096/10071 [00:01<00:01, 3152.09it/s] 54%|█████▍    | 5432/10071 [00:01<00:01, 3182.67it/s] 58%|█████▊    | 5796/10071 [00:02<00:01, 3302.48it/s] 61%|██████    | 6146/10071 [00:02<00:01, 3330.91it/s] 65%|██████▍   | 6496/10071 [00:02<00:01, 3357.34it/s] 68%|██████▊   | 6832/10071 [00:02<00:00, 3340.75it/s] 71%|███████   | 7168/10071 [00:02<00:00, 3343.35it/s] 75%|███████▍  | 7503/10071 [00:02<00:00, 3342.90it/s] 78%|███████▊  | 7838/10071 [00:02<00:00, 3307.99it/s] 81%|████████  | 8169/10071 [00:02<00:00, 3218.56it/s] 85%|████████▍ | 8526/10071 [00:02<00:00, 3315.72it/s] 88%|████████▊ | 8859/10071 [00:02<00:00, 3300.35it/s] 91%|█████████▏| 9190/10071 [00:03<00:00, 3251.64it/s] 95%|█████████▍| 9520/10071 [00:03<00:00, 3258.88it/s] 98%|█████████▊| 9856/10071 [00:03<00:00, 3260.54it/s]100%|██████████| 10071/10071 [00:03<00:00, 2991.17it/s]
Size of transfer function: 1.61 MB. 

Size of integrand: 33.88 MB. Time to calculate integrand: 0.025906085968017578 s

Getting spherical harmonics
  0%|          | 0/393248 [00:00<?, ?it/s]  0%|          | 513/393248 [00:00<02:02, 3200.17it/s]  1%|▏         | 5643/393248 [00:00<00:15, 24974.56it/s]  3%|▎         | 10260/393248 [00:00<00:11, 32368.15it/s]  4%|▎         | 13851/393248 [00:00<00:11, 32734.66it/s]  5%|▍         | 18468/393248 [00:00<00:10, 35920.50it/s]  6%|▌         | 22194/393248 [00:00<00:10, 34759.35it/s]  7%|▋         | 26163/393248 [00:00<00:10, 35139.92it/s]  8%|▊         | 30780/393248 [00:00<00:09, 38150.97it/s]  9%|▉         | 35397/393248 [00:01<00:08, 40052.35it/s] 10%|█         | 40014/393248 [00:01<00:08, 41254.89it/s] 11%|█         | 44176/393248 [00:01<00:08, 41280.05it/s] 12%|█▏        | 48735/393248 [00:01<00:08, 42241.59it/s] 14%|█▎        | 53505/393248 [00:01<00:07, 43847.69it/s] 15%|█▍        | 57908/393248 [00:01<00:08, 40911.61it/s] 16%|█▌        | 62073/393248 [00:01<00:08, 38695.93it/s] 17%|█▋        | 66690/393248 [00:01<00:08, 40509.76it/s] 18%|█▊        | 71820/393248 [00:01<00:07, 43356.65it/s] 19%|█▉        | 76437/393248 [00:01<00:07, 42439.35it/s] 21%|██        | 80721/393248 [00:02<00:07, 41886.73it/s] 22%|██▏       | 85158/393248 [00:02<00:07, 41911.05it/s] 23%|██▎       | 89368/393248 [00:02<00:07, 41679.81it/s] 24%|██▍       | 93879/393248 [00:02<00:07, 41956.45it/s] 26%|██▌       | 100430/393248 [00:02<00:06, 48740.54it/s] 27%|██▋       | 106191/393248 [00:02<00:05, 50137.70it/s] 28%|██▊       | 111226/393248 [00:02<00:05, 50142.31it/s] 30%|██▉       | 116255/393248 [00:02<00:05, 48322.97it/s] 31%|███       | 121581/393248 [00:02<00:05, 47963.51it/s] 32%|███▏      | 127202/393248 [00:03<00:05, 50296.81it/s] 34%|███▍      | 132867/393248 [00:03<00:05, 50943.79it/s] 35%|███▌      | 137978/393248 [00:03<00:05, 50407.00it/s] 36%|███▋      | 143030/393248 [00:03<00:04, 50153.42it/s] 38%|███▊      | 148053/393248 [00:03<00:04, 49892.81it/s] 39%|███▉      | 153047/393248 [00:03<00:05, 46267.20it/s] 40%|████      | 157723/393248 [00:03<00:05, 44995.30it/s] 41%|████▏     | 163134/393248 [00:03<00:04, 47126.10it/s] 43%|████▎     | 168777/393248 [00:03<00:04, 48664.29it/s] 44%|████▍     | 173669/393248 [00:04<00:04, 48437.37it/s] 45%|████▌     | 178530/393248 [00:04<00:04, 47329.99it/s] 47%|████▋     | 184167/393248 [00:04<00:04, 49040.51it/s] 48%|████▊     | 189810/393248 [00:04<00:04, 49720.17it/s] 50%|████▉     | 196479/393248 [00:04<00:03, 54125.85it/s] 52%|█████▏    | 202635/393248 [00:04<00:03, 55217.58it/s] 53%|█████▎    | 209304/393248 [00:04<00:03, 58097.09it/s] 55%|█████▍    | 215131/393248 [00:04<00:03, 56930.96it/s] 56%|█████▌    | 221103/393248 [00:04<00:02, 57588.03it/s] 58%|█████▊    | 226874/393248 [00:04<00:03, 53577.75it/s] 59%|█████▉    | 232389/393248 [00:05<00:03, 51798.13it/s] 61%|██████    | 238032/393248 [00:05<00:02, 52878.08it/s] 62%|██████▏   | 243359/393248 [00:05<00:02, 51717.89it/s] 64%|██████▎   | 249831/393248 [00:05<00:02, 54739.68it/s] 65%|██████▌   | 255987/393248 [00:05<00:02, 56626.25it/s] 67%|██████▋   | 261679/393248 [00:05<00:02, 53320.44it/s] 68%|██████▊   | 267064/393248 [00:05<00:02, 51794.65it/s] 69%|██████▉   | 272282/393248 [00:05<00:02, 50775.26it/s] 71%|███████   | 278046/393248 [00:05<00:02, 52595.06it/s] 72%|███████▏  | 283335/393248 [00:06<00:02, 52322.90it/s] 73%|███████▎  | 288819/393248 [00:06<00:02, 52095.91it/s] 75%|███████▍  | 294462/393248 [00:06<00:01, 53333.58it/s] 76%|███████▋  | 300105/393248 [00:06<00:01, 53893.51it/s] 78%|███████▊  | 305506/393248 [00:06<00:01, 53777.17it/s] 79%|███████▉  | 310892/393248 [00:06<00:01, 53093.78it/s] 81%|████████  | 317034/393248 [00:06<00:01, 54428.62it/s] 82%|████████▏ | 323190/393248 [00:06<00:01, 55132.88it/s] 84%|████████▍ | 330372/393248 [00:06<00:01, 58752.49it/s] 86%|████████▌ | 336528/393248 [00:07<00:00, 59471.19it/s] 87%|████████▋ | 342475/393248 [00:07<00:00, 54268.87it/s] 88%|████████▊ | 347980/393248 [00:07<00:00, 53572.68it/s] 90%|█████████ | 353970/393248 [00:07<00:00, 54673.59it/s] 91%|█████████▏| 359613/393248 [00:07<00:00, 54784.52it/s] 93%|█████████▎| 365769/393248 [00:07<00:00, 56694.14it/s] 94%|█████████▍| 371468/393248 [00:07<00:00, 52046.51it/s] 96%|█████████▌| 376759/393248 [00:07<00:00, 51881.09it/s] 97%|█████████▋| 383211/393248 [00:07<00:00, 54846.41it/s] 99%|█████████▉| 389880/393248 [00:07<00:00, 57794.51it/s]100%|██████████| 393248/393248 [00:08<00:00, 48973.52it/s]
The spherical harmonics array is 346.53 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 98.25422406196594 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 2.1605574258206706
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.0005, 'pow_max': 0.00055, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 13.06it/s] 21%|██        | 4/19 [00:00<00:01, 13.96it/s] 32%|███▏      | 6/19 [00:00<00:00, 14.82it/s] 42%|████▏     | 8/19 [00:00<00:00, 15.74it/s] 53%|█████▎    | 10/19 [00:00<00:00, 16.68it/s] 68%|██████▊   | 13/19 [00:00<00:00, 18.07it/s] 84%|████████▍ | 16/19 [00:00<00:00, 19.62it/s]100%|██████████| 19/19 [00:01<00:00, 20.75it/s]100%|██████████| 19/19 [00:01<00:00, 18.16it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5563266 Minimum k_amp 0.00020658328967625562 n_x_max 110 n_z_max 110
Time to get list of k, phi, theta: 0.6307873725891113 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0706865355710117
Ratio of unique |k|: 0.0018102675658507072
Time to get unique k and theta: 1.3106985092163086 seconds

Getting transfer functions
  0%|          | 0/10071 [00:00<?, ?it/s]  2%|▏         | 182/10071 [00:00<00:05, 1751.28it/s]  4%|▍         | 434/10071 [00:00<00:04, 2192.11it/s]  7%|▋         | 700/10071 [00:00<00:03, 2348.03it/s]  9%|▉         | 952/10071 [00:00<00:03, 2366.60it/s] 12%|█▏        | 1190/10071 [00:00<00:03, 2321.88it/s] 14%|█▍        | 1456/10071 [00:00<00:03, 2416.08it/s] 17%|█▋        | 1736/10071 [00:00<00:03, 2510.36it/s] 20%|██        | 2016/10071 [00:00<00:03, 2577.70it/s] 23%|██▎       | 2282/10071 [00:00<00:03, 2573.79it/s] 25%|██▌       | 2548/10071 [00:01<00:02, 2569.74it/s] 28%|██▊       | 2842/10071 [00:01<00:02, 2679.36it/s] 31%|███▏      | 3164/10071 [00:01<00:02, 2813.60it/s] 34%|███▍      | 3472/10071 [00:01<00:02, 2884.61it/s] 38%|███▊      | 3850/10071 [00:01<00:01, 3126.80it/s] 42%|████▏     | 4186/10071 [00:01<00:01, 3189.93it/s] 45%|████▍     | 4508/10071 [00:01<00:01, 3168.71it/s] 48%|████▊     | 4825/10071 [00:01<00:01, 3156.29it/s] 51%|█████     | 5152/10071 [00:01<00:01, 3165.65it/s] 55%|█████▍    | 5530/10071 [00:01<00:01, 3324.95it/s] 58%|█████▊    | 5863/10071 [00:02<00:01, 3298.18it/s] 61%|██████▏   | 6193/10071 [00:02<00:01, 3204.23it/s] 65%|██████▍   | 6538/10071 [00:02<00:01, 3250.10it/s] 69%|██████▊   | 6916/10071 [00:02<00:00, 3391.73it/s] 72%|███████▏  | 7280/10071 [00:02<00:00, 3431.42it/s] 76%|███████▌  | 7630/10071 [00:02<00:00, 3426.49it/s] 79%|███████▉  | 7980/10071 [00:02<00:00, 3439.63it/s] 83%|████████▎ | 8344/10071 [00:02<00:00, 3471.57it/s] 86%|████████▋ | 8692/10071 [00:02<00:00, 3454.00it/s] 90%|████████▉ | 9038/10071 [00:02<00:00, 3437.22it/s] 93%|█████████▎| 9382/10071 [00:03<00:00, 3418.71it/s] 97%|█████████▋| 9724/10071 [00:03<00:00, 3366.65it/s]100%|█████████▉| 10061/10071 [00:03<00:00, 3353.35it/s]100%|██████████| 10071/10071 [00:03<00:00, 3054.30it/s]
Size of transfer function: 1.61 MB. 

Size of integrand: 33.88 MB. Time to calculate integrand: 0.02016758918762207 s

Getting spherical harmonics
  0%|          | 0/393248 [00:00<?, ?it/s]  0%|          | 1026/393248 [00:00<00:38, 10235.78it/s]  1%|▏         | 5643/393248 [00:00<00:12, 30154.51it/s]  2%|▏         | 9234/393248 [00:00<00:12, 31736.64it/s]  3%|▎         | 13338/393248 [00:00<00:11, 34245.38it/s]  4%|▍         | 16929/393248 [00:00<00:10, 34658.20it/s]  5%|▌         | 21546/393248 [00:00<00:09, 37988.09it/s]  7%|▋         | 26163/393248 [00:00<00:09, 39548.25it/s]  8%|▊         | 30110/393248 [00:00<00:11, 32950.71it/s]  9%|▊         | 34371/393248 [00:01<00:10, 35033.29it/s] 10%|▉         | 38988/393248 [00:01<00:09, 37879.39it/s] 11%|█         | 44118/393248 [00:01<00:08, 40585.52it/s] 12%|█▏        | 48735/393248 [00:01<00:08, 42132.22it/s] 14%|█▎        | 53352/393248 [00:01<00:07, 42497.55it/s] 15%|█▍        | 57657/393248 [00:01<00:07, 42281.76it/s] 16%|█▌        | 62586/393248 [00:01<00:07, 43572.18it/s] 17%|█▋        | 68229/393248 [00:01<00:07, 45239.79it/s] 19%|█▊        | 72763/393248 [00:01<00:07, 42305.74it/s] 20%|█▉        | 77976/393248 [00:01<00:07, 44432.33it/s] 21%|██        | 83106/393248 [00:02<00:06, 45745.21it/s] 22%|██▏       | 87711/393248 [00:02<00:06, 44305.47it/s] 23%|██▎       | 92166/393248 [00:02<00:07, 40683.97it/s] 24%|██▍       | 96294/393248 [00:02<00:07, 38845.57it/s] 26%|██▌       | 101574/393248 [00:02<00:06, 42206.69it/s] 27%|██▋       | 106704/393248 [00:02<00:06, 44492.28it/s] 28%|██▊       | 111834/393248 [00:02<00:06, 46375.52it/s] 30%|██▉       | 116964/393248 [00:02<00:05, 46996.58it/s] 31%|███       | 122607/393248 [00:02<00:05, 48510.42it/s] 32%|███▏      | 127484/393248 [00:03<00:05, 48218.03it/s] 34%|███▎      | 132354/393248 [00:03<00:05, 47128.74it/s] 35%|███▌      | 137997/393248 [00:03<00:05, 49033.33it/s] 36%|███▋      | 143127/393248 [00:03<00:05, 49603.37it/s] 38%|███▊      | 149283/393248 [00:03<00:04, 51662.57it/s] 40%|███▉      | 156978/393248 [00:03<00:04, 58685.54it/s] 41%|████▏     | 163134/393248 [00:03<00:03, 58322.04it/s] 43%|████▎     | 168983/393248 [00:04<00:06, 35628.52it/s] 44%|████▍     | 173625/393248 [00:04<00:09, 23856.25it/s] 45%|████▌     | 177231/393248 [00:04<00:09, 22435.60it/s] 46%|████▌     | 180308/393248 [00:04<00:10, 19630.26it/s] 47%|████▋     | 182861/393248 [00:04<00:10, 19386.70it/s] 47%|████▋     | 185202/393248 [00:05<00:11, 17994.89it/s] 48%|████▊     | 187264/393248 [00:05<00:12, 16404.83it/s] 48%|████▊     | 189074/393248 [00:05<00:12, 16578.24it/s] 49%|████▊     | 190860/393248 [00:05<00:13, 14756.80it/s] 49%|████▉     | 192431/393248 [00:05<00:14, 14138.49it/s] 49%|████▉     | 193914/393248 [00:05<00:14, 13428.36it/s] 50%|████▉     | 195287/393248 [00:05<00:15, 12478.71it/s] 50%|█████     | 197505/393248 [00:06<00:14, 13858.04it/s] 51%|█████     | 199044/393248 [00:06<00:15, 12487.19it/s] 51%|█████     | 201096/393248 [00:06<00:14, 13364.71it/s] 52%|█████▏    | 202635/393248 [00:06<00:14, 13205.21it/s] 52%|█████▏    | 204174/393248 [00:06<00:14, 13115.84it/s] 52%|█████▏    | 206226/393248 [00:06<00:13, 13608.64it/s] 53%|█████▎    | 208278/393248 [00:06<00:12, 14598.45it/s] 53%|█████▎    | 210330/393248 [00:07<00:12, 15217.07it/s] 54%|█████▍    | 211869/393248 [00:07<00:12, 14969.14it/s] 54%|█████▍    | 213408/393248 [00:07<00:12, 13875.88it/s] 55%|█████▍    | 214947/393248 [00:07<00:12, 14160.00it/s] 55%|█████▌    | 216999/393248 [00:07<00:11, 15612.17it/s] 56%|█████▌    | 219051/393248 [00:07<00:11, 15642.10it/s] 56%|█████▌    | 220629/393248 [00:07<00:11, 15531.09it/s] 57%|█████▋    | 222191/393248 [00:07<00:11, 15433.23it/s] 57%|█████▋    | 223740/393248 [00:07<00:11, 15316.76it/s] 57%|█████▋    | 225720/393248 [00:08<00:11, 15228.32it/s] 58%|█████▊    | 227259/393248 [00:08<00:11, 14186.93it/s] 59%|█████▉    | 231363/393248 [00:08<00:07, 21228.72it/s] 60%|██████    | 237519/393248 [00:08<00:04, 32098.59it/s] 62%|██████▏   | 243675/393248 [00:08<00:03, 40151.00it/s] 64%|██████▍   | 250857/393248 [00:08<00:02, 48751.21it/s] 65%|██████▌   | 256500/393248 [00:08<00:02, 50792.45it/s] 67%|██████▋   | 262656/393248 [00:08<00:02, 52851.42it/s] 68%|██████▊   | 268011/393248 [00:08<00:02, 48836.96it/s] 69%|██████▉   | 272997/393248 [00:09<00:03, 38560.44it/s] 70%|███████   | 277237/393248 [00:09<00:04, 27289.94it/s] 71%|███████▏  | 280645/393248 [00:09<00:04, 24975.06it/s] 72%|███████▏  | 283611/393248 [00:09<00:04, 24347.16it/s] 73%|███████▎  | 286358/393248 [00:09<00:05, 19727.52it/s] 73%|███████▎  | 288639/393248 [00:10<00:05, 19712.51it/s] 74%|███████▍  | 290825/393248 [00:10<00:06, 16645.20it/s] 74%|███████▍  | 292680/393248 [00:10<00:07, 14185.98it/s] 75%|███████▍  | 294254/393248 [00:10<00:07, 13501.30it/s] 75%|███████▌  | 295697/393248 [00:10<00:07, 12798.34it/s] 76%|███████▌  | 297540/393248 [00:10<00:06, 13786.55it/s] 76%|███████▌  | 299592/393248 [00:10<00:06, 14969.86it/s] 77%|███████▋  | 301164/393248 [00:11<00:06, 13601.67it/s] 77%|███████▋  | 302670/393248 [00:11<00:07, 12894.64it/s] 77%|███████▋  | 304722/393248 [00:11<00:06, 13678.68it/s] 78%|███████▊  | 306261/393248 [00:11<00:06, 13097.22it/s] 78%|███████▊  | 307800/393248 [00:11<00:06, 12746.69it/s] 79%|███████▊  | 309339/393248 [00:11<00:06, 12774.82it/s] 79%|███████▉  | 310878/393248 [00:11<00:06, 12884.47it/s] 80%|███████▉  | 312930/393248 [00:11<00:05, 13731.89it/s] 80%|███████▉  | 314469/393248 [00:12<00:05, 13389.55it/s] 80%|████████  | 316008/393248 [00:12<00:05, 13185.04it/s] 81%|████████  | 318060/393248 [00:12<00:05, 13600.29it/s] 81%|████████▏ | 320112/393248 [00:12<00:04, 15268.79it/s] 82%|████████▏ | 322164/393248 [00:12<00:04, 15763.46it/s] 82%|████████▏ | 323762/393248 [00:12<00:04, 15749.02it/s] 83%|████████▎ | 325352/393248 [00:12<00:04, 15738.37it/s] 83%|████████▎ | 327294/393248 [00:12<00:04, 16444.40it/s] 84%|████████▎ | 328948/393248 [00:13<00:04, 15151.71it/s] 84%|████████▍ | 330485/393248 [00:13<00:04, 14020.98it/s] 84%|████████▍ | 331911/393248 [00:13<00:04, 13988.21it/s] 85%|████████▍ | 333450/393248 [00:13<00:04, 14323.91it/s] 85%|████████▌ | 335179/393248 [00:13<00:03, 15149.36it/s] 86%|████████▌ | 336711/393248 [00:13<00:03, 15027.05it/s] 86%|████████▌ | 338226/393248 [00:13<00:03, 14950.51it/s] 86%|████████▋ | 339729/393248 [00:13<00:03, 13753.23it/s] 87%|████████▋ | 341145/393248 [00:13<00:03, 13113.28it/s] 87%|████████▋ | 343710/393248 [00:14<00:03, 15846.76it/s] 88%|████████▊ | 345762/393248 [00:14<00:02, 15976.83it/s] 88%|████████▊ | 347368/393248 [00:14<00:03, 13838.45it/s] 89%|████████▊ | 348840/393248 [00:14<00:03, 13971.32it/s] 89%|████████▉ | 351405/393248 [00:14<00:02, 16380.91it/s] 90%|████████▉ | 353078/393248 [00:14<00:02, 16073.41it/s] 90%|█████████ | 354708/393248 [00:14<00:02, 15722.88it/s] 91%|█████████ | 356535/393248 [00:14<00:02, 15996.23it/s] 91%|█████████ | 358146/393248 [00:15<00:02, 14136.22it/s] 92%|█████████▏| 360639/393248 [00:15<00:01, 16499.91it/s] 92%|█████████▏| 362338/393248 [00:15<00:01, 16296.34it/s] 93%|█████████▎| 364000/393248 [00:15<00:01, 14747.09it/s] 93%|█████████▎| 366795/393248 [00:15<00:01, 18142.08it/s] 94%|█████████▍| 368695/393248 [00:15<00:01, 18227.49it/s] 94%|█████████▍| 370899/393248 [00:15<00:01, 18933.45it/s] 95%|█████████▍| 372838/393248 [00:15<00:01, 18910.10it/s] 95%|█████████▌| 374761/393248 [00:15<00:01, 17599.19it/s] 96%|█████████▌| 376557/393248 [00:16<00:00, 17429.65it/s] 96%|█████████▋| 378594/393248 [00:16<00:00, 18208.50it/s] 97%|█████████▋| 380438/393248 [00:16<00:00, 18003.24it/s] 97%|█████████▋| 382254/393248 [00:16<00:00, 14747.01it/s] 98%|█████████▊| 383831/393248 [00:16<00:00, 14858.13it/s] 98%|█████████▊| 387315/393248 [00:16<00:00, 19641.68it/s]100%|█████████▉| 391419/393248 [00:16<00:00, 24408.44it/s]100%|██████████| 393248/393248 [00:16<00:00, 23379.15it/s]
The spherical harmonics array is 346.53 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 100.35769128799438 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 2.0903457030761863
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.0006, 'pow_max': 0.00065, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 16%|█▌        | 3/19 [00:00<00:00, 21.01it/s] 32%|███▏      | 6/19 [00:00<00:00, 21.62it/s] 47%|████▋     | 9/19 [00:00<00:00, 22.24it/s] 63%|██████▎   | 12/19 [00:00<00:00, 22.54it/s] 79%|███████▉  | 15/19 [00:00<00:00, 22.78it/s] 95%|█████████▍| 18/19 [00:00<00:00, 22.92it/s]100%|██████████| 19/19 [00:00<00:00, 22.59it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5563266 Minimum k_amp 0.00020658328967625562 n_x_max 110 n_z_max 110
Time to get list of k, phi, theta: 0.6736671924591064 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0706865355710117
Ratio of unique |k|: 0.0018102675658507072
Time to get unique k and theta: 1.3295893669128418 seconds

Getting transfer functions
  0%|          | 0/10071 [00:00<?, ?it/s]  0%|          | 14/10071 [00:00<01:28, 113.26it/s]  2%|▏         | 168/10071 [00:00<00:11, 858.23it/s]  4%|▍         | 406/10071 [00:00<00:06, 1496.07it/s]  6%|▋         | 630/10071 [00:00<00:05, 1752.63it/s]  9%|▊         | 868/10071 [00:00<00:04, 1933.38it/s] 11%|█         | 1120/10071 [00:00<00:04, 2084.77it/s] 13%|█▎        | 1344/10071 [00:00<00:04, 2107.72it/s] 16%|█▌        | 1596/10071 [00:00<00:03, 2188.81it/s] 18%|█▊        | 1834/10071 [00:00<00:03, 2234.99it/s] 21%|██        | 2086/10071 [00:01<00:03, 2299.76it/s] 23%|██▎       | 2317/10071 [00:01<00:03, 2291.41it/s] 25%|██▌       | 2547/10071 [00:01<00:03, 2272.90it/s] 28%|██▊       | 2800/10071 [00:01<00:03, 2325.50it/s] 31%|███▏      | 3150/10071 [00:01<00:02, 2670.06it/s] 34%|███▍      | 3458/10071 [00:01<00:02, 2783.24it/s] 37%|███▋      | 3766/10071 [00:01<00:02, 2850.29it/s] 41%|████      | 4102/10071 [00:01<00:01, 2992.99it/s] 44%|████▍     | 4438/10071 [00:01<00:01, 3060.68it/s] 47%|████▋     | 4760/10071 [00:01<00:01, 3068.52it/s] 50%|█████     | 5082/10071 [00:02<00:01, 3100.29it/s] 54%|█████▍    | 5418/10071 [00:02<00:01, 3176.38it/s] 57%|█████▋    | 5736/10071 [00:02<00:01, 3171.24it/s] 60%|██████    | 6054/10071 [00:02<00:01, 3147.42it/s] 64%|██████▎   | 6412/10071 [00:02<00:01, 3254.91it/s] 67%|██████▋   | 6738/10071 [00:02<00:01, 3242.08it/s] 70%|███████   | 7070/10071 [00:02<00:00, 3232.47it/s] 74%|███████▎  | 7420/10071 [00:02<00:00, 3276.32it/s] 77%|███████▋  | 7748/10071 [00:02<00:00, 3230.42it/s] 80%|████████  | 8106/10071 [00:03<00:00, 3296.63it/s] 84%|████████▍ | 8436/10071 [00:03<00:00, 3273.83it/s] 87%|████████▋ | 8792/10071 [00:03<00:00, 3330.26it/s] 91%|█████████ | 9128/10071 [00:03<00:00, 3307.62it/s] 94%|█████████▍| 9478/10071 [00:03<00:00, 3341.59it/s] 97%|█████████▋| 9813/10071 [00:03<00:00, 3209.14it/s]100%|██████████| 10071/10071 [00:03<00:00, 2784.20it/s]
Size of transfer function: 1.61 MB. 

Size of integrand: 33.88 MB. Time to calculate integrand: 0.021862268447875977 s

Getting spherical harmonics
  0%|          | 0/393248 [00:00<?, ?it/s]  1%|          | 4617/393248 [00:00<00:09, 43051.74it/s]  2%|▏         | 9234/393248 [00:00<00:08, 44016.13it/s]  4%|▎         | 13851/393248 [00:00<00:08, 42936.92it/s]  5%|▍         | 18149/393248 [00:00<00:09, 39623.41it/s]  6%|▌         | 23598/393248 [00:00<00:08, 43919.58it/s]  7%|▋         | 28728/393248 [00:00<00:07, 46044.74it/s]  8%|▊         | 33372/393248 [00:00<00:07, 45856.39it/s] 10%|▉         | 38475/393248 [00:00<00:07, 46613.40it/s] 11%|█         | 43154/393248 [00:00<00:07, 44333.73it/s] 12%|█▏        | 47709/393248 [00:01<00:07, 44162.22it/s] 13%|█▎        | 52326/393248 [00:01<00:07, 44594.56it/s] 14%|█▍        | 56943/393248 [00:01<00:07, 44752.29it/s] 16%|█▌        | 61560/393248 [00:01<00:07, 44950.39it/s] 17%|█▋        | 66379/393248 [00:01<00:07, 45902.72it/s] 18%|█▊        | 70978/393248 [00:01<00:07, 44943.57it/s] 19%|█▉        | 75481/393248 [00:01<00:07, 39818.38it/s] 20%|██        | 79569/393248 [00:01<00:08, 35055.18it/s] 22%|██▏       | 84645/393248 [00:02<00:08, 37279.98it/s] 23%|██▎       | 89262/393248 [00:02<00:07, 38865.63it/s] 24%|██▍       | 94392/393248 [00:02<00:07, 41707.26it/s] 25%|██▌       | 99009/393248 [00:02<00:06, 42666.50it/s] 27%|██▋       | 104652/393248 [00:02<00:06, 46390.76it/s] 28%|██▊       | 110808/393248 [00:02<00:05, 50479.68it/s] 30%|██▉       | 116451/393248 [00:02<00:05, 51678.27it/s] 31%|███       | 121674/393248 [00:02<00:05, 51403.63it/s] 32%|███▏      | 126853/393248 [00:02<00:05, 50906.29it/s] 34%|███▎      | 131970/393248 [00:02<00:05, 49112.07it/s] 35%|███▌      | 137997/393248 [00:03<00:05, 50423.68it/s] 36%|███▋      | 143055/393248 [00:03<00:05, 49637.71it/s] 38%|███▊      | 148770/393248 [00:03<00:04, 50256.80it/s] 39%|███▉      | 154926/393248 [00:03<00:04, 52204.94it/s] 41%|████▏     | 162621/393248 [00:03<00:03, 58262.39it/s] 43%|████▎     | 168462/393248 [00:03<00:03, 56582.04it/s] 44%|████▍     | 174134/393248 [00:03<00:04, 54249.10it/s] 46%|████▌     | 179578/393248 [00:03<00:03, 53488.59it/s] 47%|████▋     | 186732/393248 [00:03<00:03, 57858.16it/s] 49%|████▉     | 193914/393248 [00:04<00:03, 60697.71it/s] 51%|█████     | 200001/393248 [00:04<00:03, 58760.56it/s] 52%|█████▏    | 205895/393248 [00:04<00:03, 53002.31it/s] 54%|█████▎    | 211295/393248 [00:04<00:03, 51332.84it/s] 55%|█████▌    | 216495/393248 [00:04<00:03, 46518.39it/s] 56%|█████▋    | 222129/393248 [00:04<00:03, 48777.22it/s] 58%|█████▊    | 227112/393248 [00:04<00:03, 45143.82it/s] 59%|█████▉    | 231729/393248 [00:05<00:05, 30128.18it/s] 60%|█████▉    | 235431/393248 [00:05<00:06, 25743.30it/s] 61%|██████    | 238545/393248 [00:05<00:07, 21208.73it/s] 61%|██████▏   | 241115/393248 [00:05<00:08, 18805.66it/s] 62%|██████▏   | 243306/393248 [00:05<00:08, 17380.24it/s] 62%|██████▏   | 245240/393248 [00:06<00:08, 16840.65it/s] 63%|██████▎   | 247044/393248 [00:06<00:08, 16903.00it/s] 63%|██████▎   | 248821/393248 [00:06<00:09, 15661.09it/s] 64%|██████▎   | 250442/393248 [00:06<00:09, 14598.33it/s] 64%|██████▍   | 251934/393248 [00:06<00:10, 13244.88it/s] 65%|██████▍   | 254448/393248 [00:06<00:08, 15658.89it/s] 65%|██████▌   | 256089/393248 [00:06<00:08, 15767.20it/s] 66%|██████▌   | 258552/393248 [00:06<00:07, 17948.79it/s] 67%|██████▋   | 263169/393248 [00:06<00:05, 25407.55it/s] 68%|██████▊   | 269325/393248 [00:07<00:03, 34105.27it/s] 70%|██████▉   | 274455/393248 [00:07<00:03, 34686.62it/s] 71%|███████   | 277980/393248 [00:07<00:04, 26716.00it/s] 71%|███████▏  | 280935/393248 [00:07<00:05, 22225.62it/s] 72%|███████▏  | 283439/393248 [00:07<00:05, 20582.47it/s] 73%|███████▎  | 285684/393248 [00:07<00:05, 19721.93it/s] 73%|███████▎  | 287772/393248 [00:08<00:05, 17716.52it/s] 74%|███████▎  | 289630/393248 [00:08<00:06, 15535.76it/s] 74%|███████▍  | 291258/393248 [00:08<00:06, 15327.90it/s] 74%|███████▍  | 292837/393248 [00:08<00:06, 15084.07it/s] 75%|███████▌  | 296514/393248 [00:08<00:04, 20117.25it/s] 77%|███████▋  | 301644/393248 [00:08<00:03, 28051.48it/s] 78%|███████▊  | 307287/393248 [00:08<00:02, 35396.61it/s] 80%|███████▉  | 314469/393248 [00:08<00:01, 45223.62it/s] 82%|████████▏ | 321138/393248 [00:08<00:01, 50312.21it/s] 83%|████████▎ | 326350/393248 [00:09<00:01, 47950.62it/s] 84%|████████▍ | 331911/393248 [00:09<00:01, 49722.05it/s] 86%|████████▌ | 336996/393248 [00:09<00:01, 43690.42it/s] 87%|████████▋ | 341562/393248 [00:09<00:01, 27892.83it/s] 88%|████████▊ | 345179/393248 [00:09<00:02, 22086.97it/s] 89%|████████▊ | 348104/393248 [00:10<00:02, 20674.37it/s] 89%|████████▉ | 350653/393248 [00:10<00:02, 18484.60it/s] 90%|████████▉ | 352833/393248 [00:10<00:02, 17812.99it/s] 90%|█████████ | 354827/393248 [00:10<00:02, 15635.95it/s] 91%|█████████ | 356544/393248 [00:10<00:02, 13959.27it/s] 91%|█████████ | 358587/393248 [00:10<00:02, 15126.25it/s] 92%|█████████▏| 360233/393248 [00:11<00:02, 14799.79it/s] 92%|█████████▏| 361799/393248 [00:11<00:02, 14995.01it/s] 92%|█████████▏| 363365/393248 [00:11<00:01, 15112.74it/s] 93%|█████████▎| 365256/393248 [00:11<00:01, 15424.24it/s] 93%|█████████▎| 366834/393248 [00:11<00:01, 15513.41it/s] 94%|█████████▎| 368412/393248 [00:11<00:01, 13909.71it/s] 94%|█████████▍| 369873/393248 [00:11<00:01, 13999.30it/s] 94%|█████████▍| 371412/393248 [00:11<00:01, 13226.86it/s] 95%|█████████▍| 372762/393248 [00:11<00:01, 13186.65it/s] 95%|█████████▌| 374100/393248 [00:12<00:01, 12351.64it/s] 95%|█████████▌| 375516/393248 [00:12<00:01, 12476.45it/s] 96%|█████████▌| 378081/393248 [00:12<00:01, 14854.74it/s] 97%|█████████▋| 379620/393248 [00:12<00:00, 14847.23it/s] 97%|█████████▋| 381672/393248 [00:12<00:00, 16142.70it/s] 97%|█████████▋| 383292/393248 [00:12<00:00, 16049.94it/s] 98%|█████████▊| 384901/393248 [00:12<00:00, 14916.33it/s] 98%|█████████▊| 386406/393248 [00:12<00:00, 13700.41it/s] 99%|█████████▊| 387828/393248 [00:12<00:00, 13627.67it/s] 99%|█████████▉| 389367/393248 [00:13<00:00, 13111.69it/s] 99%|█████████▉| 390692/393248 [00:13<00:00, 12927.67it/s]100%|█████████▉| 392445/393248 [00:13<00:00, 12968.34it/s]100%|██████████| 393248/393248 [00:13<00:00, 29355.29it/s]
The spherical harmonics array is 346.53 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 90.36182808876038 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 2.0049440558199647
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.0007, 'pow_max': 0.00075, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 18.66it/s] 26%|██▋       | 5/19 [00:00<00:00, 20.31it/s] 42%|████▏     | 8/19 [00:00<00:00, 20.67it/s] 58%|█████▊    | 11/19 [00:00<00:00, 21.61it/s] 74%|███████▎  | 14/19 [00:00<00:00, 22.15it/s] 89%|████████▉ | 17/19 [00:00<00:00, 22.09it/s]100%|██████████| 19/19 [00:00<00:00, 21.74it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5563266 Minimum k_amp 0.00020658328967625562 n_x_max 110 n_z_max 110
Time to get list of k, phi, theta: 0.6663308143615723 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0706865355710117
Ratio of unique |k|: 0.0018102675658507072
Time to get unique k and theta: 1.3221054077148438 seconds

Getting transfer functions
  0%|          | 0/10071 [00:00<?, ?it/s]  2%|▏         | 182/10071 [00:00<00:05, 1737.15it/s]  4%|▍         | 434/10071 [00:00<00:04, 2125.98it/s]  7%|▋         | 658/10071 [00:00<00:04, 2168.80it/s]  9%|▉         | 896/10071 [00:00<00:04, 2248.35it/s] 11%|█▏        | 1148/10071 [00:00<00:03, 2304.49it/s] 14%|█▍        | 1400/10071 [00:00<00:03, 2373.60it/s] 16%|█▋        | 1652/10071 [00:00<00:03, 2405.94it/s] 19%|█▉        | 1918/10071 [00:00<00:03, 2447.05it/s] 22%|██▏       | 2184/10071 [00:00<00:03, 2509.51it/s] 24%|██▍       | 2450/10071 [00:01<00:03, 2515.74it/s] 27%|██▋       | 2716/10071 [00:01<00:02, 2532.14it/s] 30%|███       | 3052/10071 [00:01<00:02, 2765.34it/s] 34%|███▎      | 3374/10071 [00:01<00:02, 2882.52it/s] 37%|███▋      | 3710/10071 [00:01<00:02, 2995.27it/s] 41%|████      | 4088/10071 [00:01<00:01, 3201.36it/s] 44%|████▍     | 4410/10071 [00:01<00:01, 3188.25it/s] 47%|████▋     | 4746/10071 [00:01<00:01, 3197.55it/s] 50%|█████     | 5068/10071 [00:01<00:01, 3179.45it/s] 54%|█████▎    | 5404/10071 [00:01<00:01, 3215.51it/s] 57%|█████▋    | 5782/10071 [00:02<00:01, 3369.78it/s] 61%|██████    | 6120/10071 [00:02<00:01, 3299.96it/s] 65%|██████▍   | 6496/10071 [00:02<00:01, 3422.79it/s] 68%|██████▊   | 6839/10071 [00:02<00:00, 3419.86it/s] 71%|███████▏  | 7182/10071 [00:02<00:00, 3371.67it/s] 75%|███████▍  | 7520/10071 [00:02<00:00, 3334.27it/s] 78%|███████▊  | 7882/10071 [00:02<00:00, 3391.75it/s] 82%|████████▏ | 8222/10071 [00:02<00:00, 3346.34it/s] 85%|████████▌ | 8582/10071 [00:02<00:00, 3409.73it/s] 89%|████████▊ | 8924/10071 [00:02<00:00, 3339.76it/s] 92%|█████████▏| 9296/10071 [00:03<00:00, 3436.21it/s] 96%|█████████▌| 9641/10071 [00:03<00:00, 3351.52it/s] 99%|█████████▉| 9977/10071 [00:03<00:00, 3333.45it/s]100%|██████████| 10071/10071 [00:03<00:00, 3023.12it/s]
Size of transfer function: 1.61 MB. 

Size of integrand: 33.88 MB. Time to calculate integrand: 0.02232956886291504 s

Getting spherical harmonics
  0%|          | 0/393248 [00:00<?, ?it/s]  1%|▏         | 5130/393248 [00:00<00:08, 46928.23it/s]  3%|▎         | 10773/393248 [00:00<00:07, 50034.57it/s]  4%|▍         | 15903/393248 [00:00<00:08, 46366.39it/s]  5%|▌         | 20561/393248 [00:00<00:09, 39813.29it/s]  7%|▋         | 25650/393248 [00:00<00:08, 42970.79it/s]  8%|▊         | 30060/393248 [00:00<00:08, 40854.80it/s]  9%|▊         | 34222/393248 [00:00<00:09, 38643.30it/s] 10%|▉         | 38475/393248 [00:00<00:09, 37933.39it/s] 11%|█         | 42579/393248 [00:01<00:09, 38670.80it/s] 12%|█▏        | 46683/393248 [00:01<00:08, 38814.25it/s] 13%|█▎        | 51300/393248 [00:01<00:08, 39086.12it/s] 14%|█▍        | 55225/393248 [00:01<00:08, 38417.03it/s] 15%|█▌        | 60021/393248 [00:01<00:08, 39704.54it/s] 16%|█▋        | 64125/393248 [00:01<00:08, 39606.76it/s] 17%|█▋        | 68089/393248 [00:01<00:10, 29626.15it/s] 18%|█▊        | 71820/393248 [00:01<00:10, 30909.48it/s] 19%|█▉        | 76437/393248 [00:02<00:09, 34524.09it/s] 21%|██        | 81054/393248 [00:02<00:08, 37401.30it/s] 22%|██▏       | 86184/393248 [00:02<00:07, 39856.98it/s] 23%|██▎       | 90337/393248 [00:02<00:07, 39981.16it/s] 24%|██▍       | 94905/393248 [00:02<00:07, 41077.83it/s] 25%|██▌       | 99101/393248 [00:02<00:07, 39786.65it/s] 26%|██▋       | 104139/393248 [00:02<00:06, 42404.22it/s] 28%|██▊       | 109782/393248 [00:02<00:06, 46163.28it/s] 29%|██▉       | 114457/393248 [00:02<00:06, 45630.48it/s] 31%|███       | 121068/393248 [00:02<00:05, 51514.86it/s] 32%|███▏      | 126711/393248 [00:03<00:05, 51775.41it/s] 34%|███▎      | 132354/393248 [00:03<00:04, 52605.75it/s] 35%|███▌      | 138510/393248 [00:03<00:04, 54632.24it/s] 37%|███▋      | 144666/393248 [00:03<00:04, 55591.29it/s] 38%|███▊      | 150822/393248 [00:03<00:04, 57076.22it/s] 40%|███▉      | 156543/393248 [00:03<00:04, 50614.59it/s] 42%|████▏     | 163647/393248 [00:03<00:04, 55634.47it/s] 43%|████▎     | 169348/393248 [00:03<00:04, 55651.50it/s] 45%|████▍     | 175010/393248 [00:03<00:03, 55349.81it/s] 46%|████▋     | 182115/393248 [00:04<00:03, 57270.65it/s] 48%|████▊     | 188784/393248 [00:04<00:03, 58413.24it/s] 49%|████▉     | 194652/393248 [00:04<00:03, 57374.06it/s] 51%|█████     | 200583/393248 [00:04<00:03, 57298.58it/s] 52%|█████▏    | 206325/393248 [00:04<00:03, 56777.81it/s] 54%|█████▍    | 212010/393248 [00:04<00:03, 55837.40it/s] 55%|█████▌    | 218025/393248 [00:04<00:03, 56765.50it/s] 57%|█████▋    | 223708/393248 [00:04<00:03, 56240.96it/s] 59%|█████▉    | 231876/393248 [00:04<00:02, 61747.13it/s] 61%|██████    | 238032/393248 [00:05<00:02, 58895.60it/s] 62%|██████▏   | 243926/393248 [00:05<00:02, 54940.52it/s] 63%|██████▎   | 249460/393248 [00:05<00:02, 54848.20it/s] 65%|██████▍   | 254972/393248 [00:05<00:02, 54558.69it/s] 66%|██████▋   | 260604/393248 [00:05<00:02, 54549.71it/s] 68%|██████▊   | 266760/393248 [00:05<00:02, 56494.56it/s] 69%|██████▉   | 272916/393248 [00:05<00:02, 57153.71it/s] 71%|███████   | 278643/393248 [00:05<00:02, 56184.76it/s] 72%|███████▏  | 284715/393248 [00:05<00:01, 56282.62it/s] 74%|███████▍  | 291384/393248 [00:05<00:01, 57911.76it/s] 76%|███████▌  | 297178/393248 [00:06<00:01, 54525.18it/s] 77%|███████▋  | 302670/393248 [00:06<00:01, 54313.33it/s] 79%|███████▊  | 309339/393248 [00:06<00:01, 57269.39it/s] 80%|████████  | 315091/393248 [00:06<00:01, 55825.69it/s] 82%|████████▏ | 321651/393248 [00:06<00:01, 58163.44it/s] 83%|████████▎ | 327489/393248 [00:06<00:01, 52694.39it/s] 85%|████████▍ | 333450/393248 [00:06<00:01, 54565.56it/s] 86%|████████▌ | 339093/393248 [00:06<00:00, 54445.73it/s] 88%|████████▊ | 344736/393248 [00:06<00:00, 53875.86it/s] 89%|████████▉ | 350379/393248 [00:07<00:00, 53259.43it/s] 91%|█████████ | 356022/393248 [00:07<00:00, 53354.54it/s] 92%|█████████▏| 361665/393248 [00:07<00:00, 54050.72it/s] 93%|█████████▎| 367089/393248 [00:07<00:00, 50478.49it/s] 95%|█████████▍| 372438/393248 [00:07<00:00, 50870.02it/s] 96%|█████████▌| 377568/393248 [00:07<00:00, 49602.71it/s] 97%|█████████▋| 382698/393248 [00:07<00:00, 49680.28it/s] 99%|█████████▉| 390393/393248 [00:07<00:00, 56961.55it/s]100%|██████████| 393248/393248 [00:07<00:00, 50039.29it/s]
The spherical harmonics array is 346.53 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 87.22247958183289 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 1.908932216846038
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.0008, 'pow_max': 0.0008500000000000001, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 18.33it/s] 26%|██▋       | 5/19 [00:00<00:00, 19.64it/s] 42%|████▏     | 8/19 [00:00<00:00, 20.90it/s] 58%|█████▊    | 11/19 [00:00<00:00, 21.66it/s] 74%|███████▎  | 14/19 [00:00<00:00, 22.09it/s] 89%|████████▉ | 17/19 [00:00<00:00, 22.11it/s]100%|██████████| 19/19 [00:00<00:00, 21.66it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5563266 Minimum k_amp 0.00020658328967625562 n_x_max 110 n_z_max 110
Time to get list of k, phi, theta: 0.6650285720825195 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0706865355710117
Ratio of unique |k|: 0.0018102675658507072
Time to get unique k and theta: 1.3105852603912354 seconds

Getting transfer functions
  0%|          | 0/10071 [00:00<?, ?it/s]  1%|          | 84/10071 [00:00<00:12, 826.19it/s]  3%|▎         | 308/10071 [00:00<00:05, 1641.07it/s]  5%|▌         | 532/10071 [00:00<00:05, 1893.20it/s]  8%|▊         | 756/10071 [00:00<00:04, 2026.56it/s] 10%|▉         | 980/10071 [00:00<00:04, 2102.04it/s] 12%|█▏        | 1204/10071 [00:00<00:04, 2118.03it/s] 14%|█▍        | 1442/10071 [00:00<00:03, 2159.63it/s] 17%|█▋        | 1680/10071 [00:00<00:03, 2203.06it/s] 19%|█▉        | 1904/10071 [00:00<00:03, 2187.64it/s] 21%|██        | 2128/10071 [00:01<00:03, 2190.28it/s] 23%|██▎       | 2352/10071 [00:01<00:03, 2203.27it/s] 26%|██▌       | 2590/10071 [00:01<00:03, 2221.05it/s] 29%|██▊       | 2884/10071 [00:01<00:02, 2416.36it/s] 32%|███▏      | 3220/10071 [00:01<00:02, 2665.19it/s] 35%|███▌      | 3542/10071 [00:01<00:02, 2794.80it/s] 38%|███▊      | 3864/10071 [00:01<00:02, 2899.64it/s] 42%|████▏     | 4186/10071 [00:01<00:01, 2991.08it/s] 45%|████▍     | 4522/10071 [00:01<00:01, 3082.48it/s] 48%|████▊     | 4858/10071 [00:01<00:01, 3141.57it/s] 52%|█████▏    | 5222/10071 [00:02<00:01, 3271.96it/s] 55%|█████▌    | 5572/10071 [00:02<00:01, 3296.49it/s] 59%|█████▊    | 5908/10071 [00:02<00:01, 3297.13it/s] 62%|██████▏   | 6238/10071 [00:02<00:01, 3244.13it/s] 65%|██████▌   | 6566/10071 [00:02<00:01, 3229.19it/s] 69%|██████▊   | 6902/10071 [00:02<00:00, 3258.12it/s] 72%|███████▏  | 7228/10071 [00:02<00:00, 3142.05it/s] 75%|███████▌  | 7574/10071 [00:02<00:00, 3206.57it/s] 79%|███████▊  | 7924/10071 [00:02<00:00, 3276.13it/s] 82%|████████▏ | 8288/10071 [00:02<00:00, 3381.45it/s] 86%|████████▌ | 8627/10071 [00:03<00:00, 3366.35it/s] 89%|████████▉ | 8974/10071 [00:03<00:00, 3377.21it/s] 93%|█████████▎| 9324/10071 [00:03<00:00, 3398.87it/s] 96%|█████████▌| 9688/10071 [00:03<00:00, 3422.62it/s]100%|█████████▉| 10031/10071 [00:03<00:00, 3278.56it/s]100%|██████████| 10071/10071 [00:03<00:00, 2857.38it/s]
Size of transfer function: 1.61 MB. 

Size of integrand: 33.88 MB. Time to calculate integrand: 0.0260162353515625 s

Getting spherical harmonics
  0%|          | 0/393248 [00:00<?, ?it/s]  0%|          | 513/393248 [00:00<03:37, 1801.78it/s]  1%|▏         | 5643/393248 [00:00<00:21, 18024.93it/s]  2%|▏         | 8721/393248 [00:00<00:17, 21594.39it/s]  3%|▎         | 12690/393248 [00:00<00:14, 27173.03it/s]  4%|▍         | 16018/393248 [00:00<00:13, 27770.62it/s]  5%|▌         | 20799/393248 [00:00<00:11, 33674.30it/s]  6%|▋         | 25137/393248 [00:00<00:10, 36034.24it/s]  8%|▊         | 29754/393248 [00:01<00:09, 38573.99it/s]  9%|▉         | 35397/393248 [00:01<00:08, 43331.16it/s] 10%|█         | 40527/393248 [00:01<00:07, 45171.95it/s] 12%|█▏        | 45657/393248 [00:01<00:07, 46832.58it/s] 13%|█▎        | 51300/393248 [00:01<00:07, 48206.99it/s] 14%|█▍        | 56171/393248 [00:01<00:07, 46406.12it/s] 16%|█▌        | 61047/393248 [00:01<00:07, 45748.18it/s] 17%|█▋        | 65664/393248 [00:01<00:07, 45333.54it/s] 18%|█▊        | 70794/393248 [00:01<00:07, 45419.13it/s] 19%|█▉        | 75924/393248 [00:01<00:06, 46091.38it/s] 21%|██        | 81054/393248 [00:02<00:06, 47290.71it/s] 22%|██▏       | 86184/393248 [00:02<00:06, 47508.30it/s] 23%|██▎       | 91314/393248 [00:02<00:06, 48398.40it/s] 25%|██▍       | 96444/393248 [00:02<00:06, 49075.14it/s] 26%|██▌       | 101574/393248 [00:02<00:05, 49541.86it/s] 27%|██▋       | 107217/393248 [00:02<00:05, 50142.03it/s] 29%|██▊       | 112347/393248 [00:02<00:05, 49335.10it/s] 30%|██▉       | 117477/393248 [00:02<00:05, 49586.95it/s] 31%|███▏      | 123120/393248 [00:02<00:05, 50718.56it/s] 33%|███▎      | 129789/393248 [00:03<00:04, 54860.16it/s] 34%|███▍      | 135282/393248 [00:03<00:04, 52032.40it/s] 36%|███▌      | 141588/393248 [00:03<00:04, 54461.06it/s] 38%|███▊      | 147744/393248 [00:03<00:04, 56288.61it/s] 39%|███▉      | 154413/393248 [00:03<00:04, 58385.14it/s] 41%|████      | 160271/393248 [00:03<00:04, 56136.17it/s] 42%|████▏     | 165910/393248 [00:03<00:04, 55759.87it/s] 44%|████▎     | 171503/393248 [00:03<00:04, 53204.32it/s] 45%|████▍     | 176851/393248 [00:03<00:04, 53213.67it/s] 46%|████▋     | 182192/393248 [00:04<00:04, 52197.79it/s] 48%|████▊     | 187426/393248 [00:04<00:04, 50669.06it/s] 49%|████▉     | 193401/393248 [00:04<00:03, 51275.16it/s] 50%|█████     | 198536/393248 [00:04<00:04, 45533.80it/s] 52%|█████▏    | 204174/393248 [00:04<00:03, 47292.12it/s] 53%|█████▎    | 208989/393248 [00:04<00:04, 45015.07it/s] 54%|█████▍    | 213556/393248 [00:04<00:04, 44086.99it/s] 56%|█████▌    | 219051/393248 [00:04<00:03, 46684.17it/s] 57%|█████▋    | 225720/393248 [00:04<00:03, 50730.85it/s] 59%|█████▉    | 231363/393248 [00:05<00:03, 51534.72it/s] 60%|██████    | 236547/393248 [00:05<00:03, 50796.92it/s] 61%|██████▏   | 241646/393248 [00:05<00:03, 49081.93it/s] 63%|██████▎   | 246572/393248 [00:05<00:03, 48570.06it/s] 64%|██████▍   | 251883/393248 [00:05<00:02, 49285.20it/s] 65%|██████▌   | 257526/393248 [00:05<00:02, 49450.94it/s] 67%|██████▋   | 263682/393248 [00:05<00:02, 52489.30it/s] 69%|██████▊   | 269838/393248 [00:05<00:02, 54093.88it/s] 70%|██████▉   | 275260/393248 [00:05<00:02, 53896.56it/s] 71%|███████▏  | 280658/393248 [00:05<00:02, 52538.22it/s] 73%|███████▎  | 285921/393248 [00:06<00:02, 52422.62it/s] 74%|███████▍  | 291384/393248 [00:06<00:01, 52898.33it/s] 76%|███████▌  | 297540/393248 [00:06<00:01, 54203.16it/s] 77%|███████▋  | 303183/393248 [00:06<00:01, 54651.53it/s] 78%|███████▊  | 308650/393248 [00:06<00:01, 54397.08it/s] 80%|███████▉  | 314469/393248 [00:06<00:01, 52170.56it/s] 81%|████████▏ | 319711/393248 [00:06<00:01, 50660.37it/s] 83%|████████▎ | 325755/393248 [00:06<00:01, 52563.66it/s] 84%|████████▍ | 331721/393248 [00:06<00:01, 54574.35it/s] 86%|████████▌ | 337203/393248 [00:07<00:01, 52263.09it/s] 87%|████████▋ | 342461/393248 [00:07<00:01, 50026.00it/s] 89%|████████▊ | 348840/393248 [00:07<00:00, 53219.17it/s] 90%|█████████ | 354199/393248 [00:07<00:00, 52055.22it/s] 91%|█████████▏| 359431/393248 [00:07<00:00, 49939.64it/s] 93%|█████████▎| 365256/393248 [00:07<00:00, 52172.14it/s] 94%|█████████▍| 370508/393248 [00:07<00:00, 48523.84it/s] 96%|█████████▌| 377055/393248 [00:07<00:00, 52676.94it/s] 97%|█████████▋| 382396/393248 [00:07<00:00, 52420.92it/s] 99%|█████████▊| 387828/393248 [00:08<00:00, 52494.68it/s]100%|██████████| 393248/393248 [00:08<00:00, 48487.54it/s]
The spherical harmonics array is 346.53 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 92.35449814796448 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 1.930297009657357
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.0009, 'pow_max': 0.00095, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 11.74it/s] 21%|██        | 4/19 [00:00<00:01, 12.70it/s] 32%|███▏      | 6/19 [00:00<00:00, 13.51it/s] 42%|████▏     | 8/19 [00:00<00:00, 14.38it/s] 53%|█████▎    | 10/19 [00:00<00:00, 14.94it/s] 63%|██████▎   | 12/19 [00:00<00:00, 16.05it/s] 79%|███████▉  | 15/19 [00:00<00:00, 17.73it/s] 95%|█████████▍| 18/19 [00:01<00:00, 19.26it/s]100%|██████████| 19/19 [00:01<00:00, 16.75it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519265089295892
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5563266 Minimum k_amp 0.00020658328967625562 n_x_max 110 n_z_max 110
Time to get list of k, phi, theta: 0.6664817333221436 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0706865355710117
Ratio of unique |k|: 0.0018102675658507072
Time to get unique k and theta: 1.4911885261535645 seconds

Getting transfer functions
  0%|          | 0/10071 [00:00<?, ?it/s]  1%|          | 56/10071 [00:00<00:18, 547.49it/s]  3%|▎         | 266/10071 [00:00<00:06, 1451.23it/s]  5%|▍         | 462/10071 [00:00<00:05, 1650.96it/s]  7%|▋         | 700/10071 [00:00<00:04, 1904.67it/s]  9%|▉         | 938/10071 [00:00<00:04, 2043.09it/s] 11%|█▏        | 1143/10071 [00:00<00:04, 2045.08it/s] 13%|█▎        | 1358/10071 [00:00<00:04, 2048.65it/s] 16%|█▌        | 1610/10071 [00:00<00:03, 2159.53it/s] 18%|█▊        | 1834/10071 [00:00<00:03, 2140.47it/s] 21%|██        | 2086/10071 [00:01<00:03, 2222.44it/s] 23%|██▎       | 2338/10071 [00:01<00:03, 2282.45it/s] 26%|██▌       | 2576/10071 [00:01<00:03, 2299.63it/s] 28%|██▊       | 2870/10071 [00:01<00:02, 2465.59it/s] 32%|███▏      | 3192/10071 [00:01<00:02, 2660.04it/s] 35%|███▍      | 3500/10071 [00:01<00:02, 2758.77it/s] 38%|███▊      | 3850/10071 [00:01<00:02, 2948.87it/s] 42%|████▏     | 4186/10071 [00:01<00:01, 2996.36it/s] 45%|████▍     | 4486/10071 [00:01<00:01, 2972.82it/s] 48%|████▊     | 4802/10071 [00:01<00:01, 2989.52it/s] 51%|█████     | 5152/10071 [00:02<00:01, 3107.18it/s] 54%|█████▍    | 5463/10071 [00:02<00:01, 3103.59it/s] 58%|█████▊    | 5810/10071 [00:02<00:01, 3188.00it/s] 61%|██████▏   | 6174/10071 [00:02<00:01, 3305.80it/s] 65%|██████▍   | 6510/10071 [00:02<00:01, 3320.01it/s] 68%|██████▊   | 6843/10071 [00:02<00:00, 3299.87it/s] 71%|███████   | 7174/10071 [00:02<00:00, 3225.92it/s] 75%|███████▍  | 7518/10071 [00:02<00:00, 3271.23it/s] 78%|███████▊  | 7846/10071 [00:02<00:00, 3178.86it/s] 81%|████████  | 8176/10071 [00:03<00:00, 3200.44it/s] 85%|████████▍ | 8526/10071 [00:03<00:00, 3267.25it/s] 88%|████████▊ | 8904/10071 [00:03<00:00, 3409.76it/s] 92%|█████████▏| 9254/10071 [00:03<00:00, 3408.96it/s] 95%|█████████▌| 9604/10071 [00:03<00:00, 3434.35it/s] 99%|█████████▉| 9948/10071 [00:03<00:00, 3344.06it/s]100%|██████████| 10071/10071 [00:03<00:00, 2830.56it/s]
Size of transfer function: 1.61 MB. 

Size of integrand: 33.88 MB. Time to calculate integrand: 0.018105030059814453 s

Getting spherical harmonics
  0%|          | 0/393248 [00:00<?, ?it/s]  1%|          | 4104/393248 [00:00<00:11, 34483.75it/s]  2%|▏         | 9747/393248 [00:00<00:08, 43795.52it/s]  4%|▍         | 14877/393248 [00:00<00:08, 46000.27it/s]  5%|▌         | 20520/393248 [00:00<00:07, 48412.18it/s]  6%|▋         | 25380/393248 [00:00<00:08, 45319.89it/s]  8%|▊         | 30780/393248 [00:00<00:07, 47346.16it/s]  9%|▉         | 35546/393248 [00:00<00:07, 45649.65it/s] 10%|█         | 40135/393248 [00:00<00:08, 44127.26it/s] 11%|█▏        | 44631/393248 [00:01<00:08, 43468.61it/s] 13%|█▎        | 50787/393248 [00:01<00:07, 47318.35it/s] 14%|█▍        | 55917/393248 [00:01<00:06, 48391.19it/s] 16%|█▌        | 61560/393248 [00:01<00:06, 48917.10it/s] 17%|█▋        | 66459/393248 [00:01<00:06, 48318.23it/s] 18%|█▊        | 71307/393248 [00:01<00:06, 47616.04it/s] 20%|█▉        | 76950/393248 [00:01<00:06, 49946.72it/s] 21%|██        | 81955/393248 [00:01<00:07, 44321.96it/s] 22%|██▏       | 86500/393248 [00:01<00:08, 35381.09it/s] 23%|██▎       | 90801/393248 [00:02<00:08, 37091.21it/s] 24%|██▍       | 95931/393248 [00:02<00:07, 40492.40it/s] 26%|██▌       | 102600/393248 [00:02<00:06, 46752.51it/s] 28%|██▊       | 109782/393248 [00:02<00:05, 52946.93it/s] 30%|██▉       | 116451/393248 [00:02<00:04, 55725.18it/s] 31%|███▏      | 123120/393248 [00:02<00:04, 57990.57it/s] 33%|███▎      | 129045/393248 [00:02<00:04, 56281.13it/s] 34%|███▍      | 134766/393248 [00:02<00:04, 55134.41it/s] 36%|███▌      | 140344/393248 [00:02<00:04, 53685.74it/s] 37%|███▋      | 145759/393248 [00:03<00:04, 53395.40it/s] 39%|███▊      | 152361/393248 [00:03<00:04, 55648.43it/s] 40%|████      | 158004/393248 [00:03<00:04, 54990.78it/s] 42%|████▏     | 163647/393248 [00:03<00:04, 53882.37it/s] 43%|████▎     | 169047/393248 [00:03<00:04, 51135.23it/s] 44%|████▍     | 174420/393248 [00:03<00:04, 51443.58it/s] 46%|████▌     | 180063/393248 [00:03<00:04, 52576.07it/s] 47%|████▋     | 186219/393248 [00:03<00:03, 54840.76it/s] 49%|████▉     | 192375/393248 [00:03<00:03, 55591.54it/s] 50%|█████     | 197948/393248 [00:03<00:03, 55399.73it/s] 52%|█████▏    | 203661/393248 [00:04<00:03, 55467.77it/s] 53%|█████▎    | 209304/393248 [00:04<00:03, 54844.08it/s] 55%|█████▍    | 214794/393248 [00:04<00:03, 54111.73it/s] 56%|█████▌    | 220209/393248 [00:04<00:03, 53325.98it/s] 58%|█████▊    | 226746/393248 [00:04<00:02, 55661.91it/s] 59%|█████▉    | 232902/393248 [00:04<00:02, 56065.12it/s] 61%|██████    | 238507/393248 [00:04<00:02, 54911.86it/s] 62%|██████▏   | 243998/393248 [00:04<00:02, 54891.78it/s] 63%|██████▎   | 249487/393248 [00:04<00:02, 54666.23it/s] 65%|██████▍   | 255474/393248 [00:05<00:02, 55538.21it/s] 67%|██████▋   | 262143/393248 [00:05<00:02, 56657.08it/s] 68%|██████▊   | 268299/393248 [00:05<00:02, 57385.07it/s] 70%|██████▉   | 274455/393248 [00:05<00:02, 58396.06it/s] 71%|███████▏  | 281124/393248 [00:05<00:01, 59949.70it/s] 73%|███████▎  | 287280/393248 [00:05<00:01, 57649.56it/s] 75%|███████▍  | 293436/393248 [00:05<00:01, 57656.33it/s] 76%|███████▋  | 300105/393248 [00:05<00:01, 59911.82it/s] 78%|███████▊  | 306114/393248 [00:05<00:01, 59046.55it/s] 79%|███████▉  | 312031/393248 [00:06<00:01, 56056.49it/s] 81%|████████  | 317668/393248 [00:06<00:01, 55634.41it/s] 82%|████████▏ | 323703/393248 [00:06<00:01, 55472.25it/s] 84%|████████▍ | 330317/393248 [00:06<00:01, 58496.35it/s] 86%|████████▌ | 337554/393248 [00:06<00:00, 62474.11it/s] 88%|████████▊ | 344223/393248 [00:06<00:00, 62845.08it/s] 89%|████████▉ | 350532/393248 [00:06<00:00, 58990.12it/s] 91%|█████████ | 356535/393248 [00:06<00:00, 57779.07it/s] 92%|█████████▏| 362691/393248 [00:06<00:00, 57734.60it/s] 94%|█████████▎| 368493/393248 [00:06<00:00, 56554.77it/s] 95%|█████████▌| 375003/393248 [00:07<00:00, 58836.58it/s] 97%|█████████▋| 380913/393248 [00:07<00:00, 57805.12it/s] 98%|█████████▊| 387315/393248 [00:07<00:00, 58091.92it/s]100%|█████████▉| 393137/393248 [00:07<00:00, 56691.82it/s]100%|██████████| 393248/393248 [00:07<00:00, 53123.40it/s]
The spherical harmonics array is 346.53 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 85.61227178573608 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 1.8410695242716473
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.001, 'pow_max': 0.00105, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 16.84it/s] 21%|██        | 4/19 [00:00<00:00, 17.72it/s] 32%|███▏      | 6/19 [00:00<00:00, 18.38it/s] 47%|████▋     | 9/19 [00:00<00:00, 19.81it/s] 63%|██████▎   | 12/19 [00:00<00:00, 21.10it/s] 79%|███████▉  | 15/19 [00:00<00:00, 21.76it/s] 95%|█████████▍| 18/19 [00:00<00:00, 21.96it/s]100%|██████████| 19/19 [00:00<00:00, 20.93it/s]
Done. k_max for TT ell_max = 0.02261894553888885 k_max for EE ell_max = 0.08519989272692324
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5498442 Minimum k_amp 0.00020658328967625562 n_x_max 110 n_z_max 110
Time to get list of k, phi, theta: 0.6436035633087158 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07072257923244439
Ratio of unique |k|: 0.0018176057872393671
Time to get unique k and theta: 1.3084375858306885 seconds

Getting transfer functions
  0%|          | 0/9994 [00:00<?, ?it/s]  1%|          | 84/9994 [00:00<00:12, 796.68it/s]  3%|▎         | 322/9994 [00:00<00:05, 1694.95it/s]  6%|▌         | 560/9994 [00:00<00:04, 1970.79it/s]  8%|▊         | 812/9994 [00:00<00:04, 2163.60it/s] 11%|█         | 1064/9994 [00:00<00:03, 2256.98it/s] 13%|█▎        | 1302/9994 [00:00<00:03, 2292.72it/s] 15%|█▌        | 1532/9994 [00:00<00:03, 2237.43it/s] 18%|█▊        | 1792/9994 [00:00<00:03, 2322.16it/s] 20%|██        | 2044/9994 [00:00<00:03, 2355.04it/s] 23%|██▎       | 2296/9994 [00:01<00:03, 2390.62it/s] 25%|██▌       | 2548/9994 [00:01<00:03, 2396.95it/s] 28%|██▊       | 2828/9994 [00:01<00:02, 2514.58it/s] 32%|███▏      | 3150/9994 [00:01<00:02, 2721.00it/s] 35%|███▌      | 3514/9994 [00:01<00:02, 2980.16it/s] 38%|███▊      | 3836/9994 [00:01<00:02, 3048.62it/s] 41%|████▏     | 4144/9994 [00:01<00:01, 3040.22it/s] 45%|████▍     | 4466/9994 [00:01<00:01, 3061.19it/s] 48%|████▊     | 4816/9994 [00:01<00:01, 3155.67it/s] 52%|█████▏    | 5152/9994 [00:01<00:01, 3193.87it/s] 55%|█████▍    | 5474/9994 [00:02<00:01, 3183.76it/s] 58%|█████▊    | 5796/9994 [00:02<00:01, 3187.01it/s] 61%|██████    | 6118/9994 [00:02<00:01, 3183.54it/s] 65%|██████▍   | 6468/9994 [00:02<00:01, 3255.03it/s] 68%|██████▊   | 6804/9994 [00:02<00:00, 3276.56it/s] 72%|███████▏  | 7154/9994 [00:02<00:00, 3321.95it/s] 75%|███████▍  | 7490/9994 [00:02<00:00, 3325.29it/s] 78%|███████▊  | 7826/9994 [00:02<00:00, 3328.81it/s] 82%|████████▏ | 8176/9994 [00:02<00:00, 3364.17it/s] 85%|████████▌ | 8513/9994 [00:02<00:00, 3299.09it/s] 88%|████████▊ | 8844/9994 [00:03<00:00, 3254.57it/s] 92%|█████████▏| 9170/9994 [00:03<00:00, 3250.34it/s] 95%|█████████▌| 9496/9994 [00:03<00:00, 3216.84it/s] 98%|█████████▊| 9818/9994 [00:03<00:00, 3087.07it/s]100%|██████████| 9994/9994 [00:03<00:00, 2891.77it/s]
Size of transfer function: 1.6 MB. 

Size of integrand: 33.63 MB. Time to calculate integrand: 0.021091461181640625 s

Getting spherical harmonics
  0%|          | 0/388864 [00:00<?, ?it/s]  0%|          | 507/388864 [00:00<01:31, 4241.98it/s]  1%|▏         | 5577/388864 [00:00<00:13, 28521.02it/s]  3%|▎         | 11154/388864 [00:00<00:09, 39180.18it/s]  4%|▍         | 15717/388864 [00:00<00:09, 41034.29it/s]  5%|▌         | 19886/388864 [00:00<00:08, 40999.89it/s]  6%|▋         | 24843/388864 [00:00<00:08, 43410.81it/s]  8%|▊         | 29406/388864 [00:00<00:08, 44081.63it/s]  9%|▊         | 33837/388864 [00:00<00:09, 38696.65it/s] 10%|▉         | 38025/388864 [00:00<00:08, 39329.60it/s] 11%|█         | 43095/388864 [00:01<00:08, 40921.46it/s] 12%|█▏        | 47658/388864 [00:01<00:08, 41924.15it/s] 14%|█▎        | 52728/388864 [00:01<00:07, 44255.18it/s] 15%|█▍        | 57798/388864 [00:01<00:07, 45782.74it/s] 16%|█▋        | 63882/388864 [00:01<00:06, 48800.47it/s] 18%|█▊        | 69459/388864 [00:01<00:06, 49933.40it/s] 19%|█▉        | 75036/388864 [00:01<00:06, 51501.45it/s] 21%|██        | 80203/388864 [00:01<00:06, 50847.16it/s] 22%|██▏       | 85683/388864 [00:01<00:05, 51649.11it/s] 23%|██▎       | 90858/388864 [00:02<00:06, 47526.06it/s] 25%|██▍       | 95823/388864 [00:02<00:06, 47591.19it/s] 26%|██▌       | 100628/388864 [00:02<00:06, 45598.99it/s] 27%|██▋       | 105963/388864 [00:02<00:05, 47467.13it/s] 29%|██▉       | 113061/388864 [00:02<00:05, 53329.81it/s] 31%|███       | 118638/388864 [00:02<00:05, 53618.95it/s] 32%|███▏      | 125229/388864 [00:02<00:04, 56705.15it/s] 34%|███▎      | 130928/388864 [00:02<00:04, 55608.41it/s] 35%|███▌      | 136511/388864 [00:02<00:04, 53659.92it/s] 36%|███▋      | 141901/388864 [00:03<00:04, 51579.18it/s] 38%|███▊      | 147537/388864 [00:03<00:04, 52681.95it/s] 40%|███▉      | 153621/388864 [00:03<00:04, 53838.80it/s] 41%|████      | 159705/388864 [00:03<00:04, 54860.40it/s] 43%|████▎     | 166803/388864 [00:03<00:03, 58175.37it/s] 44%|████▍     | 172628/388864 [00:03<00:03, 56826.47it/s] 46%|████▌     | 178464/388864 [00:03<00:03, 56190.28it/s] 48%|████▊     | 185273/388864 [00:03<00:03, 59584.08it/s] 49%|████▉     | 191252/388864 [00:03<00:03, 57329.89it/s] 51%|█████     | 197567/388864 [00:03<00:03, 58984.60it/s] 52%|█████▏    | 203493/388864 [00:04<00:03, 57248.13it/s] 54%|█████▍    | 209244/388864 [00:04<00:03, 54994.82it/s] 55%|█████▌    | 214968/388864 [00:04<00:03, 55069.63it/s] 57%|█████▋    | 221559/388864 [00:04<00:02, 56722.90it/s] 58%|█████▊    | 227245/388864 [00:04<00:02, 54564.69it/s] 60%|█████▉    | 232719/388864 [00:04<00:02, 54265.17it/s] 61%|██████▏   | 238290/388864 [00:04<00:02, 52706.31it/s] 63%|██████▎   | 243867/388864 [00:04<00:02, 51844.80it/s] 64%|██████▍   | 249444/388864 [00:04<00:02, 52433.76it/s] 66%|██████▌   | 255528/388864 [00:05<00:02, 53724.42it/s] 67%|██████▋   | 262119/388864 [00:05<00:02, 55667.01it/s] 69%|██████▉   | 268203/388864 [00:05<00:02, 56857.24it/s] 70%|███████   | 273897/388864 [00:05<00:02, 56257.81it/s] 72%|███████▏  | 279528/388864 [00:05<00:01, 55624.41it/s] 73%|███████▎  | 285093/388864 [00:05<00:01, 53573.19it/s] 75%|███████▍  | 291018/388864 [00:05<00:01, 54056.73it/s] 77%|███████▋  | 298116/388864 [00:05<00:01, 56764.87it/s] 78%|███████▊  | 303790/388864 [00:06<00:02, 39836.44it/s] 79%|███████▉  | 308441/388864 [00:06<00:02, 32305.07it/s] 80%|████████  | 312313/388864 [00:06<00:03, 25381.52it/s] 81%|████████  | 315464/388864 [00:06<00:03, 22331.42it/s] 82%|████████▏ | 318131/388864 [00:06<00:03, 21141.11it/s] 83%|████████▎ | 322959/388864 [00:07<00:02, 25877.95it/s] 85%|████████▍ | 329043/388864 [00:07<00:01, 32531.20it/s] 86%|████████▌ | 335127/388864 [00:07<00:01, 38823.28it/s] 88%|████████▊ | 341718/388864 [00:07<00:01, 44539.95it/s] 90%|████████▉ | 348816/388864 [00:07<00:00, 51061.77it/s] 91%|█████████ | 354393/388864 [00:07<00:00, 51747.99it/s] 93%|█████████▎| 359970/388864 [00:07<00:00, 52391.44it/s] 94%|█████████▍| 366054/388864 [00:07<00:00, 52141.00it/s] 96%|█████████▌| 372645/388864 [00:07<00:00, 54686.67it/s] 98%|█████████▊| 379743/388864 [00:07<00:00, 57578.61it/s] 99%|█████████▉| 386841/388864 [00:08<00:00, 60476.45it/s]100%|██████████| 388864/388864 [00:08<00:00, 47822.20it/s]
The spherical harmonics array is 342.67 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 93.94814777374268 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 1.828833203832822
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.0015, 'pow_max': 0.00155, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 13.82it/s] 21%|██        | 4/19 [00:00<00:00, 15.63it/s] 32%|███▏      | 6/19 [00:00<00:00, 16.88it/s] 42%|████▏     | 8/19 [00:00<00:00, 17.39it/s] 58%|█████▊    | 11/19 [00:00<00:00, 19.05it/s] 74%|███████▎  | 14/19 [00:00<00:00, 20.12it/s] 89%|████████▉ | 17/19 [00:00<00:00, 20.44it/s]100%|██████████| 19/19 [00:00<00:00, 19.25it/s]
Done. k_max for TT ell_max = 0.009880133605414064 k_max for EE ell_max = 0.08519563282459129
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 1981402 Minimum k_amp 0.00020658328967625562 n_x_max 78 n_z_max 78
Time to get list of k, phi, theta: 0.2436380386352539 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07407835461960774
Ratio of unique |k|: 0.0025547566823895403
Time to get unique k and theta: 0.41431117057800293 seconds

Getting transfer functions
  0%|          | 0/5062 [00:00<?, ?it/s]  1%|          | 28/5062 [00:00<00:17, 279.92it/s]  3%|▎         | 147/5062 [00:00<00:06, 790.65it/s]  6%|▌         | 280/5062 [00:00<00:04, 1016.07it/s]  8%|▊         | 413/5062 [00:00<00:04, 1106.82it/s] 11%|█         | 546/5062 [00:00<00:03, 1172.83it/s] 13%|█▎        | 663/5062 [00:00<00:03, 1160.98it/s] 15%|█▌        | 779/5062 [00:00<00:03, 1137.98it/s] 18%|█▊        | 896/5062 [00:00<00:03, 1133.72it/s] 20%|██        | 1022/5062 [00:00<00:03, 1152.76it/s] 23%|██▎       | 1141/5062 [00:01<00:03, 1157.53it/s] 25%|██▍       | 1260/5062 [00:01<00:03, 1159.10it/s] 28%|██▊       | 1393/5062 [00:01<00:03, 1205.23it/s] 31%|███▏      | 1582/5062 [00:01<00:02, 1407.12it/s] 35%|███▍      | 1757/5062 [00:01<00:02, 1503.82it/s] 38%|███▊      | 1939/5062 [00:01<00:01, 1595.33it/s] 42%|████▏     | 2142/5062 [00:01<00:01, 1713.85it/s] 46%|████▋     | 2345/5062 [00:01<00:01, 1792.85it/s] 50%|█████     | 2555/5062 [00:01<00:01, 1873.80it/s] 54%|█████▍    | 2758/5062 [00:01<00:01, 1901.40it/s] 59%|█████▉    | 2975/5062 [00:02<00:01, 1975.80it/s] 63%|██████▎   | 3185/5062 [00:02<00:00, 2003.95it/s] 67%|██████▋   | 3388/5062 [00:02<00:00, 1993.14it/s] 71%|███████   | 3588/5062 [00:02<00:00, 1933.96it/s] 75%|███████▍  | 3782/5062 [00:02<00:00, 1898.85it/s] 78%|███████▊  | 3973/5062 [00:02<00:00, 1873.82it/s] 82%|████████▏ | 4172/5062 [00:02<00:00, 1901.55it/s] 86%|████████▋ | 4375/5062 [00:02<00:00, 1929.15it/s] 90%|█████████ | 4569/5062 [00:02<00:00, 1910.40it/s] 94%|█████████▍| 4761/5062 [00:02<00:00, 1864.17it/s] 98%|█████████▊| 4963/5062 [00:03<00:00, 1891.99it/s]100%|██████████| 5062/5062 [00:03<00:00, 1607.28it/s]
Size of transfer function: 0.81 MB. 

Size of integrand: 17.03 MB. Time to calculate integrand: 0.012341737747192383 s

Getting spherical harmonics
  0%|          | 0/146779 [00:00<?, ?it/s]  3%|▎         | 4608/146779 [00:00<00:03, 42725.98it/s]  6%|▌         | 8881/146779 [00:00<00:04, 30984.28it/s]  8%|▊         | 12150/146779 [00:00<00:04, 29788.94it/s] 10%|█         | 15208/146779 [00:00<00:04, 28383.68it/s] 13%|█▎        | 19200/146779 [00:00<00:04, 31441.28it/s] 16%|█▌        | 23232/146779 [00:00<00:03, 34049.91it/s] 18%|█▊        | 27072/146779 [00:00<00:03, 35257.14it/s] 21%|██        | 30655/146779 [00:00<00:03, 31543.61it/s] 25%|██▍       | 36288/146779 [00:01<00:02, 38316.34it/s] 28%|██▊       | 41472/146779 [00:01<00:02, 41800.25it/s] 32%|███▏      | 46464/146779 [00:01<00:02, 43975.23it/s] 36%|███▌      | 52224/146779 [00:01<00:01, 47593.73it/s] 39%|███▉      | 57067/146779 [00:01<00:01, 46174.44it/s] 42%|████▏     | 61749/146779 [00:01<00:01, 44062.93it/s] 45%|████▌     | 66240/146779 [00:01<00:01, 44234.40it/s] 48%|████▊     | 70705/146779 [00:01<00:01, 44173.60it/s] 51%|█████▏    | 75456/146779 [00:01<00:01, 44615.93it/s] 55%|█████▌    | 80832/146779 [00:02<00:01, 46879.56it/s] 58%|█████▊    | 85824/146779 [00:02<00:01, 47556.45it/s] 62%|██████▏   | 90624/146779 [00:02<00:01, 47623.39it/s] 65%|██████▍   | 95397/146779 [00:02<00:01, 47443.53it/s] 68%|██████▊   | 100224/146779 [00:02<00:00, 47650.52it/s] 72%|███████▏  | 104995/146779 [00:02<00:00, 47342.38it/s] 75%|███████▌  | 110400/146779 [00:02<00:00, 49166.89it/s] 79%|███████▊  | 115321/146779 [00:02<00:00, 45905.60it/s] 82%|████████▏ | 120384/146779 [00:02<00:00, 47109.96it/s] 86%|████████▌ | 126528/146779 [00:02<00:00, 50852.29it/s] 90%|█████████ | 132672/146779 [00:03<00:00, 53813.95it/s] 94%|█████████▍| 138087/146779 [00:03<00:00, 46700.12it/s] 98%|█████████▊| 143232/146779 [00:03<00:00, 47450.37it/s]100%|██████████| 146779/146779 [00:03<00:00, 43176.65it/s]
The spherical harmonics array is 129.34 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 81.06965804100037 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 1.6721253736574315
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 0.6, 'pow_min': 0.002, 'pow_max': 0.00205, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 17.46it/s] 26%|██▋       | 5/19 [00:00<00:00, 20.47it/s] 42%|████▏     | 8/19 [00:00<00:00, 21.79it/s] 58%|█████▊    | 11/19 [00:00<00:00, 22.40it/s] 74%|███████▎  | 14/19 [00:00<00:00, 22.35it/s] 89%|████████▉ | 17/19 [00:00<00:00, 22.63it/s]100%|██████████| 19/19 [00:00<00:00, 22.15it/s]
Done. k_max for TT ell_max = 0.012366638596575524 k_max for EE ell_max = 0.08519733678552407
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 2472510 Minimum k_amp 0.00020658328967625562 n_x_max 84 n_z_max 84
Time to get list of k, phi, theta: 0.2856581211090088 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07334530497348848
Ratio of unique |k|: 0.0023724878766921064
Time to get unique k and theta: 0.5176734924316406 seconds

Getting transfer functions
  0%|          | 0/5866 [00:00<?, ?it/s]  2%|▏         | 96/5866 [00:00<00:06, 952.21it/s]  4%|▍         | 240/5866 [00:00<00:04, 1234.12it/s]  7%|▋         | 384/5866 [00:00<00:04, 1324.73it/s]  9%|▉         | 536/5866 [00:00<00:03, 1389.22it/s] 12%|█▏        | 688/5866 [00:00<00:03, 1427.69it/s] 14%|█▍        | 832/5866 [00:00<00:03, 1429.01it/s] 17%|█▋        | 984/5866 [00:00<00:03, 1439.26it/s] 19%|█▉        | 1136/5866 [00:00<00:03, 1464.26it/s] 22%|██▏       | 1296/5866 [00:00<00:03, 1496.13it/s] 25%|██▍       | 1448/5866 [00:01<00:02, 1493.50it/s] 28%|██▊       | 1624/5866 [00:01<00:02, 1568.83it/s] 32%|███▏      | 1856/5866 [00:01<00:02, 1775.41it/s] 36%|███▌      | 2088/5866 [00:01<00:01, 1932.71it/s] 40%|███▉      | 2328/5866 [00:01<00:01, 2069.06it/s] 44%|████▎     | 2560/5866 [00:01<00:01, 2135.91it/s] 47%|████▋     | 2784/5866 [00:01<00:01, 2148.58it/s] 52%|█████▏    | 3024/5866 [00:01<00:01, 2215.06it/s] 55%|█████▌    | 3248/5866 [00:01<00:01, 2215.84it/s] 59%|█████▉    | 3488/5866 [00:01<00:01, 2248.57it/s] 63%|██████▎   | 3713/5866 [00:02<00:00, 2234.54it/s] 67%|██████▋   | 3937/5866 [00:02<00:00, 2207.67it/s] 71%|███████   | 4160/5866 [00:02<00:00, 2200.15it/s] 75%|███████▍  | 4384/5866 [00:02<00:00, 2199.18it/s] 78%|███████▊  | 4604/5866 [00:02<00:00, 2194.46it/s] 82%|████████▏ | 4824/5866 [00:02<00:00, 2162.85it/s] 86%|████████▌ | 5041/5866 [00:02<00:00, 2155.33it/s] 90%|████████▉ | 5257/5866 [00:02<00:00, 2142.27it/s] 94%|█████████▍| 5512/5866 [00:02<00:00, 2260.21it/s] 98%|█████████▊| 5752/5866 [00:02<00:00, 2277.47it/s]100%|██████████| 5866/5866 [00:02<00:00, 1955.35it/s]
Size of transfer function: 0.94 MB. 

Size of integrand: 19.74 MB. Time to calculate integrand: 0.015639305114746094 s

Getting spherical harmonics
  0%|          | 0/181347 [00:00<?, ?it/s]  3%|▎         | 4740/181347 [00:00<00:03, 47335.38it/s]  5%|▌         | 9474/181347 [00:00<00:03, 45890.96it/s]  8%|▊         | 14067/181347 [00:00<00:04, 34694.85it/s] 10%|▉         | 17782/181347 [00:00<00:07, 22403.38it/s] 11%|█▏        | 20556/181347 [00:00<00:08, 18098.03it/s] 13%|█▎        | 23937/181347 [00:00<00:07, 21166.54it/s] 15%|█▌        | 27966/181347 [00:01<00:06, 25372.55it/s] 17%|█▋        | 31018/181347 [00:01<00:05, 26438.45it/s] 19%|█▉        | 34045/181347 [00:01<00:05, 27211.84it/s] 21%|██        | 37446/181347 [00:01<00:04, 28830.40it/s] 23%|██▎       | 41475/181347 [00:01<00:04, 31531.36it/s] 25%|██▌       | 45741/181347 [00:01<00:03, 34275.34it/s] 28%|██▊       | 50481/181347 [00:01<00:03, 37775.03it/s] 31%|███       | 55695/181347 [00:01<00:03, 41574.89it/s] 33%|███▎      | 59961/181347 [00:01<00:02, 41513.59it/s] 35%|███▌      | 64227/181347 [00:02<00:02, 41339.13it/s] 38%|███▊      | 68967/181347 [00:02<00:02, 41601.89it/s] 41%|████      | 73944/181347 [00:02<00:02, 43672.58it/s] 43%|████▎     | 78447/181347 [00:02<00:02, 43649.91it/s] 46%|████▌     | 83187/181347 [00:02<00:02, 44404.47it/s] 49%|████▉     | 89112/181347 [00:02<00:01, 48481.69it/s] 52%|█████▏    | 94563/181347 [00:02<00:01, 49442.05it/s] 55%|█████▍    | 99519/181347 [00:02<00:01, 47448.17it/s] 58%|█████▊    | 104754/181347 [00:02<00:01, 48838.06it/s] 61%|██████    | 109731/181347 [00:02<00:01, 49104.93it/s] 63%|██████▎   | 114658/181347 [00:03<00:01, 48634.24it/s] 66%|██████▌   | 119533/181347 [00:03<00:01, 48311.28it/s] 69%|██████▊   | 124372/181347 [00:03<00:01, 48141.03it/s] 71%|███████   | 129192/181347 [00:03<00:01, 47822.50it/s] 74%|███████▍  | 133978/181347 [00:03<00:01, 44386.04it/s] 76%|███████▋  | 138642/181347 [00:03<00:00, 45018.11it/s] 79%|███████▉  | 143182/181347 [00:03<00:00, 42430.14it/s] 81%|████████▏ | 147475/181347 [00:03<00:00, 42111.48it/s] 84%|████████▍ | 152154/181347 [00:03<00:00, 42580.56it/s] 87%|████████▋ | 157131/181347 [00:04<00:00, 44330.92it/s] 89%|████████▉ | 161589/181347 [00:04<00:00, 40731.36it/s] 91%|█████████▏| 165900/181347 [00:04<00:00, 41148.72it/s] 94%|█████████▍| 171114/181347 [00:04<00:00, 43831.27it/s] 97%|█████████▋| 175545/181347 [00:04<00:00, 43891.81it/s] 99%|█████████▉| 180357/181347 [00:04<00:00, 45050.43it/s]100%|██████████| 181347/181347 [00:04<00:00, 39400.30it/s]
The spherical harmonics array is 159.8 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 80.49652600288391 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 1.6880984701549098
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.0001, 'pow_max': 0.00015000000000000001, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 15.76it/s] 21%|██        | 4/19 [00:00<00:00, 17.14it/s] 32%|███▏      | 6/19 [00:00<00:00, 18.21it/s] 47%|████▋     | 9/19 [00:00<00:00, 19.58it/s] 63%|██████▎   | 12/19 [00:00<00:00, 20.33it/s] 79%|███████▉  | 15/19 [00:00<00:00, 20.64it/s] 95%|█████████▍| 18/19 [00:00<00:00, 21.10it/s]100%|██████████| 19/19 [00:00<00:00, 20.16it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5563266 Minimum k_amp 0.00020658328967625562 n_x_max 110 n_z_max 110
Time to get list of k, phi, theta: 0.6696410179138184 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0706865355710117
Ratio of unique |k|: 0.0018102675658507072
Time to get unique k and theta: 1.3375425338745117 seconds

Getting transfer functions
  0%|          | 0/10071 [00:00<?, ?it/s]  2%|▏         | 154/10071 [00:00<00:06, 1461.74it/s]  4%|▍         | 378/10071 [00:00<00:05, 1902.90it/s]  6%|▋         | 630/10071 [00:00<00:04, 2140.09it/s]  9%|▉         | 882/10071 [00:00<00:04, 2245.28it/s] 11%|█         | 1120/10071 [00:00<00:03, 2278.81it/s] 14%|█▎        | 1372/10071 [00:00<00:03, 2326.70it/s] 16%|█▌        | 1610/10071 [00:00<00:03, 2333.36it/s] 18%|█▊        | 1848/10071 [00:00<00:03, 2321.92it/s] 21%|██        | 2086/10071 [00:00<00:03, 2319.18it/s] 23%|██▎       | 2338/10071 [00:01<00:03, 2359.39it/s] 26%|██▌       | 2604/10071 [00:01<00:03, 2430.10it/s] 29%|██▉       | 2912/10071 [00:01<00:02, 2599.01it/s] 32%|███▏      | 3248/10071 [00:01<00:02, 2802.47it/s] 36%|███▌      | 3584/10071 [00:01<00:02, 2964.22it/s] 39%|███▉      | 3906/10071 [00:01<00:02, 3002.55it/s] 42%|████▏     | 4214/10071 [00:01<00:01, 3008.67it/s] 45%|████▌     | 4550/10071 [00:01<00:01, 3089.86it/s] 49%|████▉     | 4914/10071 [00:01<00:01, 3215.56it/s] 52%|█████▏    | 5236/10071 [00:01<00:01, 3206.34it/s] 55%|█████▌    | 5572/10071 [00:02<00:01, 3247.88it/s] 59%|█████▊    | 5897/10071 [00:02<00:01, 3205.38it/s] 62%|██████▏   | 6218/10071 [00:02<00:01, 3199.85it/s] 65%|██████▍   | 6539/10071 [00:02<00:01, 3180.54it/s] 68%|██████▊   | 6874/10071 [00:02<00:00, 3224.85it/s] 71%|███████▏  | 7197/10071 [00:02<00:00, 3178.63it/s] 75%|███████▌  | 7560/10071 [00:02<00:00, 3286.44it/s] 78%|███████▊  | 7889/10071 [00:02<00:00, 3271.93it/s] 82%|████████▏ | 8217/10071 [00:02<00:00, 3233.44it/s] 85%|████████▍ | 8541/10071 [00:02<00:00, 3186.78it/s] 88%|████████▊ | 8876/10071 [00:03<00:00, 3206.48it/s] 92%|█████████▏| 9226/10071 [00:03<00:00, 3264.55it/s] 95%|█████████▍| 9562/10071 [00:03<00:00, 3268.73it/s] 98%|█████████▊| 9898/10071 [00:03<00:00, 3294.87it/s]100%|██████████| 10071/10071 [00:03<00:00, 2924.43it/s]
Size of transfer function: 1.61 MB. 

Size of integrand: 33.88 MB. Time to calculate integrand: 0.01714038848876953 s

Getting spherical harmonics
  0%|          | 0/393248 [00:00<?, ?it/s]  1%|          | 2052/393248 [00:00<00:19, 20113.28it/s]  2%|▏         | 6669/393248 [00:00<00:11, 35099.70it/s]  3%|▎         | 11286/393248 [00:00<00:09, 38856.80it/s]  4%|▍         | 15903/393248 [00:00<00:09, 40169.01it/s]  5%|▌         | 20007/393248 [00:00<00:12, 28772.79it/s]  6%|▌         | 23251/393248 [00:00<00:12, 28787.53it/s]  7%|▋         | 27702/393248 [00:00<00:11, 32415.45it/s]  8%|▊         | 32319/393248 [00:00<00:10, 35384.33it/s]  9%|▉         | 36047/393248 [00:01<00:10, 34156.74it/s] 10%|█         | 40014/393248 [00:01<00:10, 34802.47it/s] 12%|█▏        | 45657/393248 [00:01<00:08, 39816.95it/s] 13%|█▎        | 50787/393248 [00:01<00:08, 42454.12it/s] 14%|█▍        | 55917/393248 [00:01<00:07, 44769.58it/s] 16%|█▌        | 61047/393248 [00:01<00:07, 45463.04it/s] 17%|█▋        | 66690/393248 [00:01<00:06, 48567.99it/s] 18%|█▊        | 72333/393248 [00:01<00:06, 49957.43it/s] 20%|█▉        | 77365/393248 [00:01<00:06, 49528.00it/s] 21%|██        | 82593/393248 [00:02<00:06, 49472.43it/s] 22%|██▏       | 87723/393248 [00:02<00:06, 48827.80it/s] 24%|██▎       | 93366/393248 [00:02<00:06, 49534.33it/s] 25%|██▌       | 99009/393248 [00:02<00:05, 50805.45it/s] 27%|██▋       | 105678/393248 [00:02<00:05, 55262.34it/s] 29%|██▊       | 112860/393248 [00:02<00:04, 59380.87it/s] 30%|███       | 119529/393248 [00:02<00:04, 60516.78it/s] 32%|███▏      | 125594/393248 [00:02<00:04, 58315.82it/s] 33%|███▎      | 131446/393248 [00:02<00:04, 54687.21it/s] 35%|███▍      | 136963/393248 [00:03<00:04, 53678.13it/s] 36%|███▌      | 142362/393248 [00:03<00:04, 51234.19it/s] 38%|███▊      | 147744/393248 [00:03<00:04, 51940.58it/s] 39%|███▉      | 152967/393248 [00:03<00:04, 50087.94it/s] 40%|████      | 159030/393248 [00:03<00:04, 52677.79it/s] 42%|████▏     | 164673/393248 [00:03<00:04, 52960.96it/s] 43%|████▎     | 170829/393248 [00:03<00:04, 54363.24it/s] 45%|████▌     | 176985/393248 [00:03<00:03, 55298.95it/s] 46%|████▋     | 182628/393248 [00:03<00:03, 54469.02it/s] 48%|████▊     | 188084/393248 [00:03<00:03, 52973.26it/s] 49%|████▉     | 193390/393248 [00:04<00:03, 51153.00it/s] 50%|█████     | 198531/393248 [00:04<00:03, 51102.62it/s] 52%|█████▏    | 203649/393248 [00:04<00:03, 49529.91it/s] 53%|█████▎    | 208791/393248 [00:04<00:03, 49979.45it/s] 55%|█████▍    | 215460/393248 [00:04<00:03, 54381.82it/s] 56%|█████▌    | 220915/393248 [00:04<00:03, 53120.86it/s] 58%|█████▊    | 226746/393248 [00:04<00:03, 53332.96it/s] 59%|█████▉    | 232089/393248 [00:04<00:03, 47977.63it/s] 61%|██████    | 238032/393248 [00:04<00:03, 50076.41it/s] 62%|██████▏   | 243119/393248 [00:05<00:03, 46322.68it/s] 63%|██████▎   | 247842/393248 [00:05<00:03, 45972.43it/s] 64%|██████▍   | 253422/393248 [00:05<00:02, 48155.23it/s] 66%|██████▌   | 260091/393248 [00:05<00:02, 52648.31it/s] 67%|██████▋   | 265418/393248 [00:05<00:02, 50468.68it/s] 69%|██████▉   | 270864/393248 [00:05<00:02, 51417.34it/s] 70%|███████   | 276050/393248 [00:05<00:02, 49406.59it/s] 72%|███████▏  | 281637/393248 [00:05<00:02, 49840.15it/s] 73%|███████▎  | 287280/393248 [00:05<00:02, 49856.75it/s] 74%|███████▍  | 292410/393248 [00:06<00:02, 49592.16it/s] 76%|███████▌  | 298053/393248 [00:06<00:01, 51115.27it/s] 77%|███████▋  | 304209/393248 [00:06<00:01, 52673.83it/s] 79%|███████▉  | 309852/393248 [00:06<00:01, 52143.74it/s] 80%|████████  | 315074/393248 [00:06<00:01, 50926.45it/s] 82%|████████▏ | 320625/393248 [00:06<00:01, 51577.16it/s] 83%|████████▎ | 326781/393248 [00:06<00:01, 53555.67it/s] 84%|████████▍ | 332143/393248 [00:07<00:01, 32486.17it/s] 86%|████████▌ | 336389/393248 [00:07<00:01, 32924.34it/s] 87%|████████▋ | 342171/393248 [00:07<00:01, 37862.93it/s] 89%|████████▊ | 348327/393248 [00:07<00:01, 42883.63it/s] 90%|████████▉ | 353457/393248 [00:07<00:00, 44702.86it/s] 91%|█████████▏| 359100/393248 [00:07<00:00, 47537.11it/s] 93%|█████████▎| 364212/393248 [00:07<00:00, 47092.75it/s] 94%|█████████▍| 369360/393248 [00:07<00:00, 47334.55it/s] 95%|█████████▌| 374490/393248 [00:07<00:00, 47868.57it/s] 97%|█████████▋| 380646/393248 [00:08<00:00, 51706.54it/s] 98%|█████████▊| 386802/393248 [00:08<00:00, 53106.68it/s]100%|█████████▉| 392191/393248 [00:08<00:00, 53015.74it/s]100%|██████████| 393248/393248 [00:08<00:00, 47716.04it/s]
The spherical harmonics array is 346.53 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 88.06054258346558 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 1.8742413736032364
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.0002, 'pow_max': 0.00025, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 15.96it/s] 21%|██        | 4/19 [00:00<00:00, 17.96it/s] 37%|███▋      | 7/19 [00:00<00:00, 19.35it/s] 53%|█████▎    | 10/19 [00:00<00:00, 20.44it/s] 68%|██████▊   | 13/19 [00:00<00:00, 20.89it/s] 84%|████████▍ | 16/19 [00:00<00:00, 21.27it/s]100%|██████████| 19/19 [00:00<00:00, 21.55it/s]100%|██████████| 19/19 [00:00<00:00, 20.66it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5563266 Minimum k_amp 0.00020658328967625562 n_x_max 110 n_z_max 110
Time to get list of k, phi, theta: 0.6832950115203857 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0706865355710117
Ratio of unique |k|: 0.0018102675658507072
Time to get unique k and theta: 1.3529047966003418 seconds

Getting transfer functions
  0%|          | 0/10071 [00:00<?, ?it/s]  1%|          | 98/10071 [00:00<00:10, 951.77it/s]  3%|▎         | 322/10071 [00:00<00:05, 1661.63it/s]  5%|▌         | 546/10071 [00:00<00:05, 1899.48it/s]  8%|▊         | 798/10071 [00:00<00:04, 2088.45it/s] 10%|█         | 1036/10071 [00:00<00:04, 2159.59it/s] 12%|█▏        | 1252/10071 [00:00<00:04, 2141.94it/s] 15%|█▍        | 1467/10071 [00:00<00:04, 2137.38it/s] 17%|█▋        | 1681/10071 [00:00<00:04, 2078.96it/s] 19%|█▉        | 1904/10071 [00:00<00:03, 2090.70it/s] 21%|██        | 2114/10071 [00:01<00:03, 2093.08it/s] 23%|██▎       | 2324/10071 [00:01<00:03, 2079.89it/s] 25%|██▌       | 2562/10071 [00:01<00:03, 2131.74it/s] 28%|██▊       | 2842/10071 [00:01<00:03, 2321.47it/s] 32%|███▏      | 3192/10071 [00:01<00:02, 2669.22it/s] 36%|███▌      | 3584/10071 [00:01<00:02, 2991.68it/s] 39%|███▉      | 3934/10071 [00:01<00:01, 3107.97it/s] 42%|████▏     | 4256/10071 [00:01<00:01, 3139.63it/s] 46%|████▌     | 4606/10071 [00:01<00:01, 3221.87it/s] 49%|████▉     | 4929/10071 [00:01<00:01, 3211.77it/s] 52%|█████▏    | 5264/10071 [00:02<00:01, 3226.02it/s] 56%|█████▌    | 5628/10071 [00:02<00:01, 3345.92it/s] 59%|█████▉    | 5978/10071 [00:02<00:01, 3364.39it/s] 63%|██████▎   | 6356/10071 [00:02<00:01, 3451.64it/s] 67%|██████▋   | 6702/10071 [00:02<00:00, 3430.48it/s] 70%|███████   | 7056/10071 [00:02<00:00, 3434.27it/s] 73%|███████▎  | 7400/10071 [00:02<00:00, 3388.98it/s] 77%|███████▋  | 7770/10071 [00:02<00:00, 3456.43it/s] 81%|████████  | 8148/10071 [00:02<00:00, 3539.31it/s] 85%|████████▍ | 8526/10071 [00:02<00:00, 3596.02it/s] 88%|████████▊ | 8904/10071 [00:03<00:00, 3646.77it/s] 92%|█████████▏| 9269/10071 [00:03<00:00, 3595.74it/s] 96%|█████████▌| 9629/10071 [00:03<00:00, 3592.63it/s] 99%|█████████▉| 9989/10071 [00:03<00:00, 3570.99it/s]100%|██████████| 10071/10071 [00:03<00:00, 2944.80it/s]
Size of transfer function: 1.61 MB. 

Size of integrand: 33.88 MB. Time to calculate integrand: 0.024708986282348633 s

Getting spherical harmonics
  0%|          | 0/393248 [00:00<?, ?it/s]  0%|          | 513/393248 [00:00<03:24, 1922.59it/s]  1%|          | 3591/393248 [00:00<00:33, 11629.27it/s]  2%|▏         | 8208/393248 [00:00<00:17, 22202.93it/s]  3%|▎         | 12825/393248 [00:00<00:13, 29003.48it/s]  4%|▍         | 17442/393248 [00:00<00:11, 33734.32it/s]  5%|▌         | 21546/393248 [00:00<00:10, 34364.33it/s]  7%|▋         | 26163/393248 [00:00<00:09, 37627.82it/s]  8%|▊         | 30150/393248 [00:01<00:09, 38254.87it/s]  9%|▊         | 34371/393248 [00:01<00:09, 38060.18it/s] 10%|▉         | 38287/393248 [00:01<00:09, 36910.33it/s] 11%|█         | 42057/393248 [00:01<00:11, 31847.39it/s] 12%|█▏        | 46683/393248 [00:01<00:09, 35193.88it/s] 13%|█▎        | 52326/393248 [00:01<00:08, 40380.26it/s] 14%|█▍        | 56943/393248 [00:01<00:08, 41513.12it/s] 16%|█▌        | 61560/393248 [00:01<00:07, 42335.45it/s] 17%|█▋        | 67203/393248 [00:01<00:07, 45741.98it/s] 18%|█▊        | 72333/393248 [00:02<00:06, 47316.86it/s] 20%|█▉        | 77976/393248 [00:02<00:06, 49304.70it/s] 21%|██        | 82950/393248 [00:02<00:06, 45356.44it/s] 22%|██▏       | 87570/393248 [00:02<00:07, 41631.55it/s] 23%|██▎       | 91834/393248 [00:02<00:07, 40897.12it/s] 25%|██▍       | 96957/393248 [00:02<00:06, 42562.89it/s] 26%|██▌       | 101574/393248 [00:02<00:06, 42991.03it/s] 27%|██▋       | 106191/393248 [00:02<00:06, 43292.40it/s] 29%|██▊       | 112860/393248 [00:02<00:05, 48752.47it/s] 30%|███       | 118503/393248 [00:03<00:05, 49696.93it/s] 32%|███▏      | 124146/393248 [00:03<00:05, 50836.67it/s] 33%|███▎      | 129276/393248 [00:03<00:05, 50721.55it/s] 34%|███▍      | 134359/393248 [00:03<00:05, 50546.61it/s] 35%|███▌      | 139421/393248 [00:03<00:05, 48252.35it/s] 37%|███▋      | 144268/393248 [00:03<00:05, 45977.29it/s] 38%|███▊      | 149283/393248 [00:03<00:05, 47093.20it/s] 40%|███▉      | 155439/393248 [00:03<00:04, 50645.50it/s] 41%|████      | 161082/393248 [00:03<00:04, 51462.62it/s] 43%|████▎     | 167238/393248 [00:03<00:04, 53432.84it/s] 44%|████▍     | 172881/393248 [00:04<00:04, 54157.50it/s] 45%|████▌     | 178311/393248 [00:04<00:04, 50977.54it/s] 47%|████▋     | 183450/393248 [00:04<00:04, 50596.75it/s] 48%|████▊     | 188784/393248 [00:04<00:04, 49544.51it/s] 49%|████▉     | 193761/393248 [00:04<00:04, 49588.92it/s] 51%|█████     | 199557/393248 [00:04<00:03, 51528.26it/s] 52%|█████▏    | 204726/393248 [00:04<00:03, 48817.74it/s] 53%|█████▎    | 209641/393248 [00:04<00:03, 47115.42it/s] 55%|█████▍    | 214380/393248 [00:04<00:03, 45321.23it/s] 56%|█████▌    | 219051/393248 [00:05<00:03, 45190.08it/s] 58%|█████▊    | 226233/393248 [00:05<00:03, 51653.12it/s] 59%|█████▉    | 231421/393248 [00:05<00:04, 39604.57it/s] 60%|██████    | 236211/393248 [00:05<00:03, 41561.89it/s] 62%|██████▏   | 242136/393248 [00:05<00:03, 45299.36it/s] 64%|██████▎   | 249831/393248 [00:05<00:02, 51899.84it/s] 65%|██████▌   | 255987/393248 [00:05<00:02, 53849.14it/s] 67%|██████▋   | 261559/393248 [00:05<00:02, 53764.78it/s] 68%|██████▊   | 267066/393248 [00:06<00:02, 46495.53it/s] 69%|██████▉   | 272403/393248 [00:06<00:02, 47586.01it/s] 71%|███████   | 278559/393248 [00:06<00:02, 51101.50it/s] 72%|███████▏  | 283844/393248 [00:06<00:02, 49506.94it/s] 73%|███████▎  | 288918/393248 [00:06<00:02, 49496.18it/s] 75%|███████▍  | 293954/393248 [00:06<00:02, 48451.38it/s] 76%|███████▋  | 300105/393248 [00:06<00:01, 51402.83it/s] 78%|███████▊  | 306774/393248 [00:06<00:01, 55071.68it/s] 79%|███████▉  | 312417/393248 [00:06<00:01, 55350.53it/s] 81%|████████  | 317988/393248 [00:07<00:01, 52713.45it/s] 82%|████████▏ | 323703/393248 [00:07<00:01, 52751.73it/s] 84%|████████▍ | 330372/393248 [00:07<00:01, 56005.30it/s] 86%|████████▌ | 336528/393248 [00:07<00:00, 56785.16it/s] 87%|████████▋ | 343197/393248 [00:07<00:00, 58175.35it/s] 89%|████████▉ | 349030/393248 [00:07<00:00, 57946.75it/s] 90%|█████████ | 354835/393248 [00:07<00:00, 57577.28it/s] 92%|█████████▏| 360639/393248 [00:07<00:00, 56900.13it/s] 93%|█████████▎| 366795/393248 [00:07<00:00, 58116.81it/s] 95%|█████████▍| 373464/393248 [00:07<00:00, 60036.28it/s] 97%|█████████▋| 379620/393248 [00:08<00:00, 59206.68it/s] 98%|█████████▊| 385546/393248 [00:08<00:00, 58845.96it/s]100%|█████████▉| 392958/393248 [00:08<00:00, 63039.00it/s]100%|██████████| 393248/393248 [00:08<00:00, 47361.71it/s]
The spherical harmonics array is 346.53 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 85.04191851615906 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 2.4750649962419544
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.0003, 'pow_max': 0.00035, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 12.12it/s] 21%|██        | 4/19 [00:00<00:01, 11.54it/s] 32%|███▏      | 6/19 [00:00<00:01, 12.29it/s] 42%|████▏     | 8/19 [00:00<00:00, 13.09it/s] 53%|█████▎    | 10/19 [00:00<00:00, 13.69it/s] 63%|██████▎   | 12/19 [00:00<00:00, 14.75it/s] 74%|███████▎  | 14/19 [00:00<00:00, 15.87it/s] 89%|████████▉ | 17/19 [00:01<00:00, 17.24it/s]100%|██████████| 19/19 [00:01<00:00, 15.43it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5563266 Minimum k_amp 0.00020658328967625562 n_x_max 110 n_z_max 110
Time to get list of k, phi, theta: 0.761631965637207 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0706865355710117
Ratio of unique |k|: 0.0018102675658507072
Time to get unique k and theta: 1.501878261566162 seconds

Getting transfer functions
  0%|          | 0/10071 [00:00<?, ?it/s]  2%|▏         | 182/10071 [00:00<00:05, 1750.86it/s]  4%|▍         | 434/10071 [00:00<00:04, 2183.54it/s]  7%|▋         | 672/10071 [00:00<00:04, 2270.00it/s]  9%|▉         | 910/10071 [00:00<00:04, 2266.74it/s] 12%|█▏        | 1162/10071 [00:00<00:03, 2348.53it/s] 14%|█▍        | 1414/10071 [00:00<00:03, 2382.08it/s] 17%|█▋        | 1666/10071 [00:00<00:03, 2401.84it/s] 19%|█▉        | 1918/10071 [00:00<00:03, 2421.77it/s] 22%|██▏       | 2184/10071 [00:00<00:03, 2473.74it/s] 24%|██▍       | 2450/10071 [00:01<00:03, 2501.52it/s] 27%|██▋       | 2701/10071 [00:01<00:02, 2476.58it/s] 30%|███       | 3052/10071 [00:01<00:02, 2759.28it/s] 34%|███▎      | 3388/10071 [00:01<00:02, 2906.71it/s] 37%|███▋      | 3724/10071 [00:01<00:02, 3002.31it/s] 40%|████      | 4046/10071 [00:01<00:01, 3036.72it/s] 44%|████▎     | 4396/10071 [00:01<00:01, 3144.04it/s] 47%|████▋     | 4732/10071 [00:01<00:01, 3187.65it/s] 50%|█████     | 5054/10071 [00:01<00:01, 3157.74it/s] 54%|█████▎    | 5390/10071 [00:01<00:01, 3178.28it/s] 57%|█████▋    | 5726/10071 [00:02<00:01, 3231.01it/s] 60%|██████    | 6050/10071 [00:02<00:01, 3207.30it/s] 64%|██████▎   | 6398/10071 [00:02<00:01, 3284.43it/s] 67%|██████▋   | 6748/10071 [00:02<00:00, 3342.58it/s] 71%|███████   | 7112/10071 [00:02<00:00, 3403.57it/s] 74%|███████▍  | 7462/10071 [00:02<00:00, 3412.60it/s] 77%|███████▋  | 7804/10071 [00:02<00:00, 3339.91it/s] 81%|████████  | 8162/10071 [00:02<00:00, 3409.40it/s] 85%|████████▍ | 8526/10071 [00:02<00:00, 3448.62it/s] 88%|████████▊ | 8876/10071 [00:02<00:00, 3436.43it/s] 92%|█████████▏| 9220/10071 [00:03<00:00, 3407.30it/s] 95%|█████████▍| 9561/10071 [00:03<00:00, 3379.55it/s] 98%|█████████▊| 9900/10071 [00:03<00:00, 3304.30it/s]100%|██████████| 10071/10071 [00:03<00:00, 3011.91it/s]
Size of transfer function: 1.61 MB. 

Size of integrand: 33.88 MB. Time to calculate integrand: 0.019616127014160156 s

Getting spherical harmonics
  0%|          | 0/393248 [00:00<?, ?it/s]  0%|          | 1026/393248 [00:00<01:06, 5920.51it/s]  2%|▏         | 6156/393248 [00:00<00:15, 25022.57it/s]  3%|▎         | 10773/393248 [00:00<00:11, 32113.04it/s]  4%|▎         | 14364/393248 [00:00<00:11, 32881.00it/s]  5%|▍         | 19494/393248 [00:00<00:09, 38448.34it/s]  6%|▌         | 24111/393248 [00:00<00:09, 40569.90it/s]  7%|▋         | 28300/393248 [00:00<00:08, 40682.51it/s]  8%|▊         | 32458/393248 [00:00<00:09, 39984.04it/s]  9%|▉         | 36936/393248 [00:01<00:08, 40789.02it/s] 11%|█         | 41553/393248 [00:01<00:08, 41155.73it/s] 12%|█▏        | 46170/393248 [00:01<00:08, 42401.33it/s] 13%|█▎        | 50436/393248 [00:01<00:08, 39536.15it/s] 14%|█▍        | 55917/393248 [00:01<00:07, 42186.36it/s] 16%|█▌        | 61047/393248 [00:01<00:07, 42792.14it/s] 17%|█▋        | 65347/393248 [00:01<00:08, 39640.79it/s] 18%|█▊        | 69353/393248 [00:01<00:08, 38745.54it/s] 19%|█▊        | 73252/393248 [00:01<00:08, 38280.80it/s] 20%|█▉        | 77094/393248 [00:02<00:08, 36770.82it/s] 21%|██        | 81567/393248 [00:02<00:08, 38922.89it/s] 22%|██▏       | 86697/393248 [00:02<00:07, 42062.90it/s] 23%|██▎       | 91827/393248 [00:02<00:06, 43168.97it/s] 25%|██▍       | 96444/393248 [00:02<00:07, 41923.60it/s] 26%|██▌       | 100657/393248 [00:02<00:08, 32761.69it/s] 27%|██▋       | 104234/393248 [00:02<00:10, 27216.10it/s] 27%|██▋       | 108045/393248 [00:02<00:09, 29561.11it/s] 29%|██▉       | 113886/393248 [00:03<00:08, 34109.77it/s] 31%|███       | 120042/393248 [00:03<00:06, 40678.62it/s] 32%|███▏      | 124659/393248 [00:03<00:06, 41895.98it/s] 33%|███▎      | 131328/393248 [00:03<00:05, 47668.93it/s] 35%|███▌      | 137997/393248 [00:03<00:04, 52202.88it/s] 37%|███▋      | 144666/393248 [00:03<00:04, 55258.84it/s] 38%|███▊      | 150335/393248 [00:03<00:04, 51507.78it/s] 40%|███▉      | 155624/393248 [00:03<00:04, 50663.52it/s] 41%|████      | 160784/393248 [00:03<00:04, 48160.04it/s] 42%|████▏     | 165676/393248 [00:04<00:07, 29533.85it/s] 43%|████▎     | 169537/393248 [00:04<00:08, 27231.27it/s] 44%|████▍     | 172892/393248 [00:04<00:09, 22715.32it/s] 45%|████▍     | 175959/393248 [00:04<00:09, 23783.84it/s] 46%|████▌     | 181089/393248 [00:04<00:07, 28007.56it/s] 47%|████▋     | 184680/393248 [00:05<00:07, 29526.00it/s] 48%|████▊     | 190323/393248 [00:05<00:05, 35230.89it/s] 50%|████▉     | 195453/393248 [00:05<00:05, 37174.55it/s] 51%|█████     | 200070/393248 [00:05<00:04, 38757.21it/s] 52%|█████▏    | 204149/393248 [00:05<00:05, 37180.15it/s] 53%|█████▎    | 208791/393248 [00:05<00:04, 39215.37it/s] 54%|█████▍    | 213921/393248 [00:05<00:04, 42246.85it/s] 56%|█████▌    | 218538/393248 [00:05<00:04, 42522.26it/s] 57%|█████▋    | 224181/393248 [00:05<00:03, 46389.65it/s] 58%|█████▊    | 228906/393248 [00:06<00:03, 44540.92it/s] 59%|█████▉    | 233431/393248 [00:06<00:03, 44574.98it/s] 61%|██████    | 237938/393248 [00:06<00:03, 44237.03it/s] 62%|██████▏   | 243162/393248 [00:06<00:03, 44933.11it/s] 63%|██████▎   | 248805/393248 [00:06<00:03, 46526.37it/s] 65%|██████▍   | 254961/393248 [00:06<00:02, 50233.41it/s] 66%|██████▌   | 260091/393248 [00:06<00:02, 50236.33it/s] 68%|██████▊   | 266247/393248 [00:06<00:02, 52995.17it/s] 69%|██████▉   | 271563/393248 [00:06<00:02, 51719.72it/s] 71%|███████   | 277533/393248 [00:07<00:02, 53660.36it/s] 72%|███████▏  | 282915/393248 [00:07<00:02, 51454.92it/s] 73%|███████▎  | 288293/393248 [00:07<00:02, 52114.02it/s] 75%|███████▍  | 293525/393248 [00:07<00:01, 51702.16it/s] 76%|███████▌  | 298709/393248 [00:07<00:01, 51518.48it/s] 77%|███████▋  | 303871/393248 [00:07<00:01, 49795.97it/s] 79%|███████▊  | 308866/393248 [00:07<00:01, 48928.71it/s] 80%|████████  | 315495/393248 [00:07<00:01, 52913.67it/s] 82%|████████▏ | 321651/393248 [00:07<00:01, 53792.17it/s] 83%|████████▎ | 327807/393248 [00:07<00:01, 55638.58it/s] 85%|████████▍ | 333380/393248 [00:08<00:01, 54963.84it/s] 86%|████████▌ | 338882/393248 [00:08<00:01, 53956.61it/s] 88%|████████▊ | 344283/393248 [00:08<00:00, 52683.88it/s] 89%|████████▉ | 349557/393248 [00:08<00:00, 51840.18it/s] 90%|█████████ | 354745/393248 [00:08<00:00, 50455.49it/s] 92%|█████████▏| 361665/393248 [00:08<00:00, 55680.68it/s] 93%|█████████▎| 367261/393248 [00:08<00:00, 53585.60it/s] 95%|█████████▍| 373464/393248 [00:08<00:00, 55593.25it/s] 97%|█████████▋| 379620/393248 [00:08<00:00, 56161.18it/s] 98%|█████████▊| 385256/393248 [00:09<00:00, 55849.75it/s] 99%|█████████▉| 390854/393248 [00:09<00:00, 44688.15it/s]100%|██████████| 393248/393248 [00:09<00:00, 42311.79it/s]
The spherical harmonics array is 346.53 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 92.65611433982849 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 2.354573244067573
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.0004, 'pow_max': 0.00045000000000000004, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 16.54it/s] 21%|██        | 4/19 [00:00<00:00, 17.75it/s] 37%|███▋      | 7/19 [00:00<00:00, 19.19it/s] 53%|█████▎    | 10/19 [00:00<00:00, 20.32it/s] 68%|██████▊   | 13/19 [00:00<00:00, 20.97it/s] 84%|████████▍ | 16/19 [00:00<00:00, 21.35it/s]100%|██████████| 19/19 [00:00<00:00, 21.32it/s]100%|██████████| 19/19 [00:00<00:00, 20.56it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5563266 Minimum k_amp 0.00020658328967625562 n_x_max 110 n_z_max 110
Time to get list of k, phi, theta: 0.6850650310516357 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0706865355710117
Ratio of unique |k|: 0.0018102675658507072
Time to get unique k and theta: 1.3300795555114746 seconds

Getting transfer functions
  0%|          | 0/10071 [00:00<?, ?it/s]  2%|▏         | 168/10071 [00:00<00:06, 1587.57it/s]  4%|▍         | 420/10071 [00:00<00:04, 2107.64it/s]  7%|▋         | 672/10071 [00:00<00:04, 2258.37it/s]  9%|▉         | 899/10071 [00:00<00:04, 2218.17it/s] 11%|█▏        | 1148/10071 [00:00<00:03, 2282.15it/s] 14%|█▍        | 1386/10071 [00:00<00:03, 2268.12it/s] 16%|█▌        | 1624/10071 [00:00<00:03, 2290.52it/s] 19%|█▊        | 1876/10071 [00:00<00:03, 2333.74it/s] 21%|██        | 2128/10071 [00:00<00:03, 2356.67it/s] 24%|██▎       | 2380/10071 [00:01<00:03, 2385.43it/s] 26%|██▌       | 2632/10071 [00:01<00:03, 2383.27it/s] 30%|██▉       | 2982/10071 [00:01<00:02, 2702.98it/s] 33%|███▎      | 3304/10071 [00:01<00:02, 2840.03it/s] 36%|███▌      | 3626/10071 [00:01<00:02, 2910.87it/s] 39%|███▉      | 3976/10071 [00:01<00:02, 3044.00it/s] 43%|████▎     | 4284/10071 [00:01<00:01, 3052.94it/s] 46%|████▌     | 4606/10071 [00:01<00:01, 3098.04it/s] 49%|████▉     | 4970/10071 [00:01<00:01, 3254.45it/s] 53%|█████▎    | 5296/10071 [00:01<00:01, 3243.68it/s] 56%|█████▌    | 5621/10071 [00:02<00:01, 3234.30it/s] 59%|█████▉    | 5945/10071 [00:02<00:01, 3232.32it/s] 63%|██████▎   | 6300/10071 [00:02<00:01, 3278.81it/s] 66%|██████▌   | 6636/10071 [00:02<00:01, 3271.87it/s] 69%|██████▉   | 6972/10071 [00:02<00:00, 3279.68it/s] 73%|███████▎  | 7336/10071 [00:02<00:00, 3372.68it/s] 77%|███████▋  | 7714/10071 [00:02<00:00, 3464.90it/s] 80%|████████  | 8061/10071 [00:02<00:00, 3416.36it/s] 83%|████████▎ | 8403/10071 [00:02<00:00, 3360.14it/s] 87%|████████▋ | 8764/10071 [00:02<00:00, 3402.86it/s] 90%|█████████ | 9105/10071 [00:03<00:00, 3285.31it/s] 94%|█████████▎| 9435/10071 [00:03<00:00, 3245.83it/s] 97%|█████████▋| 9772/10071 [00:03<00:00, 3277.19it/s]100%|██████████| 10071/10071 [00:03<00:00, 2965.51it/s]
Size of transfer function: 1.61 MB. 

Size of integrand: 33.88 MB. Time to calculate integrand: 0.024225234985351562 s

Getting spherical harmonics
  0%|          | 0/393248 [00:00<?, ?it/s]  0%|          | 513/393248 [00:00<01:42, 3823.90it/s]  1%|▏         | 5643/393248 [00:00<00:13, 28267.11it/s]  3%|▎         | 10773/393248 [00:00<00:10, 38013.29it/s]  4%|▍         | 15390/393248 [00:00<00:09, 40788.35it/s]  5%|▌         | 20007/393248 [00:00<00:09, 40646.69it/s]  6%|▋         | 24624/393248 [00:00<00:09, 39425.49it/s]  8%|▊         | 30267/393248 [00:00<00:08, 43674.82it/s]  9%|▉         | 35397/393248 [00:00<00:07, 45215.08it/s] 10%|█         | 40014/393248 [00:00<00:07, 44633.43it/s] 11%|█▏        | 44631/393248 [00:01<00:07, 44488.14it/s] 13%|█▎        | 50274/393248 [00:01<00:07, 46901.81it/s] 14%|█▍        | 55917/393248 [00:01<00:07, 47794.25it/s] 16%|█▌        | 61047/393248 [00:01<00:06, 47643.18it/s] 17%|█▋        | 65818/393248 [00:01<00:06, 47140.76it/s] 18%|█▊        | 70535/393248 [00:01<00:07, 43123.64it/s] 19%|█▉        | 75097/393248 [00:01<00:07, 43802.64it/s] 20%|██        | 79523/393248 [00:01<00:07, 43910.69it/s] 21%|██▏       | 83947/393248 [00:02<00:08, 36271.04it/s] 23%|██▎       | 88749/393248 [00:02<00:07, 38821.02it/s] 24%|██▎       | 93366/393248 [00:02<00:07, 40231.35it/s] 25%|██▍       | 97983/393248 [00:02<00:07, 40569.15it/s] 26%|██▋       | 103626/393248 [00:02<00:06, 44401.29it/s] 28%|██▊       | 108243/393248 [00:02<00:06, 44107.61it/s] 29%|██▉       | 114399/393248 [00:02<00:05, 48761.08it/s] 31%|███       | 120042/393248 [00:02<00:05, 49961.50it/s] 32%|███▏      | 125502/393248 [00:02<00:05, 51284.41it/s] 33%|███▎      | 130815/393248 [00:02<00:05, 50670.15it/s] 35%|███▍      | 135945/393248 [00:03<00:05, 49689.27it/s] 36%|███▌      | 140938/393248 [00:03<00:05, 47896.93it/s] 37%|███▋      | 145753/393248 [00:03<00:05, 45998.73it/s] 38%|███▊      | 150378/393248 [00:03<00:05, 43396.69it/s] 40%|███▉      | 155952/393248 [00:03<00:05, 46086.73it/s] 41%|████      | 161082/393248 [00:03<00:04, 46564.16it/s] 42%|████▏     | 166725/393248 [00:03<00:04, 47521.08it/s] 44%|████▎     | 171496/393248 [00:03<00:05, 43651.10it/s] 45%|████▍     | 176472/393248 [00:04<00:04, 45170.24it/s] 46%|████▌     | 181046/393248 [00:04<00:04, 44898.59it/s] 47%|████▋     | 185706/393248 [00:04<00:04, 44013.94it/s] 49%|████▉     | 191862/393248 [00:04<00:04, 48463.19it/s] 50%|█████     | 196748/393248 [00:04<00:04, 46142.88it/s] 51%|█████     | 201405/393248 [00:04<00:04, 43199.60it/s] 52%|█████▏    | 206226/393248 [00:04<00:04, 43730.60it/s] 54%|█████▎    | 211356/393248 [00:04<00:04, 45196.37it/s] 55%|█████▌    | 217512/393248 [00:04<00:03, 49113.32it/s] 57%|█████▋    | 223155/393248 [00:04<00:03, 50856.12it/s] 58%|█████▊    | 228277/393248 [00:05<00:03, 49929.45it/s] 59%|█████▉    | 233415/393248 [00:05<00:03, 49395.60it/s] 61%|██████    | 238373/393248 [00:05<00:03, 48004.48it/s] 62%|██████▏   | 245214/393248 [00:05<00:02, 53724.07it/s] 64%|██████▎   | 250628/393248 [00:05<00:02, 51510.46it/s] 65%|██████▌   | 255821/393248 [00:05<00:02, 51459.43it/s] 66%|██████▋   | 261117/393248 [00:05<00:02, 50538.99it/s] 68%|██████▊   | 266247/393248 [00:05<00:02, 50728.02it/s] 69%|██████▉   | 272403/393248 [00:05<00:02, 53598.57it/s] 71%|███████   | 278559/393248 [00:06<00:02, 55216.08it/s] 72%|███████▏  | 284715/393248 [00:06<00:01, 56798.12it/s] 74%|███████▍  | 291384/393248 [00:06<00:01, 57645.45it/s] 76%|███████▌  | 297540/393248 [00:06<00:01, 58221.50it/s] 77%|███████▋  | 303366/393248 [00:06<00:01, 57234.42it/s] 79%|███████▊  | 309339/393248 [00:06<00:01, 56540.91it/s] 80%|████████  | 314997/393248 [00:06<00:01, 53191.37it/s] 81%|████████▏ | 320349/393248 [00:06<00:01, 52506.74it/s] 83%|████████▎ | 325755/393248 [00:06<00:01, 52755.86it/s] 84%|████████▍ | 331398/393248 [00:07<00:01, 52981.70it/s] 86%|████████▌ | 336708/393248 [00:07<00:01, 48331.50it/s] 87%|████████▋ | 341616/393248 [00:07<00:01, 48008.32it/s] 88%|████████▊ | 346467/393248 [00:07<00:00, 47897.04it/s] 90%|████████▉ | 352944/393248 [00:07<00:00, 52032.87it/s] 91%|█████████▏| 359100/393248 [00:07<00:00, 53464.71it/s] 93%|█████████▎| 366046/393248 [00:07<00:00, 58018.21it/s] 95%|█████████▍| 371889/393248 [00:07<00:00, 56293.71it/s] 96%|█████████▌| 378081/393248 [00:07<00:00, 57128.33it/s] 98%|█████████▊| 383820/393248 [00:07<00:00, 55235.62it/s] 99%|█████████▉| 389369/393248 [00:08<00:00, 54780.90it/s]100%|██████████| 393248/393248 [00:08<00:00, 48231.78it/s]
The spherical harmonics array is 346.53 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 86.75296378135681 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 2.6422403812377677
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.0005, 'pow_max': 0.00055, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 16.50it/s] 26%|██▋       | 5/19 [00:00<00:00, 19.25it/s] 42%|████▏     | 8/19 [00:00<00:00, 20.19it/s] 58%|█████▊    | 11/19 [00:00<00:00, 21.06it/s] 74%|███████▎  | 14/19 [00:00<00:00, 21.45it/s] 89%|████████▉ | 17/19 [00:00<00:00, 21.72it/s]100%|██████████| 19/19 [00:00<00:00, 21.02it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5563266 Minimum k_amp 0.00020658328967625562 n_x_max 110 n_z_max 110
Time to get list of k, phi, theta: 0.6741859912872314 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0706865355710117
Ratio of unique |k|: 0.0018102675658507072
Time to get unique k and theta: 1.3328795433044434 seconds

Getting transfer functions
  0%|          | 0/10071 [00:00<?, ?it/s]  2%|▏         | 182/10071 [00:00<00:05, 1730.52it/s]  4%|▍         | 392/10071 [00:00<00:05, 1870.49it/s]  6%|▋         | 630/10071 [00:00<00:04, 2065.90it/s]  8%|▊         | 840/10071 [00:00<00:04, 2059.18it/s] 11%|█         | 1078/10071 [00:00<00:04, 2134.42it/s] 13%|█▎        | 1316/10071 [00:00<00:03, 2195.50it/s] 15%|█▌        | 1554/10071 [00:00<00:03, 2210.07it/s] 18%|█▊        | 1806/10071 [00:00<00:03, 2289.27it/s] 20%|██        | 2044/10071 [00:00<00:03, 2304.39it/s] 23%|██▎       | 2282/10071 [00:01<00:03, 2300.61it/s] 25%|██▍       | 2513/10071 [00:01<00:03, 2270.81it/s] 27%|██▋       | 2758/10071 [00:01<00:03, 2306.19it/s] 31%|███       | 3108/10071 [00:01<00:02, 2658.26it/s] 35%|███▍      | 3486/10071 [00:01<00:02, 2975.69it/s] 38%|███▊      | 3822/10071 [00:01<00:02, 3080.92it/s] 41%|████      | 4131/10071 [00:01<00:01, 3035.75it/s] 45%|████▍     | 4508/10071 [00:01<00:01, 3231.22it/s] 48%|████▊     | 4832/10071 [00:01<00:01, 3143.18it/s] 51%|█████     | 5148/10071 [00:01<00:01, 3125.24it/s] 54%|█████▍    | 5462/10071 [00:02<00:01, 3066.96it/s] 57%|█████▋    | 5782/10071 [00:02<00:01, 3104.54it/s] 61%|██████    | 6132/10071 [00:02<00:01, 3180.01it/s] 64%|██████▍   | 6451/10071 [00:02<00:01, 3177.60it/s] 67%|██████▋   | 6769/10071 [00:02<00:01, 3153.00it/s] 71%|███████   | 7112/10071 [00:02<00:00, 3202.91it/s] 74%|███████▍  | 7448/10071 [00:02<00:00, 3218.20it/s] 77%|███████▋  | 7770/10071 [00:02<00:00, 3143.94it/s] 80%|████████  | 8085/10071 [00:02<00:00, 3069.02it/s] 83%|████████▎ | 8400/10071 [00:03<00:00, 3074.71it/s] 87%|████████▋ | 8736/10071 [00:03<00:00, 3131.40it/s] 90%|█████████ | 9100/10071 [00:03<00:00, 3246.34it/s] 94%|█████████▎| 9436/10071 [00:03<00:00, 3255.94it/s] 97%|█████████▋| 9800/10071 [00:03<00:00, 3332.88it/s]100%|██████████| 10071/10071 [00:03<00:00, 2877.79it/s]
Size of transfer function: 1.61 MB. 

Size of integrand: 33.88 MB. Time to calculate integrand: 0.024932384490966797 s

Getting spherical harmonics
  0%|          | 0/393248 [00:00<?, ?it/s]  0%|          | 513/393248 [00:00<02:45, 2377.67it/s]  2%|▏         | 6156/393248 [00:00<00:16, 22867.66it/s]  3%|▎         | 10773/393248 [00:00<00:12, 30278.45it/s]  4%|▎         | 14406/393248 [00:00<00:12, 29777.93it/s]  5%|▍         | 18468/393248 [00:00<00:11, 32516.59it/s]  6%|▌         | 24111/393248 [00:00<00:09, 38577.76it/s]  7%|▋         | 28193/393248 [00:00<00:09, 38733.74it/s]  8%|▊         | 32319/393248 [00:00<00:09, 38079.17it/s]  9%|▉         | 36231/393248 [00:01<00:09, 36308.34it/s] 10%|█         | 40527/393248 [00:01<00:09, 37616.44it/s] 11%|█▏        | 44352/393248 [00:01<00:10, 33746.91it/s] 12%|█▏        | 47828/393248 [00:01<00:11, 29238.93it/s] 13%|█▎        | 50901/393248 [00:01<00:12, 26377.25it/s] 14%|█▎        | 53664/393248 [00:01<00:14, 24093.68it/s] 14%|█▍        | 56168/393248 [00:02<00:18, 18334.96it/s] 15%|█▍        | 58234/393248 [00:02<00:21, 15831.68it/s] 15%|█▌        | 60000/393248 [00:02<00:20, 16071.72it/s] 16%|█▌        | 61747/393248 [00:02<00:21, 15118.91it/s] 16%|█▌        | 63349/393248 [00:02<00:21, 15062.70it/s] 17%|█▋        | 64917/393248 [00:02<00:23, 14027.99it/s] 17%|█▋        | 66362/393248 [00:02<00:24, 13109.93it/s] 17%|█▋        | 67716/393248 [00:02<00:24, 13023.33it/s] 18%|█▊        | 69036/393248 [00:03<00:24, 13024.77it/s] 18%|█▊        | 70351/393248 [00:03<00:24, 12974.01it/s] 18%|█▊        | 72333/393248 [00:03<00:21, 14767.05it/s] 20%|█▉        | 77463/393248 [00:03<00:12, 24843.94it/s] 21%|██        | 82593/393248 [00:03<00:10, 30983.23it/s] 22%|██▏       | 87210/393248 [00:03<00:08, 34752.39it/s] 23%|██▎       | 92340/393248 [00:03<00:07, 37615.01it/s] 25%|██▍       | 97470/393248 [00:03<00:07, 40214.70it/s] 26%|██▌       | 103113/393248 [00:03<00:06, 42872.28it/s] 27%|██▋       | 108017/393248 [00:04<00:06, 44573.58it/s] 29%|██▊       | 112487/393248 [00:04<00:06, 40687.55it/s] 30%|██▉       | 116616/393248 [00:04<00:11, 24968.80it/s] 30%|███       | 119875/393248 [00:04<00:10, 25618.76it/s] 31%|███▏      | 123120/393248 [00:04<00:09, 27031.33it/s] 33%|███▎      | 128250/393248 [00:04<00:08, 32318.44it/s] 34%|███▍      | 134919/393248 [00:04<00:06, 40675.47it/s] 36%|███▌      | 141075/393248 [00:05<00:05, 43706.96it/s] 37%|███▋      | 146718/393248 [00:05<00:05, 45661.76it/s] 39%|███▊      | 151546/393248 [00:05<00:05, 45385.32it/s] 40%|███▉      | 156266/393248 [00:05<00:05, 40653.40it/s] 41%|████      | 160530/393248 [00:05<00:05, 40775.80it/s] 42%|████▏     | 165186/393248 [00:05<00:05, 42250.99it/s] 43%|████▎     | 170829/393248 [00:05<00:05, 43422.22it/s] 45%|████▍     | 176472/393248 [00:05<00:04, 46343.22it/s] 46%|████▋     | 182628/393248 [00:05<00:04, 49892.77it/s] 48%|████▊     | 187758/393248 [00:06<00:04, 49867.73it/s] 49%|████▉     | 192795/393248 [00:06<00:04, 49767.03it/s] 50%|█████     | 198018/393248 [00:06<00:03, 50385.81it/s] 52%|█████▏    | 203661/393248 [00:06<00:03, 51276.35it/s] 53%|█████▎    | 208807/393248 [00:06<00:03, 47757.65it/s] 54%|█████▍    | 213637/393248 [00:06<00:03, 47299.63it/s] 56%|█████▌    | 218538/393248 [00:06<00:03, 47591.56it/s] 57%|█████▋    | 223427/393248 [00:06<00:03, 47962.05it/s] 58%|█████▊    | 228244/393248 [00:06<00:03, 41523.21it/s] 59%|█████▉    | 232555/393248 [00:07<00:05, 28484.06it/s] 60%|██████    | 236036/393248 [00:07<00:06, 23056.25it/s] 61%|██████    | 238903/393248 [00:07<00:07, 20415.09it/s] 61%|██████▏   | 241623/393248 [00:07<00:07, 21403.25it/s] 62%|██████▏   | 245214/393248 [00:07<00:06, 23146.34it/s] 63%|██████▎   | 248292/393248 [00:08<00:05, 24324.87it/s] 64%|██████▍   | 251370/393248 [00:08<00:05, 25484.77it/s] 65%|██████▌   | 257013/393248 [00:08<00:04, 33098.16it/s] 67%|██████▋   | 263682/393248 [00:08<00:03, 41846.29it/s] 69%|██████▉   | 270864/393248 [00:08<00:02, 49458.58it/s] 70%|███████   | 277020/393248 [00:08<00:02, 51056.16it/s] 72%|███████▏  | 282327/393248 [00:08<00:02, 50912.72it/s] 73%|███████▎  | 287559/393248 [00:08<00:02, 45971.46it/s] 74%|███████▍  | 292410/393248 [00:08<00:02, 45821.70it/s] 76%|███████▌  | 298053/393248 [00:09<00:01, 47764.83it/s] 77%|███████▋  | 303183/393248 [00:09<00:01, 47714.23it/s] 78%|███████▊  | 308313/393248 [00:09<00:01, 48692.10it/s] 80%|███████▉  | 313443/393248 [00:09<00:01, 49188.72it/s] 81%|████████  | 318403/393248 [00:09<00:01, 48023.76it/s] 82%|████████▏ | 323236/393248 [00:09<00:01, 47671.13it/s] 84%|████████▎ | 328833/393248 [00:09<00:01, 49179.73it/s] 85%|████████▌ | 334476/393248 [00:09<00:01, 50670.59it/s] 86%|████████▋ | 339555/393248 [00:09<00:01, 49893.11it/s] 88%|████████▊ | 344553/393248 [00:09<00:01, 46516.09it/s] 89%|████████▉ | 350892/393248 [00:10<00:00, 50109.25it/s] 91%|█████████ | 356022/393248 [00:10<00:00, 50144.50it/s] 92%|█████████▏| 363204/393248 [00:10<00:00, 55893.21it/s] 94%|█████████▍| 369873/393248 [00:10<00:00, 57777.71it/s] 96%|█████████▌| 375678/393248 [00:10<00:00, 56754.38it/s] 97%|█████████▋| 381373/393248 [00:10<00:00, 56238.78it/s] 98%|█████████▊| 387009/393248 [00:10<00:00, 52559.00it/s]100%|█████████▉| 392313/393248 [00:10<00:00, 51303.60it/s]100%|██████████| 393248/393248 [00:10<00:00, 36224.92it/s]
The spherical harmonics array is 346.53 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 92.92066597938538 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 2.569300915074101
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.0006, 'pow_max': 0.00065, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 16.06it/s] 21%|██        | 4/19 [00:00<00:00, 17.51it/s] 32%|███▏      | 6/19 [00:00<00:00, 18.45it/s] 47%|████▋     | 9/19 [00:00<00:00, 19.69it/s] 63%|██████▎   | 12/19 [00:00<00:00, 20.68it/s] 79%|███████▉  | 15/19 [00:00<00:00, 21.21it/s] 95%|█████████▍| 18/19 [00:00<00:00, 21.58it/s]100%|██████████| 19/19 [00:00<00:00, 20.55it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5563266 Minimum k_amp 0.00020658328967625562 n_x_max 110 n_z_max 110
Time to get list of k, phi, theta: 0.6779415607452393 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0706865355710117
Ratio of unique |k|: 0.0018102675658507072
Time to get unique k and theta: 1.3684868812561035 seconds

Getting transfer functions
  0%|          | 0/10071 [00:00<?, ?it/s]  2%|▏         | 224/10071 [00:00<00:04, 2182.71it/s]  5%|▍         | 490/10071 [00:00<00:03, 2431.48it/s]  7%|▋         | 742/10071 [00:00<00:03, 2439.63it/s] 10%|▉         | 986/10071 [00:00<00:03, 2417.55it/s] 12%|█▏        | 1232/10071 [00:00<00:03, 2383.67it/s] 15%|█▍        | 1498/10071 [00:00<00:03, 2441.19it/s] 17%|█▋        | 1750/10071 [00:00<00:03, 2444.36it/s] 20%|█▉        | 2002/10071 [00:00<00:03, 2447.68it/s] 22%|██▏       | 2247/10071 [00:00<00:03, 2429.81it/s] 25%|██▍       | 2490/10071 [00:01<00:03, 2406.69it/s] 27%|██▋       | 2731/10071 [00:01<00:03, 2356.08it/s] 31%|███       | 3080/10071 [00:01<00:02, 2669.32it/s] 34%|███▎      | 3388/10071 [00:01<00:02, 2788.76it/s] 37%|███▋      | 3710/10071 [00:01<00:02, 2880.79it/s] 40%|███▉      | 4018/10071 [00:01<00:02, 2937.18it/s] 43%|████▎     | 4340/10071 [00:01<00:01, 2986.90it/s] 47%|████▋     | 4704/10071 [00:01<00:01, 3157.05it/s] 50%|█████     | 5040/10071 [00:01<00:01, 3194.25it/s] 53%|█████▎    | 5376/10071 [00:01<00:01, 3199.30it/s] 57%|█████▋    | 5740/10071 [00:02<00:01, 3264.82it/s] 60%|██████    | 6067/10071 [00:02<00:01, 3216.72it/s] 63%|██████▎   | 6389/10071 [00:02<00:01, 3195.00it/s] 67%|██████▋   | 6709/10071 [00:02<00:01, 3144.41it/s] 70%|██████▉   | 7042/10071 [00:02<00:00, 3187.03it/s] 73%|███████▎  | 7392/10071 [00:02<00:00, 3267.42it/s] 77%|███████▋  | 7728/10071 [00:02<00:00, 3289.32it/s] 80%|████████  | 8058/10071 [00:02<00:00, 3165.44it/s] 83%|████████▎ | 8386/10071 [00:02<00:00, 3196.21it/s] 86%|████████▋ | 8708/10071 [00:02<00:00, 3189.04it/s] 90%|████████▉ | 9044/10071 [00:03<00:00, 3230.04it/s] 93%|█████████▎| 9368/10071 [00:03<00:00, 3095.59it/s] 96%|█████████▌| 9688/10071 [00:03<00:00, 3102.82it/s]100%|█████████▉| 10024/10071 [00:03<00:00, 3169.21it/s]100%|██████████| 10071/10071 [00:03<00:00, 2936.88it/s]
Size of transfer function: 1.61 MB. 

Size of integrand: 33.88 MB. Time to calculate integrand: 0.022153139114379883 s

Getting spherical harmonics
  0%|          | 0/393248 [00:00<?, ?it/s]  1%|▏         | 5130/393248 [00:00<00:07, 49272.32it/s]  3%|▎         | 10773/393248 [00:00<00:07, 50856.29it/s]  4%|▍         | 15856/393248 [00:00<00:07, 50454.25it/s]  5%|▌         | 20899/393248 [00:00<00:09, 39009.03it/s]  7%|▋         | 25650/393248 [00:00<00:08, 41486.05it/s]  8%|▊         | 30267/393248 [00:00<00:08, 42262.57it/s]  9%|▉         | 35397/393248 [00:00<00:07, 44851.33it/s] 10%|█         | 41040/393248 [00:00<00:07, 46766.49it/s] 12%|█▏        | 46683/393248 [00:01<00:07, 48717.97it/s] 13%|█▎        | 52326/393248 [00:01<00:06, 49580.34it/s] 15%|█▍        | 57332/393248 [00:01<00:06, 49676.38it/s] 16%|█▌        | 62333/393248 [00:01<00:06, 48735.23it/s] 17%|█▋        | 67231/393248 [00:01<00:06, 48726.44it/s] 18%|█▊        | 72121/393248 [00:01<00:06, 47304.74it/s] 20%|█▉        | 76950/393248 [00:01<00:06, 47246.73it/s] 21%|██        | 82080/393248 [00:01<00:06, 48199.18it/s] 22%|██▏       | 86911/393248 [00:01<00:06, 48120.70it/s] 23%|██▎       | 91731/393248 [00:01<00:06, 47810.17it/s] 25%|██▍       | 96517/393248 [00:02<00:06, 42849.77it/s] 26%|██▋       | 103626/393248 [00:02<00:05, 49872.96it/s] 28%|██▊       | 109369/393248 [00:02<00:05, 51974.20it/s] 29%|██▉       | 115425/393248 [00:02<00:05, 53110.73it/s] 31%|███       | 122094/393248 [00:02<00:04, 56190.35it/s] 32%|███▏      | 127765/393248 [00:02<00:04, 54427.22it/s] 34%|███▍      | 133380/393248 [00:02<00:04, 54548.53it/s] 35%|███▌      | 139023/393248 [00:02<00:04, 54393.81it/s] 37%|███▋      | 145179/393248 [00:02<00:04, 55975.68it/s] 38%|███▊      | 150795/393248 [00:03<00:04, 55258.77it/s] 40%|███▉      | 156334/393248 [00:03<00:04, 53171.25it/s] 41%|████      | 161671/393248 [00:03<00:04, 48996.73it/s] 43%|████▎     | 168264/393248 [00:03<00:04, 52796.56it/s] 44%|████▍     | 173612/393248 [00:03<00:04, 51518.78it/s] 46%|████▌     | 179037/393248 [00:03<00:04, 52001.64it/s] 47%|████▋     | 186219/393248 [00:03<00:03, 56902.19it/s] 49%|████▉     | 192375/393248 [00:03<00:03, 57601.96it/s] 50%|█████     | 198164/393248 [00:03<00:03, 56048.88it/s] 52%|█████▏    | 203793/393248 [00:04<00:03, 55885.19it/s] 53%|█████▎    | 209398/393248 [00:04<00:03, 55250.41it/s] 55%|█████▍    | 214934/393248 [00:04<00:03, 54896.68it/s] 56%|█████▌    | 220590/393248 [00:04<00:03, 55240.29it/s] 58%|█████▊    | 226746/393248 [00:04<00:03, 55485.46it/s] 59%|█████▉    | 232298/393248 [00:04<00:03, 52203.95it/s] 61%|██████    | 238032/393248 [00:04<00:02, 52860.59it/s] 62%|██████▏   | 245214/393248 [00:04<00:02, 57713.61it/s] 64%|██████▍   | 251883/393248 [00:04<00:02, 59942.46it/s] 66%|██████▌   | 258552/393248 [00:04<00:02, 61040.54it/s] 67%|██████▋   | 264680/393248 [00:05<00:02, 60870.81it/s] 69%|██████▉   | 270784/393248 [00:05<00:02, 58310.42it/s] 70%|███████   | 276644/393248 [00:05<00:02, 50620.59it/s] 72%|███████▏  | 282663/393248 [00:05<00:02, 51868.62it/s] 73%|███████▎  | 288306/393248 [00:05<00:02, 51876.41it/s] 75%|███████▍  | 293697/393248 [00:05<00:01, 52425.61it/s] 76%|███████▌  | 299592/393248 [00:05<00:01, 53578.36it/s] 78%|███████▊  | 306261/393248 [00:05<00:01, 56583.57it/s] 79%|███████▉  | 311968/393248 [00:05<00:01, 55655.76it/s] 81%|████████  | 318060/393248 [00:06<00:01, 57141.70it/s] 82%|████████▏ | 324216/393248 [00:06<00:01, 58106.04it/s] 84%|████████▍ | 330051/393248 [00:06<00:01, 57960.93it/s] 85%|████████▌ | 335864/393248 [00:06<00:01, 57363.72it/s] 87%|████████▋ | 341612/393248 [00:06<00:00, 56981.59it/s] 88%|████████▊ | 347318/393248 [00:06<00:00, 53308.99it/s] 90%|████████▉ | 352944/393248 [00:06<00:00, 53584.72it/s] 91%|█████████ | 358338/393248 [00:06<00:00, 52607.86it/s] 92%|█████████▏| 363717/393248 [00:06<00:00, 52238.44it/s] 94%|█████████▍| 368957/393248 [00:07<00:00, 51593.50it/s] 95%|█████████▌| 374490/393248 [00:07<00:00, 52103.81it/s] 97%|█████████▋| 380646/393248 [00:07<00:00, 53193.57it/s] 98%|█████████▊| 385968/393248 [00:07<00:00, 51596.55it/s] 99%|█████████▉| 391133/393248 [00:07<00:00, 51420.36it/s]100%|██████████| 393248/393248 [00:07<00:00, 52379.14it/s]
The spherical harmonics array is 346.53 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 89.4356644153595 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 2.399429836232871
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.0007, 'pow_max': 0.00075, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 16%|█▌        | 3/19 [00:00<00:00, 22.06it/s] 32%|███▏      | 6/19 [00:00<00:00, 22.21it/s] 47%|████▋     | 9/19 [00:00<00:00, 22.24it/s] 63%|██████▎   | 12/19 [00:00<00:00, 22.26it/s] 79%|███████▉  | 15/19 [00:00<00:00, 22.06it/s] 95%|█████████▍| 18/19 [00:00<00:00, 22.10it/s]100%|██████████| 19/19 [00:00<00:00, 22.14it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5563266 Minimum k_amp 0.00020658328967625562 n_x_max 110 n_z_max 110
Time to get list of k, phi, theta: 0.66221022605896 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0706865355710117
Ratio of unique |k|: 0.0018102675658507072
Time to get unique k and theta: 1.3247087001800537 seconds

Getting transfer functions
  0%|          | 0/10071 [00:00<?, ?it/s]  2%|▏         | 210/10071 [00:00<00:04, 2051.27it/s]  5%|▍         | 462/10071 [00:00<00:04, 2242.74it/s]  7%|▋         | 700/10071 [00:00<00:04, 2301.10it/s]  9%|▉         | 938/10071 [00:00<00:03, 2284.19it/s] 12%|█▏        | 1204/10071 [00:00<00:03, 2373.03it/s] 14%|█▍        | 1456/10071 [00:00<00:03, 2413.09it/s] 17%|█▋        | 1698/10071 [00:00<00:03, 2360.55it/s] 19%|█▉        | 1935/10071 [00:00<00:03, 2337.39it/s] 22%|██▏       | 2170/10071 [00:00<00:03, 2309.01it/s] 24%|██▍       | 2408/10071 [00:01<00:03, 2312.63it/s] 26%|██▋       | 2660/10071 [00:01<00:03, 2355.94it/s] 30%|██▉       | 2996/10071 [00:01<00:02, 2644.84it/s] 33%|███▎      | 3332/10071 [00:01<00:02, 2847.82it/s] 37%|███▋      | 3696/10071 [00:01<00:02, 3056.30it/s] 40%|████      | 4032/10071 [00:01<00:01, 3117.31it/s] 43%|████▎     | 4344/10071 [00:01<00:01, 3105.06it/s] 47%|████▋     | 4690/10071 [00:01<00:01, 3181.93it/s] 50%|█████     | 5054/10071 [00:01<00:01, 3278.70it/s] 54%|█████▎    | 5390/10071 [00:01<00:01, 3290.05it/s] 57%|█████▋    | 5740/10071 [00:02<00:01, 3332.21it/s] 60%|██████    | 6074/10071 [00:02<00:01, 3302.24it/s] 64%|██████▎   | 6405/10071 [00:02<00:01, 3248.29it/s] 67%|██████▋   | 6734/10071 [00:02<00:01, 3240.95it/s] 70%|███████   | 7084/10071 [00:02<00:00, 3280.49it/s] 74%|███████▎  | 7420/10071 [00:02<00:00, 3294.53it/s] 77%|███████▋  | 7770/10071 [00:02<00:00, 3313.35it/s] 81%|████████  | 8134/10071 [00:02<00:00, 3361.02it/s] 84%|████████▍ | 8484/10071 [00:02<00:00, 3387.51it/s] 88%|████████▊ | 8823/10071 [00:02<00:00, 3312.33it/s] 91%|█████████ | 9155/10071 [00:03<00:00, 3292.33it/s] 94%|█████████▍| 9485/10071 [00:03<00:00, 3288.03it/s] 97%|█████████▋| 9814/10071 [00:03<00:00, 3249.02it/s]100%|██████████| 10071/10071 [00:03<00:00, 2977.05it/s]
Size of transfer function: 1.61 MB. 

Size of integrand: 33.88 MB. Time to calculate integrand: 0.028542280197143555 s

Getting spherical harmonics
  0%|          | 0/393248 [00:00<?, ?it/s]  1%|          | 3591/393248 [00:00<00:11, 35282.50it/s]  2%|▏         | 8721/393248 [00:00<00:08, 43508.24it/s]  4%|▎         | 14364/393248 [00:00<00:08, 44730.50it/s]  5%|▍         | 19494/393248 [00:00<00:08, 45487.25it/s]  6%|▌         | 24111/393248 [00:00<00:08, 45708.36it/s]  7%|▋         | 29241/393248 [00:00<00:07, 46074.58it/s]  9%|▊         | 33858/393248 [00:00<00:08, 44403.02it/s] 10%|▉         | 38475/393248 [00:00<00:07, 44567.88it/s] 11%|█         | 44118/393248 [00:00<00:07, 46161.54it/s] 12%|█▏        | 48730/393248 [00:01<00:12, 28158.97it/s] 13%|█▎        | 52362/393248 [00:01<00:11, 29532.80it/s] 14%|█▍        | 56943/393248 [00:01<00:10, 32528.50it/s] 16%|█▌        | 62073/393248 [00:01<00:08, 36879.32it/s] 17%|█▋        | 66690/393248 [00:01<00:08, 38730.61it/s] 18%|█▊        | 71820/393248 [00:01<00:07, 41345.97it/s] 20%|█▉        | 76950/393248 [00:01<00:07, 43351.18it/s] 21%|██        | 82593/393248 [00:02<00:06, 46023.04it/s] 22%|██▏       | 87353/393248 [00:02<00:06, 45206.44it/s] 23%|██▎       | 92340/393248 [00:02<00:06, 46135.80it/s] 25%|██▍       | 97470/393248 [00:02<00:06, 46467.81it/s] 26%|██▋       | 103626/393248 [00:02<00:05, 50417.69it/s] 28%|██▊       | 110295/393248 [00:02<00:05, 54958.80it/s] 30%|██▉       | 116964/393248 [00:02<00:04, 57160.84it/s] 31%|███▏      | 123120/393248 [00:02<00:04, 56766.31it/s] 33%|███▎      | 128825/393248 [00:02<00:04, 56701.95it/s] 34%|███▍      | 134515/393248 [00:02<00:04, 54214.21it/s] 36%|███▌      | 139967/393248 [00:03<00:04, 51040.40it/s] 37%|███▋      | 146205/393248 [00:03<00:04, 52802.01it/s] 39%|███▊      | 152361/393248 [00:03<00:04, 55106.36it/s] 40%|████      | 158517/393248 [00:03<00:04, 56545.84it/s] 42%|████▏     | 164208/393248 [00:03<00:04, 56091.25it/s] 43%|████▎     | 170829/393248 [00:03<00:03, 58251.22it/s] 45%|████▍     | 176673/393248 [00:03<00:03, 56745.80it/s] 46%|████▋     | 182365/393248 [00:03<00:03, 53688.93it/s] 48%|████▊     | 187771/393248 [00:03<00:03, 52992.11it/s] 49%|████▉     | 193094/393248 [00:04<00:03, 52012.46it/s] 51%|█████     | 200070/393248 [00:04<00:03, 55655.45it/s] 52%|█████▏    | 206226/393248 [00:04<00:03, 56286.39it/s] 54%|█████▍    | 212382/393248 [00:04<00:03, 55986.49it/s] 55%|█████▌    | 217987/393248 [00:04<00:03, 54903.06it/s] 57%|█████▋    | 223481/393248 [00:04<00:03, 51436.48it/s] 58%|█████▊    | 229311/393248 [00:04<00:03, 52908.15it/s] 60%|█████▉    | 234954/393248 [00:04<00:02, 53749.47it/s] 61%|██████    | 240597/393248 [00:04<00:02, 53701.00it/s] 63%|██████▎   | 246753/393248 [00:05<00:02, 55804.88it/s] 64%|██████▍   | 252396/393248 [00:05<00:02, 53925.20it/s] 66%|██████▌   | 257814/393248 [00:05<00:02, 51290.86it/s] 67%|██████▋   | 262978/393248 [00:05<00:02, 50211.88it/s] 68%|██████▊   | 268299/393248 [00:05<00:02, 49990.89it/s] 70%|██████▉   | 273429/393248 [00:05<00:02, 50309.15it/s] 71%|███████   | 279072/393248 [00:05<00:02, 51909.21it/s] 72%|███████▏  | 284596/393248 [00:05<00:02, 52873.93it/s] 74%|███████▍  | 290871/393248 [00:05<00:01, 55350.03it/s] 76%|███████▌  | 297027/393248 [00:06<00:01, 56493.54it/s] 77%|███████▋  | 302684/393248 [00:06<00:01, 55320.85it/s] 78%|███████▊  | 308313/393248 [00:06<00:01, 54761.48it/s] 80%|███████▉  | 313956/393248 [00:06<00:01, 54618.66it/s] 81%|████████▏ | 319599/393248 [00:06<00:01, 55059.56it/s] 83%|████████▎ | 325755/393248 [00:06<00:01, 56240.95it/s] 84%|████████▍ | 331911/393248 [00:06<00:01, 57376.17it/s] 86%|████████▌ | 337651/393248 [00:06<00:00, 56786.29it/s] 87%|████████▋ | 343332/393248 [00:06<00:00, 53074.45it/s] 89%|████████▉ | 350379/393248 [00:06<00:00, 57141.19it/s] 91%|█████████ | 356137/393248 [00:07<00:00, 56038.73it/s] 92%|█████████▏| 361771/393248 [00:07<00:00, 56037.83it/s] 93%|█████████▎| 367396/393248 [00:07<00:00, 55246.47it/s] 95%|█████████▍| 372951/393248 [00:07<00:00, 53729.74it/s] 96%|█████████▋| 378594/393248 [00:07<00:00, 53021.17it/s] 98%|█████████▊| 385263/393248 [00:07<00:00, 56001.60it/s] 99%|█████████▉| 390906/393248 [00:07<00:00, 55619.11it/s]100%|██████████| 393248/393248 [00:07<00:00, 50751.11it/s]
The spherical harmonics array is 346.53 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 90.90418076515198 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 2.21976335181909
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.0008, 'pow_max': 0.0008500000000000001, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 11.39it/s] 21%|██        | 4/19 [00:00<00:01, 12.71it/s] 32%|███▏      | 6/19 [00:00<00:00, 13.68it/s] 42%|████▏     | 8/19 [00:00<00:00, 14.67it/s] 53%|█████▎    | 10/19 [00:00<00:00, 15.71it/s] 63%|██████▎   | 12/19 [00:00<00:00, 16.55it/s] 79%|███████▉  | 15/19 [00:00<00:00, 18.17it/s] 95%|█████████▍| 18/19 [00:01<00:00, 19.46it/s]100%|██████████| 19/19 [00:01<00:00, 16.99it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5563266 Minimum k_amp 0.00020658328967625562 n_x_max 110 n_z_max 110
Time to get list of k, phi, theta: 0.6848950386047363 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0706865355710117
Ratio of unique |k|: 0.0018102675658507072
Time to get unique k and theta: 1.6211798191070557 seconds

Getting transfer functions
  0%|          | 0/10071 [00:00<?, ?it/s]  0%|          | 14/10071 [00:00<01:42, 98.14it/s]  3%|▎         | 280/10071 [00:00<00:07, 1349.05it/s]  5%|▌         | 546/10071 [00:00<00:05, 1768.03it/s]  8%|▊         | 812/10071 [00:00<00:04, 2051.63it/s] 11%|█         | 1064/10071 [00:00<00:04, 2204.35it/s] 13%|█▎        | 1316/10071 [00:00<00:03, 2293.43it/s] 16%|█▌        | 1568/10071 [00:00<00:03, 2353.21it/s] 18%|█▊        | 1820/10071 [00:00<00:03, 2401.85it/s] 21%|██        | 2086/10071 [00:00<00:03, 2466.25it/s] 23%|██▎       | 2352/10071 [00:01<00:03, 2497.85it/s] 26%|██▌       | 2618/10071 [00:01<00:02, 2543.70it/s] 29%|██▉       | 2926/10071 [00:01<00:02, 2700.64it/s] 32%|███▏      | 3262/10071 [00:01<00:02, 2887.28it/s] 36%|███▌      | 3584/10071 [00:01<00:02, 2980.32it/s] 39%|███▉      | 3920/10071 [00:01<00:01, 3091.43it/s] 42%|████▏     | 4242/10071 [00:01<00:01, 3115.31it/s] 45%|████▌     | 4564/10071 [00:01<00:01, 3138.92it/s] 49%|████▊     | 4886/10071 [00:01<00:01, 3132.39it/s] 52%|█████▏    | 5222/10071 [00:01<00:01, 3194.76it/s] 55%|█████▌    | 5558/10071 [00:02<00:01, 3223.57it/s] 59%|█████▉    | 5922/10071 [00:02<00:01, 3339.79it/s] 62%|██████▏   | 6272/10071 [00:02<00:01, 3370.69it/s] 66%|██████▌   | 6650/10071 [00:02<00:00, 3480.92it/s] 69%|██████▉   | 6999/10071 [00:02<00:00, 3433.68it/s] 73%|███████▎  | 7343/10071 [00:02<00:00, 3371.28it/s] 76%|███████▋  | 7686/10071 [00:02<00:00, 3365.88it/s] 80%|███████▉  | 8050/10071 [00:02<00:00, 3428.10it/s] 83%|████████▎ | 8400/10071 [00:02<00:00, 3431.90it/s] 87%|████████▋ | 8744/10071 [00:03<00:00, 3362.20it/s] 90%|█████████ | 9100/10071 [00:03<00:00, 3391.45it/s] 94%|█████████▍| 9450/10071 [00:03<00:00, 3379.40it/s] 97%|█████████▋| 9789/10071 [00:03<00:00, 3364.32it/s]100%|██████████| 10071/10071 [00:03<00:00, 2951.14it/s]
Size of transfer function: 1.61 MB. 

Size of integrand: 33.88 MB. Time to calculate integrand: 0.024225711822509766 s

Getting spherical harmonics
  0%|          | 0/393248 [00:00<?, ?it/s]  0%|          | 513/393248 [00:00<01:20, 4859.34it/s]  1%|          | 2052/393248 [00:00<00:37, 10366.96it/s]  2%|▏         | 6669/393248 [00:00<00:15, 25625.52it/s]  3%|▎         | 11286/393248 [00:00<00:11, 32251.96it/s]  4%|▍         | 15390/393248 [00:00<00:11, 33627.46it/s]  5%|▌         | 20007/393248 [00:00<00:10, 36782.92it/s]  6%|▋         | 24624/393248 [00:00<00:09, 39582.54it/s]  7%|▋         | 28600/393248 [00:00<00:11, 32727.48it/s]  8%|▊         | 32059/393248 [00:01<00:15, 23012.11it/s]  9%|▉         | 34841/393248 [00:01<00:20, 17832.14it/s]  9%|▉         | 37086/393248 [00:01<00:21, 16600.76it/s] 10%|▉         | 39051/393248 [00:01<00:23, 14999.08it/s] 10%|█         | 40755/393248 [00:01<00:24, 14293.93it/s] 11%|█         | 42310/393248 [00:02<00:24, 14434.13it/s] 11%|█         | 43848/393248 [00:02<00:24, 14029.96it/s] 12%|█▏        | 45310/393248 [00:02<00:26, 13209.20it/s] 12%|█▏        | 46667/393248 [00:02<00:26, 13190.76it/s] 12%|█▏        | 48011/393248 [00:02<00:26, 13248.05it/s] 13%|█▎        | 49355/393248 [00:02<00:27, 12481.00it/s] 13%|█▎        | 51300/393248 [00:02<00:25, 13181.53it/s] 13%|█▎        | 52697/393248 [00:02<00:25, 13383.08it/s] 14%|█▎        | 54044/393248 [00:02<00:26, 12652.45it/s] 14%|█▍        | 55404/393248 [00:03<00:27, 12277.20it/s] 14%|█▍        | 56943/393248 [00:03<00:28, 12003.72it/s] 15%|█▍        | 58482/393248 [00:03<00:29, 11429.60it/s] 15%|█▌        | 60021/393248 [00:03<00:28, 11777.59it/s] 16%|█▌        | 61560/393248 [00:03<00:26, 12410.09it/s] 16%|█▌        | 63099/393248 [00:03<00:26, 12651.43it/s] 16%|█▋        | 64638/393248 [00:03<00:27, 11791.19it/s] 17%|█▋        | 66177/393248 [00:04<00:27, 11962.42it/s] 17%|█▋        | 67716/393248 [00:04<00:27, 12008.78it/s] 18%|█▊        | 68928/393248 [00:04<00:28, 11231.87it/s] 18%|█▊        | 70059/393248 [00:04<00:31, 10401.06it/s] 18%|█▊        | 71307/393248 [00:04<00:29, 10897.53it/s] 19%|█▊        | 72846/393248 [00:04<00:28, 11224.43it/s] 19%|█▉        | 73978/393248 [00:04<00:28, 11151.41it/s] 19%|█▉        | 75411/393248 [00:04<00:28, 11328.69it/s] 20%|█▉        | 77463/393248 [00:04<00:24, 12671.27it/s] 20%|██        | 80028/393248 [00:05<00:21, 14749.88it/s] 21%|██        | 82080/393248 [00:05<00:20, 15217.75it/s] 21%|██▏       | 83619/393248 [00:05<00:21, 14739.01it/s] 22%|██▏       | 85158/393248 [00:05<00:22, 13629.16it/s] 22%|██▏       | 86697/393248 [00:05<00:22, 13383.13it/s] 22%|██▏       | 88236/393248 [00:05<00:22, 13457.02it/s] 23%|██▎       | 90288/393248 [00:05<00:22, 13433.34it/s] 23%|██▎       | 91827/393248 [00:06<00:23, 12635.03it/s] 24%|██▎       | 93095/393248 [00:06<00:23, 12509.84it/s] 24%|██▍       | 94347/393248 [00:06<00:25, 11905.71it/s] 24%|██▍       | 95537/393248 [00:06<00:28, 10474.19it/s] 25%|██▍       | 96957/393248 [00:06<00:26, 11256.25it/s] 26%|██▌       | 101574/393248 [00:06<00:15, 19121.55it/s] 27%|██▋       | 106704/393248 [00:06<00:10, 26206.72it/s] 28%|██▊       | 109368/393248 [00:06<00:13, 21687.40it/s] 28%|██▊       | 111672/393248 [00:07<00:17, 16422.22it/s] 29%|██▉       | 113567/393248 [00:07<00:17, 16204.36it/s] 29%|██▉       | 115358/393248 [00:07<00:17, 16068.04it/s] 30%|██▉       | 117081/393248 [00:07<00:18, 14871.29it/s] 30%|███       | 119016/393248 [00:07<00:18, 15163.80it/s] 31%|███       | 120593/393248 [00:07<00:18, 14598.58it/s] 31%|███       | 122607/393248 [00:07<00:18, 14930.21it/s] 32%|███▏      | 124127/393248 [00:08<00:18, 14248.08it/s] 32%|███▏      | 125685/393248 [00:08<00:20, 12754.89it/s] 32%|███▏      | 127224/393248 [00:08<00:21, 12623.32it/s] 33%|███▎      | 128763/393248 [00:08<00:21, 12485.46it/s] 33%|███▎      | 130815/393248 [00:08<00:19, 13714.72it/s] 34%|███▎      | 132354/393248 [00:08<00:19, 13493.79it/s] 34%|███▍      | 134406/393248 [00:08<00:17, 15173.73it/s] 35%|███▍      | 135957/393248 [00:08<00:18, 14201.79it/s] 35%|███▍      | 137484/393248 [00:09<00:20, 12300.28it/s] 36%|███▌      | 139729/393248 [00:09<00:17, 14738.25it/s] 36%|███▌      | 141303/393248 [00:09<00:18, 13704.67it/s] 36%|███▋      | 142750/393248 [00:09<00:19, 12660.69it/s] 37%|███▋      | 144153/393248 [00:09<00:19, 12542.16it/s] 37%|███▋      | 145692/393248 [00:09<00:18, 13131.60it/s] 37%|███▋      | 147231/393248 [00:09<00:18, 13619.94it/s] 38%|███▊      | 148770/393248 [00:09<00:18, 13475.73it/s] 38%|███▊      | 150140/393248 [00:10<00:19, 12271.03it/s] 39%|███▉      | 154413/393248 [00:10<00:12, 19730.76it/s] 41%|████      | 160056/393248 [00:10<00:08, 28394.33it/s] 41%|████▏     | 162975/393248 [00:10<00:10, 21349.36it/s] 42%|████▏     | 165404/393248 [00:10<00:11, 19940.91it/s] 43%|████▎     | 167602/393248 [00:10<00:12, 18420.98it/s] 43%|████▎     | 169586/393248 [00:10<00:13, 17192.86it/s] 44%|████▎     | 171400/393248 [00:11<00:13, 16082.91it/s] 44%|████▍     | 173069/393248 [00:11<00:13, 16094.76it/s] 44%|████▍     | 174721/393248 [00:11<00:16, 13201.48it/s] 45%|████▍     | 176136/393248 [00:11<00:17, 12361.39it/s] 45%|████▌     | 177498/393248 [00:11<00:17, 12541.83it/s] 46%|████▌     | 179037/393248 [00:11<00:17, 12001.11it/s] 46%|████▌     | 180576/393248 [00:11<00:16, 12606.75it/s] 46%|████▋     | 182115/393248 [00:11<00:17, 12128.97it/s] 47%|████▋     | 183654/393248 [00:12<00:17, 12252.76it/s] 47%|████▋     | 185193/393248 [00:12<00:17, 11841.13it/s] 47%|████▋     | 186732/393248 [00:12<00:16, 12535.09it/s] 48%|████▊     | 188271/393248 [00:12<00:16, 12388.33it/s] 48%|████▊     | 189810/393248 [00:12<00:15, 12885.85it/s] 49%|████▊     | 191349/393248 [00:12<00:15, 13359.02it/s] 49%|████▉     | 192888/393248 [00:12<00:14, 13813.32it/s] 50%|████▉     | 194940/393248 [00:12<00:12, 15399.08it/s] 50%|████▉     | 196497/393248 [00:13<00:12, 15223.47it/s] 51%|█████     | 199044/393248 [00:13<00:11, 16228.65it/s] 51%|█████     | 201096/393248 [00:13<00:11, 17165.56it/s] 52%|█████▏    | 202816/393248 [00:13<00:11, 16741.46it/s] 52%|█████▏    | 204687/393248 [00:13<00:11, 16972.10it/s] 52%|█████▏    | 206386/393248 [00:13<00:12, 15492.74it/s] 53%|█████▎    | 207955/393248 [00:13<00:13, 14086.55it/s] 53%|█████▎    | 209392/393248 [00:13<00:13, 13965.05it/s] 54%|█████▎    | 211356/393248 [00:13<00:11, 15256.52it/s] 54%|█████▍    | 212906/393248 [00:14<00:11, 15049.64it/s] 55%|█████▍    | 214947/393248 [00:14<00:10, 16373.61it/s] 55%|█████▌    | 216604/393248 [00:14<00:10, 16131.17it/s] 55%|█████▌    | 218230/393248 [00:14<00:10, 15924.01it/s] 56%|█████▌    | 219831/393248 [00:14<00:11, 14603.19it/s] 56%|█████▋    | 221315/393248 [00:14<00:11, 14539.60it/s] 57%|█████▋    | 222785/393248 [00:14<00:11, 14481.84it/s] 57%|█████▋    | 224244/393248 [00:14<00:11, 14195.42it/s] 57%|█████▋    | 225720/393248 [00:14<00:11, 14164.06it/s] 58%|█████▊    | 227259/393248 [00:15<00:11, 14084.89it/s] 58%|█████▊    | 228672/393248 [00:15<00:12, 13316.81it/s] 58%|█████▊    | 230012/393248 [00:15<00:13, 11779.11it/s] 59%|█████▉    | 231363/393248 [00:15<00:13, 12142.58it/s] 59%|█████▉    | 232902/393248 [00:15<00:13, 12000.17it/s] 60%|█████▉    | 234123/393248 [00:15<00:13, 12039.69it/s] 60%|█████▉    | 235467/393248 [00:15<00:13, 11841.08it/s] 60%|██████    | 237006/393248 [00:15<00:12, 12291.57it/s] 61%|██████    | 238545/393248 [00:15<00:12, 12657.21it/s] 61%|██████    | 240084/393248 [00:16<00:11, 13178.66it/s] 61%|██████▏   | 241623/393248 [00:16<00:11, 13717.46it/s] 62%|██████▏   | 243162/393248 [00:16<00:11, 12995.54it/s] 62%|██████▏   | 244477/393248 [00:16<00:11, 12753.79it/s] 62%|██████▏   | 245762/393248 [00:16<00:11, 12481.78it/s] 63%|██████▎   | 247016/393248 [00:16<00:11, 12464.89it/s] 63%|██████▎   | 248267/393248 [00:16<00:12, 11486.59it/s] 63%|██████▎   | 249430/393248 [00:16<00:12, 11273.26it/s] 64%|██████▍   | 251370/393248 [00:16<00:10, 13194.35it/s] 64%|██████▍   | 252909/393248 [00:17<00:10, 13782.88it/s] 65%|██████▍   | 254301/393248 [00:17<00:10, 13653.83it/s] 65%|██████▌   | 255676/393248 [00:17<00:10, 12882.91it/s] 65%|██████▌   | 256977/393248 [00:17<00:10, 12808.30it/s] 66%|██████▌   | 258267/393248 [00:17<00:11, 11521.51it/s] 67%|██████▋   | 261630/393248 [00:17<00:08, 16251.76it/s] 67%|██████▋   | 264708/393248 [00:17<00:06, 18602.09it/s] 68%|██████▊   | 267786/393248 [00:17<00:06, 20415.96it/s] 69%|██████▉   | 271377/393248 [00:18<00:05, 23000.90it/s] 70%|██████▉   | 273942/393248 [00:18<00:05, 21029.33it/s] 70%|███████   | 276064/393248 [00:18<00:06, 18790.58it/s] 71%|███████   | 277975/393248 [00:18<00:07, 16118.88it/s] 71%|███████   | 279647/393248 [00:18<00:08, 14077.05it/s] 71%|███████▏  | 281124/393248 [00:18<00:08, 13186.46it/s] 72%|███████▏  | 282663/393248 [00:18<00:08, 13102.72it/s] 72%|███████▏  | 284202/393248 [00:19<00:09, 12089.72it/s] 73%|███████▎  | 285741/393248 [00:19<00:08, 12642.30it/s] 73%|███████▎  | 287793/393248 [00:19<00:07, 14344.03it/s] 74%|███████▎  | 289332/393248 [00:19<00:07, 14487.53it/s] 74%|███████▍  | 290819/393248 [00:19<00:07, 13511.20it/s] 74%|███████▍  | 292203/393248 [00:19<00:07, 13423.95it/s] 75%|███████▍  | 293568/393248 [00:19<00:07, 12490.88it/s] 75%|███████▌  | 295488/393248 [00:19<00:07, 13093.82it/s] 76%|███████▌  | 297027/393248 [00:20<00:07, 13148.45it/s] 76%|███████▌  | 299079/393248 [00:20<00:06, 14318.72it/s] 76%|███████▋  | 300618/393248 [00:20<00:06, 13351.46it/s] 77%|███████▋  | 301966/393248 [00:20<00:06, 13233.71it/s] 77%|███████▋  | 303297/393248 [00:20<00:07, 12213.87it/s] 77%|███████▋  | 304722/393248 [00:20<00:07, 11728.54it/s] 78%|███████▊  | 306261/393248 [00:20<00:06, 12518.63it/s] 79%|███████▊  | 308826/393248 [00:20<00:05, 15632.20it/s] 79%|███████▉  | 310426/393248 [00:20<00:05, 15562.44it/s] 79%|███████▉  | 312007/393248 [00:21<00:05, 15445.52it/s] 80%|███████▉  | 313569/393248 [00:21<00:05, 15320.18it/s] 80%|████████  | 316008/393248 [00:21<00:04, 17686.27it/s] 81%|████████  | 318060/393248 [00:21<00:04, 17911.43it/s] 81%|████████▏ | 319861/393248 [00:21<00:04, 17752.47it/s] 82%|████████▏ | 321643/393248 [00:21<00:04, 16137.81it/s] 82%|████████▏ | 323285/393248 [00:21<00:04, 16182.40it/s] 83%|████████▎ | 325242/393248 [00:21<00:04, 15597.57it/s] 83%|████████▎ | 328320/393248 [00:21<00:03, 19408.00it/s] 85%|████████▌ | 334989/393248 [00:22<00:01, 31960.62it/s] 87%|████████▋ | 343197/393248 [00:22<00:01, 45843.26it/s] 89%|████████▉ | 349353/393248 [00:22<00:00, 49401.77it/s] 90%|█████████ | 354483/393248 [00:22<00:00, 49917.75it/s] 91%|█████████▏| 359572/393248 [00:22<00:00, 46945.09it/s] 93%|█████████▎| 364743/393248 [00:22<00:00, 47785.38it/s] 94%|█████████▍| 371412/393248 [00:22<00:00, 51711.32it/s] 96%|█████████▌| 376632/393248 [00:23<00:00, 26093.87it/s] 97%|█████████▋| 380635/393248 [00:23<00:00, 22239.51it/s] 98%|█████████▊| 383889/393248 [00:23<00:00, 19820.02it/s] 98%|█████████▊| 386594/393248 [00:23<00:00, 17784.10it/s] 99%|█████████▉| 388868/393248 [00:24<00:00, 15751.98it/s] 99%|█████████▉| 390783/393248 [00:24<00:00, 15486.57it/s]100%|█████████▉| 392557/393248 [00:24<00:00, 15423.61it/s]100%|██████████| 393248/393248 [00:24<00:00, 16099.67it/s]
The spherical harmonics array is 346.53 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 123.21789860725403 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 2.260773332870427
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.0009, 'pow_max': 0.00095, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 17.41it/s] 21%|██        | 4/19 [00:00<00:00, 18.34it/s] 37%|███▋      | 7/19 [00:00<00:00, 19.37it/s] 53%|█████▎    | 10/19 [00:00<00:00, 20.44it/s] 68%|██████▊   | 13/19 [00:00<00:00, 21.12it/s] 84%|████████▍ | 16/19 [00:00<00:00, 21.49it/s]100%|██████████| 19/19 [00:00<00:00, 21.72it/s]100%|██████████| 19/19 [00:00<00:00, 20.88it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519179891249254
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5563266 Minimum k_amp 0.00020658328967625562 n_x_max 110 n_z_max 110
Time to get list of k, phi, theta: 0.623837947845459 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0706865355710117
Ratio of unique |k|: 0.0018102675658507072
Time to get unique k and theta: 1.3470158576965332 seconds

Getting transfer functions
  0%|          | 0/10071 [00:00<?, ?it/s]  2%|▏         | 154/10071 [00:00<00:06, 1505.75it/s]  4%|▍         | 392/10071 [00:00<00:04, 1999.88it/s]  6%|▋         | 630/10071 [00:00<00:04, 2126.59it/s]  9%|▉         | 882/10071 [00:00<00:04, 2235.97it/s] 11%|█▏        | 1148/10071 [00:00<00:03, 2369.90it/s] 14%|█▍        | 1414/10071 [00:00<00:03, 2448.10it/s] 17%|█▋        | 1666/10071 [00:00<00:03, 2440.64it/s] 19%|█▉        | 1918/10071 [00:00<00:03, 2458.41it/s] 22%|██▏       | 2170/10071 [00:00<00:03, 2458.62it/s] 24%|██▍       | 2436/10071 [00:01<00:03, 2491.23it/s] 27%|██▋       | 2686/10071 [00:01<00:02, 2493.55it/s] 30%|██▉       | 2996/10071 [00:01<00:02, 2664.38it/s] 33%|███▎      | 3318/10071 [00:01<00:02, 2811.95it/s] 36%|███▋      | 3654/10071 [00:01<00:02, 2974.42it/s] 40%|███▉      | 3990/10071 [00:01<00:01, 3063.90it/s] 43%|████▎     | 4326/10071 [00:01<00:01, 3108.37it/s] 46%|████▌     | 4648/10071 [00:01<00:01, 3128.62it/s] 49%|████▉     | 4961/10071 [00:01<00:01, 3118.01it/s] 53%|█████▎    | 5292/10071 [00:01<00:01, 3166.34it/s] 56%|█████▌    | 5642/10071 [00:02<00:01, 3233.87it/s] 59%|█████▉    | 5966/10071 [00:02<00:01, 3208.90it/s] 62%|██████▏   | 6287/10071 [00:02<00:01, 3145.46it/s] 66%|██████▌   | 6636/10071 [00:02<00:01, 3243.98it/s] 69%|██████▉   | 6972/10071 [00:02<00:00, 3244.17it/s] 73%|███████▎  | 7308/10071 [00:02<00:00, 3273.33it/s] 76%|███████▌  | 7658/10071 [00:02<00:00, 3305.65it/s] 80%|███████▉  | 8008/10071 [00:02<00:00, 3347.04it/s] 83%|████████▎ | 8344/10071 [00:02<00:00, 3349.78it/s] 86%|████████▋ | 8708/10071 [00:02<00:00, 3401.29it/s] 90%|████████▉ | 9049/10071 [00:03<00:00, 3372.95it/s] 93%|█████████▎| 9408/10071 [00:03<00:00, 3430.06it/s] 97%|█████████▋| 9752/10071 [00:03<00:00, 3375.97it/s]100%|██████████| 10071/10071 [00:03<00:00, 2988.46it/s]
Size of transfer function: 1.61 MB. 

Size of integrand: 33.88 MB. Time to calculate integrand: 0.029920101165771484 s

Getting spherical harmonics
  0%|          | 0/393248 [00:00<?, ?it/s]  0%|          | 513/393248 [00:00<03:21, 1953.27it/s]  2%|▏         | 6156/393248 [00:00<00:18, 20629.70it/s]  3%|▎         | 11799/393248 [00:00<00:12, 30617.84it/s]  4%|▍         | 16416/393248 [00:00<00:11, 34047.15it/s]  5%|▌         | 20399/393248 [00:00<00:11, 33194.38it/s]  6%|▌         | 24085/393248 [00:00<00:10, 33586.38it/s]  7%|▋         | 27692/393248 [00:00<00:10, 33422.36it/s]  8%|▊         | 31806/393248 [00:01<00:10, 34642.49it/s]  9%|▉         | 35910/393248 [00:01<00:09, 35995.59it/s] 10%|█         | 40527/393248 [00:01<00:09, 38559.65it/s] 12%|█▏        | 45657/393248 [00:01<00:08, 41943.01it/s] 13%|█▎        | 50787/393248 [00:01<00:07, 44012.68it/s] 14%|█▍        | 55404/393248 [00:01<00:07, 44601.39it/s] 15%|█▌        | 60021/393248 [00:01<00:07, 43791.85it/s] 16%|█▋        | 64431/393248 [00:01<00:08, 41092.50it/s] 17%|█▋        | 68742/393248 [00:01<00:07, 40773.89it/s] 19%|█▊        | 72852/393248 [00:02<00:07, 40434.15it/s] 20%|█▉        | 78489/393248 [00:02<00:07, 44311.69it/s] 21%|██        | 83106/393248 [00:02<00:07, 44094.00it/s] 22%|██▏       | 87532/393248 [00:02<00:07, 41661.46it/s] 23%|██▎       | 92340/393248 [00:02<00:07, 42583.59it/s] 25%|██▍       | 97983/393248 [00:02<00:06, 46201.96it/s] 27%|██▋       | 104652/393248 [00:02<00:05, 50990.81it/s] 28%|██▊       | 111834/393248 [00:02<00:05, 55722.93it/s] 30%|███       | 119016/393248 [00:02<00:04, 59969.54it/s] 32%|███▏      | 125172/393248 [00:02<00:04, 59800.68it/s] 33%|███▎      | 131631/393248 [00:03<00:04, 61185.32it/s] 35%|███▌      | 137769/393248 [00:03<00:04, 56835.76it/s] 36%|███▋      | 143521/393248 [00:03<00:04, 55707.79it/s] 38%|███▊      | 149139/393248 [00:03<00:04, 54875.90it/s] 39%|███▉      | 154658/393248 [00:03<00:04, 51245.64it/s] 41%|████      | 160569/393248 [00:03<00:04, 52923.53it/s] 42%|████▏     | 165913/393248 [00:03<00:04, 51876.73it/s] 44%|████▎     | 171855/393248 [00:03<00:04, 52525.48it/s] 45%|████▌     | 178524/393248 [00:03<00:03, 55429.25it/s] 47%|████▋     | 185193/393248 [00:04<00:03, 55335.17it/s] 49%|████▉     | 192375/393248 [00:04<00:03, 59785.73it/s] 50%|█████     | 198531/393248 [00:04<00:03, 59626.65it/s] 52%|█████▏    | 204528/393248 [00:04<00:03, 58801.19it/s] 54%|█████▎    | 210431/393248 [00:04<00:03, 55751.39it/s] 55%|█████▍    | 216045/393248 [00:04<00:03, 53642.67it/s] 56%|█████▋    | 221442/393248 [00:04<00:03, 50626.59it/s] 58%|█████▊    | 228798/393248 [00:04<00:02, 55092.47it/s] 60%|█████▉    | 234954/393248 [00:04<00:02, 56797.01it/s] 61%|██████▏   | 241623/393248 [00:05<00:02, 58784.73it/s] 63%|██████▎   | 248292/393248 [00:05<00:02, 59965.85it/s] 65%|██████▍   | 254316/393248 [00:05<00:02, 58928.57it/s] 66%|██████▌   | 260228/393248 [00:05<00:02, 57284.28it/s] 68%|██████▊   | 267273/393248 [00:05<00:02, 59516.93it/s] 69%|██████▉   | 273235/393248 [00:05<00:02, 54389.05it/s] 71%|███████   | 279072/393248 [00:05<00:02, 53038.23it/s] 72%|███████▏  | 284429/393248 [00:05<00:02, 47083.66it/s] 74%|███████▍  | 291384/393248 [00:06<00:01, 51178.06it/s] 76%|███████▌  | 298566/393248 [00:06<00:01, 55853.52it/s] 78%|███████▊  | 305235/393248 [00:06<00:01, 57539.84it/s] 79%|███████▉  | 311904/393248 [00:06<00:01, 59169.07it/s] 81%|████████  | 319086/393248 [00:06<00:01, 62317.94it/s] 83%|████████▎ | 325397/393248 [00:06<00:01, 58036.22it/s] 84%|████████▍ | 331301/393248 [00:06<00:01, 55431.21it/s] 86%|████████▌ | 338067/393248 [00:06<00:00, 57750.82it/s] 88%|████████▊ | 344736/393248 [00:06<00:00, 59917.78it/s] 89%|████████▉ | 350793/393248 [00:06<00:00, 59229.35it/s] 91%|█████████ | 357561/393248 [00:07<00:00, 61171.92it/s] 92%|█████████▏| 363716/393248 [00:07<00:00, 57078.71it/s] 94%|█████████▍| 369494/393248 [00:07<00:00, 55408.70it/s] 95%|█████████▌| 375516/393248 [00:07<00:00, 55063.09it/s] 97%|█████████▋| 383211/393248 [00:07<00:00, 60596.02it/s] 99%|█████████▉| 389880/393248 [00:07<00:00, 62308.15it/s]100%|██████████| 393248/393248 [00:07<00:00, 50969.48it/s]
The spherical harmonics array is 346.53 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 102.3465838432312 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 2.093146372694111
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.001, 'pow_max': 0.00105, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 14.90it/s] 21%|██        | 4/19 [00:00<00:00, 16.07it/s] 32%|███▏      | 6/19 [00:00<00:00, 17.50it/s] 47%|████▋     | 9/19 [00:00<00:00, 19.06it/s] 63%|██████▎   | 12/19 [00:00<00:00, 20.52it/s] 79%|███████▉  | 15/19 [00:00<00:00, 21.01it/s] 95%|█████████▍| 18/19 [00:00<00:00, 21.69it/s]100%|██████████| 19/19 [00:00<00:00, 20.26it/s]
Done. k_max for TT ell_max = 0.02259977597839506 k_max for EE ell_max = 0.08519861475622366
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5483586 Minimum k_amp 0.00020658328967625562 n_x_max 110 n_z_max 110
Time to get list of k, phi, theta: 0.6557259559631348 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07074057013056784
Ratio of unique |k|: 0.0018190651154189976
Time to get unique k and theta: 1.3076674938201904 seconds

Getting transfer functions
  0%|          | 0/9975 [00:00<?, ?it/s]  1%|▏         | 143/9975 [00:00<00:07, 1400.36it/s]  4%|▍         | 377/9975 [00:00<00:05, 1898.57it/s]  6%|▌         | 611/9975 [00:00<00:04, 2053.91it/s]  8%|▊         | 819/9975 [00:00<00:04, 2056.24it/s] 11%|█         | 1053/9975 [00:00<00:04, 2136.01it/s] 13%|█▎        | 1287/9975 [00:00<00:03, 2203.67it/s] 15%|█▌        | 1534/9975 [00:00<00:03, 2263.44it/s] 18%|█▊        | 1781/9975 [00:00<00:03, 2287.62it/s] 20%|██        | 2028/9975 [00:00<00:03, 2315.59it/s] 23%|██▎       | 2275/9975 [00:01<00:03, 2331.64it/s] 25%|██▌       | 2509/9975 [00:01<00:03, 2328.32it/s] 28%|██▊       | 2834/9975 [00:01<00:02, 2584.03it/s] 32%|███▏      | 3146/9975 [00:01<00:02, 2711.53it/s] 35%|███▍      | 3471/9975 [00:01<00:02, 2831.82it/s] 38%|███▊      | 3783/9975 [00:01<00:02, 2906.53it/s] 41%|████      | 4095/9975 [00:01<00:01, 2946.16it/s] 44%|████▍     | 4394/9975 [00:01<00:01, 2938.77it/s] 47%|████▋     | 4719/9975 [00:01<00:01, 3030.27it/s] 50%|█████     | 5031/9975 [00:01<00:01, 3048.31it/s] 54%|█████▎    | 5343/9975 [00:02<00:01, 3052.99it/s] 57%|█████▋    | 5668/9975 [00:02<00:01, 3102.89it/s] 60%|██████    | 6006/9975 [00:02<00:01, 3162.71it/s] 64%|██████▎   | 6357/9975 [00:02<00:01, 3243.35it/s] 67%|██████▋   | 6682/9975 [00:02<00:01, 3132.70it/s] 70%|███████   | 6996/9975 [00:02<00:00, 3070.51it/s] 73%|███████▎  | 7304/9975 [00:02<00:00, 3005.07it/s] 76%|███████▋  | 7606/9975 [00:02<00:00, 2870.10it/s] 79%|███████▉  | 7895/9975 [00:02<00:00, 2860.96it/s] 82%|████████▏ | 8229/9975 [00:03<00:00, 2983.57it/s] 86%|████████▌ | 8541/9975 [00:03<00:00, 2988.45it/s] 89%|████████▉ | 8879/9975 [00:03<00:00, 3072.46it/s] 92%|█████████▏| 9204/9975 [00:03<00:00, 3108.72it/s] 95%|█████████▌| 9516/9975 [00:03<00:00, 3025.93it/s] 99%|█████████▊| 9828/9975 [00:03<00:00, 3019.35it/s]100%|██████████| 9975/9975 [00:03<00:00, 2786.36it/s]
Size of transfer function: 1.6 MB. 

Size of integrand: 33.56 MB. Time to calculate integrand: 0.025089263916015625 s

Getting spherical harmonics
  0%|          | 0/387912 [00:00<?, ?it/s]  1%|          | 4554/387912 [00:00<00:08, 44563.31it/s]  3%|▎         | 10120/387912 [00:00<00:07, 49680.59it/s]  4%|▍         | 15138/387912 [00:00<00:07, 49902.73it/s]  5%|▌         | 20127/387912 [00:00<00:08, 45140.30it/s]  6%|▋         | 24697/387912 [00:00<00:08, 45195.51it/s]  8%|▊         | 29348/387912 [00:00<00:08, 44362.72it/s]  9%|▊         | 33902/387912 [00:00<00:08, 43130.48it/s] 10%|▉         | 38456/387912 [00:00<00:08, 43619.31it/s] 11%|█         | 43010/387912 [00:00<00:07, 43912.02it/s] 12%|█▏        | 48070/387912 [00:01<00:07, 44443.06it/s] 14%|█▎        | 52521/387912 [00:01<00:07, 43582.15it/s] 15%|█▍        | 56884/387912 [00:01<00:07, 42144.89it/s] 16%|█▌        | 61226/387912 [00:01<00:07, 41029.98it/s] 17%|█▋        | 65780/387912 [00:01<00:07, 40906.51it/s] 18%|█▊        | 70840/387912 [00:01<00:07, 43509.36it/s] 20%|█▉        | 76406/387912 [00:01<00:06, 46557.72it/s] 21%|██        | 81972/387912 [00:01<00:06, 47988.66it/s] 22%|██▏       | 87032/387912 [00:01<00:06, 48656.30it/s] 24%|██▎       | 92092/387912 [00:02<00:06, 48211.91it/s] 25%|██▍       | 96924/387912 [00:02<00:06, 45944.18it/s] 26%|██▋       | 102212/387912 [00:02<00:06, 47249.86it/s] 28%|██▊       | 106957/387912 [00:02<00:06, 46635.01it/s] 29%|██▉       | 112838/387912 [00:02<00:05, 49349.57it/s] 31%|███       | 118910/387912 [00:02<00:05, 51386.99it/s] 32%|███▏      | 125488/387912 [00:02<00:04, 55006.89it/s] 34%|███▍      | 131003/387912 [00:02<00:04, 53177.29it/s] 35%|███▌      | 137126/387912 [00:02<00:04, 54624.93it/s] 37%|███▋      | 142603/387912 [00:03<00:04, 54019.96it/s] 38%|███▊      | 148258/387912 [00:03<00:04, 54080.84it/s] 40%|███▉      | 153673/387912 [00:03<00:04, 48005.83it/s] 41%|████      | 158592/387912 [00:03<00:04, 46860.03it/s] 42%|████▏     | 164450/387912 [00:03<00:04, 48886.16it/s] 44%|████▍     | 170016/387912 [00:03<00:04, 50048.94it/s] 45%|████▌     | 176088/387912 [00:03<00:03, 52968.63it/s] 47%|████▋     | 182160/387912 [00:03<00:03, 53438.67it/s] 48%|████▊     | 187543/387912 [00:03<00:04, 49797.49it/s] 50%|████▉     | 192586/387912 [00:04<00:04, 48807.23it/s] 51%|█████     | 197508/387912 [00:04<00:03, 48111.66it/s] 52%|█████▏    | 202906/387912 [00:04<00:03, 46959.24it/s] 54%|█████▎    | 207966/387912 [00:04<00:03, 47074.92it/s] 55%|█████▍    | 212692/387912 [00:04<00:03, 46939.89it/s] 56%|█████▌    | 217580/387912 [00:04<00:03, 47329.37it/s] 58%|█████▊    | 223283/387912 [00:04<00:03, 50113.69it/s] 59%|█████▉    | 228712/387912 [00:04<00:03, 50989.85it/s] 61%|██████    | 235290/387912 [00:04<00:02, 54103.90it/s] 62%|██████▏   | 241362/387912 [00:04<00:02, 55127.15it/s] 64%|██████▍   | 247434/387912 [00:05<00:02, 55609.81it/s] 65%|██████▌   | 252996/387912 [00:05<00:02, 52391.98it/s] 67%|██████▋   | 258265/387912 [00:05<00:02, 51550.00it/s] 68%|██████▊   | 264132/387912 [00:05<00:02, 52446.71it/s] 70%|██████▉   | 270710/387912 [00:05<00:02, 55993.08it/s] 71%|███████▏  | 277288/387912 [00:05<00:01, 58451.20it/s] 73%|███████▎  | 283360/387912 [00:05<00:01, 59041.27it/s] 75%|███████▍  | 289285/387912 [00:05<00:01, 54748.30it/s] 76%|███████▌  | 294830/387912 [00:05<00:01, 50605.23it/s] 77%|███████▋  | 299984/387912 [00:06<00:01, 50605.23it/s] 79%|███████▊  | 305110/387912 [00:06<00:01, 50755.13it/s] 80%|████████  | 310684/387912 [00:06<00:01, 50957.64it/s] 82%|████████▏ | 316756/387912 [00:06<00:01, 52807.11it/s] 83%|████████▎ | 322063/387912 [00:06<00:01, 52318.98it/s] 84%|████████▍ | 327382/387912 [00:06<00:01, 52028.04it/s] 86%|████████▌ | 333454/387912 [00:06<00:01, 54066.99it/s] 88%|████████▊ | 340032/387912 [00:06<00:00, 56707.39it/s] 89%|████████▉ | 346104/387912 [00:06<00:00, 57294.83it/s] 91%|█████████ | 351841/387912 [00:07<00:00, 56458.11it/s] 92%|█████████▏| 357492/387912 [00:07<00:00, 53280.79it/s] 94%|█████████▎| 362964/387912 [00:07<00:00, 53684.49it/s] 95%|█████████▌| 368586/387912 [00:07<00:00, 54407.74it/s] 97%|█████████▋| 374946/387912 [00:07<00:00, 56640.51it/s] 98%|█████████▊| 380629/387912 [00:07<00:00, 43618.92it/s] 99%|█████████▉| 385448/387912 [00:07<00:00, 29984.96it/s]100%|██████████| 387912/387912 [00:08<00:00, 47344.95it/s]
The spherical harmonics array is 341.83 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 98.89852166175842 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 2.069625297479306
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.0015, 'pow_max': 0.00155, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 12.38it/s] 21%|██        | 4/19 [00:00<00:01, 13.88it/s] 32%|███▏      | 6/19 [00:00<00:00, 14.87it/s] 42%|████▏     | 8/19 [00:00<00:00, 15.98it/s] 53%|█████▎    | 10/19 [00:00<00:00, 17.06it/s] 68%|██████▊   | 13/19 [00:00<00:00, 18.68it/s] 84%|████████▍ | 16/19 [00:00<00:00, 19.89it/s]100%|██████████| 19/19 [00:01<00:00, 20.62it/s]100%|██████████| 19/19 [00:01<00:00, 18.22it/s]
Done. k_max for TT ell_max = 0.007820044837681183 k_max for EE ell_max = 0.08518711301992739
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 1589548 Minimum k_amp 0.00020658328967625562 n_x_max 73 n_z_max 73
Time to get list of k, phi, theta: 0.18521761894226074 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0747992511078621
Ratio of unique |k|: 0.00274920920915883
Time to get unique k and theta: 0.33018016815185547 seconds

Getting transfer functions
  0%|          | 0/4370 [00:00<?, ?it/s]  1%|          | 36/4370 [00:00<00:12, 350.72it/s]  3%|▎         | 138/4370 [00:00<00:05, 721.87it/s]  6%|▌         | 252/4370 [00:00<00:04, 894.67it/s]  8%|▊         | 366/4370 [00:00<00:04, 988.26it/s] 11%|█         | 486/4370 [00:00<00:03, 1055.54it/s] 14%|█▍        | 606/4370 [00:00<00:03, 1094.92it/s] 16%|█▋        | 716/4370 [00:00<00:03, 1074.03it/s] 19%|█▉        | 824/4370 [00:00<00:03, 1075.53it/s] 21%|██▏       | 932/4370 [00:00<00:03, 1075.87it/s] 24%|██▍       | 1040/4370 [00:01<00:03, 1071.38it/s] 26%|██▋       | 1152/4370 [00:01<00:02, 1081.93it/s] 30%|██▉       | 1308/4370 [00:01<00:02, 1209.36it/s] 34%|███▎      | 1464/4370 [00:01<00:02, 1305.91it/s] 37%|███▋      | 1626/4370 [00:01<00:01, 1392.10it/s] 41%|████      | 1782/4370 [00:01<00:01, 1441.88it/s] 44%|████▍     | 1938/4370 [00:01<00:01, 1476.01it/s] 49%|████▊     | 2124/4370 [00:01<00:01, 1584.92it/s] 52%|█████▏    | 2283/4370 [00:01<00:01, 1570.90it/s] 56%|█████▌    | 2448/4370 [00:01<00:01, 1589.63it/s] 60%|█████▉    | 2616/4370 [00:02<00:01, 1611.66it/s] 64%|██████▍   | 2790/4370 [00:02<00:00, 1643.54it/s] 68%|██████▊   | 2970/4370 [00:02<00:00, 1670.20it/s] 72%|███████▏  | 3137/4370 [00:02<00:00, 1601.66it/s] 76%|███████▌  | 3300/4370 [00:02<00:00, 1597.79it/s] 79%|███████▉  | 3461/4370 [00:02<00:00, 1566.56it/s] 83%|████████▎ | 3624/4370 [00:02<00:00, 1569.81it/s] 87%|████████▋ | 3782/4370 [00:02<00:00, 1557.92it/s] 90%|█████████ | 3938/4370 [00:02<00:00, 1526.20it/s] 94%|█████████▍| 4098/4370 [00:02<00:00, 1543.16it/s] 97%|█████████▋| 4260/4370 [00:03<00:00, 1554.18it/s]100%|██████████| 4370/4370 [00:03<00:00, 1386.95it/s]
Size of transfer function: 0.7 MB. 

Size of integrand: 14.7 MB. Time to calculate integrand: 0.008562326431274414 s

Getting spherical harmonics
  0%|          | 0/118897 [00:00<?, ?it/s]  3%|▎         | 3100/118897 [00:00<00:03, 30825.34it/s]  5%|▌         | 6355/118897 [00:00<00:03, 31327.33it/s]  8%|▊         | 9488/118897 [00:00<00:03, 29446.61it/s] 11%|█         | 13020/118897 [00:00<00:03, 31451.61it/s] 14%|█▎        | 16179/118897 [00:00<00:03, 29811.23it/s] 17%|█▋        | 20305/118897 [00:00<00:02, 33297.45it/s] 21%|██        | 24490/118897 [00:00<00:02, 35885.08it/s] 24%|██▍       | 28520/118897 [00:00<00:02, 37075.89it/s] 28%|██▊       | 33325/118897 [00:00<00:02, 40380.73it/s] 31%|███▏      | 37387/118897 [00:01<00:02, 38228.32it/s] 35%|███▌      | 42005/118897 [00:01<00:01, 40369.97it/s] 39%|███▉      | 46077/118897 [00:01<00:01, 39532.07it/s] 42%|████▏     | 50056/118897 [00:01<00:01, 36694.92it/s] 47%|████▋     | 55800/118897 [00:01<00:01, 41978.22it/s] 51%|█████     | 60295/118897 [00:01<00:01, 42718.48it/s] 54%|█████▍    | 64635/118897 [00:01<00:01, 42623.77it/s] 59%|█████▉    | 70370/118897 [00:01<00:01, 45117.62it/s] 63%|██████▎   | 74895/118897 [00:01<00:00, 44595.70it/s] 67%|██████▋   | 79363/118897 [00:02<00:00, 44543.17it/s] 71%|███████   | 83855/118897 [00:02<00:00, 43706.21it/s] 74%|███████▍  | 88350/118897 [00:02<00:00, 42800.92it/s] 78%|███████▊  | 92690/118897 [00:02<00:00, 42727.37it/s] 82%|████████▏ | 96967/118897 [00:02<00:00, 41265.08it/s] 86%|████████▌ | 101835/118897 [00:02<00:00, 42873.03it/s] 90%|████████▉ | 106485/118897 [00:02<00:00, 43654.03it/s] 93%|█████████▎| 110860/118897 [00:02<00:00, 41764.50it/s] 97%|█████████▋| 115785/118897 [00:02<00:00, 43091.87it/s]100%|██████████| 118897/118897 [00:02<00:00, 40320.58it/s]
The spherical harmonics array is 104.77 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 88.11161231994629 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 1.7259403936302857
Cubic Torus
Running - E1 l_max=20, Lx=30414
Running {'topology': 'E1', 'Lx': 1.1, 'Ly': 1.1, 'Lz': 1.1, 'beta': 90, 'alpha': 90, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1} {'powerspec': 'powlaw_mov', 'amp': 1.0, 'pow_min': 0.002, 'pow_max': 0.00205, 'location': 0.0001, 'width': 0.01, 'freq': 10, 'k_cutoff': 0.001, 'alpha_cutoff': 3.0}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 12.15it/s] 21%|██        | 4/19 [00:00<00:01, 13.90it/s] 32%|███▏      | 6/19 [00:00<00:00, 15.10it/s] 42%|████▏     | 8/19 [00:00<00:00, 16.23it/s] 53%|█████▎    | 10/19 [00:00<00:00, 17.31it/s] 68%|██████▊   | 13/19 [00:00<00:00, 18.50it/s] 84%|████████▍ | 16/19 [00:00<00:00, 19.76it/s]100%|██████████| 19/19 [00:01<00:00, 20.60it/s]100%|██████████| 19/19 [00:01<00:00, 18.24it/s]
Done. k_max for TT ell_max = 0.01028013843438453 k_max for EE ell_max = 0.08518796500039377
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 1897672 Minimum k_amp 0.00020658328967625562 n_x_max 77 n_z_max 77
Time to get list of k, phi, theta: 0.2385709285736084 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.0742525578709071
Ratio of unique |k|: 0.0025910694788140415
Time to get unique k and theta: 0.39712977409362793 seconds

Getting transfer functions
  0%|          | 0/4917 [00:00<?, ?it/s]  0%|          | 7/4917 [00:00<01:41, 48.27it/s]  3%|▎         | 140/4917 [00:00<00:07, 673.78it/s]  6%|▌         | 273/4917 [00:00<00:05, 928.18it/s]  8%|▊         | 399/4917 [00:00<00:04, 1038.00it/s] 11%|█         | 546/4917 [00:00<00:03, 1167.40it/s] 14%|█▍        | 679/4917 [00:00<00:03, 1204.72it/s] 17%|█▋        | 826/4917 [00:00<00:03, 1271.28it/s] 20%|█▉        | 959/4917 [00:00<00:03, 1284.93it/s] 22%|██▏       | 1099/4917 [00:00<00:02, 1316.91it/s] 25%|██▌       | 1239/4917 [00:01<00:02, 1337.30it/s] 28%|██▊       | 1395/4917 [00:01<00:02, 1404.28it/s] 32%|███▏      | 1582/4917 [00:01<00:02, 1542.69it/s] 36%|███▌      | 1778/4917 [00:01<00:01, 1652.06it/s] 41%|████      | 2002/4917 [00:01<00:01, 1810.35it/s] 45%|████▍     | 2212/4917 [00:01<00:01, 1878.14it/s] 49%|████▉     | 2422/4917 [00:01<00:01, 1931.34it/s] 54%|█████▎    | 2632/4917 [00:01<00:01, 1971.97it/s] 58%|█████▊    | 2842/4917 [00:01<00:01, 2003.22it/s] 62%|██████▏   | 3043/4917 [00:01<00:00, 1993.70it/s] 66%|██████▌   | 3243/4917 [00:02<00:00, 1977.27it/s] 70%|██████▉   | 3441/4917 [00:02<00:00, 1965.95it/s] 74%|███████▍  | 3640/4917 [00:02<00:00, 1958.27it/s] 78%|███████▊  | 3843/4917 [00:02<00:00, 1978.77it/s] 82%|████████▏ | 4046/4917 [00:02<00:00, 1986.83it/s] 86%|████████▋ | 4245/4917 [00:02<00:00, 1930.42it/s] 90%|█████████ | 4439/4917 [00:02<00:00, 1922.75it/s] 94%|█████████▍| 4634/4917 [00:02<00:00, 1918.55it/s] 98%|█████████▊| 4827/4917 [00:02<00:00, 1915.43it/s]100%|██████████| 4917/4917 [00:02<00:00, 1661.90it/s]
Size of transfer function: 0.79 MB. 

Size of integrand: 16.54 MB. Time to calculate integrand: 0.009299755096435547 s

Getting spherical harmonics
  0%|          | 0/140907 [00:00<?, ?it/s]  3%|▎         | 4416/140907 [00:00<00:03, 41254.25it/s]  6%|▌         | 8542/140907 [00:00<00:03, 34707.75it/s]  9%|▊         | 12066/140907 [00:00<00:03, 34202.64it/s] 11%|█▏        | 16008/140907 [00:00<00:03, 35766.15it/s] 15%|█▍        | 20608/140907 [00:00<00:03, 39044.90it/s] 17%|█▋        | 24656/140907 [00:00<00:02, 39198.68it/s] 20%|██        | 28599/140907 [00:00<00:02, 38315.59it/s] 23%|██▎       | 32568/140907 [00:00<00:02, 38676.35it/s] 26%|██▌       | 36800/140907 [00:00<00:02, 39709.05it/s] 29%|██▉       | 40783/140907 [00:01<00:02, 39015.71it/s] 32%|███▏      | 45448/140907 [00:01<00:02, 40176.92it/s] 35%|███▌      | 49469/140907 [00:01<00:02, 39044.11it/s] 38%|███▊      | 53544/140907 [00:01<00:02, 38648.97it/s] 42%|████▏     | 58696/140907 [00:01<00:01, 42305.67it/s] 45%|████▍     | 62947/140907 [00:01<00:01, 42025.38it/s] 49%|████▊     | 68448/140907 [00:01<00:01, 45627.21it/s] 52%|█████▏    | 73028/140907 [00:01<00:01, 43939.86it/s] 55%|█████▌    | 77832/140907 [00:01<00:01, 45044.55it/s] 59%|█████▉    | 82984/140907 [00:02<00:01, 46839.96it/s] 62%|██████▏   | 87688/140907 [00:02<00:01, 43743.42it/s] 65%|██████▌   | 92113/140907 [00:02<00:01, 42937.03it/s] 69%|██████▉   | 97704/140907 [00:02<00:00, 46185.62it/s] 73%|███████▎  | 103040/140907 [00:02<00:00, 47688.14it/s] 77%|███████▋  | 107839/140907 [00:02<00:00, 44970.50it/s] 80%|███████▉  | 112381/140907 [00:02<00:00, 36401.10it/s] 83%|████████▎ | 116294/140907 [00:02<00:00, 32578.51it/s] 85%|████████▌ | 119783/140907 [00:03<00:00, 27382.97it/s] 87%|████████▋ | 122777/140907 [00:03<00:00, 26029.47it/s] 89%|████████▉ | 125544/140907 [00:03<00:00, 24723.67it/s] 91%|█████████ | 128119/140907 [00:03<00:00, 21941.24it/s] 93%|█████████▎| 130456/140907 [00:03<00:00, 22225.01it/s] 94%|█████████▍| 132752/140907 [00:03<00:00, 22370.86it/s] 96%|█████████▌| 135044/140907 [00:03<00:00, 18733.54it/s] 97%|█████████▋| 137034/140907 [00:04<00:00, 17688.70it/s] 99%|█████████▊| 138880/140907 [00:04<00:00, 16298.90it/s]100%|█████████▉| 140566/140907 [00:04<00:00, 16304.50it/s]100%|██████████| 140907/140907 [00:04<00:00, 32627.98it/s]
The spherical harmonics array is 124.17 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 80.83221197128296 seconds
Calculating KL divergence

Calculating covariance matrix
KL: 1.7036789709452798
