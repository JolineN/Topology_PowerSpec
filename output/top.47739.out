Cubic Torus
Running - E1 l_max=20, Lx=27649
Running {'topology': 'E1', 'Lx': 1.0, 'Ly': 1.0, 'Lz': 1.0, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 17.74it/s] 26%|██▋       | 5/19 [00:00<00:00, 22.70it/s] 42%|████▏     | 8/19 [00:00<00:00, 24.24it/s] 58%|█████▊    | 11/19 [00:00<00:00, 24.87it/s] 74%|███████▎  | 14/19 [00:00<00:00, 25.31it/s] 89%|████████▉ | 17/19 [00:00<00:00, 25.62it/s]100%|██████████| 19/19 [00:00<00:00, 24.82it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.0851947808441249
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4179066 Minimum k_amp 0.0002272416186438812 n_x_max 100 n_z_max 100
Time to get list of k, phi, theta: 2.1695985794067383 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07165572403020197
Ratio of unique |k|: 0.0019913540489669224
Time to get unique k and theta: 0.9116542339324951 seconds

Getting transfer functions
  0%|          | 0/8322 [00:00<?, ?it/s]  2%|▏         | 154/8322 [00:00<00:05, 1515.07it/s]  4%|▍         | 341/8322 [00:00<00:04, 1647.92it/s]  6%|▌         | 517/8322 [00:00<00:04, 1658.19it/s]  8%|▊         | 693/8322 [00:00<00:04, 1679.83it/s] 10%|█         | 869/8322 [00:00<00:04, 1706.91it/s] 12%|█▏        | 1040/8322 [00:00<00:04, 1648.29it/s] 14%|█▍        | 1206/8322 [00:00<00:04, 1648.91it/s] 17%|█▋        | 1386/8322 [00:00<00:04, 1657.67it/s] 19%|█▉        | 1562/8322 [00:00<00:04, 1662.95it/s] 21%|██        | 1738/8322 [00:01<00:03, 1690.96it/s] 23%|██▎       | 1914/8322 [00:01<00:03, 1663.75it/s] 25%|██▌       | 2101/8322 [00:01<00:03, 1722.98it/s] 28%|██▊       | 2354/8322 [00:01<00:03, 1942.62it/s] 31%|███▏      | 2618/8322 [00:01<00:02, 2132.04it/s] 34%|███▍      | 2860/8322 [00:01<00:02, 2185.06it/s] 37%|███▋      | 3091/8322 [00:01<00:02, 2214.45it/s] 40%|████      | 3333/8322 [00:01<00:02, 2251.27it/s] 43%|████▎     | 3608/8322 [00:01<00:01, 2378.37it/s] 46%|████▋     | 3861/8322 [00:01<00:01, 2413.50it/s] 50%|████▉     | 4136/8322 [00:02<00:01, 2494.38it/s] 53%|█████▎    | 4389/8322 [00:02<00:01, 2461.65it/s] 57%|█████▋    | 4730/8322 [00:02<00:01, 2732.48it/s] 61%|██████    | 5049/8322 [00:02<00:01, 2843.10it/s] 65%|██████▍   | 5368/8322 [00:02<00:01, 2944.86it/s] 68%|██████▊   | 5663/8322 [00:02<00:00, 2821.89it/s] 71%|███████▏  | 5947/8322 [00:02<00:00, 2818.55it/s] 75%|███████▍  | 6230/8322 [00:02<00:00, 2814.94it/s] 79%|███████▊  | 6545/8322 [00:02<00:00, 2885.28it/s] 82%|████████▏ | 6834/8322 [00:03<00:00, 2806.87it/s] 86%|████████▌ | 7116/8322 [00:03<00:00, 2787.18it/s] 89%|████████▉ | 7396/8322 [00:03<00:00, 2778.27it/s] 92%|█████████▏| 7675/8322 [00:03<00:00, 2771.60it/s] 96%|█████████▌| 7964/8322 [00:03<00:00, 2776.78it/s] 99%|█████████▉| 8272/8322 [00:03<00:00, 2781.77it/s]100%|██████████| 8322/8322 [00:03<00:00, 2346.82it/s]
Size of transfer function: 1.33 MB. 

Size of integrand: 28.0 MB. Time to calculate integrand: 0.7501063346862793 s

Getting spherical harmonics
  0%|          | 0/299454 [00:00<?, ?it/s]  1%|          | 3510/299454 [00:00<00:10, 28764.88it/s]  2%|▏         | 6387/299454 [00:00<00:16, 18131.05it/s]  3%|▎         | 8383/299454 [00:00<00:19, 14693.91it/s]  3%|▎         | 9963/299454 [00:00<00:22, 13125.04it/s]  4%|▍         | 11327/299454 [00:00<00:26, 10770.31it/s]  4%|▍         | 12480/299454 [00:01<00:29, 9812.93it/s]   5%|▍         | 14040/299454 [00:01<00:27, 10345.07it/s]  5%|▌         | 15210/299454 [00:01<00:27, 10233.86it/s]  5%|▌         | 16380/299454 [00:01<00:26, 10534.82it/s]  6%|▌         | 17550/299454 [00:01<00:27, 10282.28it/s]  6%|▋         | 19110/299454 [00:01<00:26, 10737.44it/s]  7%|▋         | 20280/299454 [00:01<00:26, 10684.09it/s]  7%|▋         | 21450/299454 [00:01<00:26, 10356.39it/s]  8%|▊         | 23010/299454 [00:01<00:24, 11085.66it/s]  8%|▊         | 24570/299454 [00:02<00:23, 11710.88it/s]  9%|▊         | 25745/299454 [00:02<00:25, 10553.66it/s]  9%|▉         | 26910/299454 [00:02<00:26, 10445.57it/s]  9%|▉         | 28080/299454 [00:02<00:27, 9925.03it/s]  10%|▉         | 29640/299454 [00:02<00:25, 10535.41it/s] 10%|█         | 31200/299454 [00:02<00:23, 11190.24it/s] 11%|█         | 32760/299454 [00:02<00:21, 12216.37it/s] 11%|█▏        | 34320/299454 [00:02<00:22, 11970.99it/s] 12%|█▏        | 35534/299454 [00:03<00:23, 11384.50it/s] 12%|█▏        | 37050/299454 [00:03<00:22, 11654.15it/s] 13%|█▎        | 38610/299454 [00:03<00:21, 11904.08it/s] 13%|█▎        | 39806/299454 [00:03<00:22, 11730.94it/s] 14%|█▎        | 40981/299454 [00:03<00:22, 11345.66it/s] 14%|█▍        | 42120/299454 [00:03<00:22, 11214.41it/s] 15%|█▍        | 43680/299454 [00:03<00:21, 11958.88it/s] 15%|█▌        | 45240/299454 [00:03<00:20, 12285.04it/s] 16%|█▌        | 46800/299454 [00:04<00:20, 12601.07it/s] 16%|█▌        | 48059/299454 [00:04<00:20, 12105.33it/s] 17%|█▋        | 49530/299454 [00:04<00:20, 12475.70it/s] 17%|█▋        | 51090/299454 [00:04<00:19, 12638.85it/s] 17%|█▋        | 52354/299454 [00:04<00:19, 12603.78it/s] 18%|█▊        | 53614/299454 [00:04<00:19, 12463.45it/s] 18%|█▊        | 54990/299454 [00:04<00:20, 12050.19it/s] 19%|█▉        | 56550/299454 [00:04<00:19, 12443.74it/s] 19%|█▉        | 57796/299454 [00:04<00:19, 12345.42it/s] 20%|█▉        | 59280/299454 [00:05<00:19, 12519.64it/s] 20%|██        | 60840/299454 [00:05<00:18, 12637.91it/s] 21%|██        | 62400/299454 [00:05<00:18, 12707.10it/s] 21%|██▏       | 63960/299454 [00:05<00:18, 12678.30it/s] 22%|██▏       | 65520/299454 [00:05<00:17, 13038.09it/s] 22%|██▏       | 67080/299454 [00:05<00:18, 12765.84it/s] 23%|██▎       | 68360/299454 [00:05<00:18, 12738.32it/s] 23%|██▎       | 69810/299454 [00:05<00:18, 12284.67it/s] 24%|██▎       | 71043/299454 [00:05<00:19, 11495.35it/s] 24%|██▍       | 73320/299454 [00:06<00:16, 13601.47it/s] 25%|██▌       | 74880/299454 [00:06<00:16, 13259.01it/s] 26%|██▌       | 76440/299454 [00:06<00:16, 13214.99it/s] 26%|██▌       | 78067/299454 [00:06<00:15, 14010.88it/s] 27%|██▋       | 79950/299454 [00:06<00:14, 15115.37it/s] 27%|██▋       | 81510/299454 [00:06<00:15, 14262.44it/s] 28%|██▊       | 82954/299454 [00:06<00:15, 13710.88it/s] 28%|██▊       | 84338/299454 [00:06<00:19, 11210.09it/s] 29%|██▉       | 86190/299454 [00:07<00:17, 11933.11it/s] 29%|██▉       | 87750/299454 [00:07<00:17, 12367.22it/s] 30%|██▉       | 89700/299454 [00:07<00:15, 13342.44it/s] 30%|███       | 91260/299454 [00:07<00:16, 12441.86it/s] 31%|███       | 93210/299454 [00:07<00:15, 13407.38it/s] 32%|███▏      | 94579/299454 [00:07<00:15, 13306.46it/s] 32%|███▏      | 95928/299454 [00:07<00:15, 13070.13it/s] 32%|███▏      | 97246/299454 [00:07<00:16, 12522.18it/s] 33%|███▎      | 98670/299454 [00:08<00:15, 12914.25it/s] 33%|███▎      | 100230/299454 [00:08<00:15, 12873.30it/s] 34%|███▍      | 101790/299454 [00:08<00:15, 12880.18it/s] 34%|███▍      | 103083/299454 [00:08<00:16, 12205.46it/s] 35%|███▌      | 104910/299454 [00:08<00:14, 13023.87it/s] 36%|███▌      | 106470/299454 [00:08<00:15, 12761.62it/s] 36%|███▌      | 107749/299454 [00:08<00:15, 12668.43it/s] 36%|███▋      | 109200/299454 [00:08<00:14, 12888.93it/s] 37%|███▋      | 110760/299454 [00:09<00:14, 13196.80it/s] 37%|███▋      | 112082/299454 [00:09<00:14, 12712.53it/s] 38%|███▊      | 113355/299454 [00:09<00:14, 12680.53it/s] 38%|███▊      | 114624/299454 [00:09<00:14, 12350.80it/s] 39%|███▊      | 115860/299454 [00:09<00:15, 11656.61it/s] 39%|███▉      | 117390/299454 [00:09<00:15, 12061.74it/s] 40%|███▉      | 118950/299454 [00:09<00:15, 11575.47it/s] 40%|████      | 120510/299454 [00:09<00:14, 12544.84it/s] 41%|████      | 122070/299454 [00:09<00:14, 12609.77it/s] 41%|████      | 123346/299454 [00:10<00:13, 12623.24it/s] 42%|████▏     | 124619/299454 [00:10<00:13, 12548.41it/s] 42%|████▏     | 126360/299454 [00:10<00:12, 13609.26it/s] 43%|████▎     | 127920/299454 [00:10<00:12, 13843.03it/s] 43%|████▎     | 129480/299454 [00:10<00:12, 13165.65it/s] 44%|████▍     | 131040/299454 [00:10<00:13, 12723.79it/s] 44%|████▍     | 132990/299454 [00:10<00:12, 13155.23it/s] 45%|████▍     | 134310/299454 [00:10<00:12, 13031.93it/s] 45%|████▌     | 135720/299454 [00:10<00:12, 13074.90it/s] 46%|████▌     | 137280/299454 [00:11<00:11, 13610.57it/s] 46%|████▋     | 138647/299454 [00:11<00:12, 13292.49it/s] 47%|████▋     | 140400/299454 [00:11<00:11, 14149.04it/s] 48%|████▊     | 142350/299454 [00:11<00:10, 14483.13it/s] 48%|████▊     | 143798/299454 [00:11<00:11, 13389.77it/s] 48%|████▊     | 145145/299454 [00:11<00:12, 12682.54it/s] 49%|████▉     | 146420/299454 [00:11<00:12, 12127.25it/s] 49%|████▉     | 147810/299454 [00:11<00:12, 11967.03it/s] 50%|████▉     | 149370/299454 [00:12<00:12, 12465.19it/s] 50%|█████     | 150930/299454 [00:12<00:11, 12690.12it/s] 51%|█████     | 152202/299454 [00:12<00:12, 11964.27it/s] 51%|█████▏    | 154050/299454 [00:12<00:10, 13264.41it/s] 52%|█████▏    | 156000/299454 [00:12<00:10, 13998.71it/s] 53%|█████▎    | 157560/299454 [00:12<00:10, 14014.86it/s] 53%|█████▎    | 158964/299454 [00:12<00:10, 13337.15it/s] 54%|█████▎    | 160301/299454 [00:12<00:11, 12360.14it/s] 54%|█████▍    | 161850/299454 [00:12<00:11, 12340.80it/s] 55%|█████▍    | 163410/299454 [00:13<00:10, 12876.03it/s] 55%|█████▌    | 164970/299454 [00:13<00:10, 13410.67it/s] 56%|█████▌    | 166530/299454 [00:13<00:09, 13441.19it/s] 56%|█████▌    | 168090/299454 [00:13<00:09, 13886.48it/s] 57%|█████▋    | 169650/299454 [00:13<00:09, 14117.52it/s] 57%|█████▋    | 171069/299454 [00:13<00:09, 13974.11it/s] 58%|█████▊    | 172770/299454 [00:13<00:09, 14046.23it/s] 58%|█████▊    | 174178/299454 [00:13<00:09, 13452.61it/s] 59%|█████▊    | 175527/299454 [00:13<00:09, 12732.96it/s] 59%|█████▉    | 177060/299454 [00:14<00:09, 12714.13it/s] 60%|█████▉    | 178620/299454 [00:14<00:09, 13239.57it/s] 60%|██████    | 180570/299454 [00:14<00:08, 14740.15it/s] 61%|██████    | 182130/299454 [00:14<00:08, 14464.64it/s] 61%|██████▏   | 183586/299454 [00:14<00:08, 14130.63it/s] 62%|██████▏   | 185006/299454 [00:14<00:08, 13129.34it/s] 62%|██████▏   | 186333/299454 [00:14<00:09, 12117.94it/s] 63%|██████▎   | 187590/299454 [00:14<00:09, 11374.58it/s] 63%|██████▎   | 189150/299454 [00:15<00:09, 12127.48it/s] 64%|██████▍   | 191100/299454 [00:15<00:08, 13008.40it/s] 64%|██████▍   | 192660/299454 [00:15<00:08, 13259.66it/s] 65%|██████▍   | 194220/299454 [00:15<00:07, 13322.96it/s] 65%|██████▌   | 195557/299454 [00:15<00:08, 12590.51it/s] 66%|██████▌   | 196821/299454 [00:15<00:08, 11828.45it/s] 66%|██████▌   | 198120/299454 [00:15<00:08, 12041.90it/s] 67%|██████▋   | 199331/299454 [00:15<00:08, 11412.25it/s] 67%|██████▋   | 200850/299454 [00:15<00:07, 12391.02it/s] 67%|██████▋   | 202105/299454 [00:16<00:07, 12263.61it/s] 68%|██████▊   | 203342/299454 [00:16<00:07, 12257.74it/s] 68%|██████▊   | 204750/299454 [00:16<00:07, 12496.12it/s] 69%|██████▉   | 206005/299454 [00:16<00:07, 12330.61it/s] 69%|██████▉   | 207242/299454 [00:16<00:07, 12274.14it/s] 70%|██████▉   | 209430/299454 [00:16<00:06, 14799.53it/s] 70%|███████   | 210990/299454 [00:16<00:06, 14446.10it/s] 71%|███████   | 212437/299454 [00:16<00:06, 14126.42it/s] 71%|███████▏  | 213852/299454 [00:16<00:06, 13269.29it/s] 72%|███████▏  | 215188/299454 [00:17<00:06, 13038.39it/s] 72%|███████▏  | 216840/299454 [00:17<00:06, 13115.62it/s] 73%|███████▎  | 218400/299454 [00:17<00:06, 13169.74it/s] 73%|███████▎  | 219719/299454 [00:17<00:06, 12627.16it/s] 74%|███████▍  | 220984/299454 [00:17<00:06, 12073.90it/s] 74%|███████▍  | 222690/299454 [00:17<00:05, 13211.84it/s] 75%|███████▍  | 224250/299454 [00:17<00:05, 13830.72it/s] 75%|███████▌  | 225645/299454 [00:17<00:05, 13782.80it/s] 76%|███████▌  | 227032/299454 [00:17<00:05, 12953.85it/s] 76%|███████▋  | 228540/299454 [00:18<00:05, 13114.89it/s] 77%|███████▋  | 230100/299454 [00:18<00:05, 13541.14it/s] 77%|███████▋  | 231660/299454 [00:18<00:05, 13298.81it/s] 78%|███████▊  | 232997/299454 [00:18<00:05, 13169.40it/s] 78%|███████▊  | 234390/299454 [00:18<00:05, 12679.76it/s] 79%|███████▉  | 235950/299454 [00:18<00:04, 13262.05it/s] 79%|███████▉  | 237510/299454 [00:18<00:05, 12365.46it/s] 80%|███████▉  | 239070/299454 [00:18<00:04, 12369.91it/s] 80%|████████  | 240321/299454 [00:19<00:04, 12030.76it/s] 81%|████████  | 241800/299454 [00:19<00:04, 12275.97it/s] 81%|████████▏ | 243360/299454 [00:19<00:04, 13125.73it/s] 82%|████████▏ | 244920/299454 [00:19<00:04, 13120.77it/s] 82%|████████▏ | 246242/299454 [00:19<00:04, 13044.83it/s] 83%|████████▎ | 247650/299454 [00:19<00:04, 12830.00it/s] 83%|████████▎ | 249210/299454 [00:19<00:03, 13301.22it/s] 84%|████████▎ | 250545/299454 [00:19<00:03, 13121.64it/s] 84%|████████▍ | 251940/299454 [00:19<00:03, 13144.40it/s] 85%|████████▍ | 253890/299454 [00:20<00:03, 13995.31it/s] 85%|████████▌ | 255284/299454 [00:20<00:03, 13776.77it/s] 86%|████████▌ | 256657/299454 [00:20<00:03, 12521.77it/s] 86%|████████▌ | 257922/299454 [00:20<00:03, 12453.09it/s] 87%|████████▋ | 259350/299454 [00:20<00:03, 12186.44it/s] 87%|████████▋ | 260910/299454 [00:20<00:02, 12969.99it/s] 88%|████████▊ | 262470/299454 [00:20<00:02, 12779.04it/s] 88%|████████▊ | 263758/299454 [00:20<00:02, 12245.27it/s] 89%|████████▊ | 265200/299454 [00:20<00:02, 11797.22it/s] 89%|████████▉ | 266760/299454 [00:21<00:02, 12054.94it/s] 90%|████████▉ | 268320/299454 [00:21<00:02, 12676.36it/s] 90%|█████████ | 269880/299454 [00:21<00:02, 13351.13it/s] 91%|█████████ | 271229/299454 [00:21<00:02, 12923.86it/s] 91%|█████████▏| 273390/299454 [00:21<00:01, 13901.41it/s] 92%|█████████▏| 274950/299454 [00:21<00:01, 13699.82it/s] 92%|█████████▏| 276317/299454 [00:21<00:01, 12965.30it/s] 93%|█████████▎| 277680/299454 [00:21<00:01, 12555.29it/s] 93%|█████████▎| 279240/299454 [00:22<00:01, 13117.59it/s] 94%|█████████▍| 280800/299454 [00:22<00:01, 13750.87it/s] 94%|█████████▍| 282184/299454 [00:22<00:01, 13078.36it/s] 95%|█████████▍| 283920/299454 [00:22<00:01, 13276.31it/s] 95%|█████████▌| 285480/299454 [00:22<00:01, 13642.44it/s] 96%|█████████▌| 287040/299454 [00:22<00:00, 13192.06it/s] 96%|█████████▋| 288600/299454 [00:22<00:00, 13113.26it/s] 97%|█████████▋| 289917/299454 [00:22<00:00, 12818.94it/s] 97%|█████████▋| 291330/299454 [00:22<00:00, 12282.18it/s] 98%|█████████▊| 293280/299454 [00:23<00:00, 13477.38it/s] 98%|█████████▊| 294840/299454 [00:23<00:00, 13543.80it/s] 99%|█████████▉| 296790/299454 [00:23<00:00, 13570.15it/s]100%|█████████▉| 298740/299454 [00:23<00:00, 14488.01it/s]100%|██████████| 299454/299454 [00:23<00:00, 12766.30it/s]
The spherical harmonics array is 263.88 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 40.915154457092285 seconds

***********
Calculating a_lm realizations
***********

  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:05<00:00,  5.51s/it]100%|██████████| 1/1 [00:05<00:00,  5.51s/it]

Calculating covariance matrix
  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]Only calculating diagonal
  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]  3%|▎         | 138205/4179066 [00:01<00:30, 134389.47it/s]  6%|▌         | 256673/4179066 [00:01<00:17, 227315.88it/s]  9%|▊         | 364259/4179066 [00:01<00:12, 296174.46it/s] 11%|█         | 468798/4179066 [00:01<00:10, 352321.19it/s] 14%|█▎        | 569236/4179066 [00:01<00:09, 397707.59it/s] 16%|█▌        | 673698/4179066 [00:01<00:07, 439748.92it/s] 19%|█▊        | 778423/4179066 [00:01<00:07, 476768.79it/s] 21%|██▏       | 888330/4179066 [00:01<00:06, 512480.24it/s] 24%|██▍       | 1002980/4179066 [00:01<00:05, 546850.25it/s] 27%|██▋       | 1120724/4179066 [00:01<00:05, 579240.64it/s] 30%|██▉       | 1243850/4179066 [00:02<00:04, 611071.33it/s] 33%|███▎      | 1374163/4179066 [00:02<00:04, 643271.07it/s] 36%|███▌      | 1501364/4179066 [00:02<00:03, 671178.41it/s] 39%|███▉      | 1628205/4179066 [00:02<00:03, 696526.86it/s] 42%|████▏     | 1754331/4179066 [00:02<00:03, 719493.58it/s] 45%|████▍     | 1880118/4179066 [00:02<00:03, 740498.87it/s] 48%|████▊     | 2005102/4179066 [00:02<00:02, 759598.79it/s] 51%|█████     | 2131804/4179066 [00:02<00:02, 777926.21it/s] 54%|█████▍    | 2256393/4179066 [00:02<00:02, 794202.90it/s] 57%|█████▋    | 2381873/4179066 [00:02<00:02, 809676.16it/s] 60%|██████    | 2508487/4179066 [00:03<00:02, 824490.89it/s] 63%|██████▎   | 2636999/4179066 [00:03<00:01, 838967.00it/s] 66%|██████▌   | 2764352/4179066 [00:03<00:01, 852182.19it/s] 69%|██████▉   | 2892321/4179066 [00:03<00:01, 864785.64it/s] 72%|███████▏  | 3024327/4179066 [00:03<00:01, 877829.30it/s] 76%|███████▌  | 3155354/4179066 [00:03<00:01, 889850.30it/s] 79%|███████▊  | 3289335/4179066 [00:03<00:00, 902018.77it/s] 82%|████████▏ | 3426634/4179066 [00:03<00:00, 914416.54it/s] 85%|████████▌ | 3567320/4179066 [00:03<00:00, 927046.37it/s] 89%|████████▉ | 3711407/4179066 [00:03<00:00, 939898.57it/s] 93%|█████████▎| 3867878/4179066 [00:04<00:00, 955170.45it/s] 97%|█████████▋| 4045470/4179066 [00:04<00:00, 974785.98it/s]100%|██████████| 4179066/4179066 [00:04<00:00, 993168.29it/s]100%|██████████| 4179066/4179066 [00:04<00:00, 993101.22it/s]100%|██████████| 4179066/4179066 [00:04<00:00, 993071.57it/s]
Time to calculate C_TT with l_max=20 and c_l_ratio=0.99: 4.208630323410034 seconds with Numba
Power spectrum ratio: [0.8985302  1.02007754 0.99125445 1.07631351 1.07974017 1.05042362
 1.00839686 0.99681777 0.98952882 0.99104308 0.98939094 0.99022391
 0.99000692 0.98979885 0.99043445 0.98938585 0.99064859 0.98924521
 0.99078648]

Calculating covariance matrix
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [01:13<00:00, 73.72s/it]100%|██████████| 1/1 [01:13<00:00, 73.72s/it]
Calculating KL divergence

Calculating covariance matrix
KL: 31.4777840216285
