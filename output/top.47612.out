No shift: True
Running {'topology': 'E2', 'Lx': 1, 'Ly': 1, 'Lz': 1, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1}
Making run folder: runs/E2_Lx_1.00_Ly_1.00_Lz_1.00_beta_90_alpha_90_gamma_0_x_0.00_y_0.00_z_0.00_l_max_20_accuracy_99_percent/
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 18.69it/s] 26%|██▋       | 5/19 [00:00<00:00, 23.77it/s] 42%|████▏     | 8/19 [00:00<00:00, 25.38it/s] 58%|█████▊    | 11/19 [00:00<00:00, 25.99it/s] 74%|███████▎  | 14/19 [00:00<00:00, 26.49it/s] 89%|████████▉ | 17/19 [00:00<00:00, 26.79it/s]100%|██████████| 19/19 [00:00<00:00, 25.98it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519265089295892
Eigenmode 1: 198
Eigenmode 2: 4179528
E2 Final num of elements: 4179528 Minimum k_amp 0.0002272416186438812 n_x_max 200 n_z_max 400
Size of tilde xi: 127.55 MB.
Shape tilde xi: (4179528, 2) 

Time to get list of k, phi, theta: 4.740710020065308 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.14293049358683566
Ratio of unique |k|: 0.004380159673532513
Time to get unique k and theta: 0.5530788898468018 seconds

Getting transfer functions
  0%|          | 0/18307 [00:00<?, ?it/s]  2%|▏         | 360/18307 [00:00<00:05, 3583.02it/s]  4%|▍         | 768/18307 [00:00<00:04, 3738.51it/s]  6%|▌         | 1142/18307 [00:00<00:04, 3690.61it/s]  8%|▊         | 1511/18307 [00:00<00:04, 3645.65it/s] 10%|█         | 1876/18307 [00:00<00:04, 3515.97it/s] 12%|█▏        | 2232/18307 [00:00<00:04, 3522.10it/s] 14%|█▍        | 2592/18307 [00:00<00:04, 3545.96it/s] 16%|█▌        | 2952/18307 [00:00<00:04, 3534.27it/s] 18%|█▊        | 3336/18307 [00:00<00:04, 3557.13it/s] 20%|██        | 3720/18307 [00:01<00:04, 3581.43it/s] 22%|██▏       | 4104/18307 [00:01<00:03, 3608.30it/s] 24%|██▍       | 4465/18307 [00:01<00:03, 3591.81it/s] 27%|██▋       | 4944/18307 [00:01<00:03, 3895.18it/s] 30%|██▉       | 5472/18307 [00:01<00:02, 4301.13it/s] 33%|███▎      | 5976/18307 [00:01<00:02, 4514.37it/s] 36%|███▌      | 6504/18307 [00:01<00:02, 4718.13it/s] 39%|███▊      | 7056/18307 [00:01<00:02, 4920.69it/s] 42%|████▏     | 7608/18307 [00:01<00:02, 5086.48it/s] 45%|████▍     | 8160/18307 [00:01<00:01, 5159.81it/s] 48%|████▊     | 8832/18307 [00:02<00:01, 5547.52it/s] 52%|█████▏    | 9504/18307 [00:02<00:01, 5859.03it/s] 56%|█████▌    | 10200/18307 [00:02<00:01, 6171.31it/s] 60%|█████▉    | 10920/18307 [00:02<00:01, 6379.21it/s] 63%|██████▎   | 11616/18307 [00:02<00:01, 6546.14it/s] 67%|██████▋   | 12288/18307 [00:02<00:00, 6578.54it/s] 71%|███████   | 13008/18307 [00:02<00:00, 6751.98it/s] 75%|███████▌  | 13752/18307 [00:02<00:00, 6770.40it/s] 79%|███████▉  | 14520/18307 [00:02<00:00, 6996.86it/s] 84%|████████▎ | 15312/18307 [00:02<00:00, 7230.70it/s] 88%|████████▊ | 16104/18307 [00:03<00:00, 7367.87it/s] 92%|█████████▏| 16872/18307 [00:03<00:00, 7450.23it/s] 96%|█████████▋| 17640/18307 [00:03<00:00, 7489.43it/s]100%|██████████| 18307/18307 [00:03<00:00, 5428.91it/s]
Size of transfer function: 2.93 MB. 

Size of integrand: 61.6 MB. Time to calculate integrand: 0.2368466854095459 s

Getting spherical harmonics
  0%|          | 0/597382 [00:00<?, ?it/s]  1%|          | 5446/597382 [00:00<00:11, 52825.89it/s]  2%|▏         | 10729/597382 [00:00<00:20, 29137.20it/s]  2%|▏         | 14200/597382 [00:00<00:23, 24881.48it/s]  3%|▎         | 17116/597382 [00:00<00:22, 25937.03it/s]  3%|▎         | 20228/597382 [00:00<00:23, 25023.03it/s]  4%|▍         | 22870/597382 [00:00<00:24, 23877.77it/s]  4%|▍         | 25338/597382 [00:01<00:27, 20858.86it/s]  5%|▍         | 27506/597382 [00:01<00:27, 20519.54it/s]  5%|▍         | 29607/597382 [00:01<00:28, 19706.90it/s]  5%|▌         | 32676/597382 [00:01<00:26, 21476.33it/s]  6%|▌         | 35010/597382 [00:01<00:26, 21567.80it/s]  6%|▋         | 37344/597382 [00:01<00:27, 20663.20it/s]  7%|▋         | 39678/597382 [00:01<00:28, 19755.32it/s]  7%|▋         | 42012/597382 [00:01<00:28, 19762.98it/s]  7%|▋         | 44346/597382 [00:02<00:29, 19010.63it/s]  8%|▊         | 46680/597382 [00:02<00:28, 19326.22it/s]  8%|▊         | 49792/597382 [00:02<00:26, 20767.24it/s]  9%|▊         | 51871/597382 [00:02<00:26, 20756.91it/s]  9%|▉         | 53948/597382 [00:02<00:28, 19322.07it/s]  9%|▉         | 56016/597382 [00:02<00:28, 19135.31it/s] 10%|▉         | 58350/597382 [00:02<00:28, 18778.45it/s] 10%|█         | 60684/597382 [00:02<00:29, 18452.01it/s] 11%|█         | 63018/597382 [00:02<00:28, 18790.76it/s] 11%|█         | 66130/597382 [00:03<00:25, 20653.41it/s] 12%|█▏        | 69242/597382 [00:03<00:23, 22090.05it/s] 12%|█▏        | 72354/597382 [00:03<00:23, 21924.44it/s] 13%|█▎        | 74688/597382 [00:03<00:25, 20875.57it/s] 13%|█▎        | 77800/597382 [00:03<00:22, 22869.22it/s] 13%|█▎        | 80134/597382 [00:03<00:23, 22023.96it/s] 14%|█▍        | 82468/597382 [00:03<00:23, 21523.80it/s] 14%|█▍        | 85580/597382 [00:03<00:21, 23562.97it/s] 15%|█▌        | 90248/597382 [00:04<00:17, 29477.63it/s] 16%|█▌        | 93360/597382 [00:04<00:17, 28222.31it/s] 16%|█▌        | 96233/597382 [00:04<00:19, 26145.88it/s] 17%|█▋        | 98901/597382 [00:04<00:20, 23849.55it/s] 17%|█▋        | 101345/597382 [00:04<00:21, 23172.42it/s] 18%|█▊        | 105030/597382 [00:04<00:19, 25665.96it/s] 18%|█▊        | 107632/597382 [00:04<00:19, 25608.21it/s] 18%|█▊        | 110476/597382 [00:04<00:18, 26039.78it/s] 19%|█▉        | 113100/597382 [00:05<00:20, 23546.53it/s] 20%|█▉        | 116700/597382 [00:05<00:17, 26816.17it/s] 20%|██        | 121368/597382 [00:05<00:16, 29484.62it/s] 21%|██        | 124480/597382 [00:05<00:16, 29485.68it/s] 21%|██▏       | 127592/597382 [00:05<00:16, 29214.76it/s] 22%|██▏       | 130704/597382 [00:05<00:16, 27620.31it/s] 22%|██▏       | 133487/597382 [00:05<00:17, 26942.25it/s] 23%|██▎       | 136193/597382 [00:05<00:18, 24837.09it/s] 23%|██▎       | 138703/597382 [00:05<00:19, 23869.30it/s] 24%|██▎       | 141596/597382 [00:06<00:18, 24594.92it/s] 24%|██▍       | 144708/597382 [00:06<00:17, 26079.22it/s] 25%|██▍       | 147820/597382 [00:06<00:17, 26026.72it/s] 25%|██▌       | 150932/597382 [00:06<00:17, 25009.24it/s] 26%|██▌       | 154822/597382 [00:06<00:15, 27795.92it/s] 26%|██▋       | 157934/597382 [00:06<00:15, 27795.02it/s] 27%|██▋       | 161046/597382 [00:06<00:15, 27292.10it/s] 27%|██▋       | 164158/597382 [00:06<00:15, 28018.06it/s] 28%|██▊       | 167270/597382 [00:06<00:15, 27154.36it/s] 29%|██▊       | 171160/597382 [00:07<00:15, 27626.01it/s] 29%|██▉       | 174272/597382 [00:07<00:14, 28254.18it/s] 30%|██▉       | 178162/597382 [00:07<00:14, 29033.82it/s] 30%|███       | 181274/597382 [00:07<00:15, 27665.61it/s] 31%|███       | 184386/597382 [00:07<00:15, 27082.19it/s] 31%|███▏      | 187498/597382 [00:07<00:15, 27213.48it/s] 32%|███▏      | 190610/597382 [00:07<00:14, 27428.41it/s] 32%|███▏      | 193722/597382 [00:07<00:14, 27812.81it/s] 33%|███▎      | 197612/597382 [00:08<00:13, 29352.30it/s] 34%|███▎      | 200724/597382 [00:08<00:13, 29120.13it/s] 34%|███▍      | 203836/597382 [00:08<00:14, 26914.16it/s] 35%|███▍      | 206948/597382 [00:08<00:14, 27620.71it/s] 35%|███▌      | 209736/597382 [00:08<00:14, 27614.00it/s] 36%|███▌      | 212515/597382 [00:08<00:15, 25551.89it/s] 36%|███▌      | 215506/597382 [00:08<00:14, 25860.61it/s] 37%|███▋      | 218618/597382 [00:08<00:14, 26703.65it/s] 37%|███▋      | 221730/597382 [00:08<00:13, 27026.88it/s] 38%|███▊      | 225620/597382 [00:09<00:12, 28640.63it/s] 39%|███▊      | 230288/597382 [00:09<00:11, 30853.81it/s] 39%|███▉      | 233356/597382 [00:09<00:11, 30765.70it/s] 40%|███▉      | 236420/597382 [00:09<00:12, 28552.16it/s] 40%|████      | 239283/597382 [00:09<00:14, 24944.92it/s] 41%|████      | 242736/597382 [00:09<00:13, 26302.88it/s] 41%|████      | 245848/597382 [00:09<00:13, 26451.76it/s] 42%|████▏     | 249738/597382 [00:09<00:12, 27384.01it/s] 42%|████▏     | 252850/597382 [00:10<00:13, 26281.91it/s] 43%|████▎     | 256740/597382 [00:10<00:12, 28116.44it/s] 43%|████▎     | 259574/597382 [00:10<00:12, 27040.23it/s] 44%|████▍     | 262289/597382 [00:10<00:12, 26208.64it/s] 44%|████▍     | 265298/597382 [00:10<00:12, 26067.93it/s] 45%|████▍     | 268410/597382 [00:10<00:12, 26558.96it/s] 45%|████▌     | 271522/597382 [00:10<00:11, 27713.00it/s] 46%|████▌     | 274634/597382 [00:10<00:11, 27317.44it/s] 46%|████▋     | 277746/597382 [00:11<00:12, 25660.24it/s] 47%|████▋     | 281636/597382 [00:11<00:11, 28101.78it/s] 48%|████▊     | 284748/597382 [00:11<00:11, 28228.32it/s] 48%|████▊     | 287860/597382 [00:11<00:11, 27522.95it/s] 49%|████▊     | 290972/597382 [00:11<00:10, 27960.76it/s] 49%|████▉     | 294084/597382 [00:11<00:10, 28667.63it/s] 50%|████▉     | 297196/597382 [00:11<00:10, 28003.15it/s] 50%|█████     | 300308/597382 [00:11<00:10, 27809.46it/s] 51%|█████     | 303420/597382 [00:11<00:10, 27976.30it/s] 51%|█████▏    | 306532/597382 [00:12<00:10, 28044.37it/s] 52%|█████▏    | 310422/597382 [00:12<00:09, 30212.98it/s] 52%|█████▏    | 313534/597382 [00:12<00:09, 29336.62it/s] 53%|█████▎    | 316474/597382 [00:12<00:10, 27852.49it/s] 53%|█████▎    | 319270/597382 [00:12<00:10, 25852.42it/s] 54%|█████▍    | 322092/597382 [00:12<00:10, 26008.84it/s] 54%|█████▍    | 325204/597382 [00:12<00:10, 27159.10it/s] 55%|█████▍    | 328316/597382 [00:12<00:09, 28121.06it/s] 55%|█████▌    | 331428/597382 [00:12<00:09, 27297.41it/s] 56%|█████▌    | 334540/597382 [00:13<00:09, 26914.34it/s] 57%|█████▋    | 338430/597382 [00:13<00:09, 28766.62it/s] 57%|█████▋    | 342320/597382 [00:13<00:08, 30598.88it/s] 58%|█████▊    | 345432/597382 [00:13<00:08, 28201.08it/s] 58%|█████▊    | 349322/597382 [00:13<00:08, 29782.62it/s] 59%|█████▉    | 353212/597382 [00:13<00:07, 31434.04it/s] 60%|█████▉    | 356384/597382 [00:13<00:07, 30438.27it/s] 60%|██████    | 359446/597382 [00:13<00:09, 26087.42it/s] 61%|██████    | 363326/597382 [00:14<00:08, 28695.77it/s] 61%|██████▏   | 366438/597382 [00:14<00:08, 28017.60it/s] 62%|██████▏   | 369550/597382 [00:14<00:08, 27262.41it/s] 62%|██████▏   | 372662/597382 [00:14<00:08, 25263.09it/s] 63%|██████▎   | 375248/597382 [00:14<00:08, 24824.03it/s] 63%|██████▎   | 378886/597382 [00:14<00:07, 27504.63it/s] 64%|██████▍   | 382776/597382 [00:14<00:07, 30446.53it/s] 65%|██████▍   | 385895/597382 [00:14<00:07, 29281.91it/s] 65%|██████▌   | 389778/597382 [00:14<00:06, 30052.79it/s] 66%|██████▌   | 392818/597382 [00:15<00:06, 29438.98it/s] 66%|██████▋   | 395784/597382 [00:15<00:07, 28573.53it/s] 67%|██████▋   | 398655/597382 [00:15<00:07, 28078.71it/s] 67%|██████▋   | 401471/597382 [00:15<00:08, 24267.07it/s] 68%|██████▊   | 404560/597382 [00:15<00:07, 24761.73it/s] 68%|██████▊   | 408450/597382 [00:15<00:07, 26603.71it/s] 69%|██████▉   | 412340/597382 [00:15<00:07, 26148.51it/s] 70%|██████▉   | 416230/597382 [00:15<00:06, 28207.19it/s] 70%|███████   | 419097/597382 [00:16<00:06, 27690.51it/s] 71%|███████   | 421892/597382 [00:16<00:06, 27426.12it/s] 71%|███████   | 424650/597382 [00:16<00:07, 24493.67it/s] 72%|███████▏  | 427900/597382 [00:16<00:06, 24787.95it/s] 72%|███████▏  | 431801/597382 [00:16<00:05, 28395.56it/s] 73%|███████▎  | 435680/597382 [00:16<00:05, 30723.50it/s] 73%|███████▎  | 438836/597382 [00:16<00:05, 26849.02it/s] 74%|███████▍  | 442682/597382 [00:16<00:05, 28707.90it/s] 75%|███████▍  | 445658/597382 [00:17<00:05, 27615.04it/s] 75%|███████▌  | 448906/597382 [00:17<00:05, 26814.91it/s] 76%|███████▌  | 452018/597382 [00:17<00:05, 27566.30it/s] 76%|███████▌  | 455130/597382 [00:17<00:05, 27418.14it/s] 77%|███████▋  | 459798/597382 [00:17<00:04, 31061.42it/s] 78%|███████▊  | 463688/597382 [00:17<00:04, 31209.41it/s] 78%|███████▊  | 466824/597382 [00:17<00:04, 31075.72it/s] 79%|███████▉  | 470690/597382 [00:17<00:03, 32764.67it/s] 79%|███████▉  | 473984/597382 [00:17<00:04, 29579.83it/s] 80%|███████▉  | 477692/597382 [00:18<00:04, 29347.66it/s] 80%|████████  | 480804/597382 [00:18<00:04, 29056.90it/s] 81%|████████  | 483737/597382 [00:18<00:03, 28423.09it/s] 81%|████████▏ | 486595/597382 [00:18<00:03, 28066.31it/s] 82%|████████▏ | 490140/597382 [00:18<00:03, 28060.71it/s] 83%|████████▎ | 494041/597382 [00:18<00:03, 30999.62it/s] 83%|████████▎ | 497920/597382 [00:18<00:03, 31417.94it/s] 84%|████████▍ | 501087/597382 [00:18<00:03, 29778.68it/s] 85%|████████▍ | 505700/597382 [00:19<00:02, 31788.44it/s] 85%|████████▌ | 508883/597382 [00:19<00:03, 29333.63it/s] 86%|████████▌ | 512702/597382 [00:19<00:02, 31121.00it/s] 86%|████████▋ | 515848/597382 [00:19<00:02, 28837.57it/s] 87%|████████▋ | 518926/597382 [00:19<00:02, 27766.38it/s] 87%|████████▋ | 521730/597382 [00:19<00:02, 27181.13it/s] 88%|████████▊ | 524463/597382 [00:19<00:02, 26247.58it/s] 88%|████████▊ | 527096/597382 [00:19<00:02, 24487.63it/s] 89%|████████▊ | 529560/597382 [00:19<00:02, 23175.73it/s] 89%|████████▉ | 532152/597382 [00:20<00:02, 23124.96it/s] 90%|████████▉ | 535264/597382 [00:20<00:02, 22827.63it/s] 90%|█████████ | 539154/597382 [00:20<00:02, 25110.85it/s] 91%|█████████ | 541667/597382 [00:20<00:02, 22956.98it/s] 91%|█████████▏| 545378/597382 [00:20<00:02, 25495.45it/s] 92%|█████████▏| 548490/597382 [00:20<00:01, 26459.91it/s] 92%|█████████▏| 552380/597382 [00:20<00:01, 28278.87it/s] 93%|█████████▎| 555492/597382 [00:20<00:01, 25988.05it/s] 94%|█████████▍| 560160/597382 [00:21<00:01, 29352.68it/s] 94%|█████████▍| 563272/597382 [00:21<00:01, 28920.66it/s] 95%|█████████▍| 566185/597382 [00:21<00:01, 27126.76it/s] 95%|█████████▌| 569496/597382 [00:21<00:01, 27682.45it/s] 96%|█████████▌| 572690/597382 [00:21<00:00, 28798.83it/s] 96%|█████████▋| 575598/597382 [00:21<00:00, 28463.05it/s] 97%|█████████▋| 578832/597382 [00:21<00:00, 29221.28it/s] 97%|█████████▋| 581770/597382 [00:21<00:00, 28385.27it/s] 98%|█████████▊| 584621/597382 [00:22<00:00, 27866.23it/s] 98%|█████████▊| 587416/597382 [00:22<00:00, 26290.24it/s] 99%|█████████▉| 590502/597382 [00:22<00:00, 26206.16it/s] 99%|█████████▉| 593614/597382 [00:22<00:00, 25962.10it/s]100%|█████████▉| 596726/597382 [00:22<00:00, 25953.87it/s]100%|██████████| 597382/597382 [00:22<00:00, 26563.97it/s]
The spherical harmonics array is 526.41 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 47.512681007385254 seconds

***********
Calculating a_lm realizations
***********

  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:09<00:00,  9.73s/it]100%|██████████| 1/1 [00:09<00:00,  9.73s/it]

Calculating covariance matrix
  0%|          | 0/4179528 [00:00<?, ?it/s]  0%|          | 0/4179528 [00:00<?, ?it/s]Only calculating diagonal
  0%|          | 0/4179528 [00:00<?, ?it/s]  0%|          | 0/4179528 [00:00<?, ?it/s]  0%|          | 0/4179528 [00:00<?, ?it/s]  0%|          | 0/4179528 [00:00<?, ?it/s]  0%|          | 0/4179528 [00:00<?, ?it/s]  0%|          | 0/4179528 [00:00<?, ?it/s]  0%|          | 0/4179528 [00:00<?, ?it/s]  1%|          | 35799/4179528 [00:00<01:47, 38693.94it/s]  2%|▏         | 74091/4179528 [00:01<00:56, 72220.06it/s]  3%|▎         | 107008/4179528 [00:01<00:42, 94978.13it/s]  3%|▎         | 136953/4179528 [00:01<00:36, 111580.58it/s]  4%|▍         | 164969/4179528 [00:01<00:32, 124212.22it/s]  5%|▍         | 192361/4179528 [00:01<00:29, 134623.69it/s]  5%|▌         | 219504/4179528 [00:01<00:27, 143500.93it/s]  6%|▌         | 247396/4179528 [00:01<00:25, 151737.35it/s]  7%|▋         | 276144/4179528 [00:01<00:24, 159513.29it/s]  7%|▋         | 303623/4179528 [00:01<00:23, 165741.77it/s]  8%|▊         | 332704/4179528 [00:01<00:22, 172143.95it/s]  9%|▊         | 364175/4179528 [00:02<00:21, 179094.02it/s]  9%|▉         | 394304/4179528 [00:02<00:20, 184761.31it/s] 10%|█         | 428375/4179528 [00:02<00:19, 191680.09it/s] 11%|█         | 464529/4179528 [00:02<00:18, 198897.42it/s] 12%|█▏        | 499233/4179528 [00:02<00:17, 204921.70it/s] 13%|█▎        | 532400/4179528 [00:02<00:17, 209863.43it/s] 14%|█▎        | 567662/4179528 [00:02<00:16, 215221.83it/s] 14%|█▍        | 598772/4179528 [00:02<00:16, 218670.31it/s] 15%|█▌        | 631898/4179528 [00:02<00:15, 222581.56it/s] 16%|█▌        | 664022/4179528 [00:02<00:15, 225882.46it/s] 17%|█▋        | 694612/4179528 [00:03<00:15, 228461.94it/s] 17%|█▋        | 726720/4179528 [00:03<00:14, 231358.94it/s] 18%|█▊        | 758392/4179528 [00:03<00:14, 233940.81it/s] 19%|█▉        | 788110/4179528 [00:03<00:14, 235783.53it/s] 20%|█▉        | 817873/4179528 [00:03<00:14, 237531.30it/s] 20%|██        | 846699/4179528 [00:03<00:13, 238913.18it/s] 21%|██        | 874796/4179528 [00:03<00:13, 240016.17it/s] 22%|██▏       | 902597/4179528 [00:03<00:13, 240981.78it/s] 22%|██▏       | 930462/4179528 [00:03<00:13, 241912.54it/s] 23%|██▎       | 958505/4179528 [00:03<00:13, 242841.47it/s] 24%|██▎       | 985601/4179528 [00:04<00:13, 243489.63it/s] 24%|██▍       | 1012693/4179528 [00:04<00:12, 244104.77it/s] 25%|██▍       | 1039204/4179528 [00:04<00:12, 244554.48it/s] 25%|██▌       | 1065570/4179528 [00:04<00:12, 244950.73it/s] 26%|██▌       | 1091854/4179528 [00:04<00:12, 245309.91it/s] 27%|██▋       | 1118030/4179528 [00:04<00:12, 245629.28it/s] 27%|██▋       | 1144229/4179528 [00:04<00:12, 245940.71it/s] 28%|██▊       | 1170411/4179528 [00:04<00:12, 246233.45it/s] 29%|██▊       | 1196676/4179528 [00:04<00:12, 246533.36it/s] 29%|██▉       | 1222909/4179528 [00:04<00:11, 246813.68it/s] 30%|██▉       | 1249268/4179528 [00:05<00:11, 247106.57it/s] 31%|███       | 1275597/4179528 [00:05<00:11, 247383.46it/s] 31%|███       | 1301949/4179528 [00:05<00:11, 247654.99it/s] 32%|███▏      | 1328146/4179528 [00:05<00:11, 247886.10it/s] 32%|███▏      | 1353055/4179528 [00:05<00:11, 247872.49it/s] 33%|███▎      | 1377203/4179528 [00:05<00:11, 247722.84it/s] 34%|███▎      | 1402569/4179528 [00:05<00:11, 247794.11it/s] 34%|███▍      | 1428336/4179528 [00:05<00:11, 247933.05it/s] 35%|███▍      | 1454205/4179528 [00:05<00:10, 248084.21it/s] 35%|███▌      | 1480278/4179528 [00:05<00:10, 248264.92it/s] 36%|███▌      | 1506358/4179528 [00:06<00:10, 248440.51it/s] 37%|███▋      | 1529950/4179528 [00:06<00:10, 248207.34it/s] 37%|███▋      | 1554357/4179528 [00:06<00:10, 248111.02it/s] 38%|███▊      | 1579753/4179528 [00:06<00:10, 248173.38it/s] 38%|███▊      | 1605496/4179528 [00:06<00:10, 248287.09it/s] 39%|███▉      | 1631516/4179528 [00:06<00:10, 248439.77it/s] 40%|███▉      | 1657483/4179528 [00:06<00:10, 248579.95it/s] 40%|████      | 1680200/4179528 [00:06<00:10, 248235.45it/s] 41%|████      | 1704834/4179528 [00:06<00:09, 248180.68it/s] 41%|████▏     | 1730322/4179528 [00:06<00:09, 248249.88it/s] 42%|████▏     | 1756119/4179528 [00:07<00:09, 248360.19it/s] 43%|████▎     | 1782045/4179528 [00:07<00:09, 248485.58it/s] 43%|████▎     | 1805376/4179528 [00:07<00:09, 248250.90it/s] 44%|████▍     | 1829550/4179528 [00:07<00:09, 248137.19it/s] 44%|████▍     | 1854890/4179528 [00:07<00:09, 248182.16it/s] 45%|████▍     | 1880613/4179528 [00:07<00:09, 248275.59it/s] 46%|████▌     | 1906585/4179528 [00:07<00:09, 248400.12it/s] 46%|████▌     | 1930078/4179528 [00:07<00:09, 248202.37it/s] 47%|████▋     | 1953977/4179528 [00:07<00:08, 248061.71it/s] 47%|████▋     | 1979242/4179528 [00:07<00:08, 248094.99it/s] 48%|████▊     | 2004968/4179528 [00:08<00:08, 248185.43it/s] 49%|████▊     | 2030909/4179528 [00:08<00:08, 248299.45it/s] 49%|████▉     | 2054251/4179528 [00:08<00:08, 248097.23it/s] 50%|████▉     | 2079210/4179528 [00:08<00:08, 248092.29it/s] 50%|█████     | 2104484/4179528 [00:08<00:08, 248124.46it/s] 51%|█████     | 2130174/4179528 [00:08<00:08, 248204.64it/s] 52%|█████▏    | 2156662/4179528 [00:08<00:08, 248376.28it/s] 52%|█████▏    | 2182986/4179528 [00:08<00:08, 248525.53it/s] 53%|█████▎    | 2207503/4179528 [00:08<00:07, 248468.67it/s] 53%|█████▎    | 2234145/4179528 [00:08<00:07, 248649.48it/s] 54%|█████▍    | 2261111/4179528 [00:09<00:07, 248861.22it/s] 55%|█████▍    | 2288414/4179528 [00:09<00:07, 249105.71it/s] 55%|█████▌    | 2315761/4179528 [00:09<00:07, 249348.93it/s] 56%|█████▌    | 2343197/4179528 [00:09<00:07, 249597.06it/s] 57%|█████▋    | 2365867/4179528 [00:09<00:07, 249336.21it/s] 57%|█████▋    | 2390553/4179528 [00:09<00:07, 249290.95it/s] 58%|█████▊    | 2416101/4179528 [00:09<00:07, 249335.12it/s] 58%|█████▊    | 2442032/4179528 [00:09<00:06, 249418.14it/s] 59%|█████▉    | 2468133/4179528 [00:09<00:06, 249515.91it/s] 60%|█████▉    | 2490848/4179528 [00:09<00:06, 249273.30it/s] 60%|██████    | 2515496/4179528 [00:10<00:06, 249226.74it/s] 61%|██████    | 2541158/4179528 [00:10<00:06, 249281.06it/s] 61%|██████▏   | 2567129/4179528 [00:10<00:06, 249364.85it/s] 62%|██████▏   | 2594502/4179528 [00:10<00:06, 249582.60it/s] 63%|██████▎   | 2622025/4179528 [00:10<00:06, 249809.51it/s] 63%|██████▎   | 2647121/4179528 [00:10<00:06, 249797.77it/s] 64%|██████▍   | 2673191/4179528 [00:10<00:06, 249881.83it/s] 65%|██████▍   | 2699056/4179528 [00:10<00:05, 249937.70it/s] 65%|██████▌   | 2726494/4179528 [00:10<00:05, 250126.27it/s] 66%|██████▌   | 2753973/4179528 [00:11<00:05, 250336.00it/s] 67%|██████▋   | 2781473/4179528 [00:11<00:05, 250543.18it/s] 67%|██████▋   | 2809179/4179528 [00:11<00:05, 250764.85it/s] 68%|██████▊   | 2836937/4179528 [00:11<00:05, 250987.43it/s] 69%|██████▊   | 2864825/4179528 [00:11<00:05, 251217.16it/s] 69%|██████▉   | 2892808/4179528 [00:11<00:05, 251451.29it/s] 70%|██████▉   | 2920725/4179528 [00:11<00:05, 251675.73it/s] 70%|███████   | 2945670/4179528 [00:11<00:04, 251641.30it/s] 71%|███████   | 2970751/4179528 [00:11<00:04, 251618.57it/s] 72%|███████▏  | 2996696/4179528 [00:11<00:04, 251668.93it/s] 72%|███████▏  | 3022763/4179528 [00:12<00:04, 251728.81it/s] 73%|███████▎  | 3049086/4179528 [00:12<00:04, 251807.98it/s] 74%|███████▎  | 3075712/4179528 [00:12<00:04, 251911.41it/s] 74%|███████▍  | 3102268/4179528 [00:12<00:04, 252007.46it/s] 75%|███████▍  | 3129104/4179528 [00:12<00:04, 252124.56it/s] 76%|███████▌  | 3156044/4179528 [00:12<00:04, 252247.93it/s] 76%|███████▌  | 3182983/4179528 [00:12<00:03, 252368.49it/s] 77%|███████▋  | 3209967/4179528 [00:12<00:03, 252481.62it/s] 77%|███████▋  | 3237349/4179528 [00:12<00:03, 252627.69it/s] 78%|███████▊  | 3264697/4179528 [00:12<00:03, 252774.96it/s] 79%|███████▉  | 3292033/4179528 [00:13<00:03, 252918.78it/s] 79%|███████▉  | 3319665/4179528 [00:13<00:03, 253083.19it/s] 80%|████████  | 3347496/4179528 [00:13<00:03, 253259.75it/s] 81%|████████  | 3375553/4179528 [00:13<00:03, 253450.84it/s] 81%|████████▏ | 3403861/4179528 [00:13<00:03, 253657.85it/s] 82%|████████▏ | 3433444/4179528 [00:13<00:02, 253955.94it/s] 83%|████████▎ | 3463276/4179528 [00:13<00:02, 254267.72it/s] 84%|████████▎ | 3491693/4179528 [00:13<00:02, 254471.93it/s] 84%|████████▍ | 3520546/4179528 [00:13<00:02, 254704.86it/s] 85%|████████▍ | 3550238/4179528 [00:13<00:02, 254994.34it/s] 86%|████████▌ | 3581993/4179528 [00:14<00:02, 255426.92it/s] 86%|████████▋ | 3611456/4179528 [00:14<00:02, 255691.10it/s] 87%|████████▋ | 3642546/4179528 [00:14<00:02, 256066.22it/s] 88%|████████▊ | 3674472/4179528 [00:14<00:01, 256494.24it/s] 89%|████████▊ | 3705959/4179528 [00:14<00:01, 256885.87it/s] 89%|████████▉ | 3738800/4179528 [00:14<00:01, 257364.68it/s] 90%|█████████ | 3773092/4179528 [00:14<00:01, 257936.70it/s] 91%|█████████ | 3806000/4179528 [00:14<00:01, 258406.82it/s] 92%|█████████▏| 3840518/4179528 [00:14<00:01, 258979.04it/s] 93%|█████████▎| 3876656/4179528 [00:14<00:01, 259652.04it/s] 94%|█████████▎| 3915662/4179528 [00:15<00:01, 260507.01it/s] 95%|█████████▍| 3953215/4179528 [00:15<00:00, 261254.28it/s] 96%|█████████▌| 3994396/4179528 [00:15<00:00, 262229.88it/s] 97%|█████████▋| 4037357/4179528 [00:15<00:00, 263308.86it/s] 98%|█████████▊| 4085117/4179528 [00:15<00:00, 264684.85it/s] 99%|█████████▉| 4141867/4179528 [00:15<00:00, 266621.56it/s]100%|██████████| 4179528/4179528 [00:15<00:00, 268170.73it/s]100%|██████████| 4179528/4179528 [00:15<00:00, 268165.24it/s]100%|██████████| 4179528/4179528 [00:15<00:00, 268162.44it/s]
Time to calculate C_TT with l_max=20 and c_l_ratio=0.99: 15.586267232894897 seconds with Numba
Power spectrum ratio: [0.96820848 0.82982512 1.15574228 0.85818723 1.1016422  0.88751181
 1.08427039 0.90443729 1.06815041 0.9177966  1.0569682  0.92773981
 1.04798089 0.93582101 1.04071933 0.94247135 1.03452206 0.94815387
 1.02931057]

Calculating covariance matrix
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:32<00:00, 32.98s/it]100%|██████████| 1/1 [00:32<00:00, 32.98s/it]
Calculating KL divergence

Calculating covariance matrix
KL: 24.786061656269347
