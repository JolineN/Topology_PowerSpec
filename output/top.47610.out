
CommandNotFoundError: Your shell has not been properly configured to use 'conda activate'.
To initialize your shell, run

    $ conda init <SHELL_NAME>

Currently supported shells are:
  - bash
  - fish
  - tcsh
  - xonsh
  - zsh
  - powershell

See 'conda init --help' for more information and options.

IMPORTANT: You may need to close and restart your shell after running 'conda init'.


Cubic Torus
Running - E1 l_max=20, Lx=27649
Running {'topology': 'E1', 'Lx': 1.0, 'Ly': 1.0, 'Lz': 1.0, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 18.00it/s] 26%|██▋       | 5/19 [00:00<00:00, 23.63it/s] 42%|████▏     | 8/19 [00:00<00:00, 25.50it/s] 58%|█████▊    | 11/19 [00:00<00:00, 26.34it/s] 74%|███████▎  | 14/19 [00:00<00:00, 26.85it/s] 89%|████████▉ | 17/19 [00:00<00:00, 27.16it/s]100%|██████████| 19/19 [00:00<00:00, 26.23it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519265089295892
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4179066 Minimum k_amp 0.0002272416186438812 n_x_max 100 n_z_max 100
Time to get list of k, phi, theta: 2.8546905517578125 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07165572403020197
Ratio of unique |k|: 0.0019913540489669224
Time to get unique k and theta: 0.527292013168335 seconds

Getting transfer functions
  0%|          | 0/8322 [00:00<?, ?it/s]  3%|▎         | 231/8322 [00:00<00:03, 2292.51it/s]  6%|▌         | 484/8322 [00:00<00:03, 2401.23it/s]  9%|▊         | 725/8322 [00:00<00:03, 2359.80it/s] 12%|█▏        | 962/8322 [00:00<00:03, 2290.23it/s] 14%|█▍        | 1192/8322 [00:00<00:03, 2238.74it/s] 17%|█▋        | 1417/8322 [00:00<00:03, 2195.68it/s] 20%|█▉        | 1637/8322 [00:00<00:03, 2164.55it/s] 22%|██▏       | 1854/8322 [00:00<00:03, 2142.79it/s] 25%|██▍       | 2069/8322 [00:00<00:02, 2103.41it/s] 28%|██▊       | 2354/8322 [00:01<00:02, 2323.66it/s] 33%|███▎      | 2717/8322 [00:01<00:02, 2693.08it/s] 36%|███▋      | 3036/8322 [00:01<00:01, 2810.10it/s] 40%|███▉      | 3318/8322 [00:01<00:01, 2768.25it/s] 43%|████▎     | 3596/8322 [00:01<00:01, 2725.97it/s] 47%|████▋     | 3905/8322 [00:01<00:01, 2812.82it/s] 51%|█████     | 4257/8322 [00:01<00:01, 2998.72it/s] 55%|█████▍    | 4558/8322 [00:01<00:01, 2935.32it/s] 58%|█████▊    | 4853/8322 [00:01<00:01, 2852.86it/s] 62%|██████▏   | 5159/8322 [00:01<00:01, 2908.98it/s] 66%|██████▌   | 5511/8322 [00:02<00:00, 3059.72it/s] 70%|███████   | 5852/8322 [00:02<00:00, 3134.44it/s] 74%|███████▍  | 6171/8322 [00:02<00:00, 3133.35it/s] 78%|███████▊  | 6512/8322 [00:02<00:00, 3193.55it/s] 82%|████████▏ | 6832/8322 [00:02<00:00, 3109.29it/s] 86%|████████▌ | 7144/8322 [00:02<00:00, 3075.33it/s] 90%|████████▉ | 7458/8322 [00:02<00:00, 3059.55it/s] 93%|█████████▎| 7777/8322 [00:02<00:00, 3073.95it/s] 97%|█████████▋| 8085/8322 [00:02<00:00, 3019.25it/s]100%|██████████| 8322/8322 [00:03<00:00, 2768.78it/s]
Size of transfer function: 1.33 MB. 

Size of integrand: 28.0 MB. Time to calculate integrand: 0.4524109363555908 s

Getting spherical harmonics
  0%|          | 0/299454 [00:00<?, ?it/s]  1%|          | 3510/299454 [00:00<00:08, 33748.50it/s]  2%|▏         | 6885/299454 [00:00<00:13, 22068.26it/s]  3%|▎         | 9312/299454 [00:00<00:12, 22644.91it/s]  4%|▍         | 11713/299454 [00:00<00:14, 20098.47it/s]  5%|▍         | 13820/299454 [00:00<00:14, 19512.16it/s]  5%|▌         | 15827/299454 [00:00<00:14, 19547.57it/s]  6%|▌         | 17819/299454 [00:00<00:17, 16048.54it/s]  7%|▋         | 19526/299454 [00:01<00:18, 14755.63it/s]  7%|▋         | 21073/299454 [00:01<00:19, 14199.50it/s]  8%|▊         | 22620/299454 [00:01<00:19, 14303.96it/s]  8%|▊         | 24082/299454 [00:01<00:19, 14376.68it/s]  9%|▊         | 25740/299454 [00:01<00:18, 14801.30it/s]  9%|▉         | 27690/299454 [00:01<00:17, 15160.48it/s] 10%|▉         | 29250/299454 [00:01<00:18, 14531.11it/s] 11%|█         | 31590/299454 [00:01<00:16, 16379.47it/s] 11%|█         | 33241/299454 [00:01<00:16, 16030.51it/s] 12%|█▏        | 34852/299454 [00:02<00:16, 15879.39it/s] 12%|█▏        | 36660/299454 [00:02<00:16, 15875.69it/s] 13%|█▎        | 38610/299454 [00:02<00:16, 16207.43it/s] 14%|█▎        | 40950/299454 [00:02<00:14, 18000.69it/s] 14%|█▍        | 43290/299454 [00:02<00:13, 19197.32it/s] 15%|█▌        | 45630/299454 [00:02<00:12, 19865.93it/s] 16%|█▌        | 47970/299454 [00:02<00:12, 20670.87it/s] 17%|█▋        | 51090/299454 [00:02<00:10, 22818.82it/s] 18%|█▊        | 53430/299454 [00:02<00:10, 22979.66it/s] 19%|█▉        | 56550/299454 [00:03<00:09, 25131.27it/s] 20%|█▉        | 59280/299454 [00:03<00:09, 24856.85it/s] 21%|██        | 62010/299454 [00:03<00:09, 25265.53it/s] 22%|██▏       | 64541/299454 [00:03<00:09, 25137.22it/s] 22%|██▏       | 67080/299454 [00:03<00:09, 25195.35it/s] 23%|██▎       | 69810/299454 [00:03<00:08, 25668.09it/s] 24%|██▍       | 72379/299454 [00:03<00:08, 25358.31it/s] 25%|██▌       | 75270/299454 [00:03<00:08, 25907.46it/s] 26%|██▌       | 78000/299454 [00:03<00:08, 25954.07it/s] 27%|██▋       | 81510/299454 [00:04<00:08, 26287.86it/s] 28%|██▊       | 84135/299454 [00:04<00:08, 24457.25it/s] 29%|██▉       | 87750/299454 [00:04<00:07, 27083.26it/s] 30%|███       | 90483/299454 [00:04<00:07, 26499.37it/s] 31%|███       | 93149/299454 [00:04<00:08, 24625.44it/s] 32%|███▏      | 95639/299454 [00:04<00:08, 23632.86it/s] 33%|███▎      | 98670/299454 [00:04<00:07, 25234.07it/s] 34%|███▍      | 101400/299454 [00:04<00:08, 24395.09it/s] 35%|███▍      | 104130/299454 [00:04<00:08, 24022.80it/s] 36%|███▌      | 107250/299454 [00:05<00:07, 24607.18it/s] 37%|███▋      | 110370/299454 [00:05<00:07, 25381.44it/s] 38%|███▊      | 113490/299454 [00:05<00:07, 26488.53it/s] 39%|███▉      | 116610/299454 [00:05<00:06, 26824.92it/s] 40%|███▉      | 119340/299454 [00:05<00:06, 26586.27it/s] 41%|████      | 122070/299454 [00:05<00:06, 26566.57it/s] 42%|████▏     | 124731/299454 [00:05<00:06, 26450.61it/s] 43%|████▎     | 127530/299454 [00:05<00:06, 26069.69it/s] 43%|████▎     | 130260/299454 [00:05<00:06, 25263.34it/s] 44%|████▍     | 132990/299454 [00:06<00:06, 24982.18it/s] 45%|████▌     | 135720/299454 [00:06<00:06, 25458.69it/s] 46%|████▋     | 138840/299454 [00:06<00:05, 27047.48it/s] 47%|████▋     | 141558/299454 [00:06<00:06, 25520.10it/s] 48%|████▊     | 145080/299454 [00:06<00:05, 26463.18it/s] 49%|████▉     | 147735/299454 [00:06<00:05, 25316.47it/s] 50%|█████     | 150540/299454 [00:06<00:05, 25579.02it/s] 51%|█████     | 153270/299454 [00:06<00:05, 25014.79it/s] 52%|█████▏    | 156780/299454 [00:06<00:05, 27148.68it/s] 54%|█████▎    | 160290/299454 [00:07<00:04, 28680.74it/s] 54%|█████▍    | 163170/299454 [00:07<00:05, 26857.19it/s] 55%|█████▌    | 165878/299454 [00:07<00:05, 24365.87it/s] 57%|█████▋    | 169650/299454 [00:07<00:04, 27436.77it/s] 58%|█████▊    | 172459/299454 [00:07<00:04, 26568.15it/s] 59%|█████▊    | 175500/299454 [00:07<00:04, 27559.54it/s] 60%|█████▉    | 178620/299454 [00:07<00:04, 27391.41it/s] 61%|██████    | 181389/299454 [00:07<00:04, 24791.03it/s] 62%|██████▏   | 184470/299454 [00:07<00:04, 25894.17it/s] 62%|██████▏   | 187109/299454 [00:08<00:04, 23897.93it/s] 64%|██████▎   | 190320/299454 [00:08<00:04, 25430.54it/s] 65%|██████▍   | 193440/299454 [00:08<00:04, 25955.39it/s] 66%|██████▌   | 196950/299454 [00:08<00:03, 26962.09it/s] 67%|██████▋   | 199669/299454 [00:08<00:03, 26537.13it/s] 68%|██████▊   | 202410/299454 [00:08<00:03, 26392.12it/s] 69%|██████▊   | 205530/299454 [00:08<00:03, 25284.73it/s] 69%|██████▉   | 208078/299454 [00:08<00:03, 23063.86it/s] 71%|███████   | 212160/299454 [00:09<00:03, 26475.44it/s] 72%|███████▏  | 214847/299454 [00:09<00:03, 25187.29it/s] 73%|███████▎  | 217393/299454 [00:09<00:03, 24511.63it/s] 74%|███████▎  | 220740/299454 [00:09<00:02, 26702.42it/s] 75%|███████▍  | 223470/299454 [00:09<00:02, 26828.21it/s] 76%|███████▌  | 227370/299454 [00:09<00:02, 28103.20it/s] 77%|███████▋  | 230186/299454 [00:09<00:02, 27024.43it/s] 78%|███████▊  | 233220/299454 [00:09<00:02, 25950.76it/s] 79%|███████▉  | 235950/299454 [00:09<00:02, 26266.29it/s] 80%|███████▉  | 238588/299454 [00:10<00:02, 25161.64it/s] 81%|████████  | 241410/299454 [00:10<00:02, 25481.85it/s] 82%|████████▏ | 244530/299454 [00:10<00:02, 26449.76it/s] 83%|████████▎ | 247650/299454 [00:10<00:01, 26930.93it/s] 84%|████████▎ | 250349/299454 [00:10<00:01, 25753.94it/s] 84%|████████▍ | 252933/299454 [00:10<00:01, 25205.52it/s] 85%|████████▌ | 255693/299454 [00:10<00:01, 25870.10it/s] 86%|████████▋ | 258960/299454 [00:10<00:01, 27314.88it/s] 87%|████████▋ | 261699/299454 [00:10<00:01, 25143.81it/s] 88%|████████▊ | 264420/299454 [00:11<00:01, 25353.81it/s] 90%|████████▉ | 268055/299454 [00:11<00:01, 28403.68it/s] 90%|█████████ | 270937/299454 [00:11<00:01, 26483.85it/s] 92%|█████████▏| 274170/299454 [00:11<00:00, 27271.36it/s] 92%|█████████▏| 276933/299454 [00:11<00:00, 25175.17it/s] 94%|█████████▎| 280410/299454 [00:11<00:00, 26115.35it/s] 95%|█████████▍| 283920/299454 [00:11<00:00, 28402.21it/s] 96%|█████████▌| 286811/299454 [00:11<00:00, 25293.85it/s] 97%|█████████▋| 289425/299454 [00:12<00:00, 24593.06it/s] 98%|█████████▊| 292500/299454 [00:12<00:00, 25130.74it/s] 99%|█████████▊| 295053/299454 [00:12<00:00, 24369.61it/s] 99%|█████████▉| 297570/299454 [00:12<00:00, 23851.95it/s]100%|██████████| 299454/299454 [00:12<00:00, 24082.23it/s]
The spherical harmonics array is 263.88 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 27.985457181930542 seconds

***********
Calculating a_lm realizations
***********

  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:04<00:00,  4.89s/it]100%|██████████| 1/1 [00:04<00:00,  4.89s/it]

Calculating covariance matrix
  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]Only calculating diagonal
  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]  1%|          | 50478/4179066 [00:00<01:18, 52606.32it/s]  5%|▍         | 189819/4179066 [00:01<00:22, 179023.04it/s]  7%|▋         | 303398/4179066 [00:01<00:14, 261316.72it/s] 10%|▉         | 407569/4179066 [00:01<00:11, 323017.30it/s] 12%|█▏        | 503338/4179066 [00:01<00:09, 369417.29it/s] 14%|█▍        | 601055/4179066 [00:01<00:08, 410761.06it/s] 17%|█▋        | 696923/4179066 [00:01<00:07, 445601.55it/s] 19%|█▉        | 794905/4179066 [00:01<00:07, 477501.73it/s] 21%|██▏       | 895631/4179066 [00:01<00:06, 507310.93it/s] 24%|██▍       | 999605/4179066 [00:01<00:05, 535645.77it/s] 26%|██▋       | 1106169/4179066 [00:01<00:05, 562399.97it/s] 29%|██▉       | 1215307/4179066 [00:02<00:05, 587788.62it/s] 32%|███▏      | 1330142/4179066 [00:02<00:04, 613445.22it/s] 35%|███▍      | 1450743/4179066 [00:02<00:04, 639357.34it/s] 38%|███▊      | 1571250/4179066 [00:02<00:03, 663037.48it/s] 40%|████      | 1691340/4179066 [00:02<00:03, 684613.73it/s] 43%|████▎     | 1811376/4179066 [00:02<00:03, 704476.92it/s] 46%|████▌     | 1931068/4179066 [00:02<00:03, 722706.59it/s] 49%|████▉     | 2049849/4179066 [00:02<00:02, 739294.26it/s] 52%|█████▏    | 2170397/4179066 [00:02<00:02, 755329.97it/s] 55%|█████▍    | 2286404/4179066 [00:02<00:02, 768757.53it/s] 58%|█████▊    | 2405827/4179066 [00:03<00:02, 782413.39it/s] 60%|██████    | 2525929/4179066 [00:03<00:02, 795420.79it/s] 63%|██████▎   | 2646597/4179066 [00:03<00:01, 807796.11it/s] 66%|██████▌   | 2767425/4179066 [00:03<00:01, 819470.96it/s] 69%|██████▉   | 2889064/4179066 [00:03<00:01, 830715.14it/s] 72%|███████▏  | 3012272/4179066 [00:03<00:01, 841762.38it/s] 75%|███████▌  | 3139705/4179066 [00:03<00:01, 853350.09it/s] 78%|███████▊  | 3269045/4179066 [00:03<00:01, 864823.51it/s] 81%|████████▏ | 3400918/4179066 [00:03<00:00, 876361.74it/s] 85%|████████▍ | 3536778/4179066 [00:03<00:00, 888309.52it/s] 88%|████████▊ | 3681026/4179066 [00:04<00:00, 901729.81it/s] 92%|█████████▏| 3834039/4179066 [00:04<00:00, 916594.65it/s] 96%|█████████▌| 4003537/4179066 [00:04<00:00, 934612.51it/s]100%|██████████| 4179066/4179066 [00:04<00:00, 957815.74it/s]100%|██████████| 4179066/4179066 [00:04<00:00, 957747.97it/s]100%|██████████| 4179066/4179066 [00:04<00:00, 957719.13it/s]
Time to calculate C_TT with l_max=20 and c_l_ratio=0.99: 4.363962411880493 seconds with Numba
Power spectrum ratio: [0.86075667 1.01362753 0.97966619 0.99618841 0.98595729 0.99311502
 0.98750462 0.99164978 0.98853031 0.9909037  0.98937305 0.99022028
 0.99000661 0.98979881 0.99043442 0.98938582 0.99064857 0.98924519
 0.99078646]

Calculating covariance matrix
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:33<00:00, 33.97s/it]100%|██████████| 1/1 [00:33<00:00, 33.97s/it]
Calculating KL divergence

Calculating covariance matrix
KL: 24.914376380808406

CommandNotFoundError: Your shell has not been properly configured to use 'conda deactivate'.
To initialize your shell, run

    $ conda init <SHELL_NAME>

Currently supported shells are:
  - bash
  - fish
  - tcsh
  - xonsh
  - zsh
  - powershell

See 'conda init --help' for more information and options.

IMPORTANT: You may need to close and restart your shell after running 'conda init'.


