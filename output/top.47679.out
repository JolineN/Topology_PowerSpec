Cubic Torus
Running - E1 l_max=20, Lx=27649
Running {'topology': 'E1', 'Lx': 1.0, 'Ly': 1.0, 'Lz': 1.0, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 18.04it/s] 26%|██▋       | 5/19 [00:00<00:00, 23.33it/s] 42%|████▏     | 8/19 [00:00<00:00, 25.09it/s] 58%|█████▊    | 11/19 [00:00<00:00, 25.84it/s] 74%|███████▎  | 14/19 [00:00<00:00, 26.30it/s] 89%|████████▉ | 17/19 [00:00<00:00, 26.59it/s]100%|██████████| 19/19 [00:00<00:00, 25.74it/s]
Done. k_max for TT ell_max = 0.02432972231540152 k_max for EE ell_max = 0.08519563282459129
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 5141030 Minimum k_amp 0.0002272416186438812 n_x_max 108 n_z_max 108
Time to get list of k, phi, theta: 2.2459139823913574 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07095718173206536
Ratio of unique |k|: 0.001858576977765156
Time to get unique k and theta: 1.1637284755706787 seconds

Getting transfer functions
  0%|          | 0/9555 [00:00<?, ?it/s]  3%|▎         | 273/9555 [00:00<00:03, 2706.66it/s]  6%|▌         | 546/9555 [00:00<00:03, 2702.99it/s]  9%|▊         | 819/9555 [00:00<00:03, 2667.86it/s] 11%|█▏        | 1092/9555 [00:00<00:03, 2678.42it/s] 14%|█▍        | 1365/9555 [00:00<00:03, 2664.35it/s] 17%|█▋        | 1638/9555 [00:00<00:02, 2646.90it/s] 20%|██        | 1911/9555 [00:00<00:02, 2644.31it/s] 23%|██▎       | 2176/9555 [00:00<00:02, 2626.63it/s] 26%|██▌       | 2444/9555 [00:00<00:02, 2609.90it/s] 29%|██▉       | 2808/9555 [00:01<00:02, 2901.76it/s] 33%|███▎      | 3120/9555 [00:01<00:02, 2954.49it/s] 37%|███▋      | 3497/9555 [00:01<00:01, 3195.04it/s] 40%|████      | 3822/9555 [00:01<00:01, 3203.25it/s] 43%|████▎     | 4147/9555 [00:01<00:01, 3190.74it/s] 47%|████▋     | 4472/9555 [00:01<00:01, 3206.11it/s] 50%|█████     | 4810/9555 [00:01<00:01, 3235.78it/s] 54%|█████▍    | 5161/9555 [00:01<00:01, 3303.50it/s] 58%|█████▊    | 5512/9555 [00:01<00:01, 3337.99it/s] 61%|██████▏   | 5863/9555 [00:01<00:01, 3370.06it/s] 65%|██████▌   | 6214/9555 [00:02<00:00, 3388.92it/s] 69%|██████▊   | 6553/9555 [00:02<00:00, 3358.70it/s] 73%|███████▎  | 6942/9555 [00:02<00:00, 3489.90it/s] 76%|███████▋  | 7293/9555 [00:02<00:00, 3475.95it/s] 80%|████████  | 7683/9555 [00:02<00:00, 3589.14it/s] 85%|████████▍ | 8099/9555 [00:02<00:00, 3726.12it/s] 89%|████████▉ | 8515/9555 [00:02<00:00, 3824.34it/s] 93%|█████████▎| 8898/9555 [00:02<00:00, 3813.93it/s] 97%|█████████▋| 9280/9555 [00:02<00:00, 3765.54it/s]100%|██████████| 9555/9555 [00:02<00:00, 3251.61it/s]
Size of transfer function: 1.53 MB. 

Size of integrand: 32.15 MB. Time to calculate integrand: 0.4418978691101074 s

Getting spherical harmonics
  0%|          | 0/364793 [00:00<?, ?it/s]  1%|▏         | 4750/364793 [00:00<00:10, 35359.85it/s]  2%|▏         | 8286/364793 [00:00<00:13, 27105.73it/s]  3%|▎         | 11050/364793 [00:00<00:15, 22921.00it/s]  4%|▍         | 14250/364793 [00:00<00:13, 25495.44it/s]  5%|▍         | 16895/364793 [00:00<00:14, 23861.65it/s]  5%|▌         | 19339/364793 [00:00<00:14, 23283.25it/s]  6%|▌         | 21699/364793 [00:00<00:17, 19886.45it/s]  7%|▋         | 23764/364793 [00:01<00:24, 14010.70it/s]  7%|▋         | 25650/364793 [00:01<00:23, 14736.24it/s]  8%|▊         | 27550/364793 [00:01<00:21, 15499.36it/s]  8%|▊         | 29267/364793 [00:01<00:21, 15272.27it/s]  9%|▊         | 31350/364793 [00:01<00:21, 15660.66it/s]  9%|▉         | 33250/364793 [00:01<00:21, 15295.21it/s] 10%|▉         | 35150/364793 [00:01<00:22, 14852.71it/s] 10%|█         | 36676/364793 [00:02<00:22, 14559.55it/s] 11%|█         | 39425/364793 [00:02<00:18, 17213.50it/s] 11%|█▏        | 41800/364793 [00:02<00:17, 18154.23it/s] 12%|█▏        | 44175/364793 [00:02<00:16, 19246.80it/s] 13%|█▎        | 46130/364793 [00:02<00:16, 19170.12it/s] 13%|█▎        | 48068/364793 [00:02<00:16, 19121.27it/s] 14%|█▎        | 49994/364793 [00:02<00:18, 16896.14it/s] 14%|█▍        | 52725/364793 [00:02<00:15, 19599.49it/s] 15%|█▌        | 55575/364793 [00:02<00:14, 21742.67it/s] 16%|█▌        | 57950/364793 [00:03<00:14, 21164.54it/s] 17%|█▋        | 60800/364793 [00:03<00:13, 22650.94it/s] 17%|█▋        | 63175/364793 [00:03<00:13, 22919.47it/s] 18%|█▊        | 66025/364793 [00:03<00:12, 24225.02it/s] 19%|█▉        | 68473/364793 [00:03<00:12, 23984.74it/s] 20%|█▉        | 71250/364793 [00:03<00:11, 24487.06it/s] 20%|██        | 73711/364793 [00:03<00:12, 23989.68it/s] 21%|██        | 76119/364793 [00:03<00:12, 22817.88it/s] 22%|██▏       | 79325/364793 [00:03<00:11, 24257.95it/s] 23%|██▎       | 82650/364793 [00:04<00:11, 25556.19it/s] 23%|██▎       | 85500/364793 [00:04<00:10, 25782.40it/s] 24%|██▍       | 88350/364793 [00:04<00:10, 25831.92it/s] 25%|██▍       | 90934/364793 [00:04<00:11, 24441.73it/s] 26%|██▌       | 93575/364793 [00:04<00:11, 23894.18it/s] 26%|██▋       | 96425/364793 [00:04<00:10, 24651.66it/s] 27%|██▋       | 100225/364793 [00:04<00:09, 28171.19it/s] 28%|██▊       | 103075/364793 [00:04<00:10, 26160.58it/s] 29%|██▉       | 105734/364793 [00:04<00:10, 24660.71it/s] 30%|██▉       | 108775/364793 [00:05<00:09, 25692.56it/s] 31%|███       | 111378/364793 [00:05<00:10, 24671.45it/s] 31%|███▏      | 114000/364793 [00:05<00:10, 24064.99it/s] 32%|███▏      | 117800/364793 [00:05<00:09, 27320.92it/s] 33%|███▎      | 120563/364793 [00:05<00:09, 27063.02it/s] 34%|███▍      | 123975/364793 [00:05<00:08, 28644.57it/s] 35%|███▍      | 127300/364793 [00:05<00:08, 29557.24it/s] 36%|███▌      | 130272/364793 [00:05<00:08, 26103.48it/s] 36%|███▋      | 132959/364793 [00:05<00:09, 25753.22it/s] 37%|███▋      | 135586/364793 [00:06<00:09, 23147.30it/s] 38%|███▊      | 138225/364793 [00:06<00:09, 23888.46it/s] 39%|███▊      | 141075/364793 [00:06<00:09, 23819.13it/s] 39%|███▉      | 143925/364793 [00:06<00:08, 24646.02it/s] 40%|████      | 147250/364793 [00:06<00:08, 26777.06it/s] 41%|████      | 149971/364793 [00:06<00:08, 26763.79it/s] 42%|████▏     | 152678/364793 [00:06<00:08, 26182.82it/s] 43%|████▎     | 155325/364793 [00:06<00:08, 25907.68it/s] 43%|████▎     | 157930/364793 [00:07<00:08, 24039.34it/s] 44%|████▍     | 161025/364793 [00:07<00:07, 25851.60it/s] 45%|████▌     | 165300/364793 [00:07<00:06, 29047.37it/s] 46%|████▌     | 168214/364793 [00:07<00:07, 26524.62it/s] 47%|████▋     | 170902/364793 [00:07<00:07, 25969.76it/s] 48%|████▊     | 173521/364793 [00:07<00:07, 24454.83it/s] 48%|████▊     | 176700/364793 [00:07<00:07, 24466.53it/s] 49%|████▉     | 179550/364793 [00:07<00:07, 23612.13it/s] 50%|█████     | 182875/364793 [00:07<00:07, 25428.00it/s] 51%|█████     | 185445/364793 [00:08<00:07, 24819.75it/s] 52%|█████▏    | 187943/364793 [00:08<00:07, 24299.29it/s] 53%|█████▎    | 191900/364793 [00:08<00:06, 27875.36it/s] 53%|█████▎    | 194710/364793 [00:08<00:06, 27726.25it/s] 54%|█████▍    | 197497/364793 [00:08<00:06, 26163.39it/s] 55%|█████▍    | 200450/364793 [00:08<00:06, 24930.13it/s] 56%|█████▌    | 203300/364793 [00:08<00:06, 25818.46it/s] 57%|█████▋    | 207100/364793 [00:08<00:05, 28936.35it/s] 58%|█████▊    | 210037/364793 [00:08<00:05, 26529.82it/s] 58%|█████▊    | 213275/364793 [00:09<00:05, 27553.77it/s] 59%|█████▉    | 216125/364793 [00:09<00:05, 27341.29it/s] 60%|██████    | 218893/364793 [00:09<00:05, 26316.99it/s] 61%|██████    | 221825/364793 [00:09<00:05, 26491.74it/s] 62%|██████▏   | 224675/364793 [00:09<00:05, 25933.21it/s] 62%|██████▏   | 227283/364793 [00:09<00:05, 24985.13it/s] 63%|██████▎   | 230375/364793 [00:09<00:05, 25537.05it/s] 64%|██████▍   | 232936/364793 [00:09<00:05, 24303.86it/s] 65%|██████▍   | 235375/364793 [00:10<00:05, 22457.08it/s] 65%|██████▌   | 238450/364793 [00:10<00:05, 24449.98it/s] 66%|██████▌   | 241300/364793 [00:10<00:04, 24876.05it/s] 67%|██████▋   | 244946/364793 [00:10<00:04, 28052.09it/s] 68%|██████▊   | 248425/364793 [00:10<00:03, 29832.46it/s] 69%|██████▉   | 252225/364793 [00:10<00:03, 29879.32it/s] 70%|███████   | 255550/364793 [00:10<00:03, 29478.18it/s] 71%|███████   | 258875/364793 [00:10<00:03, 29679.86it/s] 72%|███████▏  | 261860/364793 [00:10<00:03, 27288.10it/s] 73%|███████▎  | 264625/364793 [00:11<00:04, 23933.42it/s] 73%|███████▎  | 267098/364793 [00:11<00:04, 21311.12it/s] 74%|███████▍  | 269314/364793 [00:11<00:04, 21334.18it/s] 75%|███████▍  | 273125/364793 [00:11<00:03, 24359.48it/s] 76%|███████▌  | 275975/364793 [00:11<00:03, 24751.27it/s] 76%|███████▋  | 278825/364793 [00:11<00:03, 25614.14it/s] 77%|███████▋  | 281675/364793 [00:11<00:03, 25612.53it/s] 78%|███████▊  | 285000/364793 [00:11<00:03, 26126.16it/s] 79%|███████▉  | 288325/364793 [00:12<00:02, 27456.09it/s] 80%|███████▉  | 291090/364793 [00:12<00:02, 26620.03it/s] 81%|████████  | 293765/364793 [00:12<00:03, 23619.23it/s] 81%|████████  | 296184/364793 [00:12<00:02, 23525.81it/s] 82%|████████▏ | 299250/364793 [00:12<00:02, 24443.78it/s] 83%|████████▎ | 302100/364793 [00:12<00:02, 25127.62it/s] 84%|████████▎ | 305425/364793 [00:12<00:02, 25419.32it/s] 85%|████████▍ | 308275/364793 [00:12<00:02, 25363.44it/s] 85%|████████▌ | 310822/364793 [00:12<00:02, 25372.67it/s] 86%|████████▌ | 313500/364793 [00:13<00:01, 25697.85it/s] 87%|████████▋ | 316350/364793 [00:13<00:01, 25982.64it/s] 88%|████████▊ | 319200/364793 [00:13<00:01, 25554.03it/s] 88%|████████▊ | 322525/364793 [00:13<00:01, 26727.46it/s] 89%|████████▉ | 325200/364793 [00:13<00:01, 23739.20it/s] 90%|████████▉ | 328225/364793 [00:13<00:01, 25367.93it/s] 91%|█████████ | 331550/364793 [00:13<00:01, 27134.83it/s] 92%|█████████▏| 334400/364793 [00:13<00:01, 27238.71it/s] 93%|█████████▎| 337725/364793 [00:13<00:01, 26726.76it/s] 93%|█████████▎| 340430/364793 [00:14<00:00, 25062.30it/s] 94%|█████████▍| 342969/364793 [00:14<00:00, 24624.72it/s] 95%|█████████▍| 345451/364793 [00:14<00:00, 24084.24it/s] 95%|█████████▌| 348175/364793 [00:14<00:00, 23921.16it/s] 96%|█████████▋| 351500/364793 [00:14<00:00, 25396.26it/s] 97%|█████████▋| 354350/364793 [00:14<00:00, 25343.42it/s] 98%|█████████▊| 357200/364793 [00:14<00:00, 25885.40it/s] 99%|█████████▊| 360050/364793 [00:14<00:00, 25616.43it/s] 99%|█████████▉| 362900/364793 [00:14<00:00, 25029.62it/s]100%|██████████| 364793/364793 [00:15<00:00, 24257.66it/s]
The spherical harmonics array is 321.45 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 29.866931915283203 seconds

***********
Calculating a_lm realizations
***********

  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:06<00:00,  6.98s/it]100%|██████████| 1/1 [00:06<00:00,  6.98s/it]

Calculating covariance matrix
  0%|          | 0/5141030 [00:00<?, ?it/s]  0%|          | 0/5141030 [00:00<?, ?it/s]Only calculating diagonal
  0%|          | 0/5141030 [00:00<?, ?it/s]  0%|          | 0/5141030 [00:00<?, ?it/s]  0%|          | 0/5141030 [00:00<?, ?it/s]  0%|          | 0/5141030 [00:00<?, ?it/s]  0%|          | 0/5141030 [00:00<?, ?it/s]  0%|          | 0/5141030 [00:00<?, ?it/s]  0%|          | 0/5141030 [00:00<?, ?it/s]  0%|          | 0/5141030 [00:00<?, ?it/s]  1%|▏         | 69081/5141030 [00:00<01:10, 72247.44it/s]  5%|▍         | 239226/5141030 [00:01<00:21, 226344.31it/s]  8%|▊         | 394977/5141030 [00:01<00:13, 341205.06it/s] 11%|█         | 540368/5141030 [00:01<00:10, 429443.36it/s] 13%|█▎        | 680457/5141030 [00:01<00:08, 500701.48it/s] 16%|█▌        | 817599/5141030 [00:01<00:07, 560118.48it/s] 19%|█▊        | 957315/5141030 [00:01<00:06, 613504.09it/s] 21%|██▏       | 1100114/5141030 [00:01<00:06, 662278.27it/s] 24%|██▍       | 1240207/5141030 [00:01<00:05, 703945.30it/s] 27%|██▋       | 1381075/5141030 [00:01<00:05, 741516.61it/s] 29%|██▉       | 1515994/5141030 [00:01<00:04, 772210.89it/s] 32%|███▏      | 1649501/5141030 [00:02<00:04, 799217.69it/s] 35%|███▍      | 1782189/5141030 [00:02<00:04, 823341.85it/s] 37%|███▋      | 1910865/5141030 [00:02<00:03, 843542.24it/s] 40%|███▉      | 2039370/5141030 [00:02<00:03, 861935.00it/s] 42%|████▏     | 2170532/5141030 [00:02<00:03, 879920.47it/s] 45%|████▍     | 2296397/5141030 [00:02<00:03, 894429.46it/s] 47%|████▋     | 2425571/5141030 [00:02<00:02, 909091.51it/s] 50%|████▉     | 2551808/5141030 [00:02<00:02, 921625.29it/s] 52%|█████▏    | 2681260/5141030 [00:02<00:02, 934394.00it/s] 55%|█████▍    | 2814657/5141030 [00:02<00:02, 947636.92it/s] 58%|█████▊    | 2959106/5141030 [00:03<00:02, 963622.63it/s] 60%|██████    | 3104139/5141030 [00:03<00:02, 978773.63it/s] 63%|██████▎   | 3245695/5141030 [00:03<00:01, 991927.01it/s] 66%|██████▌   | 3376987/5141030 [00:03<00:01, 1001241.86it/s] 68%|██████▊   | 3506062/5141030 [00:03<00:01, 1009348.70it/s] 71%|███████   | 3638653/5141030 [00:03<00:01, 1018002.11it/s] 73%|███████▎  | 3775589/5141030 [00:03<00:01, 1027366.90it/s] 76%|███████▌  | 3912157/5141030 [00:03<00:01, 1036139.84it/s] 79%|███████▉  | 4055321/5141030 [00:03<00:01, 1046156.23it/s] 82%|████████▏ | 4201695/5141030 [00:03<00:00, 1056469.10it/s] 85%|████████▍ | 4351863/5141030 [00:04<00:00, 1067208.47it/s] 88%|████████▊ | 4510754/5141030 [00:04<00:00, 1079515.03it/s] 91%|█████████ | 4683976/5141030 [00:04<00:00, 1094593.81it/s] 95%|█████████▍| 4878642/5141030 [00:04<00:00, 1113869.67it/s]100%|█████████▉| 5130878/5141030 [00:04<00:00, 1145145.28it/s]100%|██████████| 5141030/5141030 [00:04<00:00, 1146722.41it/s]100%|██████████| 5141030/5141030 [00:04<00:00, 1146691.80it/s]100%|██████████| 5141030/5141030 [00:04<00:00, 1146663.20it/s]
Time to calculate C_TT with l_max=20 and c_l_ratio=0.99: 4.483896732330322 seconds with Numba
Power spectrum ratio: [0.85886882 1.01348132 0.98112613 0.99730603 0.98573301 0.99240019
 0.98698586 0.99150317 0.98872015 0.99112316 0.98929899 0.99006076
 0.99007464 0.98988117 0.99035248 0.98935822 0.99071721 0.98921305
 0.99076181]

Calculating covariance matrix
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:34<00:00, 34.58s/it]100%|██████████| 1/1 [00:34<00:00, 34.58s/it]
Calculating KL divergence

Calculating covariance matrix
KL: 24.90991366224269
