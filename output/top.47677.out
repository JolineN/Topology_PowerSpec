Cubic Torus
Running - E1 l_max=20, Lx=27649
Running {'topology': 'E1', 'Lx': 1.0, 'Ly': 1.0, 'Lz': 1.0, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 17.42it/s] 26%|██▋       | 5/19 [00:00<00:00, 21.96it/s] 42%|████▏     | 8/19 [00:00<00:00, 23.37it/s] 58%|█████▊    | 11/19 [00:00<00:00, 23.92it/s] 74%|███████▎  | 14/19 [00:00<00:00, 24.30it/s] 89%|████████▉ | 17/19 [00:00<00:00, 24.57it/s]100%|██████████| 19/19 [00:00<00:00, 23.87it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4179066 Minimum k_amp 0.0002272416186438812 n_x_max 100 n_z_max 100
Time to get list of k, phi, theta: 2.1681275367736816 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07165572403020197
Ratio of unique |k|: 0.0019913540489669224
Time to get unique k and theta: 0.9144883155822754 seconds

Getting transfer functions
  0%|          | 0/8322 [00:00<?, ?it/s]  3%|▎         | 220/8322 [00:00<00:03, 2191.87it/s]  5%|▌         | 451/8322 [00:00<00:03, 2235.32it/s]  8%|▊         | 682/8322 [00:00<00:03, 2237.06it/s] 11%|█         | 906/8322 [00:00<00:03, 2199.40it/s] 14%|█▎        | 1126/8322 [00:00<00:03, 2122.62it/s] 16%|█▌        | 1342/8322 [00:00<00:03, 2126.10it/s] 19%|█▉        | 1595/8322 [00:00<00:02, 2249.34it/s] 22%|██▏       | 1826/8322 [00:00<00:02, 2258.68it/s] 25%|██▍       | 2053/8322 [00:00<00:02, 2255.70it/s] 28%|██▊       | 2343/8322 [00:01<00:02, 2435.91it/s] 31%|███▏      | 2618/8322 [00:01<00:02, 2507.11it/s] 35%|███▌      | 2937/8322 [00:01<00:01, 2710.00it/s] 39%|███▊      | 3209/8322 [00:01<00:01, 2710.20it/s] 42%|████▏     | 3487/8322 [00:01<00:01, 2696.91it/s] 46%|████▌     | 3828/8322 [00:01<00:01, 2872.12it/s] 50%|█████     | 4202/8322 [00:01<00:01, 3127.70it/s] 54%|█████▍    | 4532/8322 [00:01<00:01, 3143.39it/s] 58%|█████▊    | 4847/8322 [00:01<00:01, 3037.17it/s] 62%|██████▏   | 5152/8322 [00:01<00:01, 3022.90it/s] 66%|██████▌   | 5467/8322 [00:02<00:00, 3020.77it/s] 69%|██████▉   | 5770/8322 [00:02<00:00, 2959.30it/s] 73%|███████▎  | 6094/8322 [00:02<00:00, 3031.07it/s] 77%|███████▋  | 6424/8322 [00:02<00:00, 3108.64it/s] 81%|████████  | 6736/8322 [00:02<00:00, 3063.76it/s] 85%|████████▍ | 7051/8322 [00:02<00:00, 3078.37it/s] 88%|████████▊ | 7360/8322 [00:02<00:00, 3058.77it/s] 92%|█████████▏| 7678/8322 [00:02<00:00, 3076.38it/s] 96%|█████████▌| 7986/8322 [00:02<00:00, 3062.69it/s]100%|█████████▉| 8295/8322 [00:02<00:00, 3070.68it/s]100%|██████████| 8322/8322 [00:02<00:00, 2780.93it/s]
Size of transfer function: 1.33 MB. 

Size of integrand: 28.0 MB. Time to calculate integrand: 0.46314048767089844 s

Getting spherical harmonics
  0%|          | 0/299454 [00:00<?, ?it/s]  1%|▏         | 3900/299454 [00:00<00:09, 32614.66it/s]  2%|▏         | 7162/299454 [00:00<00:12, 23245.29it/s]  3%|▎         | 9608/299454 [00:00<00:13, 21042.28it/s]  4%|▍         | 11764/299454 [00:00<00:14, 19807.23it/s]  5%|▍         | 14040/299454 [00:00<00:14, 19961.71it/s]  5%|▌         | 16050/299454 [00:00<00:16, 16885.43it/s]  6%|▌         | 17794/299454 [00:00<00:16, 16760.19it/s]  7%|▋         | 19505/299454 [00:01<00:18, 15198.08it/s]  7%|▋         | 21058/299454 [00:01<00:18, 14965.37it/s]  8%|▊         | 22620/299454 [00:01<00:19, 14079.35it/s]  8%|▊         | 24180/299454 [00:01<00:19, 14427.12it/s]  9%|▊         | 26130/299454 [00:01<00:18, 14841.87it/s]  9%|▉         | 27690/299454 [00:01<00:18, 15005.23it/s] 10%|▉         | 29250/299454 [00:01<00:18, 14385.87it/s] 10%|█         | 30810/299454 [00:01<00:18, 14656.24it/s] 11%|█         | 33150/299454 [00:01<00:16, 16288.71it/s] 12%|█▏        | 35490/299454 [00:02<00:15, 17382.03it/s] 13%|█▎        | 37830/299454 [00:02<00:14, 17674.05it/s] 13%|█▎        | 39780/299454 [00:02<00:14, 18075.00it/s] 14%|█▍        | 41590/299454 [00:02<00:14, 17584.13it/s] 14%|█▍        | 43349/299454 [00:02<00:15, 16494.59it/s] 15%|█▌        | 45630/299454 [00:02<00:14, 17449.46it/s] 16%|█▌        | 48360/299454 [00:02<00:12, 20048.04it/s] 17%|█▋        | 50700/299454 [00:02<00:12, 20019.90it/s] 18%|█▊        | 54210/299454 [00:02<00:10, 24077.63it/s] 19%|█▉        | 56667/299454 [00:03<00:10, 23243.26it/s] 20%|█▉        | 59280/299454 [00:03<00:10, 23558.79it/s] 21%|██        | 62010/299454 [00:03<00:09, 24275.95it/s] 22%|██▏       | 64459/299454 [00:03<00:10, 23238.99it/s] 23%|██▎       | 67470/299454 [00:03<00:09, 24178.01it/s] 23%|██▎       | 69900/299454 [00:03<00:09, 23533.40it/s] 24%|██▍       | 72261/299454 [00:03<00:09, 22784.50it/s] 25%|██▌       | 75660/299454 [00:03<00:08, 25746.60it/s] 26%|██▋       | 78780/299454 [00:03<00:08, 25871.27it/s] 27%|██▋       | 81383/299454 [00:04<00:08, 25834.30it/s] 28%|██▊       | 83978/299454 [00:04<00:08, 25414.28it/s] 29%|██▉       | 86580/299454 [00:04<00:08, 24357.00it/s] 30%|██▉       | 89700/299454 [00:04<00:08, 24566.72it/s] 31%|███       | 92163/299454 [00:04<00:09, 22944.64it/s] 32%|███▏      | 95940/299454 [00:04<00:08, 25166.92it/s] 33%|███▎      | 98458/299454 [00:04<00:08, 24580.12it/s] 34%|███▍      | 101400/299454 [00:04<00:07, 24824.47it/s] 35%|███▍      | 103881/299454 [00:05<00:07, 24482.06it/s] 36%|███▌      | 106860/299454 [00:05<00:07, 24472.29it/s] 37%|███▋      | 109980/299454 [00:05<00:07, 25413.54it/s] 38%|███▊      | 112522/299454 [00:05<00:07, 24713.63it/s] 39%|███▊      | 115440/299454 [00:05<00:07, 25191.74it/s] 40%|███▉      | 118560/299454 [00:05<00:06, 25951.51it/s] 41%|████      | 121290/299454 [00:05<00:06, 25654.29it/s] 42%|████▏     | 124410/299454 [00:05<00:06, 25428.08it/s] 42%|████▏     | 127140/299454 [00:05<00:06, 25245.24it/s] 43%|████▎     | 129870/299454 [00:06<00:06, 25605.40it/s] 44%|████▍     | 132434/299454 [00:06<00:06, 25602.00it/s] 45%|████▌     | 134997/299454 [00:06<00:06, 25172.45it/s] 46%|████▌     | 137516/299454 [00:06<00:06, 24416.23it/s] 47%|████▋     | 140400/299454 [00:06<00:06, 24979.87it/s] 48%|████▊     | 142900/299454 [00:06<00:06, 24488.78it/s] 49%|████▊     | 145860/299454 [00:06<00:06, 25302.76it/s] 50%|████▉     | 148590/299454 [00:06<00:05, 25293.73it/s] 51%|█████     | 151320/299454 [00:06<00:05, 25465.75it/s] 51%|█████▏    | 154050/299454 [00:07<00:05, 25435.77it/s] 52%|█████▏    | 156780/299454 [00:07<00:05, 25686.82it/s] 53%|█████▎    | 159437/299454 [00:07<00:05, 25939.88it/s] 54%|█████▍    | 162240/299454 [00:07<00:05, 26071.95it/s] 55%|█████▌    | 164849/299454 [00:07<00:05, 25787.17it/s] 56%|█████▌    | 167429/299454 [00:07<00:05, 25053.92it/s] 57%|█████▋    | 170820/299454 [00:07<00:04, 26697.20it/s] 58%|█████▊    | 173550/299454 [00:07<00:04, 26494.63it/s] 59%|█████▉    | 176197/299454 [00:07<00:04, 25792.19it/s] 60%|█████▉    | 178776/299454 [00:07<00:04, 24822.22it/s] 61%|██████    | 182520/299454 [00:08<00:04, 27366.05it/s] 62%|██████▏   | 185640/299454 [00:08<00:04, 27680.29it/s] 63%|██████▎   | 188406/299454 [00:08<00:04, 26086.27it/s] 64%|██████▍   | 191024/299454 [00:08<00:04, 25687.14it/s] 65%|██████▍   | 193597/299454 [00:08<00:04, 25204.89it/s] 66%|██████▌   | 196170/299454 [00:08<00:04, 24516.80it/s] 67%|██████▋   | 199680/299454 [00:08<00:03, 26765.24it/s] 68%|██████▊   | 202410/299454 [00:08<00:03, 25600.72it/s] 69%|██████▊   | 205140/299454 [00:08<00:03, 25910.20it/s] 69%|██████▉   | 207870/299454 [00:09<00:03, 24771.45it/s] 70%|███████   | 210990/299454 [00:09<00:03, 25759.60it/s] 72%|███████▏  | 214110/299454 [00:09<00:03, 27068.93it/s] 72%|███████▏  | 216834/299454 [00:09<00:03, 25371.69it/s] 73%|███████▎  | 219570/299454 [00:09<00:03, 25088.81it/s] 74%|███████▍  | 222300/299454 [00:09<00:03, 24492.31it/s] 75%|███████▌  | 225030/299454 [00:09<00:03, 24202.10it/s] 76%|███████▋  | 228540/299454 [00:09<00:02, 26007.01it/s] 77%|███████▋  | 231270/299454 [00:09<00:02, 26013.90it/s] 78%|███████▊  | 234000/299454 [00:10<00:02, 25400.31it/s] 79%|███████▉  | 237900/299454 [00:10<00:02, 28631.09it/s] 80%|████████  | 241020/299454 [00:10<00:02, 28089.56it/s] 81%|████████▏ | 243842/299454 [00:10<00:02, 26829.87it/s] 82%|████████▏ | 246538/299454 [00:10<00:02, 24037.66it/s] 83%|████████▎ | 249990/299454 [00:10<00:01, 25620.86it/s] 84%|████████▍ | 252720/299454 [00:10<00:01, 25651.73it/s] 85%|████████▌ | 255314/299454 [00:10<00:01, 24405.36it/s] 86%|████████▌ | 257790/299454 [00:11<00:01, 23892.72it/s] 87%|████████▋ | 260910/299454 [00:11<00:01, 24354.43it/s] 88%|████████▊ | 264420/299454 [00:11<00:01, 25508.81it/s] 89%|████████▉ | 266971/299454 [00:11<00:01, 25118.51it/s] 90%|█████████ | 270660/299454 [00:11<00:01, 27564.13it/s] 91%|█████████▏| 273780/299454 [00:11<00:00, 27475.65it/s] 92%|█████████▏| 276900/299454 [00:11<00:00, 28448.20it/s] 94%|█████████▎| 280020/299454 [00:11<00:00, 28265.92it/s] 94%|█████████▍| 282856/299454 [00:11<00:00, 25147.14it/s] 95%|█████████▌| 285870/299454 [00:12<00:00, 25443.23it/s] 96%|█████████▋| 288600/299454 [00:12<00:00, 25730.61it/s] 97%|█████████▋| 291330/299454 [00:12<00:00, 25307.50it/s] 98%|█████████▊| 294060/299454 [00:12<00:00, 24836.24it/s] 99%|█████████▉| 296560/299454 [00:12<00:00, 24095.91it/s]100%|█████████▉| 298980/299454 [00:12<00:00, 23697.17it/s]100%|██████████| 299454/299454 [00:12<00:00, 23643.69it/s]
The spherical harmonics array is 263.88 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 27.465591192245483 seconds

***********
Calculating a_lm realizations
***********

  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:05<00:00,  5.29s/it]100%|██████████| 1/1 [00:05<00:00,  5.29s/it]

Calculating covariance matrix
  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]Only calculating diagonal
  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]  2%|▏         | 69633/4179066 [00:00<00:56, 72773.07it/s]  5%|▌         | 214801/4179066 [00:01<00:19, 203098.69it/s]  8%|▊         | 341840/4179066 [00:01<00:13, 295124.06it/s] 11%|█         | 466260/4179066 [00:01<00:10, 370333.04it/s] 14%|█▍        | 587079/4179066 [00:01<00:08, 431770.54it/s] 17%|█▋        | 711516/4179066 [00:01<00:07, 487219.89it/s] 20%|██        | 839162/4179066 [00:01<00:06, 537564.69it/s] 23%|██▎       | 969713/4179066 [00:01<00:05, 583565.40it/s] 26%|██▋       | 1098816/4179066 [00:01<00:04, 623486.64it/s] 29%|██▉       | 1229193/4179066 [00:01<00:04, 659768.15it/s] 32%|███▏      | 1354855/4179066 [00:01<00:04, 689936.67it/s] 35%|███▌      | 1479747/4179066 [00:02<00:03, 716790.72it/s] 38%|███▊      | 1604646/4179066 [00:02<00:03, 741133.31it/s] 41%|████▏     | 1728382/4179066 [00:02<00:03, 762816.10it/s] 44%|████▍     | 1851123/4179066 [00:02<00:02, 782224.49it/s] 47%|████▋     | 1973245/4179066 [00:02<00:02, 799807.71it/s] 50%|█████     | 2096742/4179066 [00:02<00:02, 816541.74it/s] 53%|█████▎    | 2219247/4179066 [00:02<00:02, 831640.02it/s] 56%|█████▌    | 2340796/4179066 [00:02<00:02, 845300.09it/s] 59%|█████▉    | 2463516/4179066 [00:02<00:01, 858400.57it/s] 62%|██████▏   | 2586976/4179066 [00:02<00:01, 870866.99it/s] 65%|██████▍   | 2710907/4179066 [00:03<00:01, 882675.02it/s] 68%|██████▊   | 2836122/4179066 [00:03<00:01, 894129.83it/s] 71%|███████   | 2965303/4179066 [00:03<00:01, 906093.66it/s] 74%|███████▍  | 3092735/4179066 [00:03<00:01, 916831.02it/s] 77%|███████▋  | 3224512/4179066 [00:03<00:01, 928189.84it/s] 80%|████████  | 3357926/4179066 [00:03<00:00, 939367.76it/s] 84%|████████▎ | 3496199/4179066 [00:03<00:00, 951261.70it/s] 87%|████████▋ | 3637443/4179066 [00:03<00:00, 963298.94it/s] 91%|█████████ | 3786288/4179066 [00:03<00:00, 976673.98it/s] 95%|█████████▍| 3950351/4179066 [00:03<00:00, 993205.03it/s] 99%|█████████▉| 4152413/4179066 [00:04<00:00, 1018233.66it/s]100%|██████████| 4179066/4179066 [00:04<00:00, 1022467.88it/s]100%|██████████| 4179066/4179066 [00:04<00:00, 1022413.85it/s]100%|██████████| 4179066/4179066 [00:04<00:00, 1022377.77it/s]
Time to calculate C_TT with l_max=20 and c_l_ratio=0.99: 4.088002920150757 seconds with Numba
Power spectrum ratio: [0.87319092 1.01609088 0.98426221 1.0233038  1.01778953 1.01214014
 0.99454383 0.99344142 0.98886641 0.99095279 0.98937858 0.99022122
 0.9900067  0.98979884 0.99043445 0.98938585 0.99064859 0.98924521
 0.99078648]

Calculating covariance matrix
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:33<00:00, 33.58s/it]100%|██████████| 1/1 [00:33<00:00, 33.58s/it]
Calculating KL divergence

Calculating covariance matrix
KL: 26.16121687082011
