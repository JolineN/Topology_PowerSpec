Cubic Torus
Running - E1 l_max=20, Lx=27649
Running {'topology': 'E1', 'Lx': 1.0, 'Ly': 1.0, 'Lz': 1.0, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 14.83it/s] 26%|██▋       | 5/19 [00:00<00:00, 20.77it/s] 42%|████▏     | 8/19 [00:00<00:00, 22.88it/s] 58%|█████▊    | 11/19 [00:00<00:00, 23.83it/s] 74%|███████▎  | 14/19 [00:00<00:00, 24.43it/s] 89%|████████▉ | 17/19 [00:00<00:00, 24.84it/s]100%|██████████| 19/19 [00:00<00:00, 23.71it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 4179066 Minimum k_amp 0.0002272416186438812 n_x_max 100 n_z_max 100
Time to get list of k, phi, theta: 2.927359104156494 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.07165572403020197
Ratio of unique |k|: 0.0019913540489669224
Time to get unique k and theta: 0.9152328968048096 seconds

Getting transfer functions
  0%|          | 0/8322 [00:00<?, ?it/s]  2%|▏         | 176/8322 [00:00<00:04, 1726.45it/s]  4%|▍         | 352/8322 [00:00<00:04, 1704.11it/s]  6%|▋         | 528/8322 [00:00<00:04, 1688.48it/s]  8%|▊         | 697/8322 [00:00<00:04, 1666.32it/s] 10%|█         | 869/8322 [00:00<00:04, 1681.43it/s] 13%|█▎        | 1045/8322 [00:00<00:04, 1700.29it/s] 15%|█▍        | 1216/8322 [00:00<00:04, 1696.70it/s] 17%|█▋        | 1386/8322 [00:00<00:04, 1650.51it/s] 19%|█▉        | 1573/8322 [00:00<00:03, 1691.25it/s] 21%|██        | 1760/8322 [00:01<00:03, 1714.35it/s] 23%|██▎       | 1936/8322 [00:01<00:03, 1715.56it/s] 25%|██▌       | 2112/8322 [00:01<00:03, 1727.34it/s] 28%|██▊       | 2332/8322 [00:01<00:03, 1843.58it/s] 31%|███       | 2574/8322 [00:01<00:02, 1994.23it/s] 34%|███▎      | 2794/8322 [00:01<00:02, 2010.53it/s] 36%|███▋      | 3036/8322 [00:01<00:02, 2129.04it/s] 40%|███▉      | 3289/8322 [00:01<00:02, 2207.50it/s] 43%|████▎     | 3542/8322 [00:01<00:02, 2286.47it/s] 45%|████▌     | 3784/8322 [00:01<00:01, 2301.82it/s] 49%|████▊     | 4048/8322 [00:02<00:01, 2382.20it/s] 52%|█████▏    | 4301/8322 [00:02<00:01, 2405.94it/s] 55%|█████▌    | 4587/8322 [00:02<00:01, 2511.31it/s] 58%|█████▊    | 4840/8322 [00:02<00:01, 2506.18it/s] 62%|██████▏   | 5126/8322 [00:02<00:01, 2588.92it/s] 65%|██████▌   | 5423/8322 [00:02<00:01, 2668.77it/s] 68%|██████▊   | 5698/8322 [00:02<00:00, 2681.10it/s] 72%|███████▏  | 5984/8322 [00:02<00:00, 2717.06it/s] 75%|███████▌  | 6259/8322 [00:02<00:00, 2715.07it/s] 78%|███████▊  | 6531/8322 [00:02<00:00, 2686.66it/s] 82%|████████▏ | 6800/8322 [00:03<00:00, 2627.00it/s] 85%|████████▍ | 7063/8322 [00:03<00:00, 2608.54it/s] 88%|████████▊ | 7326/8322 [00:03<00:00, 2591.77it/s] 92%|█████████▏| 7623/8322 [00:03<00:00, 2682.35it/s] 95%|█████████▍| 7892/8322 [00:03<00:00, 2599.64it/s] 98%|█████████▊| 8153/8322 [00:03<00:00, 2577.56it/s]100%|██████████| 8322/8322 [00:03<00:00, 2253.84it/s]
Size of transfer function: 1.33 MB. 

Size of integrand: 28.0 MB. Time to calculate integrand: 0.4242517948150635 s

Getting spherical harmonics
  0%|          | 0/299454 [00:00<?, ?it/s]  1%|          | 2730/299454 [00:00<00:11, 25386.55it/s]  2%|▏         | 5269/299454 [00:00<00:17, 17272.54it/s]  2%|▏         | 7134/299454 [00:00<00:19, 14807.41it/s]  3%|▎         | 8694/299454 [00:00<00:20, 13961.97it/s]  3%|▎         | 10127/299454 [00:00<00:20, 14055.18it/s]  4%|▍         | 11559/299454 [00:00<00:24, 11937.08it/s]  4%|▍         | 12801/299454 [00:00<00:25, 11386.29it/s]  5%|▍         | 14040/299454 [00:01<00:26, 10636.10it/s]  5%|▌         | 15210/299454 [00:01<00:26, 10584.29it/s]  5%|▌         | 16380/299454 [00:01<00:26, 10552.80it/s]  6%|▌         | 17550/299454 [00:01<00:28, 10003.22it/s]  6%|▌         | 18559/299454 [00:01<00:28, 10019.81it/s]  7%|▋         | 19890/299454 [00:01<00:28, 9874.68it/s]   7%|▋         | 21060/299454 [00:01<00:28, 9766.33it/s]  8%|▊         | 22620/299454 [00:01<00:25, 10906.68it/s]  8%|▊         | 23790/299454 [00:02<00:26, 10277.24it/s]  8%|▊         | 24960/299454 [00:02<00:26, 10324.62it/s]  9%|▊         | 26130/299454 [00:02<00:26, 10494.11it/s]  9%|▉         | 27300/299454 [00:02<00:25, 10760.81it/s] 10%|▉         | 28470/299454 [00:02<00:25, 10582.07it/s] 10%|█         | 30401/299454 [00:02<00:20, 12868.86it/s] 11%|█         | 31707/299454 [00:02<00:22, 11803.08it/s] 11%|█         | 32914/299454 [00:02<00:23, 11445.91it/s] 11%|█▏        | 34077/299454 [00:02<00:25, 10250.99it/s] 12%|█▏        | 35132/299454 [00:03<00:26, 10047.77it/s] 12%|█▏        | 36660/299454 [00:03<00:25, 10497.51it/s] 13%|█▎        | 38610/299454 [00:03<00:21, 12223.42it/s] 13%|█▎        | 40170/299454 [00:03<00:20, 12739.97it/s] 14%|█▍        | 41458/299454 [00:03<00:20, 12770.32it/s] 14%|█▍        | 42745/299454 [00:03<00:20, 12656.02it/s] 15%|█▍        | 44017/299454 [00:03<00:21, 12035.56it/s] 15%|█▌        | 45240/299454 [00:03<00:21, 11962.80it/s] 16%|█▌        | 46441/299454 [00:04<00:23, 10962.52it/s] 16%|█▌        | 47580/299454 [00:04<00:22, 10960.07it/s] 16%|█▋        | 49140/299454 [00:04<00:22, 11212.25it/s] 17%|█▋        | 50700/299454 [00:04<00:20, 12187.03it/s] 17%|█▋        | 52260/299454 [00:04<00:19, 12470.28it/s] 18%|█▊        | 53820/299454 [00:04<00:19, 12632.61it/s] 18%|█▊        | 55380/299454 [00:04<00:19, 12648.55it/s] 19%|█▉        | 56649/299454 [00:04<00:19, 12556.45it/s] 19%|█▉        | 58110/299454 [00:04<00:19, 12304.32it/s] 20%|█▉        | 59670/299454 [00:05<00:18, 12631.08it/s] 20%|██        | 61230/299454 [00:05<00:18, 12543.35it/s] 21%|██        | 62790/299454 [00:05<00:18, 12649.89it/s] 21%|██▏       | 64057/299454 [00:05<00:18, 12586.77it/s] 22%|██▏       | 65910/299454 [00:05<00:17, 13472.72it/s] 23%|██▎       | 67470/299454 [00:05<00:18, 12467.37it/s] 23%|██▎       | 69030/299454 [00:05<00:18, 12683.62it/s] 23%|██▎       | 70309/299454 [00:05<00:18, 12514.68it/s] 24%|██▍       | 71566/299454 [00:06<00:18, 12267.37it/s] 24%|██▍       | 72795/299454 [00:06<00:18, 12270.59it/s] 25%|██▍       | 74100/299454 [00:06<00:19, 11709.99it/s] 25%|██▌       | 75660/299454 [00:06<00:18, 12141.56it/s] 26%|██▌       | 77220/299454 [00:06<00:17, 12731.99it/s] 26%|██▋       | 78780/299454 [00:06<00:16, 13017.34it/s] 27%|██▋       | 80340/299454 [00:06<00:17, 12588.39it/s] 27%|██▋       | 81900/299454 [00:06<00:18, 12020.22it/s] 28%|██▊       | 83113/299454 [00:06<00:18, 11956.48it/s] 28%|██▊       | 85020/299454 [00:07<00:15, 13654.26it/s] 29%|██▉       | 86407/299454 [00:07<00:15, 13679.02it/s] 29%|██▉       | 87790/299454 [00:07<00:15, 13308.86it/s] 30%|██▉       | 89310/299454 [00:07<00:16, 12638.96it/s] 30%|███       | 90590/299454 [00:07<00:16, 12412.81it/s] 31%|███       | 92040/299454 [00:07<00:17, 12158.79it/s] 31%|███▏      | 93600/299454 [00:07<00:17, 11960.35it/s] 32%|███▏      | 94804/299454 [00:07<00:17, 11533.78it/s] 32%|███▏      | 96330/299454 [00:08<00:16, 12129.90it/s] 33%|███▎      | 97890/299454 [00:08<00:16, 12147.90it/s] 33%|███▎      | 99450/299454 [00:08<00:16, 12250.27it/s] 34%|███▎      | 101010/299454 [00:08<00:16, 11857.30it/s] 34%|███▍      | 102570/299454 [00:08<00:16, 11984.46it/s] 35%|███▍      | 104130/299454 [00:08<00:15, 12582.85it/s] 36%|███▌      | 106470/299454 [00:08<00:13, 14307.86it/s] 36%|███▌      | 107901/299454 [00:08<00:13, 13944.34it/s] 36%|███▋      | 109293/299454 [00:09<00:14, 13245.51it/s] 37%|███▋      | 110760/299454 [00:09<00:14, 13057.60it/s] 37%|███▋      | 112064/299454 [00:09<00:14, 12661.35it/s] 38%|███▊      | 113490/299454 [00:09<00:15, 11754.48it/s] 39%|███▊      | 115440/299454 [00:09<00:14, 12895.33it/s] 39%|███▉      | 116736/299454 [00:09<00:14, 12339.40it/s] 39%|███▉      | 118170/299454 [00:09<00:14, 12601.56it/s] 40%|███▉      | 119730/299454 [00:09<00:13, 13017.98it/s] 41%|████      | 121290/299454 [00:09<00:14, 12718.92it/s] 41%|████      | 122850/299454 [00:10<00:13, 13116.16it/s] 42%|████▏     | 124410/299454 [00:10<00:13, 13334.95it/s] 42%|████▏     | 125749/299454 [00:10<00:13, 13099.00it/s] 42%|████▏     | 127140/299454 [00:10<00:13, 13144.57it/s] 43%|████▎     | 128457/299454 [00:10<00:13, 13073.42it/s] 43%|████▎     | 129870/299454 [00:10<00:13, 12458.59it/s] 44%|████▍     | 131430/299454 [00:10<00:13, 12370.32it/s] 44%|████▍     | 132990/299454 [00:10<00:13, 12282.14it/s] 45%|████▌     | 134940/299454 [00:11<00:12, 13431.35it/s] 46%|████▌     | 136503/299454 [00:11<00:11, 14005.61it/s] 46%|████▌     | 138060/299454 [00:11<00:12, 13444.57it/s] 47%|████▋     | 139416/299454 [00:11<00:13, 12205.43it/s] 47%|████▋     | 140790/299454 [00:11<00:13, 12077.98it/s] 47%|████▋     | 142012/299454 [00:11<00:13, 11907.32it/s] 48%|████▊     | 143520/299454 [00:11<00:12, 12742.97it/s] 49%|████▊     | 145860/299454 [00:11<00:10, 15305.20it/s] 49%|████▉     | 147408/299454 [00:11<00:09, 15340.94it/s] 50%|████▉     | 148955/299454 [00:12<00:10, 14766.71it/s] 50%|█████     | 150443/299454 [00:12<00:10, 14037.09it/s] 51%|█████     | 151859/299454 [00:12<00:11, 13412.15it/s] 51%|█████     | 153270/299454 [00:12<00:11, 13084.71it/s] 52%|█████▏    | 155220/299454 [00:12<00:09, 14619.09it/s] 53%|█████▎    | 157560/299454 [00:12<00:08, 15785.28it/s] 53%|█████▎    | 159138/299454 [00:12<00:08, 15754.05it/s] 54%|█████▍    | 161070/299454 [00:12<00:08, 16409.75it/s] 54%|█████▍    | 162713/299454 [00:12<00:09, 14838.52it/s] 55%|█████▍    | 164220/299454 [00:13<00:09, 14822.36it/s] 55%|█████▌    | 166140/299454 [00:13<00:08, 15150.68it/s] 56%|█████▌    | 167665/299454 [00:13<00:09, 14616.86it/s] 56%|█████▋    | 169133/299454 [00:13<00:09, 13054.74it/s] 57%|█████▋    | 170465/299454 [00:13<00:09, 12996.28it/s] 57%|█████▋    | 171990/299454 [00:13<00:09, 13302.31it/s] 58%|█████▊    | 173550/299454 [00:13<00:09, 13141.58it/s] 58%|█████▊    | 174875/299454 [00:13<00:09, 12888.16it/s] 59%|█████▉    | 176670/299454 [00:14<00:09, 12966.69it/s] 60%|█████▉    | 178230/299454 [00:14<00:09, 12256.94it/s] 60%|██████    | 179790/299454 [00:14<00:09, 12459.69it/s] 60%|██████    | 181044/299454 [00:14<00:10, 10849.65it/s] 61%|██████    | 182520/299454 [00:14<00:10, 11276.75it/s] 61%|██████▏   | 184080/299454 [00:14<00:10, 11413.89it/s] 62%|██████▏   | 185640/299454 [00:14<00:09, 12203.44it/s] 63%|██████▎   | 187200/299454 [00:14<00:08, 12940.36it/s] 63%|██████▎   | 188760/299454 [00:15<00:08, 13220.79it/s] 64%|██████▎   | 190320/299454 [00:15<00:08, 13412.56it/s] 64%|██████▍   | 191880/299454 [00:15<00:08, 13137.82it/s] 65%|██████▍   | 193206/299454 [00:15<00:08, 12001.72it/s] 65%|██████▍   | 194426/299454 [00:15<00:09, 11200.47it/s] 65%|██████▌   | 195780/299454 [00:15<00:09, 11060.26it/s] 66%|██████▌   | 197340/299454 [00:15<00:08, 11574.15it/s] 66%|██████▋   | 198510/299454 [00:15<00:08, 11376.72it/s] 67%|██████▋   | 200070/299454 [00:15<00:08, 12198.22it/s] 67%|██████▋   | 202020/299454 [00:16<00:07, 13474.45it/s] 68%|██████▊   | 203372/299454 [00:16<00:07, 12828.37it/s] 68%|██████▊   | 204659/299454 [00:16<00:07, 12602.98it/s] 69%|██████▉   | 206159/299454 [00:16<00:07, 13255.23it/s] 69%|██████▉   | 207870/299454 [00:16<00:06, 14046.39it/s] 70%|██████▉   | 209430/299454 [00:16<00:06, 14264.65it/s] 71%|███████   | 211380/299454 [00:16<00:06, 14669.32it/s] 71%|███████   | 212940/299454 [00:16<00:05, 14537.46it/s] 72%|███████▏  | 214890/299454 [00:16<00:05, 15628.04it/s] 72%|███████▏  | 216457/299454 [00:17<00:05, 14512.28it/s] 73%|███████▎  | 217922/299454 [00:17<00:05, 14048.23it/s] 73%|███████▎  | 219336/299454 [00:17<00:05, 13889.59it/s] 74%|███████▍  | 221130/299454 [00:17<00:05, 14301.70it/s] 74%|███████▍  | 222563/299454 [00:17<00:06, 12733.98it/s] 75%|███████▍  | 223862/299454 [00:17<00:06, 11553.62it/s] 75%|███████▌  | 225046/299454 [00:17<00:06, 10890.85it/s] 76%|███████▌  | 226590/299454 [00:17<00:06, 11853.16it/s] 76%|███████▌  | 228150/299454 [00:18<00:06, 11870.81it/s] 77%|███████▋  | 229710/299454 [00:18<00:05, 12568.48it/s] 77%|███████▋  | 231270/299454 [00:18<00:05, 12892.41it/s] 78%|███████▊  | 232830/299454 [00:18<00:05, 12153.24it/s] 78%|███████▊  | 234390/299454 [00:18<00:05, 12165.77it/s] 79%|███████▉  | 235950/299454 [00:18<00:04, 12969.22it/s] 79%|███████▉  | 237900/299454 [00:18<00:04, 13322.50it/s] 80%|███████▉  | 239246/299454 [00:18<00:04, 13151.68it/s] 80%|████████  | 240569/299454 [00:19<00:04, 12933.80it/s] 81%|████████  | 241866/299454 [00:19<00:04, 12346.96it/s] 81%|████████▏ | 243360/299454 [00:19<00:04, 12436.79it/s] 82%|████████▏ | 244920/299454 [00:19<00:04, 12425.29it/s] 82%|████████▏ | 246480/299454 [00:19<00:04, 12726.03it/s] 83%|████████▎ | 248040/299454 [00:19<00:03, 13242.89it/s] 83%|████████▎ | 249370/299454 [00:19<00:03, 13041.89it/s] 84%|████████▍ | 251160/299454 [00:19<00:03, 13815.54it/s] 84%|████████▍ | 252543/299454 [00:19<00:03, 13549.06it/s] 85%|████████▍ | 253898/299454 [00:20<00:03, 12579.36it/s] 85%|████████▌ | 255165/299454 [00:20<00:03, 12303.63it/s] 86%|████████▌ | 256620/299454 [00:20<00:03, 11817.23it/s] 86%|████████▌ | 258180/299454 [00:20<00:03, 11851.49it/s] 87%|████████▋ | 259371/299454 [00:20<00:03, 11655.19it/s] 87%|████████▋ | 260910/299454 [00:20<00:03, 12290.09it/s] 88%|████████▊ | 262470/299454 [00:20<00:02, 13006.62it/s] 88%|████████▊ | 263779/299454 [00:20<00:02, 12250.96it/s] 89%|████████▊ | 265200/299454 [00:21<00:02, 12285.64it/s] 89%|████████▉ | 266760/299454 [00:21<00:02, 13110.58it/s] 90%|████████▉ | 268710/299454 [00:21<00:02, 14431.25it/s] 90%|█████████ | 270660/299454 [00:21<00:01, 15391.41it/s] 91%|█████████ | 272207/299454 [00:21<00:01, 15393.73it/s] 91%|█████████▏| 273752/299454 [00:21<00:01, 15152.38it/s] 92%|█████████▏| 275340/299454 [00:21<00:01, 15239.90it/s] 92%|█████████▏| 276900/299454 [00:21<00:01, 14748.17it/s] 93%|█████████▎| 279240/299454 [00:21<00:01, 15978.75it/s] 94%|█████████▍| 280829/299454 [00:22<00:01, 14596.22it/s] 94%|█████████▍| 282360/299454 [00:22<00:01, 13409.50it/s] 95%|█████████▍| 283920/299454 [00:22<00:01, 13258.70it/s] 95%|█████████▌| 285480/299454 [00:22<00:01, 13215.24it/s] 96%|█████████▌| 286810/299454 [00:22<00:00, 12866.93it/s] 96%|█████████▌| 288210/299454 [00:22<00:00, 12262.30it/s] 97%|█████████▋| 289442/299454 [00:22<00:00, 10523.75it/s] 97%|█████████▋| 291330/299454 [00:22<00:00, 11829.73it/s] 98%|█████████▊| 292890/299454 [00:23<00:00, 11614.75it/s] 98%|█████████▊| 294450/299454 [00:23<00:00, 11943.42it/s] 99%|█████████▉| 296010/299454 [00:23<00:00, 12802.07it/s] 99%|█████████▉| 297321/299454 [00:23<00:00, 12794.42it/s]100%|█████████▉| 298622/299454 [00:23<00:00, 11756.98it/s]100%|██████████| 299454/299454 [00:23<00:00, 12663.30it/s]
The spherical harmonics array is 263.88 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 41.08743476867676 seconds

***********
Calculating a_lm realizations
***********

  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:04<00:00,  4.79s/it]100%|██████████| 1/1 [00:04<00:00,  4.79s/it]

Calculating covariance matrix
  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]Only calculating diagonal
  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]  0%|          | 0/4179066 [00:00<?, ?it/s]  1%|          | 44167/4179066 [00:00<01:29, 46281.44it/s]  4%|▍         | 182713/4179066 [00:01<00:23, 173179.60it/s]  7%|▋         | 298498/4179066 [00:01<00:15, 258263.05it/s] 10%|▉         | 405236/4179066 [00:01<00:11, 322504.46it/s] 12%|█▏        | 509722/4179066 [00:01<00:09, 375547.40it/s] 15%|█▍        | 611991/4179066 [00:01<00:08, 419742.47it/s] 17%|█▋        | 719471/4179066 [00:01<00:07, 461568.74it/s] 20%|█▉        | 827259/4179066 [00:01<00:06, 498505.50it/s] 22%|██▏       | 940223/4179066 [00:01<00:06, 534158.28it/s] 25%|██▌       | 1059347/4179066 [00:01<00:05, 569268.23it/s] 28%|██▊       | 1180991/4179066 [00:01<00:04, 602054.64it/s] 31%|███▏      | 1310632/4179066 [00:02<00:04, 635512.52it/s] 34%|███▍      | 1438823/4179066 [00:02<00:04, 665180.46it/s] 37%|███▋      | 1565914/4179066 [00:02<00:03, 691721.67it/s] 41%|████      | 1692683/4179066 [00:02<00:03, 715874.47it/s] 44%|████▎     | 1818795/4179066 [00:02<00:03, 737778.53it/s] 47%|████▋     | 1944212/4179066 [00:02<00:02, 757700.44it/s] 50%|████▉     | 2068728/4179066 [00:02<00:02, 775771.45it/s] 53%|█████▎    | 2195728/4179066 [00:02<00:02, 793432.74it/s] 56%|█████▌    | 2320983/4179066 [00:02<00:02, 809238.21it/s] 59%|█████▊    | 2447521/4179066 [00:02<00:02, 824402.77it/s] 62%|██████▏   | 2575536/4179066 [00:03<00:01, 839064.48it/s] 65%|██████▍   | 2702682/4179066 [00:03<00:01, 852512.32it/s] 68%|██████▊   | 2830174/4179066 [00:03<00:01, 865242.22it/s] 71%|███████   | 2961071/4179066 [00:03<00:01, 878201.01it/s] 74%|███████▍  | 3091477/4179066 [00:03<00:01, 890287.64it/s] 77%|███████▋  | 3225104/4179066 [00:03<00:01, 902587.77it/s] 80%|████████  | 3360305/4179066 [00:03<00:00, 914646.30it/s] 84%|████████▍ | 3500131/4179066 [00:03<00:00, 927281.11it/s] 87%|████████▋ | 3643204/4179066 [00:03<00:00, 940098.73it/s] 91%|█████████ | 3795980/4179066 [00:03<00:00, 954705.29it/s] 95%|█████████▍| 3961698/4179066 [00:04<00:00, 971765.65it/s]100%|█████████▉| 4175149/4179066 [00:04<00:00, 999460.95it/s]100%|██████████| 4179066/4179066 [00:04<00:00, 1000120.75it/s]100%|██████████| 4179066/4179066 [00:04<00:00, 1000092.84it/s]100%|██████████| 4179066/4179066 [00:04<00:00, 1000067.40it/s]
Time to calculate C_TT with l_max=20 and c_l_ratio=0.99: 4.179210186004639 seconds with Numba
Power spectrum ratio: [0.90298043 1.02053898 0.99590529 1.08798765 1.08989503 1.05560984
 1.01022383 0.99730725 0.98959268 0.99105505 0.98938726 0.99022324
 0.99000686 0.98979885 0.99043445 0.98938585 0.99064859 0.98924521
 0.99078648]

Calculating covariance matrix
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [01:11<00:00, 71.82s/it]100%|██████████| 1/1 [01:11<00:00, 71.82s/it]
Calculating KL divergence

Calculating covariance matrix
KL: 29.530046065598334
