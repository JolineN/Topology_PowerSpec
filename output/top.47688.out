No shift: True
Running {'topology': 'E2', 'Lx': 1, 'Ly': 1, 'Lz': 1, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 18.72it/s] 26%|██▋       | 5/19 [00:00<00:00, 23.78it/s] 42%|████▏     | 8/19 [00:00<00:00, 25.43it/s] 58%|█████▊    | 11/19 [00:00<00:00, 26.11it/s] 74%|███████▎  | 14/19 [00:00<00:00, 26.60it/s] 89%|████████▉ | 17/19 [00:00<00:00, 26.93it/s]100%|██████████| 19/19 [00:00<00:00, 26.07it/s]
Done. k_max for TT ell_max = 0.02432972231540152 k_max for EE ell_max = 0.08519563282459129
Eigenmode 1: 214
Eigenmode 2: 5140810
E2 Final num of elements: 5140810 Minimum k_amp 0.0002272416186438812 n_x_max 216 n_z_max 430
Size of tilde xi: 156.89 MB.
Shape tilde xi: (5140810, 2) 

Time to get list of k, phi, theta: 5.011282444000244 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.14134348478158112
Ratio of unique |k|: 0.004088266245980692
Time to get unique k and theta: 1.6886677742004395 seconds

Getting transfer functions
  0%|          | 0/21017 [00:00<?, ?it/s]  2%|▏         | 476/21017 [00:00<00:04, 4636.58it/s]  5%|▍         | 952/21017 [00:00<00:04, 4585.37it/s]  7%|▋         | 1411/21017 [00:00<00:04, 4225.06it/s]  9%|▊         | 1837/21017 [00:00<00:04, 3880.27it/s] 11%|█         | 2240/21017 [00:00<00:04, 3798.99it/s] 13%|█▎        | 2716/21017 [00:00<00:04, 4031.11it/s] 15%|█▌        | 3164/21017 [00:00<00:04, 4095.51it/s] 17%|█▋        | 3584/21017 [00:00<00:04, 4088.04it/s] 19%|█▉        | 3995/21017 [00:00<00:04, 4055.79it/s] 21%|██        | 4402/21017 [00:01<00:04, 4003.56it/s] 23%|██▎       | 4803/21017 [00:01<00:04, 3946.02it/s] 25%|██▍       | 5198/21017 [00:01<00:04, 3903.35it/s] 27%|██▋       | 5589/21017 [00:01<00:04, 3854.88it/s] 29%|██▉       | 6160/21017 [00:01<00:03, 4292.69it/s] 32%|███▏      | 6692/21017 [00:01<00:03, 4553.38it/s] 34%|███▍      | 7224/21017 [00:01<00:02, 4745.96it/s] 37%|███▋      | 7728/21017 [00:01<00:02, 4803.97it/s] 39%|███▉      | 8232/21017 [00:01<00:02, 4859.42it/s] 42%|████▏     | 8764/21017 [00:02<00:02, 4985.53it/s] 44%|████▍     | 9263/21017 [00:02<00:02, 4798.14it/s] 46%|████▋     | 9745/21017 [00:02<00:02, 4624.68it/s] 49%|████▊     | 10220/21017 [00:02<00:02, 4636.24it/s] 51%|█████     | 10686/21017 [00:02<00:02, 4609.50it/s] 53%|█████▎    | 11172/21017 [00:02<00:02, 4648.54it/s] 56%|█████▌    | 11788/21017 [00:02<00:01, 5072.52it/s] 59%|█████▉    | 12348/21017 [00:02<00:01, 5082.87it/s] 61%|██████    | 12858/21017 [00:02<00:01, 5043.52it/s] 64%|██████▎   | 13384/21017 [00:02<00:01, 5090.34it/s] 66%|██████▌   | 13894/21017 [00:03<00:01, 4923.56it/s] 68%|██████▊   | 14388/21017 [00:03<00:01, 4627.75it/s] 71%|███████   | 14855/21017 [00:03<00:01, 4532.47it/s] 73%|███████▎  | 15311/21017 [00:03<00:01, 4473.43it/s] 75%|███████▌  | 15764/21017 [00:03<00:01, 4465.07it/s] 78%|███████▊  | 16296/21017 [00:03<00:01, 4685.05it/s] 80%|████████  | 16828/21017 [00:03<00:00, 4820.24it/s] 83%|████████▎ | 17416/21017 [00:03<00:00, 5093.65it/s] 85%|████████▌ | 17948/21017 [00:03<00:00, 5103.41it/s] 88%|████████▊ | 18480/21017 [00:04<00:00, 5155.72it/s] 91%|█████████ | 19096/21017 [00:04<00:00, 5369.40it/s] 94%|█████████▎| 19684/21017 [00:04<00:00, 5510.14it/s] 96%|█████████▋| 20244/21017 [00:04<00:00, 5481.16it/s] 99%|█████████▉| 20832/21017 [00:04<00:00, 5542.04it/s]100%|██████████| 21017/21017 [00:04<00:00, 4705.38it/s]
Size of transfer function: 3.37 MB. 

Size of integrand: 70.71 MB. Time to calculate integrand: 0.2511005401611328 s

Getting spherical harmonics
  0%|          | 0/726620 [00:00<?, ?it/s]  1%|          | 6741/726620 [00:00<00:10, 67396.25it/s]  2%|▏         | 13481/726620 [00:00<00:23, 30603.32it/s]  2%|▏         | 17559/726620 [00:00<00:26, 27107.28it/s]  3%|▎         | 20786/726620 [00:00<00:25, 27820.91it/s]  3%|▎         | 23919/726620 [00:00<00:27, 25550.51it/s]  4%|▎         | 26682/726620 [00:00<00:29, 23745.13it/s]  4%|▍         | 29177/726620 [00:01<00:30, 22791.71it/s]  4%|▍         | 31521/726620 [00:01<00:35, 19562.58it/s]  5%|▍         | 33557/726620 [00:01<00:36, 19083.18it/s]  5%|▍         | 35510/726620 [00:01<00:38, 17933.31it/s]  5%|▌         | 37880/726620 [00:01<00:37, 18583.36it/s]  5%|▌         | 39774/726620 [00:01<00:36, 18581.41it/s]  6%|▌         | 42615/726620 [00:01<00:33, 20502.73it/s]  6%|▋         | 45456/726620 [00:01<00:31, 21591.17it/s]  7%|▋         | 48297/726620 [00:02<00:30, 21890.46it/s]  7%|▋         | 51138/726620 [00:02<00:29, 22594.02it/s]  7%|▋         | 53979/726620 [00:02<00:30, 21983.47it/s]  8%|▊         | 56820/726620 [00:02<00:29, 22531.02it/s]  8%|▊         | 59661/726620 [00:02<00:27, 23871.59it/s]  9%|▊         | 62502/726620 [00:02<00:28, 23625.30it/s]  9%|▉         | 65343/726620 [00:02<00:30, 21878.30it/s]  9%|▉         | 67571/726620 [00:02<00:30, 21966.23it/s] 10%|▉         | 70078/726620 [00:03<00:31, 21017.74it/s] 10%|█         | 72919/726620 [00:03<00:31, 20596.85it/s] 10%|█         | 75760/726620 [00:03<00:31, 20379.50it/s] 11%|█         | 78601/726620 [00:03<00:29, 21887.61it/s] 11%|█         | 80827/726620 [00:03<00:29, 21788.58it/s] 11%|█▏        | 83031/726620 [00:03<00:29, 21688.77it/s] 12%|█▏        | 85230/726620 [00:03<00:29, 21384.41it/s] 12%|█▏        | 88071/726620 [00:03<00:28, 22339.87it/s] 12%|█▏        | 90310/726620 [00:04<00:29, 21917.86it/s] 13%|█▎        | 93753/726620 [00:04<00:28, 22581.25it/s] 13%|█▎        | 96594/726620 [00:04<00:29, 21622.98it/s] 14%|█▎        | 99435/726620 [00:04<00:28, 21693.50it/s] 14%|█▍        | 102276/726620 [00:04<00:26, 23153.58it/s] 14%|█▍        | 105117/726620 [00:04<00:26, 23698.43it/s] 15%|█▍        | 108905/726620 [00:04<00:24, 25506.29it/s] 15%|█▌        | 111746/726620 [00:04<00:25, 23899.74it/s] 16%|█▌        | 115534/726620 [00:05<00:23, 26297.26it/s] 16%|█▋        | 118190/726620 [00:05<00:24, 24997.31it/s] 17%|█▋        | 121216/726620 [00:05<00:25, 23910.25it/s] 17%|█▋        | 124057/726620 [00:05<00:26, 22754.09it/s] 18%|█▊        | 127845/726620 [00:05<00:23, 25350.34it/s] 18%|█▊        | 130686/726620 [00:05<00:22, 26053.41it/s] 18%|█▊        | 133330/726620 [00:05<00:23, 25784.93it/s] 19%|█▊        | 135933/726620 [00:05<00:22, 25719.81it/s] 19%|█▉        | 138522/726620 [00:05<00:23, 25567.73it/s] 19%|█▉        | 141103/726620 [00:06<00:24, 23829.98it/s] 20%|█▉        | 143944/726620 [00:06<00:23, 24743.87it/s] 20%|██        | 146785/726620 [00:06<00:22, 25406.72it/s] 21%|██        | 149626/726620 [00:06<00:24, 23962.09it/s] 21%|██        | 153414/726620 [00:06<00:21, 26087.28it/s] 22%|██▏       | 157202/726620 [00:06<00:21, 26666.96it/s] 22%|██▏       | 160091/726620 [00:06<00:20, 27237.81it/s] 22%|██▏       | 162884/726620 [00:06<00:21, 26162.30it/s] 23%|██▎       | 166672/726620 [00:07<00:21, 25602.76it/s] 23%|██▎       | 169513/726620 [00:07<00:22, 24312.41it/s] 24%|██▍       | 173301/726620 [00:07<00:20, 27245.21it/s] 24%|██▍       | 176142/726620 [00:07<00:20, 27155.58it/s] 25%|██▍       | 178983/726620 [00:07<00:20, 27252.87it/s] 25%|██▌       | 181824/726620 [00:07<00:20, 26689.49it/s] 25%|██▌       | 184665/726620 [00:07<00:20, 26223.83it/s] 26%|██▌       | 188453/726620 [00:07<00:19, 27621.70it/s] 26%|██▋       | 191294/726620 [00:07<00:19, 26950.71it/s] 27%|██▋       | 194135/726620 [00:08<00:20, 25415.32it/s] 27%|██▋       | 197923/726620 [00:08<00:20, 26282.72it/s] 28%|██▊       | 200764/726620 [00:08<00:20, 25436.95it/s] 28%|██▊       | 203307/726620 [00:08<00:20, 25036.18it/s] 28%|██▊       | 205806/726620 [00:08<00:20, 24870.70it/s] 29%|██▊       | 208340/726620 [00:08<00:21, 23807.46it/s] 29%|██▉       | 210721/726620 [00:08<00:22, 23401.55it/s] 29%|██▉       | 213075/726620 [00:08<00:22, 22894.11it/s] 30%|██▉       | 215916/726620 [00:09<00:22, 23109.61it/s] 30%|███       | 219704/726620 [00:09<00:19, 26675.57it/s] 31%|███       | 224439/726620 [00:09<00:16, 30866.18it/s] 31%|███▏      | 227521/726620 [00:09<00:18, 27194.52it/s] 32%|███▏      | 230299/726620 [00:09<00:18, 26932.88it/s] 32%|███▏      | 233030/726620 [00:09<00:18, 26134.61it/s] 32%|███▏      | 235803/726620 [00:09<00:19, 25191.75it/s] 33%|███▎      | 239591/726620 [00:09<00:18, 27014.33it/s] 33%|███▎      | 242432/726620 [00:09<00:18, 25571.41it/s] 34%|███▍      | 245273/726620 [00:10<00:18, 26298.52it/s] 34%|███▍      | 248114/726620 [00:10<00:19, 25015.13it/s] 35%|███▍      | 251902/726620 [00:10<00:17, 27222.83it/s] 35%|███▌      | 254743/726620 [00:10<00:17, 26955.25it/s] 36%|███▌      | 258531/726620 [00:10<00:16, 27991.52it/s] 36%|███▌      | 261372/726620 [00:10<00:17, 26482.04it/s] 36%|███▋      | 265160/726620 [00:10<00:16, 28752.17it/s] 37%|███▋      | 268054/726620 [00:10<00:17, 26103.62it/s] 37%|███▋      | 271789/726620 [00:11<00:16, 28130.90it/s] 38%|███▊      | 274646/726620 [00:11<00:16, 27537.81it/s] 38%|███▊      | 277471/726620 [00:11<00:16, 27523.75it/s] 39%|███▊      | 281259/726620 [00:11<00:16, 27182.11it/s] 39%|███▉      | 284100/726620 [00:11<00:17, 25695.41it/s] 39%|███▉      | 286941/726620 [00:11<00:18, 24325.16it/s] 40%|███▉      | 289782/726620 [00:11<00:18, 23457.89it/s] 40%|████      | 293570/726620 [00:11<00:16, 25661.07it/s] 41%|████      | 296411/726620 [00:12<00:16, 25963.18it/s] 41%|████      | 299252/726620 [00:12<00:16, 25857.83it/s] 42%|████▏     | 302093/726620 [00:12<00:16, 25452.46it/s] 42%|████▏     | 305881/726620 [00:12<00:15, 28033.57it/s] 43%|████▎     | 309669/726620 [00:12<00:14, 28428.82it/s] 43%|████▎     | 313457/726620 [00:12<00:14, 29266.19it/s] 44%|████▎     | 316389/726620 [00:12<00:16, 25515.04it/s] 44%|████▍     | 320086/726620 [00:12<00:14, 28207.28it/s] 45%|████▍     | 323874/726620 [00:12<00:13, 30096.43it/s] 45%|████▌     | 327662/726620 [00:13<00:13, 30655.26it/s] 46%|████▌     | 331450/726620 [00:13<00:13, 29911.47it/s] 46%|████▌     | 334490/726620 [00:13<00:13, 28625.63it/s] 46%|████▋     | 337384/726620 [00:13<00:13, 28478.75it/s] 47%|████▋     | 340252/726620 [00:13<00:14, 26578.72it/s] 47%|████▋     | 342936/726620 [00:13<00:15, 25403.41it/s] 48%|████▊     | 345655/726620 [00:13<00:15, 23854.36it/s] 48%|████▊     | 348064/726620 [00:13<00:16, 23283.64it/s] 48%|████▊     | 351337/726620 [00:14<00:15, 24085.32it/s] 49%|████▊     | 354178/726620 [00:14<00:15, 24662.35it/s] 49%|████▉     | 357019/726620 [00:14<00:14, 25107.96it/s] 50%|████▉     | 359861/726620 [00:14<00:14, 26007.38it/s] 50%|████▉     | 362701/726620 [00:14<00:14, 25398.39it/s] 50%|█████     | 365542/726620 [00:14<00:14, 25187.59it/s] 51%|█████     | 370277/726620 [00:14<00:12, 27970.68it/s] 51%|█████▏    | 373118/726620 [00:14<00:13, 25929.89it/s] 52%|█████▏    | 375959/726620 [00:15<00:14, 24160.00it/s] 52%|█████▏    | 379747/726620 [00:15<00:12, 26710.36it/s] 53%|█████▎    | 382447/726620 [00:15<00:12, 26478.60it/s] 53%|█████▎    | 385429/726620 [00:15<00:14, 22906.63it/s] 54%|█████▎    | 389217/726620 [00:15<00:13, 24662.65it/s] 54%|█████▍    | 393005/726620 [00:15<00:12, 26891.02it/s] 54%|█████▍    | 395846/726620 [00:15<00:12, 25544.64it/s] 55%|█████▌    | 400581/726620 [00:15<00:10, 29821.54it/s] 56%|█████▌    | 403629/726620 [00:16<00:11, 29227.94it/s] 56%|█████▌    | 406593/726620 [00:16<00:11, 28220.79it/s] 56%|█████▋    | 410051/726620 [00:16<00:10, 28834.20it/s] 57%|█████▋    | 412954/726620 [00:16<00:11, 26816.98it/s] 57%|█████▋    | 416680/726620 [00:16<00:11, 28155.93it/s] 58%|█████▊    | 419516/726620 [00:16<00:11, 27877.99it/s] 58%|█████▊    | 422315/726620 [00:16<00:12, 24059.04it/s] 58%|█████▊    | 424802/726620 [00:16<00:13, 21790.26it/s] 59%|█████▉    | 428991/726620 [00:17<00:11, 25491.25it/s] 60%|█████▉    | 432779/726620 [00:17<00:11, 26231.16it/s] 60%|█████▉    | 435620/726620 [00:17<00:10, 26636.27it/s] 60%|██████    | 439408/726620 [00:17<00:10, 27484.42it/s] 61%|██████    | 442249/726620 [00:17<00:10, 27441.67it/s] 61%|██████▏   | 445090/726620 [00:17<00:10, 26909.01it/s] 62%|██████▏   | 447931/726620 [00:17<00:11, 24960.78it/s] 62%|██████▏   | 450455/726620 [00:17<00:11, 24574.64it/s] 62%|██████▏   | 452928/726620 [00:17<00:11, 23469.32it/s] 63%|██████▎   | 456454/726620 [00:18<00:11, 24437.01it/s] 63%|██████▎   | 460242/726620 [00:18<00:09, 27634.89it/s] 64%|██████▍   | 464977/726620 [00:18<00:08, 31240.37it/s] 64%|██████▍   | 468122/726620 [00:18<00:08, 30631.68it/s] 65%|██████▍   | 471196/726620 [00:18<00:08, 30560.85it/s] 65%|██████▌   | 474259/726620 [00:18<00:08, 28600.63it/s] 66%|██████▌   | 477140/726620 [00:18<00:09, 25497.71it/s] 66%|██████▌   | 480129/726620 [00:18<00:10, 24136.54it/s] 66%|██████▋   | 482970/726620 [00:19<00:09, 24710.24it/s] 67%|██████▋   | 485811/726620 [00:19<00:09, 24165.92it/s] 67%|██████▋   | 488652/726620 [00:19<00:10, 23730.51it/s] 68%|██████▊   | 491493/726620 [00:19<00:09, 24619.11it/s] 68%|██████▊   | 494334/726620 [00:19<00:09, 23342.05it/s] 68%|██████▊   | 497175/726620 [00:19<00:09, 23094.27it/s] 69%|██████▉   | 500016/726620 [00:19<00:09, 23603.17it/s] 69%|██████▉   | 502857/726620 [00:19<00:09, 24106.34it/s] 70%|██████▉   | 506645/726620 [00:20<00:08, 24564.26it/s] 70%|███████   | 509486/726620 [00:20<00:08, 25214.57it/s] 71%|███████   | 513274/726620 [00:20<00:07, 28134.85it/s] 71%|███████   | 517062/726620 [00:20<00:07, 28918.78it/s] 72%|███████▏  | 519979/726620 [00:20<00:08, 25823.41it/s] 72%|███████▏  | 523691/726620 [00:20<00:07, 28256.41it/s] 73%|███████▎  | 527479/726620 [00:20<00:06, 30226.32it/s] 73%|███████▎  | 531267/726620 [00:20<00:06, 30965.44it/s] 74%|███████▎  | 535055/726620 [00:20<00:06, 30668.68it/s] 74%|███████▍  | 538158/726620 [00:21<00:06, 28517.22it/s] 75%|███████▍  | 541684/726620 [00:21<00:06, 27733.77it/s] 75%|███████▍  | 544525/726620 [00:21<00:06, 27321.59it/s] 75%|███████▌  | 547366/726620 [00:21<00:06, 26852.06it/s] 76%|███████▌  | 551154/726620 [00:21<00:06, 28368.48it/s] 76%|███████▋  | 554942/726620 [00:21<00:05, 29185.54it/s] 77%|███████▋  | 558730/726620 [00:21<00:05, 28422.40it/s] 77%|███████▋  | 561582/726620 [00:21<00:06, 25296.45it/s] 78%|███████▊  | 564412/726620 [00:22<00:06, 25338.50it/s] 78%|███████▊  | 567253/726620 [00:22<00:06, 25920.83it/s] 78%|███████▊  | 570094/726620 [00:22<00:06, 24171.76it/s] 79%|███████▉  | 572935/726620 [00:22<00:06, 24599.21it/s] 79%|███████▉  | 575425/726620 [00:22<00:06, 24038.93it/s] 80%|███████▉  | 578617/726620 [00:22<00:05, 25025.71it/s] 80%|████████  | 582405/726620 [00:22<00:05, 27384.53it/s] 81%|████████  | 586193/726620 [00:22<00:04, 28146.73it/s] 81%|████████  | 589034/726620 [00:23<00:04, 27746.22it/s] 81%|████████▏ | 591875/726620 [00:23<00:04, 27402.82it/s] 82%|████████▏ | 595320/726620 [00:23<00:04, 29338.45it/s] 82%|████████▏ | 598270/726620 [00:23<00:04, 27898.26it/s] 83%|████████▎ | 601080/726620 [00:23<00:04, 27890.67it/s] 83%|████████▎ | 604186/726620 [00:23<00:04, 26008.77it/s] 84%|████████▎ | 607027/726620 [00:23<00:04, 25688.73it/s] 84%|████████▍ | 609868/726620 [00:23<00:04, 25198.90it/s] 84%|████████▍ | 612709/726620 [00:23<00:04, 25248.43it/s] 85%|████████▍ | 616497/726620 [00:24<00:04, 26372.70it/s] 85%|████████▌ | 619338/726620 [00:24<00:04, 26711.56it/s] 86%|████████▌ | 622013/726620 [00:24<00:03, 26680.89it/s] 86%|████████▌ | 624684/726620 [00:24<00:04, 23968.56it/s] 86%|████████▋ | 627123/726620 [00:24<00:04, 22940.95it/s] 87%|████████▋ | 630702/726620 [00:24<00:03, 25659.42it/s] 87%|████████▋ | 633305/726620 [00:24<00:03, 25740.48it/s] 88%|████████▊ | 636384/726620 [00:24<00:03, 23510.15it/s] 88%|████████▊ | 639225/726620 [00:25<00:03, 24387.34it/s] 88%|████████▊ | 642066/726620 [00:25<00:03, 25386.05it/s] 89%|████████▉ | 644907/726620 [00:25<00:03, 23205.61it/s] 89%|████████▉ | 647748/726620 [00:25<00:03, 23573.18it/s] 90%|████████▉ | 650589/726620 [00:25<00:03, 24599.83it/s] 90%|█████████ | 654377/726620 [00:25<00:02, 26603.64it/s] 90%|█████████ | 657218/726620 [00:25<00:02, 26870.76it/s] 91%|█████████ | 660059/726620 [00:25<00:02, 25149.50it/s] 91%|█████████▏| 663847/726620 [00:25<00:02, 27509.65it/s] 92%|█████████▏| 666688/726620 [00:26<00:02, 26409.19it/s] 92%|█████████▏| 669529/726620 [00:26<00:02, 25514.25it/s] 93%|█████████▎| 672370/726620 [00:26<00:02, 23530.82it/s] 93%|█████████▎| 676158/726620 [00:26<00:01, 25859.84it/s] 93%|█████████▎| 678999/726620 [00:26<00:01, 26139.71it/s] 94%|█████████▍| 681840/726620 [00:26<00:01, 25562.03it/s] 94%|█████████▍| 684681/726620 [00:26<00:01, 24434.84it/s] 95%|█████████▍| 687522/726620 [00:26<00:01, 24205.94it/s] 95%|█████████▌| 691310/726620 [00:27<00:01, 26308.70it/s] 96%|█████████▌| 695098/726620 [00:27<00:01, 28692.69it/s] 96%|█████████▌| 697994/726620 [00:27<00:01, 27510.51it/s] 96%|█████████▋| 700780/726620 [00:27<00:00, 26678.40it/s] 97%|█████████▋| 703621/726620 [00:27<00:00, 25623.81it/s] 97%|█████████▋| 708356/726620 [00:27<00:00, 28948.50it/s] 98%|█████████▊| 711234/726620 [00:27<00:00, 26567.12it/s] 98%|█████████▊| 714038/726620 [00:27<00:00, 25505.79it/s] 99%|█████████▊| 716879/726620 [00:27<00:00, 25725.65it/s] 99%|█████████▉| 719720/726620 [00:28<00:00, 26013.39it/s] 99%|█████████▉| 722561/726620 [00:28<00:00, 25841.87it/s]100%|█████████▉| 726349/726620 [00:28<00:00, 25993.84it/s]100%|██████████| 726620/726620 [00:28<00:00, 25624.80it/s]
The spherical harmonics array is 640.29 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 56.88930559158325 seconds

***********
Calculating a_lm realizations
***********

  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:10<00:00, 10.69s/it]100%|██████████| 1/1 [00:10<00:00, 10.69s/it]

Calculating covariance matrix
  0%|          | 0/5140810 [00:00<?, ?it/s]  0%|          | 0/5140810 [00:00<?, ?it/s]Only calculating diagonal
  0%|          | 0/5140810 [00:00<?, ?it/s]  0%|          | 0/5140810 [00:00<?, ?it/s]  0%|          | 0/5140810 [00:00<?, ?it/s]  0%|          | 0/5140810 [00:00<?, ?it/s]  0%|          | 0/5140810 [00:00<?, ?it/s]  0%|          | 0/5140810 [00:00<?, ?it/s]  0%|          | 0/5140810 [00:00<?, ?it/s]  1%|          | 31129/5140810 [00:00<02:39, 32107.33it/s]  2%|▏         | 78915/5140810 [00:01<01:08, 73735.93it/s]  2%|▏         | 121320/5140810 [00:01<00:48, 103604.94it/s]  3%|▎         | 160650/5140810 [00:01<00:39, 126325.53it/s]  4%|▍         | 198640/5140810 [00:01<00:34, 144733.96it/s]  5%|▍         | 235731/5140810 [00:01<00:30, 160012.84it/s]  5%|▌         | 272441/5140810 [00:01<00:28, 173094.48it/s]  6%|▌         | 309844/5140810 [00:01<00:26, 185019.76it/s]  7%|▋         | 348061/5140810 [00:01<00:24, 196050.53it/s]  8%|▊         | 386732/5140810 [00:01<00:23, 206136.00it/s]  8%|▊         | 425532/5140810 [00:01<00:21, 215262.07it/s]  9%|▉         | 464935/5140810 [00:02<00:20, 223792.98it/s] 10%|▉         | 505757/5140810 [00:02<00:19, 232187.85it/s] 11%|█         | 547788/5140810 [00:02<00:19, 240370.25it/s] 11%|█▏        | 585596/5140810 [00:02<00:18, 246083.78it/s] 12%|█▏        | 625226/5140810 [00:02<00:17, 252070.35it/s] 13%|█▎        | 664091/5140810 [00:02<00:17, 257288.82it/s] 14%|█▎        | 700725/5140810 [00:02<00:16, 261285.98it/s] 14%|█▍        | 737012/5140810 [00:02<00:16, 264865.75it/s] 15%|█▌        | 774618/5140810 [00:02<00:16, 268654.81it/s] 16%|█▌        | 808474/5140810 [00:02<00:15, 270930.01it/s] 16%|█▋        | 843491/5140810 [00:03<00:15, 273433.59it/s] 17%|█▋        | 880907/5140810 [00:03<00:15, 276530.42it/s] 18%|█▊        | 913858/5140810 [00:03<00:15, 278080.40it/s] 18%|█▊        | 946771/5140810 [00:03<00:15, 279525.36it/s] 19%|█▉        | 979843/5140810 [00:03<00:14, 280934.08it/s] 20%|█▉        | 1013277/5140810 [00:03<00:14, 282362.55it/s] 20%|██        | 1047827/5140810 [00:03<00:14, 284017.78it/s] 21%|██        | 1082279/5140810 [00:03<00:14, 285557.65it/s] 22%|██▏       | 1114065/5140810 [00:03<00:14, 286333.67it/s] 22%|██▏       | 1145857/5140810 [00:03<00:13, 287070.55it/s] 23%|██▎       | 1177513/5140810 [00:04<00:13, 287739.71it/s] 24%|██▎       | 1208973/5140810 [00:04<00:13, 288328.46it/s] 24%|██▍       | 1240377/5140810 [00:04<00:13, 288877.80it/s] 25%|██▍       | 1271582/5140810 [00:04<00:13, 289355.74it/s] 25%|██▌       | 1302648/5140810 [00:04<00:13, 289783.32it/s] 26%|██▌       | 1333695/5140810 [00:04<00:13, 290186.91it/s] 27%|██▋       | 1364738/5140810 [00:04<00:12, 290571.09it/s] 27%|██▋       | 1395704/5140810 [00:04<00:12, 290924.66it/s] 28%|██▊       | 1426543/5140810 [00:04<00:12, 291236.28it/s] 28%|██▊       | 1456872/5140810 [00:04<00:12, 291433.06it/s] 29%|██▉       | 1484627/5140810 [00:05<00:12, 291117.17it/s] 29%|██▉       | 1513610/5140810 [00:05<00:12, 291049.83it/s] 30%|███       | 1543302/5140810 [00:05<00:12, 291120.63it/s] 31%|███       | 1573295/5140810 [00:05<00:12, 291243.56it/s] 31%|███       | 1603499/5140810 [00:05<00:12, 291398.09it/s] 32%|███▏      | 1633690/5140810 [00:05<00:12, 291546.48it/s] 32%|███▏      | 1663986/5140810 [00:05<00:11, 291709.08it/s] 33%|███▎      | 1694320/5140810 [00:05<00:11, 291871.55it/s] 34%|███▎      | 1723652/5140810 [00:05<00:11, 291860.13it/s] 34%|███▍      | 1749747/5140810 [00:06<00:11, 291310.09it/s] 35%|███▍      | 1778772/5140810 [00:06<00:11, 291255.25it/s] 35%|███▌      | 1807680/5140810 [00:06<00:11, 291175.42it/s] 36%|███▌      | 1837629/5140810 [00:06<00:11, 291269.65it/s] 36%|███▋      | 1867688/5140810 [00:06<00:11, 291381.87it/s] 37%|███▋      | 1897745/5140810 [00:06<00:11, 291489.50it/s] 37%|███▋      | 1922986/5140810 [00:06<00:11, 290866.47it/s] 38%|███▊      | 1951486/5140810 [00:06<00:10, 290746.98it/s] 39%|███▊      | 1980953/5140810 [00:06<00:10, 290772.63it/s] 39%|███▉      | 2010682/5140810 [00:06<00:10, 290836.28it/s] 40%|███▉      | 2040699/5140810 [00:07<00:10, 290938.67it/s] 40%|████      | 2068062/5140810 [00:07<00:10, 290664.92it/s] 41%|████      | 2094564/5140810 [00:07<00:10, 290278.58it/s] 41%|████▏     | 2123565/5140810 [00:07<00:10, 290246.26it/s] 42%|████▏     | 2153168/5140810 [00:07<00:10, 290295.03it/s] 42%|████▏     | 2182893/5140810 [00:07<00:10, 290359.46it/s] 43%|████▎     | 2211221/5140810 [00:07<00:10, 290238.33it/s] 44%|████▎     | 2236710/5140810 [00:07<00:10, 289753.39it/s] 44%|████▍     | 2265550/5140810 [00:07<00:09, 289708.74it/s] 45%|████▍     | 2295067/5140810 [00:07<00:09, 289751.36it/s] 45%|████▌     | 2324425/5140810 [00:08<00:09, 289752.62it/s] 46%|████▌     | 2351708/5140810 [00:08<00:09, 289507.85it/s] 46%|████▋     | 2378082/5140810 [00:08<00:09, 289169.84it/s] 47%|████▋     | 2406897/5140810 [00:08<00:09, 289132.53it/s] 47%|████▋     | 2436209/5140810 [00:08<00:09, 289155.88it/s] 48%|████▊     | 2465977/5140810 [00:08<00:09, 289231.85it/s] 48%|████▊     | 2491205/5140810 [00:08<00:09, 288779.51it/s] 49%|████▉     | 2518936/5140810 [00:08<00:09, 288625.09it/s] 50%|████▉     | 2548415/5140810 [00:08<00:08, 288671.39it/s] 50%|█████     | 2578418/5140810 [00:08<00:08, 288775.94it/s] 51%|█████     | 2608190/5140810 [00:09<00:08, 288851.80it/s] 51%|█████     | 2632609/5140810 [00:09<00:08, 288340.44it/s] 52%|█████▏    | 2661079/5140810 [00:09<00:08, 288278.50it/s] 52%|█████▏    | 2690259/5140810 [00:09<00:08, 288293.82it/s] 53%|█████▎    | 2719954/5140810 [00:09<00:08, 288364.25it/s] 53%|█████▎    | 2746590/5140810 [00:09<00:08, 288111.57it/s] 54%|█████▍    | 2773283/5140810 [00:09<00:08, 287870.72it/s] 55%|█████▍    | 2802139/5140810 [00:09<00:08, 287857.23it/s] 55%|█████▌    | 2831812/5140810 [00:09<00:08, 287926.45it/s] 56%|█████▌    | 2861590/5140810 [00:09<00:07, 288004.99it/s] 56%|█████▌    | 2886194/5140810 [00:10<00:07, 287565.62it/s] 57%|█████▋    | 2914430/5140810 [00:10<00:07, 287494.52it/s] 57%|█████▋    | 2943574/5140810 [00:10<00:07, 287512.87it/s] 58%|█████▊    | 2973351/5140810 [00:10<00:07, 287592.76it/s] 58%|█████▊    | 3003205/5140810 [00:10<00:07, 287678.43it/s] 59%|█████▉    | 3027440/5140810 [00:10<00:07, 287228.84it/s] 59%|█████▉    | 3056270/5140810 [00:10<00:07, 287219.93it/s] 60%|██████    | 3085610/5140810 [00:10<00:07, 287258.24it/s] 61%|██████    | 3115410/5140810 [00:10<00:07, 287339.02it/s] 61%|██████    | 3145301/5140810 [00:10<00:06, 287425.70it/s] 62%|██████▏   | 3169872/5140810 [00:11<00:06, 287029.43it/s] 62%|██████▏   | 3198531/5140810 [00:11<00:06, 287007.73it/s] 63%|██████▎   | 3228122/5140810 [00:11<00:06, 287068.27it/s] 63%|██████▎   | 3257997/5140810 [00:11<00:06, 287153.68it/s] 64%|██████▍   | 3288123/5140810 [00:11<00:06, 287259.02it/s] 64%|██████▍   | 3314362/5140810 [00:11<00:06, 287026.48it/s] 65%|██████▌   | 3342298/5140810 [00:11<00:06, 286943.10it/s] 66%|██████▌   | 3371826/5140810 [00:11<00:06, 286996.88it/s] 66%|██████▌   | 3401676/5140810 [00:11<00:06, 287077.42it/s] 67%|██████▋   | 3431838/5140810 [00:11<00:05, 287182.04it/s] 67%|██████▋   | 3462138/5140810 [00:12<00:05, 287296.62it/s] 68%|██████▊   | 3491625/5140810 [00:12<00:05, 287342.62it/s] 68%|██████▊   | 3518067/5140810 [00:12<00:05, 287138.95it/s] 69%|██████▉   | 3547291/5140810 [00:12<00:05, 287163.68it/s] 70%|██████▉   | 3577420/5140810 [00:12<00:05, 287260.78it/s] 70%|███████   | 3607545/5140810 [00:12<00:05, 287355.34it/s] 71%|███████   | 3638112/5140810 [00:12<00:05, 287483.01it/s] 71%|███████▏  | 3668630/5140810 [00:12<00:05, 287605.16it/s] 72%|███████▏  | 3699452/5140810 [00:12<00:05, 287748.73it/s] 73%|███████▎  | 3730064/5140810 [00:12<00:04, 287874.24it/s] 73%|███████▎  | 3760896/5140810 [00:13<00:04, 288014.44it/s] 74%|███████▍  | 3791894/5140810 [00:13<00:04, 288164.35it/s] 74%|███████▍  | 3821619/5140810 [00:13<00:04, 288216.73it/s] 75%|███████▍  | 3851507/5140810 [00:13<00:04, 288280.91it/s] 76%|███████▌  | 3882506/5140810 [00:13<00:04, 288426.13it/s] 76%|███████▌  | 3913958/5140810 [00:13<00:04, 288602.62it/s] 77%|███████▋  | 3945671/5140810 [00:13<00:04, 288796.61it/s] 77%|███████▋  | 3978174/5140810 [00:13<00:04, 289043.98it/s] 78%|███████▊  | 4011211/5140810 [00:13<00:03, 289326.43it/s] 79%|███████▊  | 4043309/5140810 [00:13<00:03, 289537.66it/s] 79%|███████▉  | 4074863/5140810 [00:14<00:03, 289703.36it/s] 80%|███████▉  | 4107210/5140810 [00:14<00:03, 289925.74it/s] 81%|████████  | 4139530/5140810 [00:14<00:03, 290143.87it/s] 81%|████████  | 4172318/5140810 [00:14<00:03, 290391.43it/s] 82%|████████▏ | 4205447/5140810 [00:14<00:03, 290659.21it/s] 82%|████████▏ | 4240382/5140810 [00:14<00:03, 291047.32it/s] 83%|████████▎ | 4276678/5140810 [00:14<00:02, 291523.21it/s] 84%|████████▍ | 4309909/5140810 [00:14<00:02, 291785.22it/s] 85%|████████▍ | 4344112/5140810 [00:14<00:02, 292108.68it/s] 85%|████████▌ | 4383011/5140810 [00:14<00:02, 292741.82it/s] 86%|████████▌ | 4417509/5140810 [00:15<00:02, 293074.13it/s] 87%|████████▋ | 4454021/5140810 [00:15<00:02, 293534.70it/s] 87%|████████▋ | 4492758/5140810 [00:15<00:02, 294135.23it/s] 88%|████████▊ | 4530769/5140810 [00:15<00:02, 294680.25it/s] 89%|████████▉ | 4569854/5140810 [00:15<00:01, 295287.14it/s] 90%|████████▉ | 4611754/5140810 [00:15<00:01, 296067.44it/s] 91%|█████████ | 4654602/5140810 [00:15<00:01, 296898.67it/s] 91%|█████████▏| 4698542/5140810 [00:15<00:01, 297787.87it/s] 92%|█████████▏| 4744086/5140810 [00:15<00:01, 298766.73it/s] 93%|█████████▎| 4792407/5140810 [00:15<00:01, 299907.41it/s] 94%|█████████▍| 4843454/5140810 [00:16<00:00, 301203.59it/s] 95%|█████████▌| 4897128/5140810 [00:16<00:00, 302645.06it/s] 96%|█████████▋| 4953884/5140810 [00:16<00:00, 304258.89it/s] 98%|█████████▊| 5013698/5140810 [00:16<00:00, 306039.20it/s] 99%|█████████▉| 5079502/5140810 [00:16<00:00, 308161.09it/s]100%|██████████| 5140810/5140810 [00:16<00:00, 310421.83it/s]100%|██████████| 5140810/5140810 [00:16<00:00, 310416.26it/s]100%|██████████| 5140810/5140810 [00:16<00:00, 310412.77it/s]
Time to calculate C_TT with l_max=20 and c_l_ratio=0.99: 16.56174063682556 seconds with Numba
Power spectrum ratio: [0.96473793 0.82891014 1.1564743  0.85890828 1.10067824 0.88681454
 1.08435354 0.90421498 1.06798957 0.91842187 1.05660802 0.92764291
 1.0482602  0.93553637 1.04096286 0.94228998 1.03457532 0.94825152
 1.02910111]

Calculating covariance matrix
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:34<00:00, 34.42s/it]100%|██████████| 1/1 [00:34<00:00, 34.42s/it]
Calculating KL divergence

Calculating covariance matrix
KL: 24.78802424120655
