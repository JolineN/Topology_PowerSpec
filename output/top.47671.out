No shift: True
Running {'topology': 'E2', 'Lx': 1, 'Ly': 1, 'Lz': 1, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 13.90it/s] 26%|██▋       | 5/19 [00:00<00:00, 19.90it/s] 42%|████▏     | 8/19 [00:00<00:00, 22.11it/s] 58%|█████▊    | 11/19 [00:00<00:00, 23.12it/s] 74%|███████▎  | 14/19 [00:00<00:00, 23.76it/s] 89%|████████▉ | 17/19 [00:00<00:00, 24.17it/s]100%|██████████| 19/19 [00:00<00:00, 22.98it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519435485389171
Eigenmode 1: 198
Eigenmode 2: 4179528
E2 Final num of elements: 4179528 Minimum k_amp 0.0002272416186438812 n_x_max 200 n_z_max 400
Size of tilde xi: 127.55 MB.
Shape tilde xi: (4179528, 2) 

Time to get list of k, phi, theta: 5.393373727798462 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.14293049358683566
Ratio of unique |k|: 0.004380159673532513
Time to get unique k and theta: 0.9712305068969727 seconds

Getting transfer functions
  0%|          | 0/18307 [00:00<?, ?it/s]  1%|▏         | 264/18307 [00:00<00:07, 2544.92it/s]  3%|▎         | 528/18307 [00:00<00:06, 2557.39it/s]  4%|▍         | 784/18307 [00:00<00:07, 2331.79it/s]  6%|▌         | 1056/18307 [00:00<00:07, 2418.61it/s]  7%|▋         | 1320/18307 [00:00<00:06, 2445.61it/s]  9%|▉         | 1632/18307 [00:00<00:06, 2638.15it/s] 10%|█         | 1898/18307 [00:00<00:07, 2241.97it/s] 12%|█▏        | 2160/18307 [00:00<00:06, 2342.43it/s] 14%|█▎        | 2472/18307 [00:01<00:06, 2517.44it/s] 15%|█▌        | 2760/18307 [00:01<00:06, 2565.00it/s] 17%|█▋        | 3072/18307 [00:01<00:05, 2666.86it/s] 18%|█▊        | 3360/18307 [00:01<00:05, 2711.82it/s] 20%|█▉        | 3634/18307 [00:01<00:05, 2598.69it/s] 21%|██▏       | 3912/18307 [00:01<00:05, 2631.56it/s] 23%|██▎       | 4200/18307 [00:01<00:05, 2688.62it/s] 25%|██▍       | 4488/18307 [00:01<00:05, 2717.00it/s] 26%|██▌       | 4776/18307 [00:01<00:04, 2732.21it/s] 28%|██▊       | 5184/18307 [00:01<00:04, 3099.91it/s] 30%|███       | 5544/18307 [00:02<00:03, 3235.50it/s] 33%|███▎      | 5976/18307 [00:02<00:03, 3524.70it/s] 35%|███▍      | 6330/18307 [00:02<00:03, 3523.74it/s] 37%|███▋      | 6683/18307 [00:02<00:03, 3467.60it/s] 38%|███▊      | 7031/18307 [00:02<00:03, 3292.19it/s] 40%|████      | 7363/18307 [00:02<00:03, 3295.93it/s] 42%|████▏     | 7752/18307 [00:02<00:03, 3332.98it/s] 44%|████▍     | 8112/18307 [00:02<00:03, 3365.57it/s] 46%|████▌     | 8450/18307 [00:02<00:02, 3340.56it/s] 48%|████▊     | 8808/18307 [00:03<00:02, 3356.89it/s] 50%|████▉     | 9144/18307 [00:03<00:02, 3328.63it/s] 52%|█████▏    | 9504/18307 [00:03<00:02, 3391.46it/s] 54%|█████▍    | 9912/18307 [00:03<00:02, 3527.31it/s] 56%|█████▋    | 10320/18307 [00:03<00:02, 3682.70it/s] 59%|█████▊    | 10752/18307 [00:03<00:01, 3862.16it/s] 61%|██████    | 11160/18307 [00:03<00:01, 3893.55it/s] 63%|██████▎   | 11616/18307 [00:03<00:01, 4060.76it/s] 66%|██████▌   | 12023/18307 [00:03<00:01, 4026.17it/s] 68%|██████▊   | 12432/18307 [00:03<00:01, 4036.14it/s] 70%|███████   | 12840/18307 [00:04<00:01, 4032.49it/s] 72%|███████▏  | 13272/18307 [00:04<00:01, 4110.98it/s] 75%|███████▌  | 13752/18307 [00:04<00:01, 4305.50it/s] 78%|███████▊  | 14232/18307 [00:04<00:00, 4425.71it/s] 80%|████████  | 14688/18307 [00:04<00:00, 4432.22it/s] 83%|████████▎ | 15168/18307 [00:04<00:00, 4517.75it/s] 86%|████████▌ | 15720/18307 [00:04<00:00, 4773.87it/s] 89%|████████▉ | 16320/18307 [00:04<00:00, 5115.17it/s] 92%|█████████▏| 16872/18307 [00:04<00:00, 5168.89it/s] 95%|█████████▌| 17400/18307 [00:04<00:00, 5192.53it/s] 98%|█████████▊| 17920/18307 [00:05<00:00, 5140.47it/s]100%|██████████| 18307/18307 [00:05<00:00, 3564.88it/s]
Size of transfer function: 2.93 MB. 

Size of integrand: 61.6 MB. Time to calculate integrand: 0.23721837997436523 s

Getting spherical harmonics
  0%|          | 0/597382 [00:00<?, ?it/s]  1%|          | 4668/597382 [00:00<00:13, 42573.80it/s]  1%|▏         | 8926/597382 [00:00<00:18, 32653.96it/s]  2%|▏         | 12309/597382 [00:00<00:24, 23734.86it/s]  2%|▏         | 14908/597382 [00:00<00:30, 19324.31it/s]  3%|▎         | 17013/597382 [00:00<00:31, 18681.39it/s]  3%|▎         | 18974/597382 [00:00<00:31, 18296.16it/s]  4%|▎         | 21006/597382 [00:01<00:31, 18232.10it/s]  4%|▍         | 23340/597382 [00:01<00:31, 18284.62it/s]  4%|▍         | 25192/597382 [00:01<00:31, 18342.80it/s]  5%|▍         | 27230/597382 [00:01<00:32, 17703.71it/s]  5%|▍         | 29014/597382 [00:01<00:33, 17185.18it/s]  5%|▌         | 31120/597382 [00:01<00:33, 17002.36it/s]  5%|▌         | 32826/597382 [00:01<00:33, 16898.86it/s]  6%|▌         | 34518/597382 [00:01<00:34, 16348.14it/s]  6%|▌         | 36154/597382 [00:01<00:38, 14704.49it/s]  6%|▋         | 38122/597382 [00:02<00:36, 15392.54it/s]  7%|▋         | 40456/597382 [00:02<00:34, 16368.42it/s]  7%|▋         | 42790/597382 [00:02<00:34, 15949.14it/s]  8%|▊         | 45124/597382 [00:02<00:31, 17379.47it/s]  8%|▊         | 47458/597382 [00:02<00:30, 18208.86it/s]  8%|▊         | 49792/597382 [00:02<00:30, 18085.46it/s]  9%|▊         | 52126/597382 [00:02<00:28, 18916.03it/s]  9%|▉         | 54460/597382 [00:03<00:32, 16714.16it/s]  9%|▉         | 56195/597382 [00:03<00:33, 15936.75it/s] 10%|▉         | 59128/597382 [00:03<00:28, 18905.81it/s] 11%|█         | 63025/597382 [00:03<00:22, 24020.05it/s] 11%|█         | 65574/597382 [00:03<00:22, 23708.65it/s] 11%|█▏        | 68047/597382 [00:03<00:23, 22068.84it/s] 12%|█▏        | 71405/597382 [00:03<00:20, 25085.85it/s] 13%|█▎        | 74688/597382 [00:03<00:19, 26780.01it/s] 13%|█▎        | 77800/597382 [00:03<00:20, 25244.30it/s] 13%|█▎        | 80403/597382 [00:04<00:20, 25388.12it/s] 14%|█▍        | 83246/597382 [00:04<00:20, 24932.34it/s] 14%|█▍        | 86358/597382 [00:04<00:21, 23950.53it/s] 15%|█▍        | 88795/597382 [00:04<00:21, 23630.12it/s] 15%|█▌        | 91184/597382 [00:04<00:21, 23447.94it/s] 16%|█▌        | 94916/597382 [00:04<00:18, 27094.20it/s] 16%|█▋        | 98028/597382 [00:04<00:18, 26725.22it/s] 17%|█▋        | 101140/597382 [00:04<00:18, 26444.62it/s] 17%|█▋        | 104252/597382 [00:04<00:18, 25983.48it/s] 18%|█▊        | 106869/597382 [00:05<00:20, 24019.50it/s] 18%|█▊        | 109698/597382 [00:05<00:19, 24777.61it/s] 19%|█▉        | 112810/597382 [00:05<00:18, 25919.90it/s] 19%|█▉        | 115922/597382 [00:05<00:19, 24577.59it/s] 20%|█▉        | 119034/597382 [00:05<00:18, 25354.46it/s] 20%|██        | 122146/597382 [00:05<00:18, 25865.91it/s] 21%|██        | 125258/597382 [00:05<00:18, 26216.30it/s] 21%|██▏       | 127896/597382 [00:05<00:18, 25695.05it/s] 22%|██▏       | 130704/597382 [00:06<00:18, 25388.61it/s] 22%|██▏       | 133816/597382 [00:06<00:17, 26153.73it/s] 23%|██▎       | 136928/597382 [00:06<00:17, 26103.52it/s] 23%|██▎       | 140040/597382 [00:06<00:17, 25917.06it/s] 24%|██▍       | 142636/597382 [00:06<00:17, 25704.96it/s] 24%|██▍       | 145486/597382 [00:06<00:18, 24447.33it/s] 25%|██▍       | 148598/597382 [00:06<00:17, 26133.62it/s] 25%|██▌       | 151710/597382 [00:06<00:16, 27023.59it/s] 26%|██▌       | 154822/597382 [00:06<00:16, 26833.17it/s] 26%|██▋       | 157934/597382 [00:07<00:16, 25934.14it/s] 27%|██▋       | 161046/597382 [00:07<00:16, 26007.85it/s] 27%|██▋       | 163661/597382 [00:07<00:17, 25506.64it/s] 28%|██▊       | 168048/597382 [00:07<00:15, 27980.03it/s] 29%|██▊       | 171160/597382 [00:07<00:15, 28213.17it/s] 29%|██▉       | 173971/597382 [00:07<00:15, 26661.13it/s] 30%|██▉       | 177384/597382 [00:07<00:15, 27469.91it/s] 30%|███       | 180496/597382 [00:07<00:14, 27834.63it/s] 31%|███       | 184386/597382 [00:07<00:14, 28419.97it/s] 31%|███▏      | 187498/597382 [00:08<00:14, 28828.24it/s] 32%|███▏      | 190382/597382 [00:08<00:15, 27046.45it/s] 32%|███▏      | 193097/597382 [00:08<00:15, 25320.16it/s] 33%|███▎      | 195644/597382 [00:08<00:15, 25161.95it/s] 33%|███▎      | 198390/597382 [00:08<00:15, 25159.11it/s] 34%|███▎      | 200912/597382 [00:08<00:15, 25167.53it/s] 34%|███▍      | 203836/597382 [00:08<00:15, 25483.66it/s] 35%|███▍      | 206948/597382 [00:08<00:15, 24468.60it/s] 35%|███▌      | 210060/597382 [00:09<00:16, 23944.45it/s] 36%|███▌      | 213172/597382 [00:09<00:15, 25592.71it/s] 36%|███▌      | 215766/597382 [00:09<00:15, 25048.07it/s] 37%|███▋      | 219396/597382 [00:09<00:14, 25906.58it/s] 37%|███▋      | 222508/597382 [00:09<00:13, 27119.30it/s] 38%|███▊      | 226398/597382 [00:09<00:12, 28859.64it/s] 38%|███▊      | 229510/597382 [00:09<00:13, 27850.46it/s] 39%|███▉      | 232306/597382 [00:09<00:15, 23352.71it/s] 39%|███▉      | 234956/597382 [00:10<00:15, 23148.06it/s] 40%|███▉      | 238068/597382 [00:10<00:14, 24766.05it/s] 40%|████      | 240621/597382 [00:10<00:14, 24766.24it/s] 41%|████      | 243514/597382 [00:10<00:14, 24505.98it/s] 41%|████      | 246003/597382 [00:10<00:14, 23693.24it/s] 42%|████▏     | 249738/597382 [00:10<00:13, 25590.87it/s] 42%|████▏     | 252850/597382 [00:10<00:12, 26715.01it/s] 43%|████▎     | 255962/597382 [00:10<00:13, 25300.76it/s] 43%|████▎     | 258521/597382 [00:10<00:13, 24912.10it/s] 44%|████▍     | 261408/597382 [00:11<00:13, 24917.43it/s] 44%|████▍     | 264520/597382 [00:11<00:12, 26090.63it/s] 45%|████▍     | 267632/597382 [00:11<00:12, 26486.02it/s] 46%|████▌     | 273078/597382 [00:11<00:09, 33109.62it/s] 46%|████▋     | 276408/597382 [00:11<00:09, 32556.45it/s] 47%|████▋     | 279675/597382 [00:11<00:10, 30193.91it/s] 47%|████▋     | 282724/597382 [00:11<00:10, 29407.15it/s] 48%|████▊     | 285683/597382 [00:11<00:11, 26514.09it/s] 48%|████▊     | 288638/597382 [00:11<00:11, 27084.43it/s] 49%|████▉     | 291750/597382 [00:12<00:10, 28161.27it/s] 49%|████▉     | 294862/597382 [00:12<00:10, 28197.00it/s] 50%|████▉     | 297712/597382 [00:12<00:10, 27419.66it/s] 50%|█████     | 300475/597382 [00:12<00:11, 26927.26it/s] 51%|█████     | 303420/597382 [00:12<00:11, 26057.46it/s] 51%|█████     | 306041/597382 [00:12<00:11, 25672.52it/s] 52%|█████▏    | 308617/597382 [00:12<00:11, 24678.16it/s] 52%|█████▏    | 311200/597382 [00:12<00:12, 23580.66it/s] 52%|█████▏    | 313570/597382 [00:12<00:12, 23486.89it/s] 53%|█████▎    | 316646/597382 [00:13<00:11, 24559.85it/s] 54%|█████▎    | 319758/597382 [00:13<00:10, 25253.53it/s] 54%|█████▍    | 322870/597382 [00:13<00:10, 26457.91it/s] 55%|█████▍    | 325982/597382 [00:13<00:10, 26828.83it/s] 55%|█████▌    | 328670/597382 [00:13<00:10, 25826.93it/s] 55%|█████▌    | 331258/597382 [00:13<00:10, 25757.00it/s] 56%|█████▌    | 334540/597382 [00:13<00:10, 25398.05it/s] 57%|█████▋    | 337652/597382 [00:13<00:10, 25727.17it/s] 57%|█████▋    | 340764/597382 [00:13<00:09, 27049.27it/s] 58%|█████▊    | 344654/597382 [00:14<00:09, 27952.23it/s] 58%|█████▊    | 347766/597382 [00:14<00:08, 28509.81it/s] 59%|█████▉    | 351656/597382 [00:14<00:08, 29645.78it/s] 60%|█████▉    | 355546/597382 [00:14<00:08, 29371.36it/s] 60%|██████    | 359436/597382 [00:14<00:08, 29404.52it/s] 61%|██████    | 363326/597382 [00:14<00:07, 31269.68it/s] 61%|██████▏   | 366476/597382 [00:14<00:07, 30371.20it/s] 62%|██████▏   | 369525/597382 [00:14<00:07, 29899.08it/s] 62%|██████▏   | 372520/597382 [00:15<00:10, 21369.17it/s] 63%|██████▎   | 374982/597382 [00:15<00:10, 20857.09it/s] 63%|██████▎   | 377288/597382 [00:15<00:10, 21010.75it/s] 64%|██████▎   | 380442/597382 [00:15<00:09, 22428.50it/s] 64%|██████▍   | 384332/597382 [00:15<00:08, 25049.30it/s] 65%|██████▍   | 387444/597382 [00:15<00:08, 26063.88it/s] 65%|██████▌   | 390556/597382 [00:15<00:07, 27082.38it/s] 66%|██████▌   | 393333/597382 [00:15<00:07, 25787.11it/s] 66%|██████▋   | 396002/597382 [00:16<00:07, 25178.99it/s] 67%|██████▋   | 398554/597382 [00:16<00:07, 24983.63it/s] 67%|██████▋   | 401075/597382 [00:16<00:08, 21968.65it/s] 68%|██████▊   | 403782/597382 [00:16<00:08, 22368.84it/s] 68%|██████▊   | 406069/597382 [00:16<00:08, 22293.88it/s] 68%|██████▊   | 408450/597382 [00:16<00:09, 20774.67it/s] 69%|██████▉   | 412340/597382 [00:16<00:07, 23507.21it/s] 70%|██████▉   | 416230/597382 [00:16<00:06, 26458.57it/s] 70%|███████   | 419342/597382 [00:17<00:06, 26202.86it/s] 71%|███████   | 424010/597382 [00:17<00:05, 31324.98it/s] 72%|███████▏  | 427900/597382 [00:17<00:05, 29908.69it/s] 72%|███████▏  | 430966/597382 [00:17<00:06, 26999.53it/s] 73%|███████▎  | 433748/597382 [00:17<00:06, 26186.35it/s] 73%|███████▎  | 436458/597382 [00:17<00:06, 26159.52it/s] 74%|███████▎  | 439109/597382 [00:17<00:06, 24038.17it/s] 74%|███████▍  | 442682/597382 [00:17<00:05, 26777.28it/s] 75%|███████▍  | 445426/597382 [00:18<00:05, 26722.80it/s] 75%|███████▌  | 448144/597382 [00:18<00:05, 26245.42it/s] 76%|███████▌  | 452018/597382 [00:18<00:05, 25602.80it/s] 76%|███████▌  | 455130/597382 [00:18<00:05, 26045.95it/s] 77%|███████▋  | 457762/597382 [00:18<00:05, 24819.72it/s] 77%|███████▋  | 460576/597382 [00:18<00:05, 24783.01it/s] 78%|███████▊  | 466022/597382 [00:18<00:04, 32087.72it/s] 79%|███████▊  | 469303/597382 [00:18<00:04, 28951.34it/s] 79%|███████▉  | 473802/597382 [00:19<00:04, 30789.01it/s] 80%|███████▉  | 477692/597382 [00:19<00:04, 29787.87it/s] 80%|████████  | 480804/597382 [00:19<00:03, 29481.02it/s] 81%|████████  | 484694/597382 [00:19<00:03, 29907.52it/s] 82%|████████▏ | 487706/597382 [00:19<00:03, 29840.71it/s] 82%|████████▏ | 490704/597382 [00:19<00:04, 26425.38it/s] 83%|████████▎ | 493407/597382 [00:19<00:04, 21960.02it/s] 83%|████████▎ | 497142/597382 [00:19<00:04, 23939.04it/s] 84%|████████▎ | 499650/597382 [00:20<00:04, 22890.63it/s] 84%|████████▍ | 503366/597382 [00:20<00:03, 25016.30it/s] 85%|████████▍ | 507256/597382 [00:20<00:03, 26435.32it/s] 85%|████████▌ | 510368/597382 [00:20<00:03, 26713.57it/s] 86%|████████▌ | 513480/597382 [00:20<00:03, 25226.97it/s] 86%|████████▋ | 516592/597382 [00:20<00:03, 24782.17it/s] 87%|████████▋ | 519704/597382 [00:20<00:02, 25895.52it/s] 88%|████████▊ | 523594/597382 [00:20<00:02, 27957.20it/s] 88%|████████▊ | 526421/597382 [00:21<00:02, 28025.50it/s] 89%|████████▊ | 529247/597382 [00:21<00:02, 26113.15it/s] 89%|████████▉ | 532152/597382 [00:21<00:02, 24798.04it/s] 90%|████████▉ | 534662/597382 [00:21<00:02, 23224.32it/s] 90%|████████▉ | 537009/597382 [00:21<00:02, 22959.09it/s] 90%|█████████ | 539319/597382 [00:21<00:02, 20443.26it/s] 91%|█████████ | 541488/597382 [00:21<00:02, 18949.57it/s] 91%|█████████▏| 545378/597382 [00:21<00:02, 23372.77it/s] 92%|█████████▏| 550046/597382 [00:22<00:01, 29082.13it/s] 93%|█████████▎| 553158/597382 [00:22<00:01, 28047.21it/s] 93%|█████████▎| 556063/597382 [00:22<00:01, 28059.36it/s] 94%|█████████▎| 558939/597382 [00:22<00:01, 27319.44it/s] 94%|█████████▍| 561720/597382 [00:22<00:01, 24720.80it/s] 95%|█████████▍| 564828/597382 [00:22<00:01, 25132.94it/s] 95%|█████████▌| 567940/597382 [00:22<00:01, 25379.63it/s] 96%|█████████▌| 571052/597382 [00:22<00:01, 25065.82it/s] 96%|█████████▌| 574164/597382 [00:23<00:00, 24512.60it/s] 97%|█████████▋| 576636/597382 [00:23<00:00, 24535.99it/s] 97%|█████████▋| 580388/597382 [00:23<00:00, 27584.06it/s] 98%|█████████▊| 583500/597382 [00:23<00:00, 27612.35it/s] 98%|█████████▊| 586612/597382 [00:23<00:00, 27785.22it/s] 99%|█████████▉| 590502/597382 [00:23<00:00, 29485.46it/s] 99%|█████████▉| 593614/597382 [00:23<00:00, 29253.45it/s]100%|█████████▉| 596726/597382 [00:23<00:00, 29250.13it/s]100%|██████████| 597382/597382 [00:23<00:00, 25121.45it/s]
The spherical harmonics array is 526.41 MB 


**************
Done with all preprocessing
**************

Time to pre-process with l_max=20 and accuracy=0.99: 52.4252393245697 seconds

***********
Calculating a_lm realizations
***********

  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:10<00:00, 10.68s/it]100%|██████████| 1/1 [00:10<00:00, 10.68s/it]

Calculating covariance matrix
  0%|          | 0/4179528 [00:00<?, ?it/s]  0%|          | 0/4179528 [00:00<?, ?it/s]Only calculating diagonal
  0%|          | 0/4179528 [00:00<?, ?it/s]  0%|          | 0/4179528 [00:00<?, ?it/s]  0%|          | 0/4179528 [00:00<?, ?it/s]  0%|          | 0/4179528 [00:00<?, ?it/s]  0%|          | 0/4179528 [00:00<?, ?it/s]  0%|          | 0/4179528 [00:00<?, ?it/s]  0%|          | 0/4179528 [00:00<?, ?it/s]  1%|          | 43162/4179528 [00:00<01:28, 46857.12it/s]  2%|▏         | 87905/4179528 [00:01<00:47, 86057.26it/s]  3%|▎         | 127882/4179528 [00:01<00:35, 113999.99it/s]  4%|▍         | 167069/4179528 [00:01<00:29, 136706.19it/s]  5%|▍         | 205449/4179528 [00:01<00:25, 155359.74it/s]  6%|▌         | 244245/4179528 [00:01<00:22, 171614.35it/s]  7%|▋         | 281872/4179528 [00:01<00:21, 184979.18it/s]  8%|▊         | 318039/4179528 [00:01<00:19, 195768.41it/s]  8%|▊         | 353528/4179528 [00:01<00:18, 204906.96it/s]  9%|▉         | 388020/4179528 [00:01<00:17, 212489.16it/s] 10%|█         | 422671/4179528 [00:01<00:17, 219404.74it/s] 11%|█         | 456583/4179528 [00:02<00:16, 225279.50it/s] 12%|█▏        | 488395/4179528 [00:02<00:16, 229611.57it/s] 12%|█▏        | 519541/4179528 [00:02<00:15, 233251.34it/s] 13%|█▎        | 550445/4179528 [00:02<00:15, 236477.60it/s] 14%|█▍        | 579036/4179528 [00:02<00:15, 238480.76it/s] 15%|█▍        | 609989/4179528 [00:02<00:14, 241262.37it/s] 15%|█▌        | 639564/4179528 [00:02<00:14, 243306.45it/s] 16%|█▌        | 667318/4179528 [00:02<00:14, 244533.39it/s] 17%|█▋        | 695824/4179528 [00:02<00:14, 245940.02it/s] 17%|█▋        | 725135/4179528 [00:02<00:13, 247524.97it/s] 18%|█▊        | 754780/4179528 [00:03<00:13, 249115.25it/s] 19%|█▊        | 782693/4179528 [00:03<00:13, 250050.51it/s] 19%|█▉        | 810519/4179528 [00:03<00:13, 250900.84it/s] 20%|██        | 837683/4179528 [00:03<00:13, 251501.06it/s] 21%|██        | 865292/4179528 [00:03<00:13, 252194.25it/s] 21%|██▏       | 892623/4179528 [00:03<00:13, 252768.57it/s] 22%|██▏       | 920148/4179528 [00:03<00:12, 253366.82it/s] 23%|██▎       | 947646/4179528 [00:03<00:12, 253924.98it/s] 23%|██▎       | 975024/4179528 [00:03<00:12, 254423.39it/s] 24%|██▍       | 1002238/4179528 [00:03<00:12, 254854.68it/s] 25%|██▍       | 1029420/4179528 [00:04<00:12, 255256.50it/s] 25%|██▌       | 1056538/4179528 [00:04<00:12, 255623.24it/s] 26%|██▌       | 1083272/4179528 [00:04<00:12, 255882.12it/s] 27%|██▋       | 1110345/4179528 [00:04<00:11, 256206.53it/s] 27%|██▋       | 1137052/4179528 [00:04<00:11, 256417.81it/s] 28%|██▊       | 1163981/4179528 [00:04<00:11, 256673.84it/s] 28%|██▊       | 1190724/4179528 [00:04<00:11, 256889.45it/s] 29%|██▉       | 1217445/4179528 [00:04<00:11, 257091.07it/s] 30%|██▉       | 1246023/4179528 [00:04<00:11, 257668.56it/s] 30%|███       | 1272672/4179528 [00:04<00:11, 257831.20it/s] 31%|███       | 1299312/4179528 [00:05<00:11, 257986.14it/s] 32%|███▏      | 1325923/4179528 [00:05<00:11, 258129.39it/s] 32%|███▏      | 1349754/4179528 [00:05<00:10, 257729.85it/s] 33%|███▎      | 1375271/4179528 [00:05<00:10, 257665.54it/s] 34%|███▎      | 1401136/4179528 [00:05<00:10, 257669.53it/s] 34%|███▍      | 1427294/4179528 [00:05<00:10, 257725.76it/s] 35%|███▍      | 1453627/4179528 [00:05<00:10, 257811.51it/s] 35%|███▌      | 1479993/4179528 [00:05<00:10, 257900.11it/s] 36%|███▌      | 1506638/4179528 [00:05<00:10, 258032.87it/s] 37%|███▋      | 1531357/4179528 [00:05<00:10, 257837.47it/s] 37%|███▋      | 1555959/4179528 [00:06<00:10, 257628.94it/s] 38%|███▊      | 1581587/4179528 [00:06<00:10, 257593.70it/s] 38%|███▊      | 1607544/4179528 [00:06<00:09, 257613.02it/s] 39%|███▉      | 1633656/4179528 [00:06<00:09, 257656.24it/s] 40%|███▉      | 1659703/4179528 [00:06<00:09, 257687.52it/s] 40%|████      | 1685027/4179528 [00:06<00:09, 257607.35it/s] 41%|████      | 1708825/4179528 [00:06<00:09, 257300.28it/s] 41%|████▏     | 1734425/4179528 [00:06<00:09, 257269.65it/s] 42%|████▏     | 1760445/4179528 [00:06<00:09, 257300.90it/s] 43%|████▎     | 1786489/4179528 [00:06<00:09, 257335.11it/s] 43%|████▎     | 1812649/4179528 [00:07<00:09, 257384.06it/s] 44%|████▍     | 1836570/4179528 [00:07<00:09, 257118.60it/s] 45%|████▍     | 1861183/4179528 [00:07<00:09, 256956.28it/s] 45%|████▌     | 1886945/4179528 [00:07<00:08, 256954.90it/s] 46%|████▌     | 1912718/4179528 [00:07<00:08, 256954.70it/s] 46%|████▋     | 1938882/4179528 [00:07<00:08, 257006.60it/s] 47%|████▋     | 1964841/4179528 [00:07<00:08, 257030.45it/s] 48%|████▊     | 1987728/4179528 [00:07<00:08, 256656.97it/s] 48%|████▊     | 2013147/4179528 [00:07<00:08, 256615.33it/s] 49%|████▉     | 2039032/4179528 [00:07<00:08, 256633.78it/s] 49%|████▉     | 2065399/4179528 [00:08<00:08, 256711.45it/s] 50%|█████     | 2092604/4179528 [00:08<00:08, 256890.09it/s] 51%|█████     | 2116125/4179528 [00:08<00:08, 256617.73it/s] 51%|█████     | 2140958/4179528 [00:08<00:07, 256509.14it/s] 52%|█████▏    | 2166448/4179528 [00:08<00:07, 256471.52it/s] 52%|█████▏    | 2192564/4179528 [00:08<00:07, 256511.26it/s] 53%|█████▎    | 2218704/4179528 [00:08<00:07, 256558.71it/s] 54%|█████▎    | 2242456/4179528 [00:08<00:07, 256332.11it/s] 54%|█████▍    | 2267210/4179528 [00:08<00:07, 256224.07it/s] 55%|█████▍    | 2292792/4179528 [00:08<00:07, 256210.90it/s] 55%|█████▌    | 2318874/4179528 [00:09<00:07, 256253.45it/s] 56%|█████▌    | 2345265/4179528 [00:09<00:07, 256328.81it/s] 57%|█████▋    | 2369175/4179528 [00:09<00:07, 256130.84it/s] 57%|█████▋    | 2393669/4179528 [00:09<00:06, 256001.97it/s] 58%|█████▊    | 2419167/4179528 [00:09<00:06, 255983.13it/s] 59%|█████▊    | 2445168/4179528 [00:09<00:06, 256017.00it/s] 59%|█████▉    | 2471540/4179528 [00:09<00:06, 256088.82it/s] 60%|█████▉    | 2497906/4179528 [00:09<00:06, 256158.62it/s] 60%|██████    | 2520993/4179528 [00:09<00:06, 255894.09it/s] 61%|██████    | 2546417/4179528 [00:09<00:06, 255869.21it/s] 62%|██████▏   | 2572462/4179528 [00:10<00:06, 255907.09it/s] 62%|██████▏   | 2598760/4179528 [00:10<00:06, 255969.28it/s] 63%|██████▎   | 2625140/4179528 [00:10<00:06, 256037.98it/s] 63%|██████▎   | 2651754/4179528 [00:10<00:05, 256128.18it/s] 64%|██████▍   | 2675278/4179528 [00:10<00:05, 255921.07it/s] 65%|██████▍   | 2701036/4179528 [00:10<00:05, 255929.39it/s] 65%|██████▌   | 2727119/4179528 [00:10<00:05, 255968.27it/s] 66%|██████▌   | 2753493/4179528 [00:10<00:05, 256033.46it/s] 67%|██████▋   | 2780013/4179528 [00:10<00:05, 256110.88it/s] 67%|██████▋   | 2806679/4179528 [00:10<00:05, 256199.95it/s] 68%|██████▊   | 2833444/4179528 [00:11<00:05, 256296.62it/s] 68%|██████▊   | 2857890/4179528 [00:11<00:05, 256183.72it/s] 69%|██████▉   | 2883221/4179528 [00:11<00:05, 256151.22it/s] 70%|██████▉   | 2909585/4179528 [00:11<00:04, 256210.49it/s] 70%|███████   | 2936137/4179528 [00:11<00:04, 256285.10it/s] 71%|███████   | 2962940/4179528 [00:11<00:04, 256379.91it/s] 72%|███████▏  | 2989572/4179528 [00:11<00:04, 256458.35it/s] 72%|███████▏  | 3016568/4179528 [00:11<00:04, 256566.65it/s] 73%|███████▎  | 3043652/4179528 [00:11<00:04, 256680.58it/s] 73%|███████▎  | 3070697/4179528 [00:11<00:04, 256789.12it/s] 74%|███████▍  | 3097859/4179528 [00:12<00:04, 256905.78it/s] 75%|███████▍  | 3125162/4179528 [00:12<00:04, 257032.10it/s] 75%|███████▌  | 3152484/4179528 [00:12<00:03, 257157.67it/s] 76%|███████▌  | 3179917/4179528 [00:12<00:03, 257290.39it/s] 77%|███████▋  | 3207397/4179528 [00:12<00:03, 257424.65it/s] 77%|███████▋  | 3234938/4179528 [00:12<00:03, 257561.63it/s] 78%|███████▊  | 3262596/4179528 [00:12<00:03, 257705.53it/s] 79%|███████▊  | 3290421/4179528 [00:12<00:03, 257860.37it/s] 79%|███████▉  | 3318151/4179528 [00:12<00:03, 258005.29it/s] 80%|████████  | 3346235/4179528 [00:12<00:03, 258175.54it/s] 81%|████████  | 3374356/4179528 [00:13<00:03, 258346.06it/s] 81%|████████▏ | 3403047/4179528 [00:13<00:03, 258557.25it/s] 82%|████████▏ | 3432253/4179528 [00:13<00:02, 258803.80it/s] 83%|████████▎ | 3462676/4179528 [00:13<00:02, 259137.96it/s] 84%|████████▎ | 3491156/4179528 [00:13<00:02, 259322.76it/s] 84%|████████▍ | 3519998/4179528 [00:13<00:02, 259531.48it/s] 85%|████████▍ | 3549607/4179528 [00:13<00:02, 259793.40it/s] 86%|████████▌ | 3581369/4179528 [00:13<00:02, 260208.27it/s] 86%|████████▋ | 3610812/4179528 [00:13<00:02, 260449.53it/s] 87%|████████▋ | 3641404/4179528 [00:13<00:02, 260769.31it/s] 88%|████████▊ | 3673476/4179528 [00:14<00:01, 261190.01it/s] 89%|████████▊ | 3704586/4179528 [00:14<00:01, 261537.23it/s] 89%|████████▉ | 3737506/4179528 [00:14<00:01, 262005.93it/s] 90%|█████████ | 3771721/4179528 [00:14<00:01, 262558.41it/s] 91%|█████████ | 3803871/4179528 [00:14<00:01, 262960.46it/s] 92%|█████████▏| 3838438/4179528 [00:14<00:01, 263522.94it/s] 93%|█████████▎| 3872983/4179528 [00:14<00:01, 264076.24it/s] 94%|█████████▎| 3909408/4179528 [00:14<00:01, 264749.33it/s] 94%|█████████▍| 3948530/4179528 [00:14<00:00, 265594.75it/s] 95%|█████████▌| 3987674/4179528 [00:14<00:00, 266429.80it/s] 97%|█████████▋| 4035128/4179528 [00:15<00:00, 267805.76it/s] 98%|█████████▊| 4082138/4179528 [00:15<00:00, 269134.22it/s] 99%|█████████▉| 4136545/4179528 [00:15<00:00, 270929.52it/s]100%|██████████| 4179528/4179528 [00:15<00:00, 272669.90it/s]100%|██████████| 4179528/4179528 [00:15<00:00, 272663.59it/s]100%|██████████| 4179528/4179528 [00:15<00:00, 272659.17it/s]
Time to calculate C_TT with l_max=20 and c_l_ratio=0.99: 15.329365491867065 seconds with Numba
Power spectrum ratio: [0.97247872 0.82991356 1.15359363 0.8451012  1.11546259 0.88206971
 1.08791176 0.90408673 1.06824856 0.91778898 1.05697046 0.92774014
 1.04798031 0.93582103 1.04071935 0.94247137 1.03452208 0.94815389
 1.0293106 ]

Calculating covariance matrix
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:29<00:00, 29.78s/it]100%|██████████| 1/1 [00:29<00:00, 29.78s/it]
Calculating KL divergence

Calculating covariance matrix
KL: 26.047804619900866
