Cubic Torus
Running - E1 l_max=20, Lx=27649
Running {'topology': 'E1', 'Lx': 1.0, 'Ly': 1.0, 'Lz': 1.0, 'x0': array([0., 0., 0.]), 'beta': 90, 'alpha': 90, 'gamma': 0, 'c_l_accuracy': 0.99, 'l_max': 20, 'do_polarization': False, 'A_s': 2e-09, 'n_s': 0.965, 'number_of_a_lm_realizations': 1}
Shape of transfer function from CAMB: (3, 169, 2853)

Finding k_max as a function of ell
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 17.29it/s] 26%|██▋       | 5/19 [00:00<00:00, 23.15it/s] 42%|████▏     | 8/19 [00:00<00:00, 25.13it/s] 58%|█████▊    | 11/19 [00:00<00:00, 25.95it/s] 74%|███████▎  | 14/19 [00:00<00:00, 26.51it/s] 89%|████████▉ | 17/19 [00:00<00:00, 26.90it/s]100%|██████████| 19/19 [00:00<00:00, 25.87it/s]
Done. k_max for TT ell_max = 0.02270755150739349 k_max for EE ell_max = 0.08519137292225934
inv sin and tan 1.0 6.123233995736766e-17
Final num of elements: 220776744 Minimum k_amp 0.0002272416186438812 n_x_max 375 n_z_max 375
Time to get list of k, phi, theta: 24.045088291168213 seconds
Getting repeated theta and k elements
Ratio of unique theta: 0.04900664265616672
Ratio of unique |k|: 0.0005306174820659552
Time to get unique k and theta: 78.17309427261353 seconds

Getting transfer functions
  0%|          | 0/117148 [00:00<?, ?it/s]  1%|          | 1377/117148 [00:00<00:08, 13627.61it/s]  2%|▏         | 2740/117148 [00:00<00:09, 12068.40it/s]  3%|▎         | 3958/117148 [00:00<00:11, 9749.39it/s]   4%|▍         | 4974/117148 [00:00<00:11, 9600.50it/s]  5%|▌         | 5957/117148 [00:00<00:11, 9482.49it/s]  6%|▌         | 6919/117148 [00:00<00:12, 8988.45it/s]  7%|▋         | 7828/117148 [00:00<00:12, 8703.78it/s]  8%|▊         | 8874/117148 [00:00<00:11, 9178.25it/s]  9%|▉         | 10557/117148 [00:01<00:09, 11041.84it/s] 10%|▉         | 11668/117148 [00:01<00:11, 9426.39it/s]  11%|█         | 12852/117148 [00:01<00:10, 9704.79it/s] 12%|█▏        | 13852/117148 [00:01<00:11, 9248.68it/s] 13%|█▎        | 14797/117148 [00:01<00:11, 8968.09it/s] 13%|█▎        | 15707/117148 [00:01<00:11, 8616.44it/s] 14%|█▍        | 16830/117148 [00:01<00:11, 9002.99it/s] 15%|█▌        | 17748/117148 [00:01<00:11, 8906.94it/s] 16%|█▌        | 18819/117148 [00:01<00:10, 9323.82it/s] 17%|█▋        | 19758/117148 [00:02<00:10, 9237.36it/s] 18%|█▊        | 20961/117148 [00:02<00:09, 9773.55it/s] 19%|█▉        | 22032/117148 [00:02<00:09, 9970.79it/s] 20%|█▉        | 23409/117148 [00:02<00:08, 10552.73it/s] 21%|██        | 24633/117148 [00:02<00:08, 10738.44it/s] 22%|██▏       | 25857/117148 [00:02<00:08, 10861.07it/s] 23%|██▎       | 26943/117148 [00:02<00:08, 10691.31it/s] 24%|██▍       | 28152/117148 [00:02<00:08, 10559.30it/s] 25%|██▌       | 29376/117148 [00:02<00:08, 10922.95it/s] 26%|██▋       | 30753/117148 [00:03<00:07, 11461.15it/s] 28%|██▊       | 32589/117148 [00:03<00:06, 13365.61it/s] 29%|██▉       | 34180/117148 [00:03<00:05, 14095.70it/s] 31%|███       | 35955/117148 [00:03<00:05, 15157.15it/s] 32%|███▏      | 37482/117148 [00:03<00:05, 14425.81it/s] 33%|███▎      | 39168/117148 [00:03<00:05, 14972.56it/s] 35%|███▍      | 40851/117148 [00:03<00:05, 15038.37it/s] 36%|███▌      | 42363/117148 [00:03<00:05, 14868.60it/s] 37%|███▋      | 43911/117148 [00:03<00:04, 14880.26it/s] 39%|███▉      | 45594/117148 [00:04<00:04, 15344.71it/s] 40%|████      | 47133/117148 [00:04<00:04, 14813.79it/s] 42%|████▏     | 48620/117148 [00:04<00:04, 14428.85it/s] 43%|████▎     | 50490/117148 [00:04<00:04, 15182.17it/s] 44%|████▍     | 52010/117148 [00:04<00:04, 14335.29it/s] 46%|████▌     | 53856/117148 [00:04<00:04, 15309.83it/s] 47%|████▋     | 55398/117148 [00:04<00:04, 13451.61it/s] 49%|████▊     | 56916/117148 [00:04<00:04, 13247.31it/s] 51%|█████     | 59211/117148 [00:04<00:03, 15772.01it/s] 52%|█████▏    | 60846/117148 [00:05<00:03, 14660.56it/s] 53%|█████▎    | 62362/117148 [00:05<00:03, 14197.52it/s] 55%|█████▍    | 64107/117148 [00:05<00:03, 14864.25it/s] 56%|█████▌    | 65624/117148 [00:05<00:03, 14541.95it/s] 57%|█████▋    | 67167/117148 [00:05<00:03, 14632.79it/s] 59%|█████▉    | 69156/117148 [00:05<00:03, 15094.58it/s] 60%|██████    | 70686/117148 [00:05<00:03, 14709.58it/s] 62%|██████▏   | 72522/117148 [00:05<00:02, 15601.98it/s] 63%|██████▎   | 74092/117148 [00:05<00:02, 14867.19it/s] 65%|██████▌   | 76347/117148 [00:06<00:02, 16568.38it/s] 67%|██████▋   | 78015/117148 [00:06<00:02, 16474.81it/s] 68%|██████▊   | 79713/117148 [00:06<00:02, 16108.41it/s] 70%|██████▉   | 81702/117148 [00:06<00:02, 16697.10it/s] 71%|███████   | 83376/117148 [00:06<00:02, 16432.06it/s] 73%|███████▎  | 85022/117148 [00:06<00:02, 15717.69it/s] 74%|███████▍  | 86751/117148 [00:06<00:01, 15519.30it/s] 76%|███████▌  | 88893/117148 [00:06<00:01, 16690.09it/s] 78%|███████▊  | 91035/117148 [00:06<00:01, 17709.71it/s] 79%|███████▉  | 92813/117148 [00:07<00:01, 17058.57it/s] 81%|████████  | 94554/117148 [00:07<00:01, 16986.99it/s] 82%|████████▏ | 96390/117148 [00:07<00:01, 17217.07it/s] 84%|████████▍ | 98226/117148 [00:07<00:01, 17534.46it/s] 85%|████████▌ | 99984/117148 [00:07<00:00, 17284.11it/s] 87%|████████▋ | 102051/117148 [00:07<00:00, 18137.93it/s] 89%|████████▊ | 103869/117148 [00:07<00:00, 17768.17it/s] 90%|█████████ | 105650/117148 [00:07<00:00, 17379.23it/s] 92%|█████████▏| 107406/117148 [00:07<00:00, 17110.65it/s] 93%|█████████▎| 109242/117148 [00:08<00:00, 17350.35it/s] 95%|█████████▌| 111384/117148 [00:08<00:00, 18464.18it/s] 97%|█████████▋| 113235/117148 [00:08<00:00, 17732.89it/s] 99%|█████████▊| 115515/117148 [00:08<00:00, 18423.84it/s]100%|██████████| 117148/117148 [00:08<00:00, 13885.31it/s]
Size of transfer function: 18.77 MB. 

Size of integrand: 394.15 MB. Time to calculate integrand: 0.6190609931945801 s

Getting spherical harmonics
  0%|          | 0/10819527 [00:00<?, ?it/s]  0%|          | 8381/10819527 [00:00<03:04, 58501.24it/s]  0%|          | 14232/10819527 [00:00<04:25, 40746.76it/s]  0%|          | 28176/10819527 [00:00<02:52, 62726.00it/s]  0%|          | 42264/10819527 [00:00<02:26, 73747.28it/s]  1%|          | 56352/10819527 [00:00<02:11, 82033.62it/s]  1%|          | 70440/10819527 [00:00<02:20, 76427.26it/s]  1%|          | 84528/10819527 [00:01<02:23, 74633.04it/s]  1%|          | 98616/10819527 [00:01<02:27, 72531.15it/s]  1%|          | 112704/10819527 [00:01<02:24, 73930.87it/s]  1%|          | 126792/10819527 [00:01<02:19, 76425.14it/s]  1%|▏         | 140880/10819527 [00:01<02:25, 73175.44it/s]  1%|▏         | 154968/10819527 [00:02<02:23, 74211.37it/s]  2%|▏         | 169056/10819527 [00:02<02:19, 76317.64it/s]  2%|▏         | 183144/10819527 [00:02<02:29, 70922.78it/s]  2%|▏         | 197232/10819527 [00:02<02:17, 77327.76it/s]  2%|▏         | 211320/10819527 [00:02<02:18, 76470.31it/s]  2%|▏         | 225408/10819527 [00:03<02:16, 77387.54it/s]  2%|▏         | 239496/10819527 [00:03<02:30, 70306.33it/s]  2%|▏         | 253584/10819527 [00:03<02:28, 71339.20it/s]  2%|▏         | 267672/10819527 [00:03<02:34, 68125.23it/s]  3%|▎         | 281760/10819527 [00:03<02:47, 63097.17it/s]  3%|▎         | 295848/10819527 [00:04<02:36, 67287.94it/s]  3%|▎         | 309936/10819527 [00:04<02:41, 65136.65it/s]  3%|▎         | 324024/10819527 [00:04<02:54, 60159.54it/s]  3%|▎         | 338112/10819527 [00:04<02:45, 63253.28it/s]  3%|▎         | 352200/10819527 [00:05<02:32, 68704.40it/s]  3%|▎         | 366288/10819527 [00:05<02:22, 73431.83it/s]  4%|▎         | 380376/10819527 [00:05<02:17, 76159.10it/s]  4%|▎         | 394464/10819527 [00:05<02:30, 69079.16it/s]  4%|▍         | 408552/10819527 [00:05<02:35, 66955.08it/s]  4%|▍         | 422640/10819527 [00:06<02:55, 59369.20it/s]  4%|▍         | 436728/10819527 [00:06<03:03, 56705.33it/s]  4%|▍         | 450816/10819527 [00:06<03:13, 53579.58it/s]  4%|▍         | 464904/10819527 [00:07<03:25, 50423.95it/s]  4%|▍         | 478992/10819527 [00:07<03:27, 49803.33it/s]  5%|▍         | 493080/10819527 [00:07<03:33, 48314.08it/s]  5%|▍         | 507168/10819527 [00:07<03:35, 47860.81it/s]  5%|▍         | 521256/10819527 [00:08<03:49, 44933.81it/s]  5%|▍         | 535344/10819527 [00:08<04:04, 41981.52it/s]  5%|▌         | 549432/10819527 [00:08<04:00, 42691.58it/s]  5%|▌         | 563520/10819527 [00:09<03:59, 42846.02it/s]  5%|▌         | 577608/10819527 [00:09<04:02, 42185.96it/s]  5%|▌         | 591696/10819527 [00:10<04:08, 41221.58it/s]  6%|▌         | 605784/10819527 [00:10<04:11, 40635.37it/s]  6%|▌         | 619872/10819527 [00:10<04:17, 39671.25it/s]  6%|▌         | 633960/10819527 [00:11<04:21, 38976.11it/s]  6%|▌         | 648048/10819527 [00:11<04:21, 38911.16it/s]  6%|▌         | 662136/10819527 [00:11<04:29, 37624.41it/s]  6%|▋         | 676224/10819527 [00:12<04:27, 37942.91it/s]  6%|▋         | 690312/10819527 [00:12<04:29, 37617.99it/s]  7%|▋         | 704400/10819527 [00:13<04:40, 36067.39it/s]  7%|▋         | 718488/10819527 [00:13<04:48, 35054.00it/s]  7%|▋         | 732576/10819527 [00:13<04:47, 35071.37it/s]  7%|▋         | 746664/10819527 [00:14<05:05, 32986.10it/s]  7%|▋         | 760752/10819527 [00:14<05:22, 31148.97it/s]  7%|▋         | 774840/10819527 [00:15<05:45, 29055.98it/s]  7%|▋         | 788928/10819527 [00:15<05:32, 30186.99it/s]  7%|▋         | 803016/10819527 [00:16<05:41, 29332.10it/s]  8%|▊         | 817104/10819527 [00:16<06:05, 27389.31it/s]  8%|▊         | 831192/10819527 [00:17<06:14, 26676.94it/s]  8%|▊         | 845280/10819527 [00:18<06:05, 27270.60it/s]  8%|▊         | 859368/10819527 [00:18<06:48, 24388.30it/s]  8%|▊         | 873456/10819527 [00:19<07:01, 23599.25it/s]  8%|▊         | 887544/10819527 [00:19<06:55, 23907.21it/s]  8%|▊         | 901632/10819527 [00:20<07:43, 21388.84it/s]  8%|▊         | 915720/10819527 [00:21<07:01, 23481.39it/s]  9%|▊         | 929808/10819527 [00:22<07:49, 21043.83it/s]  9%|▊         | 943896/10819527 [00:22<08:21, 19706.68it/s]  9%|▉         | 957984/10819527 [00:23<07:31, 21841.50it/s]  9%|▉         | 972072/10819527 [00:24<08:00, 20500.98it/s]  9%|▉         | 986160/10819527 [00:24<08:07, 20162.18it/s]  9%|▉         | 1000248/10819527 [00:25<07:24, 22080.73it/s]  9%|▉         | 1009256/10819527 [00:25<06:23, 25558.92it/s]  9%|▉         | 1014336/10819527 [00:26<07:41, 21258.61it/s] 10%|▉         | 1028424/10819527 [00:26<07:46, 20990.02it/s] 10%|▉         | 1042512/10819527 [00:27<06:58, 23380.62it/s] 10%|▉         | 1056600/10819527 [00:27<06:31, 24909.43it/s] 10%|▉         | 1070688/10819527 [00:28<07:02, 23081.31it/s] 10%|█         | 1084776/10819527 [00:28<06:35, 24640.54it/s] 10%|█         | 1098864/10819527 [00:29<06:23, 25367.55it/s] 10%|█         | 1112952/10819527 [00:29<06:07, 26422.70it/s] 10%|█         | 1127040/10819527 [00:30<06:17, 25652.31it/s] 11%|█         | 1141128/10819527 [00:30<05:44, 28107.93it/s] 11%|█         | 1155216/10819527 [00:31<06:10, 26056.76it/s] 11%|█         | 1169304/10819527 [00:31<06:07, 26272.28it/s] 11%|█         | 1183392/10819527 [00:32<06:20, 25325.07it/s] 11%|█         | 1197480/10819527 [00:33<06:13, 25766.82it/s] 11%|█         | 1211568/10819527 [00:33<06:00, 26632.72it/s] 11%|█▏        | 1225656/10819527 [00:34<06:08, 26035.22it/s] 11%|█▏        | 1239744/10819527 [00:34<06:06, 26129.21it/s] 12%|█▏        | 1253832/10819527 [00:35<05:57, 26780.61it/s] 12%|█▏        | 1267920/10819527 [00:35<06:35, 24143.72it/s] 12%|█▏        | 1282008/10819527 [00:36<06:19, 25119.57it/s] 12%|█▏        | 1296096/10819527 [00:37<06:30, 24408.58it/s] 12%|█▏        | 1310184/10819527 [00:37<05:46, 27439.22it/s] 12%|█▏        | 1324272/10819527 [00:38<06:04, 26028.65it/s] 12%|█▏        | 1338360/10819527 [00:38<05:54, 26715.45it/s] 13%|█▎        | 1352448/10819527 [00:38<05:26, 29016.32it/s] 13%|█▎        | 1366536/10819527 [00:39<05:55, 26573.86it/s] 13%|█▎        | 1380624/10819527 [00:40<06:24, 24573.92it/s] 13%|█▎        | 1394712/10819527 [00:40<06:28, 24250.59it/s] 13%|█▎        | 1408800/10819527 [00:41<06:11, 25312.98it/s] 13%|█▎        | 1422888/10819527 [00:41<05:57, 26307.59it/s] 13%|█▎        | 1436976/10819527 [00:42<05:57, 26222.03it/s] 13%|█▎        | 1451064/10819527 [00:42<05:48, 26902.27it/s] 14%|█▎        | 1465152/10819527 [00:43<05:31, 28237.99it/s] 14%|█▎        | 1479240/10819527 [00:43<06:13, 25010.08it/s] 14%|█▍        | 1493328/10819527 [00:44<05:43, 27144.00it/s] 14%|█▍        | 1507416/10819527 [00:44<05:15, 29472.21it/s] 14%|█▍        | 1521504/10819527 [00:45<05:14, 29529.38it/s] 14%|█▍        | 1535592/10819527 [00:45<05:52, 26348.92it/s] 14%|█▍        | 1538361/10819527 [00:46<06:04, 25458.97it/s] 14%|█▍        | 1549680/10819527 [00:46<05:55, 26059.18it/s] 14%|█▍        | 1563768/10819527 [00:46<05:45, 26795.76it/s] 15%|█▍        | 1577856/10819527 [00:47<06:21, 24204.25it/s] 15%|█▍        | 1591944/10819527 [00:48<06:05, 25264.66it/s] 15%|█▍        | 1606032/10819527 [00:48<06:20, 24207.71it/s] 15%|█▍        | 1620120/10819527 [00:49<05:58, 25676.22it/s] 15%|█▌        | 1634208/10819527 [00:50<06:49, 22409.16it/s] 15%|█▌        | 1648296/10819527 [00:50<05:55, 25824.03it/s] 15%|█▌        | 1662384/10819527 [00:50<05:30, 27686.13it/s] 15%|█▌        | 1676472/10819527 [00:51<05:19, 28655.89it/s] 16%|█▌        | 1685222/10819527 [00:51<04:37, 32867.45it/s] 16%|█▌        | 1690560/10819527 [00:51<05:52, 25909.30it/s] 16%|█▌        | 1704648/10819527 [00:52<05:24, 28109.48it/s] 16%|█▌        | 1718736/10819527 [00:52<05:27, 27812.28it/s] 16%|█▌        | 1732824/10819527 [00:53<05:29, 27559.65it/s] 16%|█▌        | 1746912/10819527 [00:53<05:02, 30037.36it/s] 16%|█▋        | 1761000/10819527 [00:54<04:39, 32375.23it/s] 16%|█▋        | 1775088/10819527 [00:54<04:32, 33182.28it/s] 17%|█▋        | 1789176/10819527 [00:55<05:43, 26262.63it/s] 17%|█▋        | 1803264/10819527 [00:55<05:39, 26535.83it/s] 17%|█▋        | 1817352/10819527 [00:56<05:46, 25973.19it/s] 17%|█▋        | 1831440/10819527 [00:56<04:55, 30388.67it/s] 17%|█▋        | 1845528/10819527 [00:57<04:45, 31420.74it/s] 17%|█▋        | 1859616/10819527 [00:57<04:44, 31535.70it/s] 17%|█▋        | 1873704/10819527 [00:58<04:52, 30572.26it/s] 17%|█▋        | 1887792/10819527 [00:58<05:02, 29571.79it/s] 18%|█▊        | 1901880/10819527 [00:58<04:56, 30081.40it/s] 18%|█▊        | 1915968/10819527 [00:59<05:22, 27607.35it/s] 18%|█▊        | 1930056/10819527 [00:59<05:04, 29218.44it/s] 18%|█▊        | 1944144/10819527 [01:00<05:15, 28159.92it/s] 18%|█▊        | 1958232/10819527 [01:01<05:44, 25712.22it/s] 18%|█▊        | 1972320/10819527 [01:01<05:37, 26213.45it/s] 18%|█▊        | 1982317/10819527 [01:01<04:53, 30066.10it/s] 18%|█▊        | 1986408/10819527 [01:02<06:01, 24404.11it/s] 18%|█▊        | 2000496/10819527 [01:02<06:20, 23160.99it/s] 19%|█▊        | 2014584/10819527 [01:03<06:13, 23544.73it/s] 19%|█▉        | 2028672/10819527 [01:03<05:26, 26891.95it/s] 19%|█▉        | 2042760/10819527 [01:04<05:40, 25745.19it/s] 19%|█▉        | 2056848/10819527 [01:04<05:29, 26595.77it/s] 19%|█▉        | 2070936/10819527 [01:05<05:29, 26537.18it/s] 19%|█▉        | 2085024/10819527 [01:05<05:05, 28609.53it/s] 19%|█▉        | 2099112/10819527 [01:06<05:16, 27510.48it/s] 20%|█▉        | 2113200/10819527 [01:06<05:04, 28562.48it/s] 20%|█▉        | 2127288/10819527 [01:07<04:45, 30492.30it/s] 20%|█▉        | 2141376/10819527 [01:07<05:02, 28658.58it/s] 20%|█▉        | 2155464/10819527 [01:08<05:04, 28459.58it/s] 20%|██        | 2169552/10819527 [01:08<05:09, 27933.21it/s] 20%|██        | 2183640/10819527 [01:09<05:33, 25916.30it/s] 20%|██        | 2197728/10819527 [01:09<05:15, 27367.14it/s] 20%|██        | 2211816/10819527 [01:10<05:10, 27684.91it/s] 21%|██        | 2225904/10819527 [01:10<05:04, 28222.45it/s] 21%|██        | 2239992/10819527 [01:11<04:45, 30076.42it/s] 21%|██        | 2254080/10819527 [01:12<05:20, 26730.71it/s]/var/spool/slurm/d/job47711/slurm_script: line 9: 205409 Killed                  python run_topology.py
slurmstepd: error: Detected 3 oom-kill event(s) in StepId=47711.batch cgroup. Some of your processes may have been killed by the cgroup out-of-memory handler.
